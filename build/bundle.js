(function e(t,r,i){function n(o,s){if(!r[o]){if(!t[o]){var l=typeof require=="function"&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var u=r[o]={exports:{}};t[o][0].call(u.exports,function(e){var r=t[o][1][e];return n(r?r:e)},u,u.exports,e,t,r,i)}return r[o].exports}var a=typeof require=="function"&&require;for(var o=0;o<i.length;o++)n(i[o]);return n})({1:[function(e,t,r){n.removeEventListener=a;n.addEventListener=n;t.exports=n;var i=null;function n(e,t,r,n){i=i||(document.addEventListener?{add:o,rm:s}:{add:l,rm:h});return i.add(e,t,r,n)}function a(e,t,r,n){i=i||(document.addEventListener?{add:o,rm:s}:{add:l,rm:h});return i.rm(e,t,r,n)}function o(e,t,r,i){e.addEventListener(t,r,i)}function s(e,t,r,i){e.removeEventListener(t,r,i)}function l(e,t,r,i){if(i){throw new Error("cannot useCapture in oldIE")}e.attachEvent("on"+t,r)}function h(e,t,r,i){e.detachEvent("on"+t,r)}},{}],2:[function(e,t,r){t.exports=function i(e,t){var r=typeof e==="number",i=typeof t==="number";if(r&&!i){t=e;e=0}else if(!r&&!i){e=0;t=0}e=e|0;t=t|0;var n=t-e;if(n<0)throw new Error("array length must be positive");var a=new Array(n);for(var o=0,s=e;o<n;o++,s++)a[o]=s;return a}},{}],3:[function(e,t,r){t.exports=function i(e,t){return typeof e==="number"?e:typeof t==="number"?t:0}},{}],4:[function(e,t,r){"use strict";t.exports=function(e){var t=e._SomePromiseArray;function r(e){var r=new t(e);var i=r.promise();if(i.isRejected()){return i}r.setHowMany(1);r.setUnwrap();r.init();return i}e.any=function i(e){return r(e)};e.prototype.any=function n(){return r(this)}}},{}],5:[function(e,t,r){(function(r){"use strict";var i=e("./schedule.js");var n=e("./queue.js");var a=e("./util.js").errorObj;var o=e("./util.js").tryCatch1;var s=typeof r!=="undefined"?r:void 0;function l(){this._isTickUsed=false;this._schedule=i;this._length=0;this._lateBuffer=new n(16);this._functionBuffer=new n(65536);var e=this;this.consumeFunctionBuffer=function t(){e._consumeFunctionBuffer()}}l.prototype.haveItemsQueued=function h(){return this._length>0};l.prototype.invokeLater=function u(e,t,r){if(s!==void 0&&s.domain!=null&&!e.domain){e=s.domain.bind(e)}this._lateBuffer.push(e,t,r);this._queueTick()};l.prototype.invoke=function f(e,t,r){if(s!==void 0&&s.domain!=null&&!e.domain){e=s.domain.bind(e)}var i=this._functionBuffer;i.push(e,t,r);this._length=i.length();this._queueTick()};l.prototype._consumeFunctionBuffer=function c(){var e=this._functionBuffer;while(e.length()>0){var t=e.shift();var r=e.shift();var i=e.shift();t.call(r,i)}this._reset();this._consumeLateBuffer()};l.prototype._consumeLateBuffer=function p(){var e=this._lateBuffer;while(e.length()>0){var t=e.shift();var r=e.shift();var i=e.shift();var n=o(t,r,i);if(n===a){this._queueTick();if(t.domain!=null){t.domain.emit("error",n.e)}else{throw n.e}}}};l.prototype._queueTick=function d(){if(!this._isTickUsed){this._schedule(this.consumeFunctionBuffer);this._isTickUsed=true}};l.prototype._reset=function v(){this._isTickUsed=false;this._length=0};t.exports=new l}).call(this,e("_process"))},{"./queue.js":28,"./schedule.js":31,"./util.js":38,_process:43}],6:[function(e,t,r){"use strict";var i=e("./promise.js")();t.exports=i},{"./promise.js":23}],7:[function(e,t,r){"use strict";var i=Object.create;if(i){var n=i(null);var a=i(null);n[" size"]=a[" size"]=0}t.exports=function(t){var r=e("./util.js");var i=r.canEvaluate;var o=r.isIdentifier;function s(e){return new Function("obj","                                             \n        'use strict'                                                         \n        var len = this.length;                                               \n        switch(len) {                                                        \n            case 1: return obj.methodName(this[0]);                          \n            case 2: return obj.methodName(this[0], this[1]);                 \n            case 3: return obj.methodName(this[0], this[1], this[2]);        \n            case 0: return obj.methodName();                                 \n            default: return obj.methodName.apply(obj, this);                 \n        }                                                                    \n        ".replace(/methodName/g,e))}function l(e){return new Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",e))}function h(e,t,r){var i=r[e];if(typeof i!=="function"){if(!o(e)){return null}i=t(e);r[e]=i;r[" size"]++;if(r[" size"]>512){var n=Object.keys(r);for(var a=0;a<256;++a)delete r[n[a]];r[" size"]=n.length-256}}return i}function u(e){return h(e,s,n)}function f(e){return h(e,l,a)}function c(e){return e[this.pop()].apply(e,this)}t.prototype.call=function v(e){var t=arguments.length;var r=new Array(t-1);for(var n=1;n<t;++n){r[n-1]=arguments[n]}if(i){var a=u(e);if(a!==null){return this._then(a,void 0,void 0,r,void 0)}}r.push(e);return this._then(c,void 0,void 0,r,void 0)};function p(e){return e[this]}function d(e){return e[this]}t.prototype.get=function m(e){var t=typeof e==="number";var r;if(!t){if(i){var n=f(e);r=n!==null?n:p}else{r=p}}else{r=d}return this._then(r,void 0,void 0,e,void 0)}}},{"./util.js":38}],8:[function(e,t,r){"use strict";t.exports=function(t,r){var i=e("./errors.js");var n=i.canAttach;var a=e("./async.js");var o=i.CancellationError;t.prototype._cancel=function s(e){if(!this.isCancellable())return this;var t;var r=this;while((t=r._cancellationParent)!==void 0&&t.isCancellable()){r=t}this._unsetCancellable();r._attachExtraTrace(e);r._rejectUnchecked(e)};t.prototype.cancel=function l(e){if(!this.isCancellable())return this;e=e!==void 0?n(e)?e:new Error(e+""):new o;a.invokeLater(this._cancel,this,e);return this};t.prototype.cancellable=function h(){if(this._cancellable())return this;this._setCancellable();this._cancellationParent=void 0;return this};t.prototype.uncancellable=function u(){var e=new t(r);e._propagateFrom(this,2|4);e._follow(this);e._unsetCancellable();return e};t.prototype.fork=function f(e,t,r){var i=this._then(e,t,r,void 0,void 0);i._setCancellable();i._cancellationParent=void 0;return i}}},{"./async.js":5,"./errors.js":13}],9:[function(e,t,r){"use strict";t.exports=function(){var t=e("./util.js").inherits;var r=e("./es5.js").defineProperty;var i=new RegExp("\\b(?:[a-zA-Z0-9.]+\\$_\\w+|"+"tryCatch(?:1|2|3|4|Apply)|new \\w*PromiseArray|"+"\\w*PromiseArray\\.\\w*PromiseArray|"+"setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|"+"process._tickCallback|nextTick|Async\\$\\w+)\\b");var n=null;var a=null;function o(e){var t;if(typeof e==="function"){t="[function "+(e.name||"anonymous")+"]"}else{t=e.toString();var r=/\[object [a-zA-Z0-9$_]+\]/;if(r.test(t)){try{var i=JSON.stringify(e);t=i}catch(n){}}if(t.length===0){t="(empty array)"}}return"(<"+s(t)+">, no stack trace)"}function s(e){var t=41;if(e.length<t){return e}return e.substr(0,t-3)+"..."}function l(e,t){this.captureStackTrace(l,t)}t(l,Error);l.prototype.captureStackTrace=function u(e,t){h(this,e,t)};l.possiblyUnhandledRejection=function f(e){if(typeof console==="object"){var t;if(typeof e==="object"||typeof e==="function"){var r=e.stack;t="Possibly unhandled "+a(r,e)}else{t="Possibly unhandled "+String(e)}if(typeof console.error==="function"||typeof console.error==="object"){console.error(t)}else if(typeof console.log==="function"||typeof console.log==="object"){console.log(t)}}};l.combine=function c(e,t){var r=e.length-1;var a=e[r];var o=-1;for(var s=t.length-1;s>=0;--s){if(t[s]===a){o=s;break}}for(var s=o;s>=0;--s){var l=t[s];if(e[r]===l){e.pop();r--}else{break}}e.push("From previous event:");var h=e.concat(t);var u=[];for(var s=0,f=h.length;s<f;++s){if(i.test(h[s])&&n.test(h[s])||s>0&&!n.test(h[s])&&h[s]!=="From previous event:"){continue}u.push(h[s])}return u};l.protectErrorMessageNewlines=function(e){for(var t=0;t<e.length;++t){if(n.test(e[t])){break}}if(t<=1)return;var r=[];for(var i=0;i<t;++i){r.push(e.shift())}e.unshift(r.join("\x00"))};l.isSupported=function p(){return typeof h==="function"};var h=function d(){if(typeof Error.stackTraceLimit==="number"&&typeof Error.captureStackTrace==="function"){n=/^\s*at\s*/;a=function(e,t){if(typeof e==="string")return e;if(t.name!==void 0&&t.message!==void 0){return t.name+". "+t.message}return o(t)};var e=Error.captureStackTrace;return function s(t,r){e(t,r)}}var t=new Error;if(typeof t.stack==="string"&&typeof"".startsWith==="function"&&t.stack.startsWith("stackDetection@")&&d.name==="stackDetection"){r(Error,"stackTraceLimit",{writable:true,enumerable:false,configurable:false,value:25});n=/@/;var i=/[@\n]/;a=function(e,t){if(typeof e==="string"){return t.name+". "+t.message+"\n"+e}if(t.name!==void 0&&t.message!==void 0){return t.name+". "+t.message}return o(t)};return function l(e){var t=(new Error).stack;var r=t.split(i);var n=r.length;var a="";for(var o=0;o<n;o+=2){a+=r[o];a+="@";a+=r[o+1];a+="\n"}e.stack=a}}else{a=function(e,t){if(typeof e==="string")return e;if((typeof t==="object"||typeof t==="function")&&t.name!==void 0&&t.message!==void 0){return t.name+". "+t.message}return o(t)};return null}}();return l}},{"./es5.js":15,"./util.js":38}],10:[function(e,t,r){"use strict";t.exports=function(t){var r=e("./util.js");var i=e("./errors.js");var n=r.tryCatch1;var a=r.errorObj;var o=e("./es5.js").keys;var s=i.TypeError;function l(e,t,r){this._instances=e;this._callback=t;this._promise=r}function h(e,t){var r={};var i=n(e,r,t);if(i===a)return i;var l=o(r);if(l.length){a.e=new s("Catch filter must inherit from Error "+"or be a simple predicate function");return a}return i}l.prototype.doFilter=function u(e){var r=this._callback;var o=this._promise;var s=o._boundTo;for(var l=0,u=this._instances.length;l<u;++l){var f=this._instances[l];var c=f===Error||f!=null&&f.prototype instanceof Error;if(c&&e instanceof f){var p=n(r,s,e);if(p===a){t.e=p.e;return t}return p}else if(typeof f==="function"&&!c){var d=h(f,e);if(d===a){var v=i.canAttach(a.e)?a.e:new Error(a.e+"");this._promise._attachExtraTrace(v);e=a.e;break}else if(d){var p=n(r,s,e);if(p===a){t.e=p.e;return t}return p}}}t.e=e;return t};return l}},{"./errors.js":13,"./es5.js":15,"./util.js":38}],11:[function(e,t,r){"use strict";var i=e("./util.js");var n=i.isPrimitive;var a=i.wrapsPrimitiveReceiver;t.exports=function(e){var t=function o(){return this};var r=function s(){throw this};var i=function l(e,t){if(t===1){return function r(){throw e}}else if(t===2){return function i(){return e}}};e.prototype["return"]=e.prototype.thenReturn=function h(e){if(a&&n(e)){return this._then(i(e,2),void 0,void 0,void 0,void 0)}return this._then(t,void 0,void 0,e,void 0)};e.prototype["throw"]=e.prototype.thenThrow=function u(e){if(a&&n(e)){return this._then(i(e,1),void 0,void 0,void 0,void 0)}return this._then(r,void 0,void 0,e,void 0)}}},{"./util.js":38}],12:[function(e,t,r){"use strict";t.exports=function(e,t){var r=e.reduce;e.prototype.each=function i(e){return r(this,e,null,t)};e.each=function n(e,i){return r(e,i,null,t)}}},{}],13:[function(e,t,r){"use strict";var i=e("./es5.js").freeze;var n=e("./util.js");var a=n.inherits;var o=n.notEnumerableProp;function s(e){try{o(e,"isOperational",true)}catch(t){}}function l(e){if(e==null)return false;return e instanceof b||e["isOperational"]===true}function h(e){return e instanceof Error}function u(e){return h(e)}function f(e,t){function r(i){if(!(this instanceof r))return new r(i);this.message=typeof i==="string"?i:t;this.name=e;if(Error.captureStackTrace){Error.captureStackTrace(this,this.constructor)}}a(r,Error);return r}var c,p;var d=f("CancellationError","cancellation error");var v=f("TimeoutError","timeout error");var m=f("AggregateError","aggregate error");try{c=TypeError;p=RangeError}catch(g){c=f("TypeError","type error");p=f("RangeError","range error")}var y=("join pop push shift unshift slice filter forEach some "+"every map indexOf lastIndexOf reduce reduceRight sort reverse").split(" ");for(var _=0;_<y.length;++_){if(typeof Array.prototype[y[_]]==="function"){m.prototype[y[_]]=Array.prototype[y[_]]}}m.prototype.length=0;m.prototype["isOperational"]=true;var x=0;m.prototype.toString=function(){var e=Array(x*4+1).join(" ");var t="\n"+e+"AggregateError of:"+"\n";x++;e=Array(x*4+1).join(" ");for(var r=0;r<this.length;++r){var i=this[r]===this?"[Circular AggregateError]":this[r]+"";var n=i.split("\n");for(var a=0;a<n.length;++a){n[a]=e+n[a]}i=n.join("\n");t+=i+"\n"}x--;return t};function b(e){this.name="OperationalError";this.message=e;this.cause=e;this["isOperational"]=true;if(e instanceof Error){this.message=e.message;this.stack=e.stack}else if(Error.captureStackTrace){Error.captureStackTrace(this,this.constructor)}}a(b,Error);var w="__BluebirdErrorTypes__";var T=Error[w];if(!T){T=i({CancellationError:d,TimeoutError:v,OperationalError:b,RejectionError:b,AggregateError:m});o(Error,w,T)}t.exports={Error:Error,TypeError:c,RangeError:p,CancellationError:T.CancellationError,OperationalError:T.OperationalError,TimeoutError:T.TimeoutError,AggregateError:T.AggregateError,originatesFromRejection:l,markAsOriginatingFromRejection:s,canAttach:u}},{"./es5.js":15,"./util.js":38}],14:[function(e,t,r){"use strict";t.exports=function(t){var r=e("./errors.js").TypeError;function i(e){var i=new r(e);var n=t.rejected(i);var a=n._peekContext();if(a!=null){a._attachExtraTrace(i)}return n}return i}},{"./errors.js":13}],15:[function(e,t,r){var i=function(){"use strict";return this===void 0}();if(i){t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,keys:Object.keys,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:i}}else{var n={}.hasOwnProperty;var a={}.toString;var o={}.constructor.prototype;var s=function c(e){var t=[];for(var r in e){if(n.call(e,r)){t.push(r)}}return t};var l=function p(e,t,r){e[t]=r.value;return e};var h=function d(e){return e};var u=function v(e){try{return Object(e).constructor.prototype}catch(t){return o}};var f=function m(e){try{return a.call(e)==="[object Array]"}catch(t){return false}};t.exports={isArray:f,keys:s,defineProperty:l,freeze:h,getPrototypeOf:u,isES5:i}}},{}],16:[function(e,t,r){"use strict";t.exports=function(e,t){var r=e.map;e.prototype.filter=function i(e,n){return r(this,e,n,t)};e.filter=function n(e,i,a){return r(e,i,a,t)}}},{}],17:[function(e,t,r){"use strict";t.exports=function(t,r,i){var n=e("./util.js");var a=n.wrapsPrimitiveReceiver;var o=n.isPrimitive;var s=n.thrower;function l(){return this}function h(){throw this}function u(e){return function t(){return e}}function f(e){return function t(){throw e}}function c(e,t,r){var i;if(a&&o(t)){i=r?u(t):f(t)}else{i=r?l:h}return e._then(i,s,void 0,t,void 0)}function p(e){var n=this.promise;var a=this.handler;var o=n._isBound()?a.call(n._boundTo):a();if(o!==void 0){var s=i(o,void 0);if(s instanceof t){return c(s,e,n.isFulfilled())}}if(n.isRejected()){r.e=e;return r}else{return e}}function d(e){var r=this.promise;var n=this.handler;var a=r._isBound()?n.call(r._boundTo,e):n(e);if(a!==void 0){var o=i(a,void 0);if(o instanceof t){return c(o,e,true)}}return e}t.prototype._passThroughHandler=function v(e,t){if(typeof e!=="function")return this.then();var r={promise:this,handler:e};return this._then(t?p:d,t?p:void 0,void 0,r,void 0)};t.prototype.lastly=t.prototype["finally"]=function m(e){return this._passThroughHandler(e,true)};t.prototype.tap=function g(e){return this._passThroughHandler(e,false)}}},{"./util.js":38}],18:[function(e,t,r){"use strict";t.exports=function(t,r,i,n){var a=e("./errors.js");var o=a.TypeError;var s=e("./util.js").deprecated;var l=e("./util.js");var h=l.errorObj;var u=l.tryCatch1;var f=[];function c(e,r){var i=h;var a=t;var o=r.length;for(var s=0;s<o;++s){var l=u(r[s],void 0,e);if(l===i){return a.reject(i.e)}var f=n(l,c);if(f instanceof a)return f}return null}function p(e,r,n){var a=this._promise=new t(i);a._setTrace(void 0);this._generatorFunction=e;this._receiver=r;this._generator=void 0;this._yieldHandlers=typeof n==="function"?[n].concat(f):f}p.prototype.promise=function d(){return this._promise};p.prototype._run=function v(){this._generator=this._generatorFunction.call(this._receiver);this._receiver=this._generatorFunction=void 0;this._next(void 0)};p.prototype._continue=function m(e){if(e===h){this._generator=void 0;var r=a.canAttach(e.e)?e.e:new Error(e.e+"");this._promise._attachExtraTrace(r);this._promise._reject(e.e,r);return}var i=e.value;if(e.done===true){this._generator=void 0;if(!this._promise._tryFollow(i)){this._promise._fulfill(i)}}else{var s=n(i,void 0);if(!(s instanceof t)){s=c(s,this._yieldHandlers);if(s===null){this._throw(new o("A value was yielded that could not be treated as a promise"));return}}s._then(this._next,this._throw,void 0,this,null)}};p.prototype._throw=function g(e){if(a.canAttach(e))this._promise._attachExtraTrace(e);this._continue(u(this._generator["throw"],this._generator,e))};p.prototype._next=function y(e){this._continue(u(this._generator.next,this._generator,e))};t.coroutine=function _(e,t){if(typeof e!=="function"){throw new o("generatorFunction must be a function")}var r=Object(t).yieldHandler;var i=p;return function(){var t=e.apply(this,arguments);var n=new i(void 0,void 0,r);n._generator=t;n._next(void 0);return n.promise()}};t.coroutine.addYieldHandler=function(e){if(typeof e!=="function")throw new o("fn must be a function");f.push(e)};t.spawn=function x(e){s("Promise.spawn is deprecated. Use Promise.coroutine instead.");if(typeof e!=="function"){return r("generatorFunction must be a function")}var i=new p(e,this);var n=i.promise();i._run(t.spawn);return n}}},{"./errors.js":13,"./util.js":38}],19:[function(e,t,r){"use strict";t.exports=function(t,r,i,n){var a=e("./util.js");var o=a.canEvaluate;var s=a.tryCatch1;var l=a.errorObj;if(o){var h=function(e){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,e))};var u=function(e){var t=[];for(var r=1;r<=e;++r)t.push("holder.p"+r);return new Function("holder","                                      \n            'use strict';                                                    \n            var callback = holder.fn;                                        \n            return callback(values);                                         \n            ".replace(/values/g,t.join(", ")))};var f=[];var c=[void 0];for(var p=1;p<=5;++p){f.push(h(p));c.push(u(p))}var d=function(e,t){this.p1=this.p2=this.p3=this.p4=this.p5=null;this.fn=t;this.total=e;this.now=0};d.prototype.callers=c;d.prototype.checkFulfillment=function(e){var t=this.now;t++;var r=this.total;if(t>=r){var i=this.callers[r];var n=s(i,void 0,this);if(n===l){e._rejectUnchecked(n.e)}else if(!e._tryFollow(n)){e._fulfillUnchecked(n)}}else{this.now=t}}}function v(e){this._reject(e)}t.join=function m(){var e=arguments.length-1;var a;if(e>0&&typeof arguments[e]==="function"){a=arguments[e];if(e<6&&o){var s=new t(n);s._setTrace(void 0);var l=new d(e,a);var h=f;for(var u=0;u<e;++u){var c=i(arguments[u],void 0);if(c instanceof t){if(c.isPending()){c._then(h[u],v,void 0,s,l)}else if(c.isFulfilled()){h[u].call(s,c._settledValue,l)}else{s._reject(c._settledValue);c._unsetRejectionIsUnhandled()}}else{h[u].call(s,c,l)}}return s}}var p=arguments.length;var m=new Array(p);for(var g=0;g<p;++g){m[g]=arguments[g]}var s=new r(m).promise();return a!==void 0?s.spread(a):s}}},{"./util.js":38}],20:[function(e,t,r){"use strict";t.exports=function(t,r,i,n,a){var o=e("./util.js");var s=o.tryCatch3;var l=o.errorObj;var h={};var u=[];function f(e,t,r,i){this.constructor$(e);this._callback=t;this._preservedValues=i===a?new Array(this.length()):null;this._limit=r;this._inFlight=0;this._queue=r>=1?[]:u;this._init$(void 0,-2)}o.inherits(f,r);f.prototype._init=function p(){};f.prototype._promiseFulfilled=function d(e,r){var i=this._values;if(i===null)return;var a=this.length();var o=this._preservedValues;var u=this._limit;if(i[r]===h){i[r]=e;if(u>=1){this._inFlight--;this._drainQueue();if(this._isResolved())return}}else{if(u>=1&&this._inFlight>=u){i[r]=e;this._queue.push(r);return}if(o!==null)o[r]=e;var f=this._callback;var c=this._promise._boundTo;var p=s(f,c,e,r,a);if(p===l)return this._reject(p.e);var d=n(p,void 0);if(d instanceof t){if(d.isPending()){if(u>=1)this._inFlight++;i[r]=h;return d._proxyPromiseArray(this,r)}else if(d.isFulfilled()){p=d.value()}else{d._unsetRejectionIsUnhandled();return this._reject(d.reason())}}i[r]=p}var v=++this._totalResolved;if(v>=a){if(o!==null){this._filter(i,o)}else{this._resolve(i)}}};f.prototype._drainQueue=function v(){var e=this._queue;var t=this._limit;var r=this._values;while(e.length>0&&this._inFlight<t){var i=e.pop();this._promiseFulfilled(r[i],i)}};f.prototype._filter=function m(e,t){var r=t.length;var i=new Array(r);var n=0;for(var a=0;a<r;++a){if(e[a])i[n++]=t[a]}i.length=n;this._resolve(i)};f.prototype.preservedValues=function g(){return this._preservedValues};function c(e,t,r,i){var n=typeof r==="object"&&r!==null?r.concurrency:0;n=typeof n==="number"&&isFinite(n)&&n>=1?n:0;return new f(e,t,n,i)}t.prototype.map=function y(e,t){if(typeof e!=="function")return i("fn must be a function");return c(this,e,t,null).promise()};t.map=function _(e,t,r,n){if(typeof t!=="function")return i("fn must be a function");return c(e,t,r,n).promise()}}},{"./util.js":38}],21:[function(e,t,r){"use strict";t.exports=function(t){var r=e("./util.js");var i=e("./async.js");var n=r.tryCatch2;var a=r.tryCatch1;var o=r.errorObj;function s(e){throw e}function l(e,t){if(!r.isArray(e))return h(e,t);var n=r.tryCatchApply(this,[null].concat(e),t);if(n===o){i.invokeLater(s,void 0,n.e)}}function h(e,t){var r=this;var l=e===void 0?a(r,t,null):n(r,t,null,e);if(l===o){i.invokeLater(s,void 0,l.e)}}function u(e,t){var r=this;var n=a(r,t,e);if(n===o){i.invokeLater(s,void 0,n.e)}}t.prototype.nodeify=function f(e,t){if(typeof e=="function"){var r=h;if(t!==void 0&&Object(t).spread){r=l}this._then(r,u,void 0,e,this._boundTo)}return this}}},{"./async.js":5,"./util.js":38}],22:[function(e,t,r){"use strict";t.exports=function(t,r){var i=e("./util.js");var n=e("./async.js");var a=e("./errors.js");var o=i.tryCatch1;var s=i.errorObj;t.prototype.progressed=function l(e){return this._then(void 0,void 0,e,void 0,void 0)};t.prototype._progress=function h(e){if(this._isFollowingOrFulfilledOrRejected())return;this._progressUnchecked(e)};t.prototype._clearFirstHandlerData$Base=t.prototype._clearFirstHandlerData;t.prototype._clearFirstHandlerData=function u(){this._clearFirstHandlerData$Base();this._progressHandler0=void 0};t.prototype._progressHandlerAt=function f(e){return e===0?this._progressHandler0:this[(e<<2)+e-5+2]};t.prototype._doProgressWith=function c(e){var r=e.value;var i=e.handler;var n=e.promise;var l=e.receiver;var h=o(i,l,r);if(h===s){if(h.e!=null&&h.e.name!=="StopProgressPropagation"){var u=a.canAttach(h.e)?h.e:new Error(h.e+"");n._attachExtraTrace(u);n._progress(h.e)}}else if(h instanceof t){h._then(n._progress,null,null,n,void 0)}else{n._progress(h)}};t.prototype._progressUnchecked=function p(e){if(!this.isPending())return;var i=this._length();var a=this._progress;for(var o=0;o<i;o++){var s=this._progressHandlerAt(o);var l=this._promiseAt(o);if(!(l instanceof t)){var h=this._receiverAt(o);if(typeof s==="function"){s.call(h,e,l)}else if(h instanceof t&&h._isProxied()){h._progressUnchecked(e)}else if(h instanceof r){h._promiseProgressed(e,l)}continue}if(typeof s==="function"){n.invoke(this._doProgressWith,this,{handler:s,promise:l,receiver:this._receiverAt(o),value:e})}else{n.invoke(a,l,e)}}}}},{"./async.js":5,"./errors.js":13,"./util.js":38}],23:[function(e,t,r){(function(r){"use strict";var i;if(typeof Promise!=="undefined")i=Promise;function n(e){try{if(Promise===e)Promise=i}catch(t){}return e}t.exports=function(){var t=e("./util.js");var i=e("./async.js");var a=e("./errors.js");var o=function(){};var s={};var l={e:null};var h=e("./thenables.js")(R,o);var u=e("./promise_array.js")(R,o,h);var f=e("./captured_trace.js")();var c=e("./catch_filter.js")(l);var p=e("./promise_resolver.js");var d=t.isArray;var v=t.errorObj;var m=t.tryCatch1;var g=t.tryCatch2;var y=t.tryCatchApply;var _=a.RangeError;var x=a.TypeError;var b=a.CancellationError;var w=a.TimeoutError;var T=a.OperationalError;var S=a.originatesFromRejection;var M=a.markAsOriginatingFromRejection;var A=a.canAttach;var E=t.thrower;var C=e("./errors_api_rejection")(R);var P=function O(){return new x("circular promise resolution chain")};function R(e){if(typeof e!=="function"){throw new x("the promise constructor requires a resolver function")}if(this.constructor!==R){throw new x("the promise constructor cannot be invoked directly")}this._bitField=0;this._fulfillmentHandler0=void 0;this._rejectionHandler0=void 0;this._promise0=void 0;this._receiver0=void 0;this._settledValue=void 0;this._boundTo=void 0;if(e!==o)this._resolveFromResolver(e)}function L(e){return e[0]}R.prototype.bind=function j(e){var t=h(e,void 0);var r=new R(o);if(t instanceof R){var i=t.then(function(e){r._setBoundTo(e)});var n=R.all([this,i]).then(L);r._follow(n)}else{r._follow(this);r._setBoundTo(e)}r._propagateFrom(this,2|1);return r};R.prototype.toString=function V(){return"[object Promise]"};R.prototype.caught=R.prototype["catch"]=function N(e){var t=arguments.length;if(t>1){var r=new Array(t-1),i=0,n;for(n=0;n<t-1;++n){var a=arguments[n];if(typeof a==="function"){r[i++]=a}else{var o=new x("A catch filter must be an error constructor "+"or a filter function");this._attachExtraTrace(o);return R.reject(o)}}r.length=i;e=arguments[n];this._resetTrace();var s=new c(r,e,this);return this._then(void 0,s.doFilter,void 0,s,void 0)}return this._then(void 0,e,void 0,void 0,void 0)};function k(){return new R.PromiseInspection(this)}R.prototype.reflect=function B(){return this._then(k,k,void 0,this,void 0)};R.prototype.then=function z(e,t,r){return this._then(e,t,r,void 0,void 0)};R.prototype.done=function I(e,t,r){var i=this._then(e,t,r,void 0,void 0);i._setIsFinal()};R.prototype.spread=function H(e,t){return this._then(e,t,void 0,s,void 0)};R.prototype.isCancellable=function G(){return!this.isResolved()&&this._cancellable()};R.prototype.toJSON=function W(){var e={isFulfilled:false,isRejected:false,fulfillmentValue:void 0,rejectionReason:void 0};if(this.isFulfilled()){e.fulfillmentValue=this._settledValue;e.isFulfilled=true}else if(this.isRejected()){e.rejectionReason=this._settledValue;e.isRejected=true}return e};R.prototype.all=function X(){return new u(this).promise()};R.is=function Y(e){return e instanceof R};R.all=function q(e){return new u(e).promise()};R.prototype.error=function K(e){return this.caught(S,e)};R.prototype._resolveFromSyncValue=function Z(e){if(e===v){this._cleanValues();this._setRejected();var t=e.e;this._settledValue=t;this._tryAttachExtraTrace(t);this._ensurePossibleRejectionHandled()}else{var r=h(e,void 0);if(r instanceof R){this._follow(r)}else{this._cleanValues();this._setFulfilled();this._settledValue=e}}};R.method=function Q(e){if(typeof e!=="function"){throw new x("fn must be a function")}return function t(){var t;switch(arguments.length){case 0:t=m(e,this,void 0);break;case 1:t=m(e,this,arguments[0]);break;case 2:t=g(e,this,arguments[0],arguments[1]);break;default:var r=arguments.length;var i=new Array(r);for(var n=0;n<r;++n){i[n]=arguments[n]}t=y(e,i,this);break}var a=new R(o);a._setTrace(void 0);a._resolveFromSyncValue(t);return a}};R.attempt=R["try"]=function $(e,t,r){if(typeof e!=="function"){return C("fn must be a function")}var i=d(t)?y(e,t,r):m(e,r,t);var n=new R(o);n._setTrace(void 0);n._resolveFromSyncValue(i);return n};R.defer=R.pending=function J(){var e=new R(o);e._setTrace(void 0);return new p(e)};R.bind=function et(e){var t=h(e,void 0);var r=new R(o);r._setTrace(void 0);if(t instanceof R){var i=t.then(function(e){r._setBoundTo(e)});r._follow(i)}else{r._setBoundTo(e);r._setFulfilled()}return r};R.cast=function tt(e){var t=h(e,void 0);if(!(t instanceof R)){var r=t;t=new R(o);t._setTrace(void 0);t._setFulfilled();t._cleanValues();t._settledValue=r}return t};R.resolve=R.fulfilled=R.cast;R.reject=R.rejected=function rt(e){var t=new R(o);t._setTrace(void 0);M(e);t._cleanValues();t._setRejected();t._settledValue=e;if(!A(e)){var r=new Error(e+"");t._setCarriedStackTrace(r)}t._ensurePossibleRejectionHandled();return t};R.onPossiblyUnhandledRejection=function it(e){f.possiblyUnhandledRejection=typeof e==="function"?e:void 0};var F;R.onUnhandledRejectionHandled=function nt(e){F=typeof e==="function"?e:void 0};var D=false||!!(typeof r!=="undefined"&&typeof r.execPath==="string"&&typeof r.env==="object"&&(r.env["BLUEBIRD_DEBUG"]||r.env["NODE_ENV"]==="development"));R.longStackTraces=function at(){if(i.haveItemsQueued()&&D===false){throw new Error("cannot enable long stack traces after promises have been created")}D=f.isSupported()};R.hasLongStackTraces=function ot(){return D&&f.isSupported()};R.prototype._then=function st(e,t,r,n,a){var s=a!==void 0;var l=s?a:new R(o);if(!s){if(D){var h=this._peekContext()===this._traceParent;l._traceParent=h?this._traceParent:this}l._propagateFrom(this,7)}var u=this._addCallbacks(e,t,r,l,n);if(this.isResolved()){i.invoke(this._queueSettleAt,this,u)}return l};R.prototype._length=function lt(){return this._bitField&262143};R.prototype._isFollowingOrFulfilledOrRejected=function ht(){return(this._bitField&939524096)>0};R.prototype._isFollowing=function ut(){return(this._bitField&536870912)===536870912};R.prototype._setLength=function ft(e){this._bitField=this._bitField&-262144|e&262143};R.prototype._setFulfilled=function ct(){this._bitField=this._bitField|268435456};R.prototype._setRejected=function pt(){this._bitField=this._bitField|134217728};R.prototype._setFollowing=function dt(){this._bitField=this._bitField|536870912};R.prototype._setIsFinal=function vt(){this._bitField=this._bitField|33554432};R.prototype._isFinal=function mt(){return(this._bitField&33554432)>0};R.prototype._cancellable=function gt(){return(this._bitField&67108864)>0};R.prototype._setCancellable=function yt(){this._bitField=this._bitField|67108864};R.prototype._unsetCancellable=function _t(){this._bitField=this._bitField&~67108864};R.prototype._setRejectionIsUnhandled=function xt(){this._bitField=this._bitField|2097152};R.prototype._unsetRejectionIsUnhandled=function bt(){this._bitField=this._bitField&~2097152;if(this._isUnhandledRejectionNotified()){this._unsetUnhandledRejectionIsNotified();this._notifyUnhandledRejectionIsHandled()}};R.prototype._isRejectionUnhandled=function wt(){return(this._bitField&2097152)>0};R.prototype._setUnhandledRejectionIsNotified=function Tt(){this._bitField=this._bitField|524288};R.prototype._unsetUnhandledRejectionIsNotified=function St(){this._bitField=this._bitField&~524288};R.prototype._isUnhandledRejectionNotified=function Mt(){return(this._bitField&524288)>0};R.prototype._setCarriedStackTrace=function At(e){this._bitField=this._bitField|1048576;this._fulfillmentHandler0=e};R.prototype._unsetCarriedStackTrace=function Et(){this._bitField=this._bitField&~1048576;this._fulfillmentHandler0=void 0};R.prototype._isCarryingStackTrace=function Ct(){return(this._bitField&1048576)>0};R.prototype._getCarriedStackTrace=function Pt(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0};R.prototype._receiverAt=function Rt(e){var t=e===0?this._receiver0:this[(e<<2)+e-5+4];if(this._isBound()&&t===void 0){return this._boundTo}return t};R.prototype._promiseAt=function Lt(e){return e===0?this._promise0:this[(e<<2)+e-5+3]};R.prototype._fulfillmentHandlerAt=function kt(e){return e===0?this._fulfillmentHandler0:this[(e<<2)+e-5+0]
};R.prototype._rejectionHandlerAt=function Ft(e){return e===0?this._rejectionHandler0:this[(e<<2)+e-5+1]};R.prototype._addCallbacks=function Dt(e,t,r,i,n){var a=this._length();if(a>=262143-5){a=0;this._setLength(0)}if(a===0){this._promise0=i;if(n!==void 0)this._receiver0=n;if(typeof e==="function"&&!this._isCarryingStackTrace())this._fulfillmentHandler0=e;if(typeof t==="function")this._rejectionHandler0=t;if(typeof r==="function")this._progressHandler0=r}else{var o=(a<<2)+a-5;this[o+3]=i;this[o+4]=n;this[o+0]=typeof e==="function"?e:void 0;this[o+1]=typeof t==="function"?t:void 0;this[o+2]=typeof r==="function"?r:void 0}this._setLength(a+1);return a};R.prototype._setProxyHandlers=function Ut(e,t){var r=this._length();if(r>=262143-5){r=0;this._setLength(0)}if(r===0){this._promise0=t;this._receiver0=e}else{var i=(r<<2)+r-5;this[i+3]=t;this[i+4]=e;this[i+0]=this[i+1]=this[i+2]=void 0}this._setLength(r+1)};R.prototype._proxyPromiseArray=function Ot(e,t){this._setProxyHandlers(e,t)};R.prototype._proxyPromise=function jt(e){e._setProxied();this._setProxyHandlers(e,-15)};R.prototype._setBoundTo=function Vt(e){if(e!==void 0){this._bitField=this._bitField|8388608;this._boundTo=e}else{this._bitField=this._bitField&~8388608}};R.prototype._isBound=function Nt(){return(this._bitField&8388608)===8388608};R.prototype._resolveFromResolver=function Bt(e){var t=this;this._setTrace(void 0);this._pushContext();function r(e){if(t._tryFollow(e)){return}t._fulfill(e)}function i(e){var r=A(e)?e:new Error(e+"");t._attachExtraTrace(r);M(e);t._reject(e,r===e?void 0:r)}var n=g(e,void 0,r,i);this._popContext();if(n!==void 0&&n===v){var a=n.e;var o=A(a)?a:new Error(a+"");t._reject(a,o)}};R.prototype._spreadSlowCase=function zt(e,t,r,i){var n=new u(r).promise();var a=n._then(function(){return e.apply(i,arguments)},void 0,void 0,s,void 0);t._follow(a)};R.prototype._callSpread=function It(e,t,r){var i=this._boundTo;if(d(r)){for(var n=0,a=r.length;n<a;++n){if(h(r[n],void 0)instanceof R){this._spreadSlowCase(e,t,r,i);return}}}t._pushContext();return y(e,r,i)};R.prototype._callHandler=function Ht(e,t,r,i){var n;if(t===s&&!this.isRejected()){n=this._callSpread(e,r,i)}else{r._pushContext();n=m(e,t,i)}r._popContext();return n};R.prototype._settlePromiseFromHandler=function Gt(e,t,r,i){if(!(i instanceof R)){e.call(t,r,i);return}if(i.isResolved())return;var n=this._callHandler(e,t,i,r);if(i._isFollowing())return;if(n===v||n===i||n===l){var a=n===i?P():n.e;var o=A(a)?a:new Error(a+"");if(n!==l)i._attachExtraTrace(o);i._rejectUnchecked(a,o)}else{var s=h(n,i);if(s instanceof R){if(s.isRejected()&&!s._isCarryingStackTrace()&&!A(s._settledValue)){var o=new Error(s._settledValue+"");i._attachExtraTrace(o);s._setCarriedStackTrace(o)}i._follow(s);i._propagateFrom(s,1)}else{i._fulfillUnchecked(n)}}};R.prototype._follow=function Wt(e){this._setFollowing();if(e.isPending()){this._propagateFrom(e,1);e._proxyPromise(this)}else if(e.isFulfilled()){this._fulfillUnchecked(e._settledValue)}else{this._rejectUnchecked(e._settledValue,e._getCarriedStackTrace())}if(e._isRejectionUnhandled())e._unsetRejectionIsUnhandled();if(D&&e._traceParent==null){e._traceParent=this}};R.prototype._tryFollow=function Xt(e){if(this._isFollowingOrFulfilledOrRejected()||e===this){return false}var t=h(e,void 0);if(!(t instanceof R)){return false}this._follow(t);return true};R.prototype._resetTrace=function Yt(){if(D){this._trace=new f(this._peekContext()===void 0)}};R.prototype._setTrace=function qt(e){if(D){var t=this._peekContext();this._traceParent=t;var r=t===void 0;if(e!==void 0&&e._traceParent===t){this._trace=e._trace}else{this._trace=new f(r)}}return this};R.prototype._tryAttachExtraTrace=function Kt(e){if(A(e)){this._attachExtraTrace(e)}};R.prototype._attachExtraTrace=function Zt(e){if(D){var t=this;var r=e.stack;r=typeof r==="string"?r.split("\n"):[];f.protectErrorMessageNewlines(r);var i=1;var n=1;while(t!=null&&t._trace!=null){r=f.combine(r,t._trace.stack.split("\n"));t=t._traceParent;n++}var a=Error.stackTraceLimit||10;var o=(a+i)*n;var s=r.length;if(s>o){r.length=o}if(s>0)r[0]=r[0].split("\x00").join("\n");if(r.length<=i){e.stack="(No stack trace)"}else{e.stack=r.join("\n")}}};R.prototype._cleanValues=function Qt(){if(this._cancellable()){this._cancellationParent=void 0}};R.prototype._propagateFrom=function $t(e,t){if((t&1)>0&&e._cancellable()){this._setCancellable();this._cancellationParent=e}if((t&4)>0){this._setBoundTo(e._boundTo)}if((t&2)>0){this._setTrace(e)}};R.prototype._fulfill=function Jt(e){if(this._isFollowingOrFulfilledOrRejected())return;this._fulfillUnchecked(e)};R.prototype._reject=function er(e,t){if(this._isFollowingOrFulfilledOrRejected())return;this._rejectUnchecked(e,t)};R.prototype._settlePromiseAt=function tr(e){var t=this.isFulfilled()?this._fulfillmentHandlerAt(e):this._rejectionHandlerAt(e);var r=this._settledValue;var i=this._receiverAt(e);var n=this._promiseAt(e);if(typeof t==="function"){this._settlePromiseFromHandler(t,i,r,n)}else{var a=false;var o=this.isFulfilled();if(i!==void 0){if(i instanceof R&&i._isProxied()){i._unsetProxied();if(o)i._fulfillUnchecked(r);else i._rejectUnchecked(r,this._getCarriedStackTrace());a=true}else if(i instanceof u){if(o)i._promiseFulfilled(r,n);else i._promiseRejected(r,n);a=true}}if(!a){if(o)n._fulfill(r);else n._reject(r,this._getCarriedStackTrace())}}if(e>=4){this._queueGC()}};R.prototype._isProxied=function rr(){return(this._bitField&4194304)===4194304};R.prototype._setProxied=function ir(){this._bitField=this._bitField|4194304};R.prototype._unsetProxied=function nr(){this._bitField=this._bitField&~4194304};R.prototype._isGcQueued=function ar(){return(this._bitField&-1073741824)===-1073741824};R.prototype._setGcQueued=function or(){this._bitField=this._bitField|-1073741824};R.prototype._unsetGcQueued=function sr(){this._bitField=this._bitField&~-1073741824};R.prototype._queueGC=function lr(){if(this._isGcQueued())return;this._setGcQueued();i.invokeLater(this._gc,this,void 0)};R.prototype._gc=function hr(){var e=this._length()*5-5;for(var t=0;t<e;t++){delete this[t]}this._clearFirstHandlerData();this._setLength(0);this._unsetGcQueued()};R.prototype._clearFirstHandlerData=function ur(){this._fulfillmentHandler0=void 0;this._rejectionHandler0=void 0;this._promise0=void 0;this._receiver0=void 0};R.prototype._queueSettleAt=function fr(e){if(this._isRejectionUnhandled())this._unsetRejectionIsUnhandled();i.invoke(this._settlePromiseAt,this,e)};R.prototype._fulfillUnchecked=function cr(e){if(!this.isPending())return;if(e===this){var t=P();this._attachExtraTrace(t);return this._rejectUnchecked(t,void 0)}this._cleanValues();this._setFulfilled();this._settledValue=e;var r=this._length();if(r>0){i.invoke(this._settlePromises,this,r)}};R.prototype._rejectUncheckedCheckError=function pr(e){var t=A(e)?e:new Error(e+"");this._rejectUnchecked(e,t===e?void 0:t)};R.prototype._rejectUnchecked=function dr(e,t){if(!this.isPending())return;if(e===this){var r=P();this._attachExtraTrace(r);return this._rejectUnchecked(r)}this._cleanValues();this._setRejected();this._settledValue=e;if(this._isFinal()){i.invokeLater(E,void 0,t===void 0?e:t);return}var n=this._length();if(t!==void 0)this._setCarriedStackTrace(t);if(n>0){i.invoke(this._rejectPromises,this,null)}else{this._ensurePossibleRejectionHandled()}};R.prototype._rejectPromises=function vr(){this._settlePromises();this._unsetCarriedStackTrace()};R.prototype._settlePromises=function mr(){var e=this._length();for(var t=0;t<e;t++){this._settlePromiseAt(t)}};R.prototype._ensurePossibleRejectionHandled=function gr(){this._setRejectionIsUnhandled();if(f.possiblyUnhandledRejection!==void 0){i.invokeLater(this._notifyUnhandledRejection,this,void 0)}};R.prototype._notifyUnhandledRejectionIsHandled=function yr(){if(typeof F==="function"){i.invokeLater(F,void 0,this)}};R.prototype._notifyUnhandledRejection=function _r(){if(this._isRejectionUnhandled()){var e=this._settledValue;var t=this._getCarriedStackTrace();this._setUnhandledRejectionIsNotified();if(t!==void 0){this._unsetCarriedStackTrace();e=t}if(typeof f.possiblyUnhandledRejection==="function"){f.possiblyUnhandledRejection(e,this)}}};var U=[];R.prototype._peekContext=function xr(){var e=U.length-1;if(e>=0){return U[e]}return void 0};R.prototype._pushContext=function br(){if(!D)return;U.push(this)};R.prototype._popContext=function wr(){if(!D)return;U.pop()};R.noConflict=function Tr(){return n(R)};R.setScheduler=function(e){if(typeof e!=="function")throw new x("fn must be a function");i._schedule=e};if(!f.isSupported()){R.longStackTraces=function(){};D=false}R._makeSelfResolutionError=P;e("./finally.js")(R,l,h);e("./direct_resolve.js")(R);e("./synchronous_inspection.js")(R);e("./join.js")(R,u,h,o);R.RangeError=_;R.CancellationError=b;R.TimeoutError=w;R.TypeError=x;R.OperationalError=T;R.RejectionError=T;R.AggregateError=a.AggregateError;t.toFastProperties(R);t.toFastProperties(R.prototype);R.Promise=R;e("./timers.js")(R,o,h);e("./race.js")(R,o,h);e("./call_get.js")(R);e("./generators.js")(R,C,o,h);e("./map.js")(R,u,C,h,o);e("./nodeify.js")(R);e("./promisify.js")(R,o);e("./props.js")(R,u,h);e("./reduce.js")(R,u,C,h,o);e("./settle.js")(R,u);e("./some.js")(R,u,C);e("./progress.js")(R,u);e("./cancel.js")(R,o);e("./filter.js")(R,o);e("./any.js")(R,u);e("./each.js")(R,o);e("./using.js")(R,C,h);R.prototype=R.prototype;return R}}).call(this,e("_process"))},{"./any.js":4,"./async.js":5,"./call_get.js":7,"./cancel.js":8,"./captured_trace.js":9,"./catch_filter.js":10,"./direct_resolve.js":11,"./each.js":12,"./errors.js":13,"./errors_api_rejection":14,"./filter.js":16,"./finally.js":17,"./generators.js":18,"./join.js":19,"./map.js":20,"./nodeify.js":21,"./progress.js":22,"./promise_array.js":24,"./promise_resolver.js":25,"./promisify.js":26,"./props.js":27,"./race.js":29,"./reduce.js":30,"./settle.js":32,"./some.js":33,"./synchronous_inspection.js":34,"./thenables.js":35,"./timers.js":36,"./using.js":37,"./util.js":38,_process:43}],24:[function(e,t,r){"use strict";t.exports=function(t,r,i){var n=e("./errors.js").canAttach;var a=e("./util.js");var o=a.isArray;function s(e){switch(e){case-1:return void 0;case-2:return[];case-3:return{}}}function l(e){var i=this._promise=new t(r);var n=void 0;if(e instanceof t){n=e;i._propagateFrom(n,1|4)}i._setTrace(n);this._values=e;this._length=0;this._totalResolved=0;this._init(void 0,-2)}l.prototype.length=function h(){return this._length};l.prototype.promise=function u(){return this._promise};l.prototype._init=function f(e,r){var n=i(this._values,void 0);if(n instanceof t){this._values=n;n._setBoundTo(this._promise._boundTo);if(n.isFulfilled()){n=n._settledValue;if(!o(n)){var a=new t.TypeError("expecting an array, a promise or a thenable");this.__hardReject__(a);return}}else if(n.isPending()){n._then(f,this._reject,void 0,this,r);return}else{n._unsetRejectionIsUnhandled();this._reject(n._settledValue);return}}else if(!o(n)){var a=new t.TypeError("expecting an array, a promise or a thenable");this.__hardReject__(a);return}if(n.length===0){if(r===-5){this._resolveEmptyArray()}else{this._resolve(s(r))}return}var l=this.getActualLength(n.length);var h=l;var u=this.shouldCopyValues()?new Array(l):this._values;var c=false;for(var p=0;p<l;++p){var d=i(n[p],void 0);if(d instanceof t){if(d.isPending()){d._proxyPromiseArray(this,p)}else{d._unsetRejectionIsUnhandled();c=true}}else{c=true}u[p]=d}this._values=u;this._length=h;if(c){this._scanDirectValues(l)}};l.prototype._settlePromiseAt=function c(e){var r=this._values[e];if(!(r instanceof t)){this._promiseFulfilled(r,e)}else if(r.isFulfilled()){this._promiseFulfilled(r._settledValue,e)}else if(r.isRejected()){this._promiseRejected(r._settledValue,e)}};l.prototype._scanDirectValues=function p(e){for(var t=0;t<e;++t){if(this._isResolved()){break}this._settlePromiseAt(t)}};l.prototype._isResolved=function d(){return this._values===null};l.prototype._resolve=function v(e){this._values=null;this._promise._fulfill(e)};l.prototype.__hardReject__=l.prototype._reject=function m(e){this._values=null;var t=n(e)?e:new Error(e+"");this._promise._attachExtraTrace(t);this._promise._reject(e,t)};l.prototype._promiseProgressed=function g(e,t){if(this._isResolved())return;this._promise._progress({index:t,value:e})};l.prototype._promiseFulfilled=function y(e,t){if(this._isResolved())return;this._values[t]=e;var r=++this._totalResolved;if(r>=this._length){this._resolve(this._values)}};l.prototype._promiseRejected=function _(e,t){if(this._isResolved())return;this._totalResolved++;this._reject(e)};l.prototype.shouldCopyValues=function x(){return true};l.prototype.getActualLength=function b(e){return e};return l}},{"./errors.js":13,"./util.js":38}],25:[function(e,t,r){"use strict";var i=e("./util.js");var n=i.maybeWrapAsError;var a=e("./errors.js");var o=a.TimeoutError;var s=a.OperationalError;var l=e("./async.js");var h=i.haveGetters;var u=e("./es5.js");function f(e){return e instanceof Error&&u.getPrototypeOf(e)===Error.prototype}function c(e){var t;if(f(e)){t=new s(e)}else{t=e}a.markAsOriginatingFromRejection(t);return t}function p(e){function t(t,r){if(e===null)return;if(t){var i=c(n(t));e._attachExtraTrace(i);e._reject(i)}else if(arguments.length>2){var a=arguments.length;var o=new Array(a-1);for(var s=1;s<a;++s){o[s-1]=arguments[s]}e._fulfill(o)}else{e._fulfill(r)}e=null}return t}var d;if(!h){d=function m(e){this.promise=e;this.asCallback=p(e);this.callback=this.asCallback}}else{d=function g(e){this.promise=e}}if(h){var v={get:function(){return p(this.promise)}};u.defineProperty(d.prototype,"asCallback",v);u.defineProperty(d.prototype,"callback",v)}d._nodebackForPromise=p;d.prototype.toString=function y(){return"[object PromiseResolver]"};d.prototype.resolve=d.prototype.fulfill=function _(e){if(!(this instanceof d)){throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.")}var t=this.promise;if(t._tryFollow(e)){return}l.invoke(t._fulfill,t,e)};d.prototype.reject=function x(e){if(!(this instanceof d)){throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.")}var t=this.promise;a.markAsOriginatingFromRejection(e);var r=a.canAttach(e)?e:new Error(e+"");t._attachExtraTrace(r);l.invoke(t._reject,t,e);if(r!==e){l.invoke(this._setCarriedStackTrace,this,r)}};d.prototype.progress=function b(e){if(!(this instanceof d)){throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.")}l.invoke(this.promise._progress,this.promise,e)};d.prototype.cancel=function w(){l.invoke(this.promise.cancel,this.promise,void 0)};d.prototype.timeout=function T(){this.reject(new o("timeout"))};d.prototype.isResolved=function S(){return this.promise.isResolved()};d.prototype.toJSON=function M(){return this.promise.toJSON()};d.prototype._setCarriedStackTrace=function A(e){if(this.promise.isRejected()){this.promise._setCarriedStackTrace(e)}};t.exports=d},{"./async.js":5,"./errors.js":13,"./es5.js":15,"./util.js":38}],26:[function(e,t,r){"use strict";t.exports=function(t,r){var i={};var n=e("./util.js");var a=e("./promise_resolver.js")._nodebackForPromise;var o=n.withAppended;var s=n.maybeWrapAsError;var l=n.canEvaluate;var h=e("./errors").TypeError;var u="Async";var f=function(e,t){return n.isIdentifier(e)&&e.charAt(0)!=="_"&&!n.isClass(t)};var c={__isPromisified__:true};function p(e){return e.replace(/([$])/,"\\$")}function d(e){try{return e.__isPromisified__===true}catch(t){return false}}function v(e,t,r){var i=n.getDataPropertyOrDefault(e,t+r,c);return i?d(i):false}function m(e,t,r){for(var i=0;i<e.length;i+=2){var n=e[i];if(r.test(n)){var a=n.replace(r,"");for(var o=0;o<e.length;o+=2){if(e[o]===a){throw new h("Cannot promisify an API "+"that has normal methods with '"+t+"'-suffix")}}}}}function g(e,t,r,i){var a=n.inheritedDataKeys(e);var o=[];for(var s=0;s<a.length;++s){var l=a[s];var h=e[l];if(typeof h==="function"&&!d(h)&&!v(e,l,t)&&i(l,h,e)){o.push(l,h)}}m(o,t,r);return o}function y(e){var t=[e];var r=Math.max(0,e-1-5);for(var i=e-1;i>=r;--i){if(i===e)continue;t.push(i)}for(var i=e+1;i<=5;++i){t.push(i)}return t}function _(e){return n.filledRange(e,"arguments[","]")}function x(e){return n.filledRange(e,"_arg","")}function b(e){if(typeof e.length==="number"){return Math.max(Math.min(e.length,1023+1),0)}return 0}function w(e){if(n.isIdentifier(e)){return"."+e}else return"['"+e.replace(/(['\\])/g,"\\$1")+"']"}function T(e,l,h,u,f){var c=Math.max(0,b(u)-1);var p=y(c);var d=typeof h==="string"&&n.isIdentifier(h)?h+f:"promisified";function v(t){var r=_(t).join(", ");var n=t>0?", ":"";var a;if(typeof e==="string"){a="                                                          \n                this.method({{args}}, fn);                                   \n                break;                                                       \n            ".replace(".method",w(e))}else if(l===i){a="                                                         \n                callback.call(this, {{args}}, fn);                           \n                break;                                                       \n            "}else if(l!==void 0){a="                                                         \n                callback.call(receiver, {{args}}, fn);                       \n                break;                                                       \n            "}else{a="                                                         \n                callback({{args}}, fn);                                      \n                break;                                                       \n            "}return a.replace("{{args}}",r).replace(", ",n)}function m(){var t="";for(var r=0;r<p.length;++r){t+="case "+p[r]+":"+v(p[r])}var n;if(typeof e==="string"){n="                                                  \n                this.property.apply(this, args);                             \n            ".replace(".property",w(e))}else if(l===i){n="                                                  \n                callback.apply(this, args);                                  \n            "}else{n="                                                  \n                callback.apply(receiver, args);                              \n            "}t+="                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = fn;                                                    \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace("[CodeForCall]",n);return t}return new Function("Promise","callback","receiver","withAppended","maybeWrapAsError","nodebackForPromise","INTERNAL","                                         \n        var ret = function FunctionName(Parameters) {                        \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._setTrace(void 0);                                       \n            var fn = nodebackForPromise(promise);                            \n            try {                                                            \n                switch(len) {                                                \n                    [CodeForSwitchCase]                                      \n                }                                                            \n            } catch (e) {                                                    \n                var wrapped = maybeWrapAsError(e);                           \n                promise._attachExtraTrace(wrapped);                          \n                promise._reject(wrapped);                                    \n            }                                                                \n            return promise;                                                  \n        };                                                                   \n        ret.__isPromisified__ = true;                                        \n        return ret;                                                          \n        ".replace("FunctionName",d).replace("Parameters",x(c)).replace("[CodeForSwitchCase]",m()))(t,e,l,o,s,a,r)}function S(e,n){function l(){var l=n;if(n===i)l=this;if(typeof e==="string"){e=l[e]}var h=new t(r);h._setTrace(void 0);var u=a(h);try{e.apply(l,o(arguments,u))}catch(f){var c=s(f);h._attachExtraTrace(c);h._reject(c)}return h}l.__isPromisified__=true;return l}var M=l?T:S;function A(e,t,r,a){var o=new RegExp(p(t)+"$");var s=g(e,t,o,r);for(var l=0,h=s.length;l<h;l+=2){var u=s[l];var f=s[l+1];var c=u+t;e[c]=a===M?M(u,i,u,f,t):a(f)}n.toFastProperties(e);return e}function E(e,t){return M(e,t,void 0,e)}t.promisify=function C(e,t){if(typeof e!=="function"){throw new h("fn must be a function")}if(d(e)){return e}return E(e,arguments.length<2?i:t)};t.promisifyAll=function P(e,t){if(typeof e!=="function"&&typeof e!=="object"){throw new h("the target of promisifyAll must be an object or a function")}t=Object(t);var r=t.suffix;if(typeof r!=="string")r=u;var i=t.filter;if(typeof i!=="function")i=f;var a=t.promisifier;if(typeof a!=="function")a=M;if(!n.isIdentifier(r)){throw new RangeError("suffix must be a valid identifier")}var o=n.inheritedDataKeys(e,{includeHidden:true});for(var s=0;s<o.length;++s){var l=e[o[s]];if(o[s]!=="constructor"&&n.isClass(l)){A(l.prototype,r,i,a);A(l,r,i,a)}}return A(e,r,i,a)}}},{"./errors":13,"./promise_resolver.js":25,"./util.js":38}],27:[function(e,t,r){"use strict";t.exports=function(t,r,i){var n=e("./util.js");var a=e("./errors_api_rejection")(t);var o=n.isObject;var s=e("./es5.js");function l(e){var t=s.keys(e);var r=t.length;var i=new Array(r*2);for(var n=0;n<r;++n){var a=t[n];i[n]=e[a];i[n+r]=a}this.constructor$(i)}n.inherits(l,r);l.prototype._init=function u(){this._init$(void 0,-3)};l.prototype._promiseFulfilled=function f(e,t){if(this._isResolved())return;this._values[t]=e;var r=++this._totalResolved;if(r>=this._length){var i={};var n=this.length();for(var a=0,o=this.length();a<o;++a){i[this._values[a+n]]=this._values[a]}this._resolve(i)}};l.prototype._promiseProgressed=function c(e,t){if(this._isResolved())return;this._promise._progress({key:this._values[t+this.length()],value:e})};l.prototype.shouldCopyValues=function p(){return false};l.prototype.getActualLength=function d(e){return e>>1};function h(e){var r;var n=i(e,void 0);if(!o(n)){return a("cannot await properties of a non-object")}else if(n instanceof t){r=n._then(t.props,void 0,void 0,void 0,void 0)}else{r=new l(n).promise()}if(n instanceof t){r._propagateFrom(n,4)}return r}t.prototype.props=function v(){return h(this)};t.props=function m(e){return h(e)}}},{"./errors_api_rejection":14,"./es5.js":15,"./util.js":38}],28:[function(e,t,r){"use strict";function i(e,t,r,i,n){for(var a=0;a<n;++a){r[a+i]=e[a+t]}}function n(e){this._capacity=e;this._length=0;this._front=0;this._makeCapacity()}n.prototype._willBeOverCapacity=function a(e){return this._capacity<e};n.prototype._pushOne=function o(e){var t=this.length();this._checkCapacity(t+1);var r=this._front+t&this._capacity-1;this[r]=e;this._length=t+1};n.prototype.push=function s(e,t,r){var i=this.length()+3;if(this._willBeOverCapacity(i)){this._pushOne(e);this._pushOne(t);this._pushOne(r);return}var n=this._front+i-3;this._checkCapacity(i);var a=this._capacity-1;this[n+0&a]=e;this[n+1&a]=t;this[n+2&a]=r;this._length=i};n.prototype.shift=function l(){var e=this._front,t=this[e];this[e]=void 0;this._front=e+1&this._capacity-1;this._length--;return t};n.prototype.length=function h(){return this._length};n.prototype._makeCapacity=function u(){var e=this._capacity;for(var t=0;t<e;++t){this[t]=void 0}};n.prototype._checkCapacity=function f(e){if(this._capacity<e){this._resizeTo(this._capacity<<3)}};n.prototype._resizeTo=function c(e){var t=this._front;var r=this._capacity;var n=new Array(r);var a=this.length();i(this,0,n,0,r);this._capacity=e;this._makeCapacity();this._front=0;if(t+a<=r){i(n,t,this,0,a)}else{var o=a-(t+a&r-1);i(n,t,this,0,o);i(n,0,this,o,a-o)}};t.exports=n},{}],29:[function(e,t,r){"use strict";t.exports=function(t,r,i){var n=e("./errors_api_rejection.js")(t);var a=e("./util.js").isArray;var o=function h(e){return e.then(function(t){return l(t,e)})};var s={}.hasOwnProperty;function l(e,l){var h=i(e,void 0);if(h instanceof t){return o(h)}else if(!a(e)){return n("expecting an array, a promise or a thenable")}var u=new t(r);if(l!==void 0){u._propagateFrom(l,7)}else{u._setTrace(void 0)}var f=u._fulfill;var c=u._reject;for(var p=0,d=e.length;p<d;++p){var v=e[p];if(v===void 0&&!s.call(e,p)){continue}t.cast(v)._then(f,c,void 0,u,null)}return u}t.race=function u(e){return l(e,void 0)};t.prototype.race=function f(){return l(this,void 0)}}},{"./errors_api_rejection.js":14,"./util.js":38}],30:[function(e,t,r){"use strict";t.exports=function(t,r,i,n,a){var o=e("./util.js");var s=o.tryCatch4;var l=o.tryCatch3;var h=o.errorObj;function u(e,r,i,o){this.constructor$(e);this._preservedValues=o===a?[]:null;this._zerothIsAccum=i===void 0;this._gotAccum=false;this._reducingIndex=this._zerothIsAccum?1:0;this._valuesPhase=undefined;var s=n(i,void 0);var l=false;var h=s instanceof t;if(h){if(s.isPending()){s._proxyPromiseArray(this,-1)}else if(s.isFulfilled()){i=s.value();this._gotAccum=true}else{s._unsetRejectionIsUnhandled();this._reject(s.reason());l=true}}if(!(h||this._zerothIsAccum))this._gotAccum=true;this._callback=r;this._accum=i;if(!l)this._init$(void 0,-5)}o.inherits(u,r);u.prototype._init=function c(){};u.prototype._resolveEmptyArray=function p(){if(this._gotAccum||this._zerothIsAccum){this._resolve(this._preservedValues!==null?[]:this._accum)}};u.prototype._promiseFulfilled=function d(e,r){var i=this._values;if(i===null)return;var a=this.length();var o=this._preservedValues;var u=o!==null;var f=this._gotAccum;var c=this._valuesPhase;var p;if(!c){c=this._valuesPhase=Array(a);for(p=0;p<a;++p){c[p]=0}}p=c[r];if(r===0&&this._zerothIsAccum){if(!f){this._accum=e;this._gotAccum=f=true}c[r]=p===0?1:2}else if(r===-1){if(!f){this._accum=e;this._gotAccum=f=true}}else{if(p===0){c[r]=1}else{c[r]=2;if(f){this._accum=e}}}if(!f)return;var d=this._callback;var v=this._promise._boundTo;var m;for(var g=this._reducingIndex;g<a;++g){p=c[g];if(p===2){this._reducingIndex=g+1;continue}if(p!==1)return;e=i[g];if(e instanceof t){if(e.isFulfilled()){e=e._settledValue}else if(e.isPending()){return}else{e._unsetRejectionIsUnhandled();return this._reject(e.reason())}}if(u){o.push(e);m=l(d,v,e,g,a)}else{m=s(d,v,this._accum,e,g,a)}if(m===h)return this._reject(m.e);var y=n(m,void 0);if(y instanceof t){if(y.isPending()){c[g]=4;return y._proxyPromiseArray(this,g)}else if(y.isFulfilled()){m=y.value()}else{y._unsetRejectionIsUnhandled();return this._reject(y.reason())}}this._reducingIndex=g+1;this._accum=m}if(this._reducingIndex<a)return;this._resolve(u?o:this._accum)};function f(e,t,r,n){if(typeof t!=="function")return i("fn must be a function");var a=new u(e,t,r,n);return a.promise()}t.prototype.reduce=function v(e,t){return f(this,e,t,null)};t.reduce=function m(e,t,r,i){return f(e,t,r,i)}}},{"./util.js":38}],31:[function(e,t,r){(function(e){"use strict";var r;var i;if(typeof e==="object"&&typeof e.version==="string"){r=function n(t){e.nextTick(t)}}else if(typeof MutationObserver!=="undefined"&&(i=MutationObserver)||typeof WebKitMutationObserver!=="undefined"&&(i=WebKitMutationObserver)){r=function(){var e=document.createElement("div");var t=void 0;var r=new i(function n(){var e=t;t=void 0;e()});r.observe(e,{attributes:true});return function a(r){t=r;e.classList.toggle("foo")}}()}else if(typeof setTimeout!=="undefined"){r=function a(e){setTimeout(e,0)}}else throw new Error("no async scheduler available");t.exports=r}).call(this,e("_process"))},{_process:43}],32:[function(e,t,r){"use strict";t.exports=function(t,r){var i=t.PromiseInspection;var n=e("./util.js");function a(e){this.constructor$(e)}n.inherits(a,r);a.prototype._promiseResolved=function o(e,t){this._values[e]=t;var r=++this._totalResolved;if(r>=this._length){this._resolve(this._values)}};a.prototype._promiseFulfilled=function s(e,t){if(this._isResolved())return;var r=new i;r._bitField=268435456;r._settledValue=e;this._promiseResolved(t,r)};a.prototype._promiseRejected=function l(e,t){if(this._isResolved())return;var r=new i;r._bitField=134217728;r._settledValue=e;this._promiseResolved(t,r)};t.settle=function h(e){return new a(e).promise()};t.prototype.settle=function u(){return new a(this).promise()}}},{"./util.js":38}],33:[function(e,t,r){"use strict";t.exports=function(t,r,i){var n=e("./util.js");var a=e("./errors.js").RangeError;var o=e("./errors.js").AggregateError;var s=n.isArray;function l(e){this.constructor$(e);this._howMany=0;this._unwrap=false;this._initialized=false}n.inherits(l,r);l.prototype._init=function u(){if(!this._initialized){return}if(this._howMany===0){this._resolve([]);return}this._init$(void 0,-5);var e=s(this._values);if(!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()){this._reject(this._getRangeError(this.length()))}};l.prototype.init=function f(){this._initialized=true;this._init()};l.prototype.setUnwrap=function c(){this._unwrap=true};l.prototype.howMany=function p(){return this._howMany};l.prototype.setHowMany=function d(e){if(this._isResolved())return;this._howMany=e};l.prototype._promiseFulfilled=function v(e){if(this._isResolved())return;this._addFulfilled(e);if(this._fulfilled()===this.howMany()){this._values.length=this.howMany();if(this.howMany()===1&&this._unwrap){this._resolve(this._values[0])}else{this._resolve(this._values)}}};l.prototype._promiseRejected=function m(e){if(this._isResolved())return;this._addRejected(e);if(this.howMany()>this._canPossiblyFulfill()){var t=new o;for(var r=this.length();r<this._values.length;++r){t.push(this._values[r])}this._reject(t)}};l.prototype._fulfilled=function g(){return this._totalResolved};l.prototype._rejected=function y(){return this._values.length-this.length()};l.prototype._addRejected=function _(e){this._values.push(e)};l.prototype._addFulfilled=function x(e){this._values[this._totalResolved++]=e};l.prototype._canPossiblyFulfill=function b(){return this.length()-this._rejected()};l.prototype._getRangeError=function w(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new a(t)};l.prototype._resolveEmptyArray=function T(){this._reject(this._getRangeError(0))};function h(e,t){if((t|0)!==t||t<0){return i("expecting a positive integer")}var r=new l(e);var n=r.promise();if(n.isRejected()){return n}r.setHowMany(t);r.init();return n}t.some=function S(e,t){return h(e,t)};t.prototype.some=function M(e){return h(this,e)};t._SomePromiseArray=l}},{"./errors.js":13,"./util.js":38}],34:[function(e,t,r){"use strict";t.exports=function(e){function t(e){if(e!==void 0){this._bitField=e._bitField;this._settledValue=e.isResolved()?e._settledValue:void 0}else{this._bitField=0;this._settledValue=void 0}}t.prototype.isFulfilled=e.prototype.isFulfilled=function r(){return(this._bitField&268435456)>0};t.prototype.isRejected=e.prototype.isRejected=function i(){return(this._bitField&134217728)>0
};t.prototype.isPending=e.prototype.isPending=function n(){return(this._bitField&402653184)===0};t.prototype.value=e.prototype.value=function a(){if(!this.isFulfilled()){throw new TypeError("cannot get fulfillment value of a non-fulfilled promise")}return this._settledValue};t.prototype.error=t.prototype.reason=e.prototype.reason=function o(){if(!this.isRejected()){throw new TypeError("cannot get rejection reason of a non-rejected promise")}return this._settledValue};t.prototype.isResolved=e.prototype.isResolved=function s(){return(this._bitField&402653184)>0};e.PromiseInspection=t}},{}],35:[function(e,t,r){"use strict";t.exports=function(t,r){var i=e("./util.js");var n=e("./errors.js").canAttach;var a=i.errorObj;var o=i.isObject;function s(e){try{return e.then}catch(t){a.e=t;return a}}function l(e,i){if(o(e)){if(e instanceof t){return e}else if(u(e)){var l=new t(r);l._setTrace(void 0);e._then(l._fulfillUnchecked,l._rejectUncheckedCheckError,l._progressUnchecked,l,null);l._setFollowing();return l}var h=s(e);if(h===a){if(i!==void 0&&n(h.e)){i._attachExtraTrace(h.e)}return t.reject(h.e)}else if(typeof h==="function"){return f(e,h,i)}}return e}var h={}.hasOwnProperty;function u(e){return h.call(e,"_promise0")}function f(e,r,i){var a=t.defer();var o=false;try{r.call(e,h,u,f)}catch(s){if(!o){o=true;var l=n(s)?s:new Error(s+"");if(i!==void 0){i._attachExtraTrace(l)}a.promise._reject(s,l)}}return a.promise;function h(r){if(o)return;o=true;if(e===r){var n=t._makeSelfResolutionError();if(i!==void 0){i._attachExtraTrace(n)}a.promise._reject(n,void 0);return}a.resolve(r)}function u(e){if(o)return;o=true;var t=n(e)?e:new Error(e+"");if(i!==void 0){i._attachExtraTrace(t)}a.promise._reject(e,t)}function f(e){if(o)return;var t=a.promise;if(typeof t._progress==="function"){t._progress(e)}}}return l}},{"./errors.js":13,"./util.js":38}],36:[function(e,t,r){"use strict";var i=function(e,t){var r=arguments.length;var i=arguments[2];var n=arguments[3];var a=r>=5?arguments[4]:void 0;return setTimeout(function(){e(i,n,a)},t|0)};t.exports=function(t,r,n){var a=e("./util.js");var o=e("./errors.js");var s=e("./errors_api_rejection")(t);var l=t.TimeoutError;var h=function d(e,t,r){if(!e.isPending())return;if(typeof t!=="string"){t="operation timed out after"+" "+r+" ms"}var i=new l(t);o.markAsOriginatingFromRejection(i);e._attachExtraTrace(i);e._cancel(i)};var u=function v(e,t){t._fulfill(e)};var f=t.delay=function m(e,a){if(a===void 0){a=e;e=void 0}a=+a;var o=n(e,void 0);var s=new t(r);if(o instanceof t){s._propagateFrom(o,7);s._follow(o);return s.then(function(e){return t.delay(e,a)})}else{s._setTrace(void 0);i(u,a,e,s)}return s};t.prototype.delay=function g(e){return f(this,e)};function c(e){var t=this;if(t instanceof Number)t=+t;clearTimeout(t);return e}function p(e){var t=this;if(t instanceof Number)t=+t;clearTimeout(t);throw e}t.prototype.timeout=function y(e,n){e=+e;var a=new t(r);a._propagateFrom(this,7);a._follow(this);var o=i(h,e,a,n,e);return a.cancellable()._then(c,p,void 0,o,void 0)}}},{"./errors.js":13,"./errors_api_rejection":14,"./util.js":38}],37:[function(e,t,r){"use strict";t.exports=function(t,r,i){var n=e("./errors.js").TypeError;var a=e("./util.js").inherits;var o=t.PromiseInspection;function s(e){var r=e.length;for(var i=0;i<r;++i){var n=e[i];if(n.isRejected()){return t.reject(n.error())}e[i]=n.value()}return e}function l(e){setTimeout(function(){throw e},0)}function h(e){var t=i(e,void 0);if(t!==e&&typeof e._isDisposable==="function"&&typeof e._getDisposer==="function"&&e._isDisposable()){t._setDisposable(e._getDisposer())}return t}function u(e,r){var n=0;var a=e.length;var o=t.defer();function s(){if(n>=a)return o.resolve();var u=h(e[n++]);if(u instanceof t&&u._isDisposable()){try{u=i(u._getDisposer().tryDispose(r),void 0)}catch(f){return l(f)}if(u instanceof t){return u._then(s,l,null,null,null)}}s()}s();return o.promise}function f(e){var t=new o;t._settledValue=e;t._bitField=268435456;return u(this,t).thenReturn(e)}function c(e){var t=new o;t._settledValue=e;t._bitField=134217728;return u(this,t).thenThrow(e)}function p(e,t){this._data=e;this._promise=t}p.prototype.data=function v(){return this._data};p.prototype.promise=function m(){return this._promise};p.prototype.resource=function g(){if(this.promise().isFulfilled()){return this.promise().value()}return null};p.prototype.tryDispose=function(e){var t=this.resource();var r=t!==null?this.doDispose(t,e):null;this._promise._unsetDisposable();this._data=this._promise=null;return r};p.isDisposer=function y(e){return e!=null&&typeof e.resource==="function"&&typeof e.tryDispose==="function"};function d(e,t){this.constructor$(e,t)}a(d,p);d.prototype.doDispose=function(e,t){var r=this.data();return r.call(e,e,t)};t.using=function _(){var e=arguments.length;if(e<2)return r("you must pass at least 2 arguments to Promise.using");var i=arguments[e-1];if(typeof i!=="function")return r("fn must be a function");e--;var n=new Array(e);for(var a=0;a<e;++a){var o=arguments[a];if(p.isDisposer(o)){var l=o;o=o.promise();o._setDisposable(l)}n[a]=o}return t.settle(n).then(s).spread(i)._then(f,c,void 0,n,void 0)};t.prototype._setDisposable=function x(e){this._bitField=this._bitField|262144;this._disposer=e};t.prototype._isDisposable=function b(){return(this._bitField&262144)>0};t.prototype._getDisposer=function w(){return this._disposer};t.prototype._unsetDisposable=function T(){this._bitField=this._bitField&~262144;this._disposer=void 0};t.prototype.disposer=function S(e){if(typeof e==="function"){return new d(e,this)}throw new n}}},{"./errors.js":13,"./util.js":38}],38:[function(require,module,exports){"use strict";var es5=require("./es5.js");var haveGetters=function(){try{var e={};es5.defineProperty(e,"f",{get:function(){return 3}});return e.f===3}catch(t){return false}}();var canEvaluate=typeof navigator=="undefined";var errorObj={e:{}};function tryCatch1(e,t,r){try{return e.call(t,r)}catch(i){errorObj.e=i;return errorObj}}function tryCatch2(e,t,r,i){try{return e.call(t,r,i)}catch(n){errorObj.e=n;return errorObj}}function tryCatch3(e,t,r,i,n){try{return e.call(t,r,i,n)}catch(a){errorObj.e=a;return errorObj}}function tryCatch4(e,t,r,i,n,a){try{return e.call(t,r,i,n,a)}catch(o){errorObj.e=o;return errorObj}}function tryCatchApply(e,t,r){try{return e.apply(r,t)}catch(i){errorObj.e=i;return errorObj}}var inherits=function(e,t){var r={}.hasOwnProperty;function i(){this.constructor=e;this.constructor$=t;for(var i in t.prototype){if(r.call(t.prototype,i)&&i.charAt(i.length-1)!=="$"){this[i+"$"]=t.prototype[i]}}}i.prototype=t.prototype;e.prototype=new i;return e.prototype};function asString(e){return typeof e==="string"?e:""+e}function isPrimitive(e){return e==null||e===true||e===false||typeof e==="string"||typeof e==="number"}function isObject(e){return!isPrimitive(e)}function maybeWrapAsError(e){if(!isPrimitive(e))return e;return new Error(asString(e))}function withAppended(e,t){var r=e.length;var i=new Array(r+1);var n;for(n=0;n<r;++n){i[n]=e[n]}i[n]=t;return i}function getDataPropertyOrDefault(e,t,r){if(es5.isES5){var i=Object.getOwnPropertyDescriptor(e,t);if(i!=null){return i.get==null&&i.set==null?i.value:r}}else{return{}.hasOwnProperty.call(e,t)?e[t]:void 0}}function notEnumerableProp(e,t,r){if(isPrimitive(e))return e;var i={value:r,configurable:true,enumerable:false,writable:true};es5.defineProperty(e,t,i);return e}var wrapsPrimitiveReceiver=function(){return this!=="string"}.call("string");function thrower(e){throw e}var inheritedDataKeys=function(){if(es5.isES5){return function(e,t){var r=[];var i=Object.create(null);var n=Object(t).includeHidden?Object.getOwnPropertyNames:Object.keys;while(e!=null){var a;try{a=n(e)}catch(o){return r}for(var s=0;s<a.length;++s){var l=a[s];if(i[l])continue;i[l]=true;var h=Object.getOwnPropertyDescriptor(e,l);if(h!=null&&h.get==null&&h.set==null){r.push(l)}}e=es5.getPrototypeOf(e)}return r}}else{return function(e){var t=[];for(var r in e){t.push(r)}return t}}}();function isClass(e){try{if(typeof e==="function"){var t=es5.keys(e.prototype);return t.length>0&&!(t.length===1&&t[0]==="constructor")}return false}catch(r){return false}}function toFastProperties(obj){function f(){}f.prototype=obj;return f;eval(obj)}var rident=/^[a-z$_][a-z$_0-9]*$/i;function isIdentifier(e){return rident.test(e)}function filledRange(e,t,r){var i=new Array(e);for(var n=0;n<e;++n){i[n]=t+n+r}return i}var ret={isClass:isClass,isIdentifier:isIdentifier,inheritedDataKeys:inheritedDataKeys,getDataPropertyOrDefault:getDataPropertyOrDefault,thrower:thrower,isArray:es5.isArray,haveGetters:haveGetters,notEnumerableProp:notEnumerableProp,isPrimitive:isPrimitive,isObject:isObject,canEvaluate:canEvaluate,errorObj:errorObj,tryCatch1:tryCatch1,tryCatch2:tryCatch2,tryCatch3:tryCatch3,tryCatch4:tryCatch4,tryCatchApply:tryCatchApply,inherits:inherits,withAppended:withAppended,asString:asString,maybeWrapAsError:maybeWrapAsError,wrapsPrimitiveReceiver:wrapsPrimitiveReceiver,toFastProperties:toFastProperties,filledRange:filledRange};module.exports=ret},{"./es5.js":15}],39:[function(e,t,r){var i=e("base64-js");var n=e("ieee754");var a=e("is-array");r.Buffer=s;r.SlowBuffer=s;r.INSPECT_MAX_BYTES=50;s.poolSize=8192;var o=1073741823;s.TYPED_ARRAY_SUPPORT=function(){try{var e=new ArrayBuffer(0);var t=new Uint8Array(e);t.foo=function(){return 42};return 42===t.foo()&&typeof t.subarray==="function"&&new Uint8Array(1).subarray(1,1).byteLength===0}catch(r){return false}}();function s(e,t,r){if(!(this instanceof s))return new s(e,t,r);var i=typeof e;var n;if(i==="number")n=e>0?e>>>0:0;else if(i==="string"){if(t==="base64")e=P(e);n=s.byteLength(e,t)}else if(i==="object"&&e!==null){if(e.type==="Buffer"&&a(e.data))e=e.data;n=+e.length>0?Math.floor(+e.length):0}else throw new TypeError("must start with number, buffer, array or string");if(this.length>o)throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+o.toString(16)+" bytes");var l;if(s.TYPED_ARRAY_SUPPORT){l=s._augment(new Uint8Array(n))}else{l=this;l.length=n;l._isBuffer=true}var h;if(s.TYPED_ARRAY_SUPPORT&&typeof e.byteLength==="number"){l._set(e)}else if(L(e)){if(s.isBuffer(e)){for(h=0;h<n;h++)l[h]=e.readUInt8(h)}else{for(h=0;h<n;h++)l[h]=(e[h]%256+256)%256}}else if(i==="string"){l.write(e,0,t)}else if(i==="number"&&!s.TYPED_ARRAY_SUPPORT&&!r){for(h=0;h<n;h++){l[h]=0}}return l}s.isBuffer=function(e){return!!(e!=null&&e._isBuffer)};s.compare=function(e,t){if(!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError("Arguments must be Buffers");var r=e.length;var i=t.length;for(var n=0,a=Math.min(r,i);n<a&&e[n]===t[n];n++){}if(n!==a){r=e[n];i=t[n]}if(r<i)return-1;if(i<r)return 1;return 0};s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};s.concat=function(e,t){if(!a(e))throw new TypeError("Usage: Buffer.concat(list[, length])");if(e.length===0){return new s(0)}else if(e.length===1){return e[0]}var r;if(t===undefined){t=0;for(r=0;r<e.length;r++){t+=e[r].length}}var i=new s(t);var n=0;for(r=0;r<e.length;r++){var o=e[r];o.copy(i,n);n+=o.length}return i};s.byteLength=function(e,t){var r;e=e+"";switch(t||"utf8"){case"ascii":case"binary":case"raw":r=e.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=e.length*2;break;case"hex":r=e.length>>>1;break;case"utf8":case"utf-8":r=F(e).length;break;case"base64":r=O(e).length;break;default:r=e.length}return r};s.prototype.length=undefined;s.prototype.parent=undefined;s.prototype.toString=function(e,t,r){var i=false;t=t>>>0;r=r===undefined||r===Infinity?this.length:r>>>0;if(!e)e="utf8";if(t<0)t=0;if(r>this.length)r=this.length;if(r<=t)return"";while(true){switch(e){case"hex":return y(this,t,r);case"utf8":case"utf-8":return v(this,t,r);case"ascii":return m(this,t,r);case"binary":return g(this,t,r);case"base64":return d(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();i=true}}};s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return s.compare(this,e)===0};s.prototype.inspect=function(){var e="";var t=r.INSPECT_MAX_BYTES;if(this.length>0){e=this.toString("hex",0,t).match(/.{2}/g).join(" ");if(this.length>t)e+=" ... "}return"<Buffer "+e+">"};s.prototype.compare=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return s.compare(this,e)};s.prototype.get=function(e){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(e)};s.prototype.set=function(e,t){console.log(".set() is deprecated. Access using array indexes instead.");return this.writeUInt8(e,t)};function l(e,t,r,i){r=Number(r)||0;var n=e.length-r;if(!i){i=n}else{i=Number(i);if(i>n){i=n}}var a=t.length;if(a%2!==0)throw new Error("Invalid hex string");if(i>a/2){i=a/2}for(var o=0;o<i;o++){var s=parseInt(t.substr(o*2,2),16);if(isNaN(s))throw new Error("Invalid hex string");e[r+o]=s}return o}function h(e,t,r,i){var n=j(F(t),e,r,i);return n}function u(e,t,r,i){var n=j(D(t),e,r,i);return n}function f(e,t,r,i){return u(e,t,r,i)}function c(e,t,r,i){var n=j(O(t),e,r,i);return n}function p(e,t,r,i){var n=j(U(t),e,r,i);return n}s.prototype.write=function(e,t,r,i){if(isFinite(t)){if(!isFinite(r)){i=r;r=undefined}}else{var n=i;i=t;t=r;r=n}t=Number(t)||0;var a=this.length-t;if(!r){r=a}else{r=Number(r);if(r>a){r=a}}i=String(i||"utf8").toLowerCase();var o;switch(i){case"hex":o=l(this,e,t,r);break;case"utf8":case"utf-8":o=h(this,e,t,r);break;case"ascii":o=u(this,e,t,r);break;case"binary":o=f(this,e,t,r);break;case"base64":o=c(this,e,t,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":o=p(this,e,t,r);break;default:throw new TypeError("Unknown encoding: "+i)}return o};s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function d(e,t,r){if(t===0&&r===e.length){return i.fromByteArray(e)}else{return i.fromByteArray(e.slice(t,r))}}function v(e,t,r){var i="";var n="";r=Math.min(e.length,r);for(var a=t;a<r;a++){if(e[a]<=127){i+=V(n)+String.fromCharCode(e[a]);n=""}else{n+="%"+e[a].toString(16)}}return i+V(n)}function m(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;n++){i+=String.fromCharCode(e[n])}return i}function g(e,t,r){return m(e,t,r)}function y(e,t,r){var i=e.length;if(!t||t<0)t=0;if(!r||r<0||r>i)r=i;var n="";for(var a=t;a<r;a++){n+=k(e[a])}return n}function _(e,t,r){var i=e.slice(t,r);var n="";for(var a=0;a<i.length;a+=2){n+=String.fromCharCode(i[a]+i[a+1]*256)}return n}s.prototype.slice=function(e,t){var r=this.length;e=~~e;t=t===undefined?r:~~t;if(e<0){e+=r;if(e<0)e=0}else if(e>r){e=r}if(t<0){t+=r;if(t<0)t=0}else if(t>r){t=r}if(t<e)t=e;if(s.TYPED_ARRAY_SUPPORT){return s._augment(this.subarray(e,t))}else{var i=t-e;var n=new s(i,undefined,true);for(var a=0;a<i;a++){n[a]=this[a+e]}return n}};function x(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUInt8=function(e,t){if(!t)x(e,1,this.length);return this[e]};s.prototype.readUInt16LE=function(e,t){if(!t)x(e,2,this.length);return this[e]|this[e+1]<<8};s.prototype.readUInt16BE=function(e,t){if(!t)x(e,2,this.length);return this[e]<<8|this[e+1]};s.prototype.readUInt32LE=function(e,t){if(!t)x(e,4,this.length);return(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};s.prototype.readUInt32BE=function(e,t){if(!t)x(e,4,this.length);return this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};s.prototype.readInt8=function(e,t){if(!t)x(e,1,this.length);if(!(this[e]&128))return this[e];return(255-this[e]+1)*-1};s.prototype.readInt16LE=function(e,t){if(!t)x(e,2,this.length);var r=this[e]|this[e+1]<<8;return r&32768?r|4294901760:r};s.prototype.readInt16BE=function(e,t){if(!t)x(e,2,this.length);var r=this[e+1]|this[e]<<8;return r&32768?r|4294901760:r};s.prototype.readInt32LE=function(e,t){if(!t)x(e,4,this.length);return this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};s.prototype.readInt32BE=function(e,t){if(!t)x(e,4,this.length);return this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};s.prototype.readFloatLE=function(e,t){if(!t)x(e,4,this.length);return n.read(this,e,true,23,4)};s.prototype.readFloatBE=function(e,t){if(!t)x(e,4,this.length);return n.read(this,e,false,23,4)};s.prototype.readDoubleLE=function(e,t){if(!t)x(e,8,this.length);return n.read(this,e,true,52,8)};s.prototype.readDoubleBE=function(e,t){if(!t)x(e,8,this.length);return n.read(this,e,false,52,8)};function b(e,t,r,i,n,a){if(!s.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");if(t>n||t<a)throw new TypeError("value is out of bounds");if(r+i>e.length)throw new TypeError("index out of range")}s.prototype.writeUInt8=function(e,t,r){e=+e;t=t>>>0;if(!r)b(this,e,t,1,255,0);if(!s.TYPED_ARRAY_SUPPORT)e=Math.floor(e);this[t]=e;return t+1};function w(e,t,r,i){if(t<0)t=65535+t+1;for(var n=0,a=Math.min(e.length-r,2);n<a;n++){e[r+n]=(t&255<<8*(i?n:1-n))>>>(i?n:1-n)*8}}s.prototype.writeUInt16LE=function(e,t,r){e=+e;t=t>>>0;if(!r)b(this,e,t,2,65535,0);if(s.TYPED_ARRAY_SUPPORT){this[t]=e;this[t+1]=e>>>8}else w(this,e,t,true);return t+2};s.prototype.writeUInt16BE=function(e,t,r){e=+e;t=t>>>0;if(!r)b(this,e,t,2,65535,0);if(s.TYPED_ARRAY_SUPPORT){this[t]=e>>>8;this[t+1]=e}else w(this,e,t,false);return t+2};function T(e,t,r,i){if(t<0)t=4294967295+t+1;for(var n=0,a=Math.min(e.length-r,4);n<a;n++){e[r+n]=t>>>(i?n:3-n)*8&255}}s.prototype.writeUInt32LE=function(e,t,r){e=+e;t=t>>>0;if(!r)b(this,e,t,4,4294967295,0);if(s.TYPED_ARRAY_SUPPORT){this[t+3]=e>>>24;this[t+2]=e>>>16;this[t+1]=e>>>8;this[t]=e}else T(this,e,t,true);return t+4};s.prototype.writeUInt32BE=function(e,t,r){e=+e;t=t>>>0;if(!r)b(this,e,t,4,4294967295,0);if(s.TYPED_ARRAY_SUPPORT){this[t]=e>>>24;this[t+1]=e>>>16;this[t+2]=e>>>8;this[t+3]=e}else T(this,e,t,false);return t+4};s.prototype.writeInt8=function(e,t,r){e=+e;t=t>>>0;if(!r)b(this,e,t,1,127,-128);if(!s.TYPED_ARRAY_SUPPORT)e=Math.floor(e);if(e<0)e=255+e+1;this[t]=e;return t+1};s.prototype.writeInt16LE=function(e,t,r){e=+e;t=t>>>0;if(!r)b(this,e,t,2,32767,-32768);if(s.TYPED_ARRAY_SUPPORT){this[t]=e;this[t+1]=e>>>8}else w(this,e,t,true);return t+2};s.prototype.writeInt16BE=function(e,t,r){e=+e;t=t>>>0;if(!r)b(this,e,t,2,32767,-32768);if(s.TYPED_ARRAY_SUPPORT){this[t]=e>>>8;this[t+1]=e}else w(this,e,t,false);return t+2};s.prototype.writeInt32LE=function(e,t,r){e=+e;t=t>>>0;if(!r)b(this,e,t,4,2147483647,-2147483648);if(s.TYPED_ARRAY_SUPPORT){this[t]=e;this[t+1]=e>>>8;this[t+2]=e>>>16;this[t+3]=e>>>24}else T(this,e,t,true);return t+4};s.prototype.writeInt32BE=function(e,t,r){e=+e;t=t>>>0;if(!r)b(this,e,t,4,2147483647,-2147483648);if(e<0)e=4294967295+e+1;if(s.TYPED_ARRAY_SUPPORT){this[t]=e>>>24;this[t+1]=e>>>16;this[t+2]=e>>>8;this[t+3]=e}else T(this,e,t,false);return t+4};function S(e,t,r,i,n,a){if(t>n||t<a)throw new TypeError("value is out of bounds");if(r+i>e.length)throw new TypeError("index out of range")}function M(e,t,r,i,a){if(!a)S(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38);n.write(e,t,r,i,23,4);return r+4}s.prototype.writeFloatLE=function(e,t,r){return M(this,e,t,true,r)};s.prototype.writeFloatBE=function(e,t,r){return M(this,e,t,false,r)};function A(e,t,r,i,a){if(!a)S(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308);n.write(e,t,r,i,52,8);return r+8}s.prototype.writeDoubleLE=function(e,t,r){return A(this,e,t,true,r)};s.prototype.writeDoubleBE=function(e,t,r){return A(this,e,t,false,r)};s.prototype.copy=function(e,t,r,i){var n=this;if(!r)r=0;if(!i&&i!==0)i=this.length;if(!t)t=0;if(i===r)return;if(e.length===0||n.length===0)return;if(i<r)throw new TypeError("sourceEnd < sourceStart");if(t<0||t>=e.length)throw new TypeError("targetStart out of bounds");if(r<0||r>=n.length)throw new TypeError("sourceStart out of bounds");if(i<0||i>n.length)throw new TypeError("sourceEnd out of bounds");if(i>this.length)i=this.length;if(e.length-t<i-r)i=e.length-t+r;var a=i-r;if(a<1e3||!s.TYPED_ARRAY_SUPPORT){for(var o=0;o<a;o++){e[o+t]=this[o+r]}}else{e._set(this.subarray(r,r+a),t)}};s.prototype.fill=function(e,t,r){if(!e)e=0;if(!t)t=0;if(!r)r=this.length;if(r<t)throw new TypeError("end < start");if(r===t)return;if(this.length===0)return;if(t<0||t>=this.length)throw new TypeError("start out of bounds");if(r<0||r>this.length)throw new TypeError("end out of bounds");var i;if(typeof e==="number"){for(i=t;i<r;i++){this[i]=e}}else{var n=F(e.toString());var a=n.length;for(i=t;i<r;i++){this[i]=n[i%a]}}return this};s.prototype.toArrayBuffer=function(){if(typeof Uint8Array!=="undefined"){if(s.TYPED_ARRAY_SUPPORT){return new s(this).buffer}else{var e=new Uint8Array(this.length);for(var t=0,r=e.length;t<r;t+=1){e[t]=this[t]}return e.buffer}}else{throw new TypeError("Buffer.toArrayBuffer not supported in this browser")}};var E=s.prototype;s._augment=function(e){e.constructor=s;e._isBuffer=true;e._get=e.get;e._set=e.set;e.get=E.get;e.set=E.set;e.write=E.write;e.toString=E.toString;e.toLocaleString=E.toString;e.toJSON=E.toJSON;e.equals=E.equals;e.compare=E.compare;e.copy=E.copy;e.slice=E.slice;e.readUInt8=E.readUInt8;e.readUInt16LE=E.readUInt16LE;e.readUInt16BE=E.readUInt16BE;e.readUInt32LE=E.readUInt32LE;e.readUInt32BE=E.readUInt32BE;e.readInt8=E.readInt8;e.readInt16LE=E.readInt16LE;e.readInt16BE=E.readInt16BE;e.readInt32LE=E.readInt32LE;e.readInt32BE=E.readInt32BE;e.readFloatLE=E.readFloatLE;e.readFloatBE=E.readFloatBE;e.readDoubleLE=E.readDoubleLE;e.readDoubleBE=E.readDoubleBE;e.writeUInt8=E.writeUInt8;e.writeUInt16LE=E.writeUInt16LE;e.writeUInt16BE=E.writeUInt16BE;e.writeUInt32LE=E.writeUInt32LE;e.writeUInt32BE=E.writeUInt32BE;e.writeInt8=E.writeInt8;e.writeInt16LE=E.writeInt16LE;e.writeInt16BE=E.writeInt16BE;e.writeInt32LE=E.writeInt32LE;e.writeInt32BE=E.writeInt32BE;e.writeFloatLE=E.writeFloatLE;e.writeFloatBE=E.writeFloatBE;e.writeDoubleLE=E.writeDoubleLE;e.writeDoubleBE=E.writeDoubleBE;e.fill=E.fill;e.inspect=E.inspect;e.toArrayBuffer=E.toArrayBuffer;return e};var C=/[^+\/0-9A-z]/g;function P(e){e=R(e).replace(C,"");while(e.length%4!==0){e=e+"="}return e}function R(e){if(e.trim)return e.trim();return e.replace(/^\s+|\s+$/g,"")}function L(e){return a(e)||s.isBuffer(e)||e&&typeof e==="object"&&typeof e.length==="number"}function k(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function F(e){var t=[];for(var r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i<=127){t.push(i)}else{var n=r;if(i>=55296&&i<=57343)r++;var a=encodeURIComponent(e.slice(n,r+1)).substr(1).split("%");for(var o=0;o<a.length;o++){t.push(parseInt(a[o],16))}}}return t}function D(e){var t=[];for(var r=0;r<e.length;r++){t.push(e.charCodeAt(r)&255)}return t}function U(e){var t,r,i;var n=[];for(var a=0;a<e.length;a++){t=e.charCodeAt(a);r=t>>8;i=t%256;n.push(i);n.push(r)}return n}function O(e){return i.toByteArray(e)}function j(e,t,r,i){for(var n=0;n<i;n++){if(n+r>=t.length||n>=e.length)break;t[n+r]=e[n]}return n}function V(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}},{"base64-js":40,ieee754:41,"is-array":42}],40:[function(e,t,r){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(e){"use strict";var t=typeof Uint8Array!=="undefined"?Uint8Array:Array;var r="+".charCodeAt(0);var n="/".charCodeAt(0);var a="0".charCodeAt(0);var o="a".charCodeAt(0);var s="A".charCodeAt(0);function l(e){var t=e.charCodeAt(0);if(t===r)return 62;if(t===n)return 63;if(t<a)return-1;if(t<a+10)return t-a+26+26;if(t<s+26)return t-s;if(t<o+26)return t-o+26}function h(e){var r,i,n,a,o,s;if(e.length%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var h=e.length;o="="===e.charAt(h-2)?2:"="===e.charAt(h-1)?1:0;s=new t(e.length*3/4-o);n=o>0?e.length-4:e.length;var u=0;function f(e){s[u++]=e}for(r=0,i=0;r<n;r+=4,i+=3){a=l(e.charAt(r))<<18|l(e.charAt(r+1))<<12|l(e.charAt(r+2))<<6|l(e.charAt(r+3));f((a&16711680)>>16);f((a&65280)>>8);f(a&255)}if(o===2){a=l(e.charAt(r))<<2|l(e.charAt(r+1))>>4;f(a&255)}else if(o===1){a=l(e.charAt(r))<<10|l(e.charAt(r+1))<<4|l(e.charAt(r+2))>>2;f(a>>8&255);f(a&255)}return s}function u(e){var t,r=e.length%3,n="",a,o;function s(e){return i.charAt(e)}function l(e){return s(e>>18&63)+s(e>>12&63)+s(e>>6&63)+s(e&63)}for(t=0,o=e.length-r;t<o;t+=3){a=(e[t]<<16)+(e[t+1]<<8)+e[t+2];n+=l(a)}switch(r){case 1:a=e[e.length-1];n+=s(a>>2);n+=s(a<<4&63);n+="==";break;case 2:a=(e[e.length-2]<<8)+e[e.length-1];n+=s(a>>10);n+=s(a>>4&63);n+=s(a<<2&63);n+="=";break}return n}e.toByteArray=h;e.fromByteArray=u})(typeof r==="undefined"?this.base64js={}:r)},{}],41:[function(e,t,r){r.read=function(e,t,r,i,n){var a,o,s=n*8-i-1,l=(1<<s)-1,h=l>>1,u=-7,f=r?n-1:0,c=r?-1:1,p=e[t+f];f+=c;a=p&(1<<-u)-1;p>>=-u;u+=s;for(;u>0;a=a*256+e[t+f],f+=c,u-=8);o=a&(1<<-u)-1;a>>=-u;u+=i;for(;u>0;o=o*256+e[t+f],f+=c,u-=8);if(a===0){a=1-h}else if(a===l){return o?NaN:(p?-1:1)*Infinity}else{o=o+Math.pow(2,i);a=a-h}return(p?-1:1)*o*Math.pow(2,a-i)};r.write=function(e,t,r,i,n,a){var o,s,l,h=a*8-n-1,u=(1<<h)-1,f=u>>1,c=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:a-1,d=i?1:-1,v=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){s=isNaN(t)?1:0;o=u}else{o=Math.floor(Math.log(t)/Math.LN2);if(t*(l=Math.pow(2,-o))<1){o--;l*=2}if(o+f>=1){t+=c/l}else{t+=c*Math.pow(2,1-f)}if(t*l>=2){o++;l/=2}if(o+f>=u){s=0;o=u}else if(o+f>=1){s=(t*l-1)*Math.pow(2,n);o=o+f}else{s=t*Math.pow(2,f-1)*Math.pow(2,n);o=0}}for(;n>=8;e[r+p]=s&255,p+=d,s/=256,n-=8);o=o<<n|s;h+=n;for(;h>0;e[r+p]=o&255,p+=d,o/=256,h-=8);e[r+p-d]|=v*128}},{}],42:[function(e,t,r){var i=Array.isArray;var n=Object.prototype.toString;t.exports=i||function(e){return!!e&&"[object Array]"==n.call(e)}},{}],43:[function(e,t,r){var i=t.exports={};i.nextTick=function(){var e=typeof window!=="undefined"&&window.setImmediate;var t=typeof window!=="undefined"&&window.MutationObserver;var r=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(e){return function(e){return window.setImmediate(e)}}var i=[];if(t){var n=document.createElement("div");var a=new MutationObserver(function(){var e=i.slice();i.length=0;e.forEach(function(e){e()})});a.observe(n,{attributes:true});return function o(e){if(!i.length){n.setAttribute("yes","no")}i.push(e)}}if(r){window.addEventListener("message",function(e){var t=e.source;if((t===window||t===null)&&e.data==="process-tick"){e.stopPropagation();if(i.length>0){var r=i.shift();r()}}},true);return function s(e){i.push(e);window.postMessage("process-tick","*")}}return function l(e){setTimeout(e,0)}}();i.title="browser";i.browser=true;i.env={};i.argv=[];function n(){}i.on=n;i.addListener=n;i.once=n;i.off=n;i.removeListener=n;i.removeAllListeners=n;i.emit=n;i.binding=function(e){throw new Error("process.binding is not supported")};i.cwd=function(){return"/"};i.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],44:[function(e,t,r){t.exports=function i(e){return e&&typeof e==="object"&&typeof e.copy==="function"&&typeof e.fill==="function"&&typeof e.readUInt8==="function"}},{}],45:[function(e,t,r){(function(t,i){var n=/%[sdj%]/g;r.format=function(e){if(!w(e)){var t=[];for(var r=0;r<arguments.length;r++){t.push(s(arguments[r]))}return t.join(" ")}var r=1;var i=arguments;var a=i.length;var o=String(e).replace(n,function(e){if(e==="%%")return"%";if(r>=a)return e;switch(e){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(t){return"[Circular]"}default:return e}});for(var l=i[r];r<a;l=i[++r]){if(_(l)||!A(l)){o+=" "+l}else{o+=" "+s(l)}}return o};r.deprecate=function(e,n){if(S(i.process)){return function(){return r.deprecate(e,n).apply(this,arguments)}}if(t.noDeprecation===true){return e}var a=false;function o(){if(!a){if(t.throwDeprecation){throw new Error(n)}else if(t.traceDeprecation){console.trace(n)}else{console.error(n)}a=true}return e.apply(this,arguments)}return o};var a={};var o;r.debuglog=function(e){if(S(o))o=t.env.NODE_DEBUG||"";e=e.toUpperCase();if(!a[e]){if(new RegExp("\\b"+e+"\\b","i").test(o)){var i=t.pid;a[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,i,t)}}else{a[e]=function(){}}}return a[e]};function s(e,t){var i={seen:[],stylize:h};if(arguments.length>=3)i.depth=arguments[2];if(arguments.length>=4)i.colors=arguments[3];if(y(t)){i.showHidden=t}else if(t){r._extend(i,t)}if(S(i.showHidden))i.showHidden=false;if(S(i.depth))i.depth=2;if(S(i.colors))i.colors=false;if(S(i.customInspect))i.customInspect=true;if(i.colors)i.stylize=l;return f(i,e,i.depth)}r.inspect=s;s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};s.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};function l(e,t){var r=s.styles[t];if(r){return"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m"}else{return e}}function h(e,t){return e}function u(e){var t={};e.forEach(function(e,r){t[e]=true});return t}function f(e,t,i){if(e.customInspect&&t&&P(t.inspect)&&t.inspect!==r.inspect&&!(t.constructor&&t.constructor.prototype===t)){var n=t.inspect(i,e);if(!w(n)){n=f(e,n,i)}return n}var a=c(e,t);if(a){return a}var o=Object.keys(t);var s=u(o);if(e.showHidden){o=Object.getOwnPropertyNames(t)}if(C(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0)){return p(t)}if(o.length===0){if(P(t)){var l=t.name?": "+t.name:"";return e.stylize("[Function"+l+"]","special")}if(M(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}if(E(t)){return e.stylize(Date.prototype.toString.call(t),"date")}if(C(t)){return p(t)}}var h="",y=false,_=["{","}"];if(g(t)){y=true;_=["[","]"]}if(P(t)){var x=t.name?": "+t.name:"";h=" [Function"+x+"]"}if(M(t)){h=" "+RegExp.prototype.toString.call(t)}if(E(t)){h=" "+Date.prototype.toUTCString.call(t)}if(C(t)){h=" "+p(t)}if(o.length===0&&(!y||t.length==0)){return _[0]+h+_[1]}if(i<0){if(M(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}else{return e.stylize("[Object]","special")}}e.seen.push(t);var b;if(y){b=d(e,t,i,s,o)}else{b=o.map(function(r){return v(e,t,i,s,r,y)})}e.seen.pop();return m(b,h,_)}function c(e,t){if(S(t))return e.stylize("undefined","undefined");if(w(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(b(t))return e.stylize(""+t,"number");if(y(t))return e.stylize(""+t,"boolean");if(_(t))return e.stylize("null","null")}function p(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,i,n){var a=[];for(var o=0,s=t.length;o<s;++o){if(U(t,String(o))){a.push(v(e,t,r,i,String(o),true))}else{a.push("")}}n.forEach(function(n){if(!n.match(/^\d+$/)){a.push(v(e,t,r,i,n,true))}});return a}function v(e,t,r,i,n,a){var o,s,l;l=Object.getOwnPropertyDescriptor(t,n)||{value:t[n]};if(l.get){if(l.set){s=e.stylize("[Getter/Setter]","special")}else{s=e.stylize("[Getter]","special")}}else{if(l.set){s=e.stylize("[Setter]","special")}}if(!U(i,n)){o="["+n+"]"}if(!s){if(e.seen.indexOf(l.value)<0){if(_(r)){s=f(e,l.value,null)}else{s=f(e,l.value,r-1)}if(s.indexOf("\n")>-1){if(a){s=s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2)}else{s="\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")}}}else{s=e.stylize("[Circular]","special")}}if(S(o)){if(a&&n.match(/^\d+$/)){return s}o=JSON.stringify(""+n);if(o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){o=o.substr(1,o.length-2);o=e.stylize(o,"name")}else{o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");o=e.stylize(o,"string")}}return o+": "+s}function m(e,t,r){var i=0;var n=e.reduce(function(e,t){i++;if(t.indexOf("\n")>=0)i++;return e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(n>60){return r[0]+(t===""?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]}return r[0]+t+" "+e.join(", ")+" "+r[1]
}function g(e){return Array.isArray(e)}r.isArray=g;function y(e){return typeof e==="boolean"}r.isBoolean=y;function _(e){return e===null}r.isNull=_;function x(e){return e==null}r.isNullOrUndefined=x;function b(e){return typeof e==="number"}r.isNumber=b;function w(e){return typeof e==="string"}r.isString=w;function T(e){return typeof e==="symbol"}r.isSymbol=T;function S(e){return e===void 0}r.isUndefined=S;function M(e){return A(e)&&L(e)==="[object RegExp]"}r.isRegExp=M;function A(e){return typeof e==="object"&&e!==null}r.isObject=A;function E(e){return A(e)&&L(e)==="[object Date]"}r.isDate=E;function C(e){return A(e)&&(L(e)==="[object Error]"||e instanceof Error)}r.isError=C;function P(e){return typeof e==="function"}r.isFunction=P;function R(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||typeof e==="symbol"||typeof e==="undefined"}r.isPrimitive=R;r.isBuffer=e("./support/isBuffer");function L(e){return Object.prototype.toString.call(e)}function k(e){return e<10?"0"+e.toString(10):e.toString(10)}var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function D(){var e=new Date;var t=[k(e.getHours()),k(e.getMinutes()),k(e.getSeconds())].join(":");return[e.getDate(),F[e.getMonth()],t].join(" ")}r.log=function(){console.log("%s - %s",D(),r.format.apply(r,arguments))};r.inherits=e("inherits");r._extend=function(e,t){if(!t||!A(t))return e;var r=Object.keys(t);var i=r.length;while(i--){e[r[i]]=t[r[i]]}return e};function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}).call(this,e("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":44,_process:43,inherits:132}],46:[function(e,t,r){var i=e("domready");e("raf.js");var n=e("canvas-app");t.exports=function(e,t,r){i(function(){if(typeof e==="object"&&e){r=e;e=null;t=null}else if(typeof t==="object"&&t){r=t;t=null}r=r||{};if(typeof r.onReady!=="function")r.onReady=t;var i=n(e,r);i.canvas.setAttribute("id","canvas");document.body.appendChild(i.canvas);document.body.style.margin="0";document.body.style.overflow="hidden";i.start()})}},{"canvas-app":47,domready:53,"raf.js":54}],47:[function(e,t,r){var i=e("is-webgl-context");var n=e("webgl-context");var a=e("debounce");var o=e("add-event-listener");function s(e){var t=typeof CanvasRenderingContext2D!=="undefined"&&e instanceof CanvasRenderingContext2D;return e&&(t||i(e))}function l(e,t){if(!(this instanceof l))return new l(e,t);if(typeof e==="object"&&e){t=e;e=null}e=typeof e==="function"?e:t.onRender;t=t||{};t.retina=typeof t.retina==="boolean"?t.retina:true;var r=typeof t.width==="number",h=typeof t.height==="number";if(r||h)t.ignoreResize=true;t.width=r?t.width:window.innerWidth;t.height=h?t.height:window.innerHeight;var u=t.retina?window.devicePixelRatio||1:1;var f,c,p=t.contextAttributes||{};this.isWebGL=false;if(s(t.context)){c=t.context;f=c.canvas}if(!f)f=t.canvas||document.createElement("canvas");f.width=t.width*u;f.height=t.height*u;if(!c){if(t.context==="webgl"||t.context==="experimental-webgl"){c=n({canvas:f,attributes:p});if(!c){throw"WebGL Context Not Supported -- try enabling it or using a different browser"}}else{c=f.getContext(t.context||"2d",p)}}this.isWebGL=i(c);if(t.retina){f.style.width=t.width+"px";f.style.height=t.height+"px"}this.running=false;this.width=t.width;this.height=t.height;this.canvas=f;this.context=c;this.onResize=t.onResize;this._DPR=u;this._retina=t.retina;this._once=t.once;this._ignoreResize=t.ignoreResize;this._lastFrame=null;this._then=Date.now();this.maxDeltaTime=typeof t.maxDeltaTime==="number"?t.maxDeltaTime:1e3/24;this.fps=60;this._frames=0;this._prevTime=this._then;if(!this._ignoreResize){t.resizeDebounce=typeof t.resizeDebounce==="number"?t.resizeDebounce:50;o(window,"resize",a(function(){this.resize(window.innerWidth,window.innerHeight)}.bind(this),t.resizeDebounce,false));o(window,"orientationchange",function(){this.resize(window.innerWidth,window.innerHeight)}.bind(this))}if(typeof e==="function"){this.onRender=e.bind(this)}else{this.onRender=function(e,t,r,i){}}this.renderOnce=function(){var e=Date.now();var t=Math.min(this.maxDeltaTime,e-this._then);this._frames++;if(e>this._prevTime+1e3){this.fps=Math.round(this._frames*1e3/(e-this._prevTime));this._prevTime=e;this._frames=0}if(!this.isWebGL){this.context.save();this.context.scale(this._DPR,this._DPR)}else{this.context.viewport(0,0,this.width*this._DPR,this.height*this._DPR)}this.onRender(this.context,this.width,this.height,t);if(!this.isWebGL)this.context.restore();this._then=e};this._renderHandler=function(){if(!this.running)return;if(!this._once){this._lastFrame=requestAnimationFrame(this._renderHandler)}this.renderOnce()}.bind(this);if(typeof t.onReady==="function"){t.onReady.call(this,c,this.width,this.height)}}Object.defineProperty(l.prototype,"retinaEnabled",{set:function(e){this._retina=e;this._DPR=this._retina?window.devicePixelRatio||1:1;this.resize(this.width,this.height)},get:function(){return this._retina}});Object.defineProperty(l.prototype,"deviceWidth",{get:function(){return this.width*this._DPR}});Object.defineProperty(l.prototype,"deviceHeight",{get:function(){return this.height*this._DPR}});l.prototype.resetFPS=function(){this._frames=0;this._prevTime=Date.now();this._then=this._prevTime;this.fps=60};l.prototype.start=function(){if(this.running)return;if(this._lastFrame)cancelAnimationFrame(this._lastFrame);this.resetFPS();this.running=true;this._lastFrame=requestAnimationFrame(this._renderHandler)};l.prototype.stop=function(){if(this._lastFrame){cancelAnimationFrame(this._lastFrame);this._lastFrame=null}this.running=false};l.prototype.resize=function(e,t){var r=this.canvas;this.width=e;this.height=t;r.width=this.width*this._DPR;r.height=this.height*this._DPR;if(this._retina){r.style.width=this.width+"px";r.style.height=this.height+"px"}if(this._once)requestAnimationFrame(this._renderHandler);if(typeof this.onResize==="function")this.onResize(this.width,this.height)};t.exports=l},{"add-event-listener":48,debounce:49,"is-webgl-context":51,"webgl-context":52}],48:[function(e,t,r){t.exports=e(1)},{"/projects/xmas/node_modules/add-event-listener/index.js":1}],49:[function(e,t,r){var i=e("date-now");t.exports=function n(e,t,r){var n,a,o,s,l;if(null==t)t=100;function h(){var u=i()-s;if(u<t&&u>0){n=setTimeout(h,t-u)}else{n=null;if(!r){l=e.apply(o,a);if(!n)o=a=null}}}return function u(){o=this;a=arguments;s=i();var u=r&&!n;if(!n)n=setTimeout(h,t);if(u){l=e.apply(o,a);o=a=null}return l}}},{"date-now":50}],50:[function(e,t,r){t.exports=Date.now||i;function i(){return(new Date).getTime()}},{}],51:[function(e,t,r){t.exports=function(e){if(!e)return false;var t=e;if(typeof e.rawgl!=="undefined")t=e.rawgl;if(typeof WebGLRenderingContext!=="undefined"&&t instanceof WebGLRenderingContext)return true;return false}},{}],52:[function(e,t,r){t.exports=function(e){e=e||{};var t=e.canvas||document.createElement("canvas");if(typeof e.width==="number")t.width=e.width;if(typeof e.height==="number")t.height=e.height;var r=e.attributes||e.attribs||{};try{gl=t.getContext("webgl",r)||t.getContext("experimental-webgl",r)}catch(i){gl=null}return gl}},{}],53:[function(e,t,r){!function(e,r){if(typeof t!="undefined")t.exports=r();else if(typeof define=="function"&&typeof define.amd=="object")define(r);else this[e]=r()}("domready",function(){var e=[],t,r=document,i=r.documentElement.doScroll,n="DOMContentLoaded",a=(i?/^loaded|^c/:/^loaded|^i|^c/).test(r.readyState);if(!a)r.addEventListener(n,t=function(){r.removeEventListener(n,t);a=1;while(t=e.shift())t()});return function(t){a?t():e.push(t)}})},{}],54:[function(e,t,r){(function(e){var t=0,r=["webkit","moz"],i=e.requestAnimationFrame,n=e.cancelAnimationFrame,a=r.length;while(--a>=0&&!i){i=e[r[a]+"RequestAnimationFrame"];n=e[r[a]+"CancelAnimationFrame"]}if(!i||!n){i=function(e){var r=+new Date,i=Math.max(t+16,r);return setTimeout(function(){e(t=i)},i-r)};n=clearTimeout}e.requestAnimationFrame=i;e.cancelAnimationFrame=n})(window)},{}],55:[function(e,t,r){t.exports=i;function i(e,t,r){return t<r?e<t?t:e>r?r:e:e<r?r:e>t?t:e}},{}],56:[function(e,t,r){"use strict";t.exports=p;var i=e("robust-orientation");var n=e("simplicial-complex").compareCells;function a(e,t){return e-t}function o(e,t,r){this.vertices=e;this.adjacent=t;this.boundary=r;this.lastVisited=-1}o.prototype.flip=function(){var e=this.vertices[0];this.vertices[0]=this.vertices[1];this.vertices[1]=e;var t=this.adjacent[0];this.adjacent[0]=this.adjacent[1];this.adjacent[1]=t};function s(e,t,r){this.vertices=e;this.cell=t;this.index=r}function l(e,t){return n(e.vertices,t.vertices)}function h(e){var t=["function orient(){var tuple=this.tuple;return test("];for(var r=0;r<=e;++r){if(r>0){t.push(",")}t.push("tuple[",r,"]")}t.push(")}return orient");var n=new Function("test",t.join(""));var a=i[e+1];if(!a){a=i}return n(a)}var u=[];function f(e,t,r){this.dimension=e;this.vertices=t;this.simplices=r;this.interior=r.filter(function(e){return!e.boundary});this.tuple=new Array(e+1);for(var i=0;i<=e;++i){this.tuple[i]=this.vertices[i]}var n=u[e];if(!n){n=u[e]=h(e)}this.orient=n}var c=f.prototype;c.handleBoundaryDegeneracy=function(e,t){var r=this.dimension;var i=this.vertices.length-1;var n=this.tuple;var a=this.vertices;var o=[e];e.lastVisited=-i;while(o.length>0){e=o.pop();var s=e.vertices;var l=e.adjacent;for(var h=0;h<=r;++h){var u=l[h];if(!u.boundary||u.lastVisited<=-i){continue}var f=u.vertices;for(var c=0;c<=r;++c){var p=f[c];if(p<0){n[c]=t}else{n[c]=a[p]}}var d=this.orient();if(d>0){return u}u.lastVisited=-i;if(d===0){o.push(u)}}}return null};c.walk=function(e,t){var r=this.vertices.length-1;var i=this.dimension;var n=this.vertices;var a=this.tuple;var o=t?this.interior.length*Math.random()|0:this.interior.length-1;var s=this.interior[o];e:while(!s.boundary){var l=s.vertices;var h=s.adjacent;for(var u=0;u<=i;++u){a[u]=n[l[u]]}s.lastVisited=r;for(var u=0;u<=i;++u){var f=h[u];if(f.lastVisited>=r){continue}var c=a[u];a[u]=e;var p=this.orient();a[u]=c;if(p<0){s=f;continue e}else{if(!f.boundary){f.lastVisited=r}else{f.lastVisited=-r}}}return}return s};c.addPeaks=function(e,t){var r=this.vertices.length-1;var i=this.dimension;var n=this.vertices;var a=this.tuple;var h=this.interior;var u=this.simplices;var f=[t];t.lastVisited=r;t.vertices[t.vertices.indexOf(-1)]=r;t.boundary=false;h.push(t);var c=[];while(f.length>0){var t=f.pop();var p=t.vertices;var d=t.adjacent;var v=p.indexOf(r);if(v<0){continue}for(var m=0;m<=i;++m){if(m===v){continue}var g=d[m];if(!g.boundary||g.lastVisited>=r){continue}var y=g.vertices;if(g.lastVisited!==-r){var _=0;for(var x=0;x<=i;++x){if(y[x]<0){_=x;a[x]=e}else{a[x]=n[y[x]]}}var b=this.orient();if(b>0){y[_]=r;g.boundary=false;h.push(g);f.push(g);g.lastVisited=r;continue}else{g.lastVisited=-r}}var w=g.adjacent;var T=p.slice();var S=d.slice();var M=new o(T,S,true);u.push(M);var A=w.indexOf(t);if(A<0){continue}w[A]=M;S[v]=g;T[m]=-1;S[m]=t;d[m]=M;M.flip();for(var x=0;x<=i;++x){var E=T[x];if(E<0||E===r){continue}var C=new Array(i-1);var P=0;for(var R=0;R<=i;++R){var L=T[R];if(L<0||R===x){continue}C[P++]=L}c.push(new s(C,M,x))}}}c.sort(l);for(var m=0;m+1<c.length;m+=2){var k=c[m];var F=c[m+1];var D=k.index;var U=F.index;if(D<0||U<0){continue}k.cell.adjacent[k.index]=F.cell;F.cell.adjacent[F.index]=k.cell}};c.insert=function(e,t){var r=this.vertices;r.push(e);var i=this.walk(e,t);if(!i){return}var n=this.dimension;var a=this.tuple;for(var o=0;o<=n;++o){var s=i.vertices[o];if(s<0){a[o]=e}else{a[o]=r[s]}}var l=this.orient(a);if(l<0){return}else if(l===0){i=this.handleBoundaryDegeneracy(i,e);if(!i){return}}this.addPeaks(e,i)};c.boundary=function(){var e=this.dimension;var t=[];var r=this.simplices;var i=r.length;for(var n=0;n<i;++n){var a=r[n];if(a.boundary){var o=new Array(e);var s=a.vertices;var l=0;var h=0;for(var u=0;u<=e;++u){if(s[u]>=0){o[l++]=s[u]}else{h=u&1}}if(h===(e&1)){var f=o[0];o[0]=o[1];o[1]=f}t.push(o)}}return t};function p(e,t){var r=e.length;if(r===0){throw new Error("Must have at least d+1 points")}var n=e[0].length;if(r<=n){throw new Error("Must input at least d+1 points")}var a=e.slice(0,n+1);var s=i.apply(void 0,a);if(s===0){throw new Error("Input not in general position")}var l=new Array(n+1);for(var h=0;h<=n;++h){l[h]=h}if(s<0){l[0]=1;l[1]=0}var u=new o(l,new Array(n+1),false);var c=u.adjacent;var p=new Array(n+2);for(var h=0;h<=n;++h){var d=l.slice();for(var v=0;v<=n;++v){if(v===h){d[v]=-1}}var m=d[0];d[0]=d[1];d[1]=m;var g=new o(d,new Array(n+1),true);c[h]=g;p[h]=g}p[n+1]=u;for(var h=0;h<=n;++h){var d=c[h].vertices;var y=c[h].adjacent;for(var v=0;v<=n;++v){var _=d[v];if(_<0){y[v]=u;continue}for(var x=0;x<=n;++x){if(c[x].vertices.indexOf(_)<0){y[v]=c[x]}}}}var b=new f(n,a,p);var w=!!t;for(var h=n+1;h<r;++h){b.insert(e[h],w)}return b.boundary()}},{"robust-orientation":62,"simplicial-complex":65}],57:[function(e,t,r){"use strict";t.exports=i;function i(e,t,r){var i=e+t;var n=i-e;var a=i-n;var o=t-n;var s=e-a;if(r){r[0]=s+o;r[1]=i;return r}return[s+o,i]}},{}],58:[function(e,t,r){"use strict";var i=e("two-product");var n=e("two-sum");t.exports=a;function a(e,t){var r=e.length;if(r===1){var a=i(e[0],t);if(a[0]){return a}return[a[1]]}var o=new Array(2*r);var s=[.1,.1];var l=[.1,.1];var h=0;i(e[0],t,s);if(s[0]){o[h++]=s[0]}for(var u=1;u<r;++u){i(e[u],t,l);var f=s[1];n(f,l[0],s);if(s[0]){o[h++]=s[0]}var c=l[1];var p=s[1];var d=c+p;var v=d-c;var m=p-v;s[1]=d;if(m){o[h++]=m}}if(s[1]){o[h++]=s[1]}if(h===0){o[h++]=0}o.length=h;return o}},{"two-product":61,"two-sum":57}],59:[function(e,t,r){"use strict";t.exports=n;function i(e,t){var r=e+t;var i=r-e;var n=r-i;var a=t-i;var o=e-n;var s=o+a;if(s){return[s,r]}return[r]}function n(e,t){var r=e.length|0;var n=t.length|0;if(r===1&&n===1){return i(e[0],-t[0])}var a=r+n;var o=new Array(a);var s=0;var l=0;var h=0;var u=Math.abs;var f=e[l];var c=u(f);var p=-t[h];var d=u(p);var v,m;if(c<d){m=f;l+=1;if(l<r){f=e[l];c=u(f)}}else{m=p;h+=1;if(h<n){p=-t[h];d=u(p)}}if(l<r&&c<d||h>=n){v=f;l+=1;if(l<r){f=e[l];c=u(f)}}else{v=p;h+=1;if(h<n){p=-t[h];d=u(p)}}var g=v+m;var y=g-v;var _=m-y;var x=_;var b=g;var w,T,S,M,A;while(l<r&&h<n){if(c<d){v=f;l+=1;if(l<r){f=e[l];c=u(f)}}else{v=p;h+=1;if(h<n){p=-t[h];d=u(p)}}m=x;g=v+m;y=g-v;_=m-y;if(_){o[s++]=_}w=b+g;T=w-b;S=w-T;M=g-T;A=b-S;x=A+M;b=w}while(l<r){v=f;m=x;g=v+m;y=g-v;_=m-y;if(_){o[s++]=_}w=b+g;T=w-b;S=w-T;M=g-T;A=b-S;x=A+M;b=w;l+=1;if(l<r){f=e[l]}}while(h<n){v=p;m=x;g=v+m;y=g-v;_=m-y;if(_){o[s++]=_}w=b+g;T=w-b;S=w-T;M=g-T;A=b-S;x=A+M;b=w;h+=1;if(h<n){p=-t[h]}}if(x){o[s++]=x}if(b){o[s++]=b}if(!s){o[s++]=0}o.length=s;return o}},{}],60:[function(e,t,r){"use strict";t.exports=n;function i(e,t){var r=e+t;var i=r-e;var n=r-i;var a=t-i;var o=e-n;var s=o+a;if(s){return[s,r]}return[r]}function n(e,t){var r=e.length|0;var n=t.length|0;if(r===1&&n===1){return i(e[0],t[0])}var a=r+n;var o=new Array(a);var s=0;var l=0;var h=0;var u=Math.abs;var f=e[l];var c=u(f);var p=t[h];var d=u(p);var v,m;if(c<d){m=f;l+=1;if(l<r){f=e[l];c=u(f)}}else{m=p;h+=1;if(h<n){p=t[h];d=u(p)}}if(l<r&&c<d||h>=n){v=f;l+=1;if(l<r){f=e[l];c=u(f)}}else{v=p;h+=1;if(h<n){p=t[h];d=u(p)}}var g=v+m;var y=g-v;var _=m-y;var x=_;var b=g;var w,T,S,M,A;while(l<r&&h<n){if(c<d){v=f;l+=1;if(l<r){f=e[l];c=u(f)}}else{v=p;h+=1;if(h<n){p=t[h];d=u(p)}}m=x;g=v+m;y=g-v;_=m-y;if(_){o[s++]=_}w=b+g;T=w-b;S=w-T;M=g-T;A=b-S;x=A+M;b=w}while(l<r){v=f;m=x;g=v+m;y=g-v;_=m-y;if(_){o[s++]=_}w=b+g;T=w-b;S=w-T;M=g-T;A=b-S;x=A+M;b=w;l+=1;if(l<r){f=e[l]}}while(h<n){v=p;m=x;g=v+m;y=g-v;_=m-y;if(_){o[s++]=_}w=b+g;T=w-b;S=w-T;M=g-T;A=b-S;x=A+M;b=w;h+=1;if(h<n){p=t[h]}}if(x){o[s++]=x}if(b){o[s++]=b}if(!s){o[s++]=0}o.length=s;return o}},{}],61:[function(e,t,r){"use strict";t.exports=n;var i=+(Math.pow(2,27)+1);function n(e,t,r){var n=e*t;var a=i*e;var o=a-e;var s=a-o;var l=e-s;var h=i*t;var u=h-t;var f=h-u;var c=t-f;var p=n-s*f;var d=p-l*f;var v=d-s*c;var m=l*c-v;if(r){r[0]=m;r[1]=n;return r}return[m,n]}},{}],62:[function(e,t,r){"use strict";var i=e("two-product");var n=e("robust-sum");var a=e("robust-scale");var o=e("robust-subtract");var s=5;var l=1.1102230246251565e-16;var h=(3+16*l)*l;var u=(7+56*l)*l;function f(e,t){var r=new Array(e.length-1);for(var i=1;i<e.length;++i){var n=r[i-1]=new Array(e.length-1);for(var a=0,o=0;a<e.length;++a){if(a===t){continue}n[o++]=e[i][a]}}return r}function c(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=new Array(e);for(var i=0;i<e;++i){t[r][i]=["m",i,"[",e-r-1,"]"].join("")}}return t}function p(e){if(e&1){return"-"}return""}function d(e){if(e.length===1){return e[0]}else if(e.length===2){return["sum(",e[0],",",e[1],")"].join("")}else{var t=e.length>>1;return["sum(",d(e.slice(0,t)),",",d(e.slice(t)),")"].join("")}}function v(e){if(e.length===2){return[["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")]}else{var t=[];for(var r=0;r<e.length;++r){t.push(["scale(",d(v(f(e,r))),",",p(r),e[0][r],")"].join(""))}return t}}function m(e){var t=[];var r=[];var s=c(e);var l=[];for(var h=0;h<e;++h){if((h&1)===0){t.push.apply(t,v(f(s,h)))}else{r.push.apply(r,v(f(s,h)))}l.push("m"+h)}var u=d(t);var p=d(r);var m="orientation"+e+"Exact";var g=["function ",m,"(",l.join(),"){var p=",u,",n=",p,",d=sub(p,n);return d[d.length-1];};return ",m].join("");var y=new Function("sum","prod","scale","sub",g);return y(n,i,a,o)}var g=m(3);var y=m(4);var _=[function w(){return 0},function T(){return 0},function S(e,t){return t[0]-e[0]},function M(e,t,r){var i=(e[1]-r[1])*(t[0]-r[0]);var n=(e[0]-r[0])*(t[1]-r[1]);var a=i-n;var o;if(i>0){if(n<=0){return a}else{o=i+n}}else if(i<0){if(n>=0){return a}else{o=-(i+n)}}else{return a}var s=h*o;if(a>=s||a<=-s){return a}return g(e,t,r)},function A(e,t,r,i){var n=e[0]-i[0];var a=t[0]-i[0];var o=r[0]-i[0];var s=e[1]-i[1];var l=t[1]-i[1];var h=r[1]-i[1];var f=e[2]-i[2];var c=t[2]-i[2];var p=r[2]-i[2];var d=a*h;var v=o*l;var m=o*s;var g=n*h;var _=n*l;var x=a*s;var b=f*(d-v)+c*(m-g)+p*(_-x);var w=(Math.abs(d)+Math.abs(v))*Math.abs(f)+(Math.abs(m)+Math.abs(g))*Math.abs(c)+(Math.abs(_)+Math.abs(x))*Math.abs(p);var T=u*w;if(b>T||-b>T){return b}return y(e,t,r,i)}];function x(e){var t=_[e.length];if(!t){t=_[e.length]=m(e.length)}return t.apply(undefined,e)}function b(){while(_.length<=s){_.push(m(_.length))}var e=[];var r=["slow"];for(var i=0;i<=s;++i){e.push("a"+i);r.push("o"+i)}var n=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(var i=2;i<=s;++i){n.push("case ",i,":return o",i,"(",e.slice(0,i).join(),");")}n.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation");r.push(n.join(""));var a=Function.apply(undefined,r);t.exports=a.apply(undefined,[x].concat(_));for(var i=0;i<=s;++i){t.exports[i]=_[i]}}b()},{"robust-scale":58,"robust-subtract":59,"robust-sum":60,"two-product":61}],63:[function(e,t,r){"use strict";"use restrict";var i=32;r.INT_BITS=i;r.INT_MAX=2147483647;r.INT_MIN=-1<<i-1;r.sign=function(e){return(e>0)-(e<0)};r.abs=function(e){var t=e>>i-1;return(e^t)-t};r.min=function(e,t){return t^(e^t)&-(e<t)};r.max=function(e,t){return e^(e^t)&-(e<t)};r.isPow2=function(e){return!(e&e-1)&&!!e};r.log2=function(e){var t,r;t=(e>65535)<<4;e>>>=t;r=(e>255)<<3;e>>>=r;t|=r;r=(e>15)<<2;e>>>=r;t|=r;r=(e>3)<<1;e>>>=r;t|=r;return t|e>>1};r.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0};r.popCount=function(e){e=e-(e>>>1&1431655765);e=(e&858993459)+(e>>>2&858993459);return(e+(e>>>4)&252645135)*16843009>>>24};function n(e){var t=32;e&=-e;if(e)t--;if(e&65535)t-=16;if(e&16711935)t-=8;if(e&252645135)t-=4;if(e&858993459)t-=2;if(e&1431655765)t-=1;return t}r.countTrailingZeros=n;r.nextPow2=function(e){e+=e===0;--e;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;return e+1};r.prevPow2=function(e){e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;return e-(e>>>1)};r.parity=function(e){e^=e>>>16;e^=e>>>8;e^=e>>>4;e&=15;return 27030>>>e&1};var a=new Array(256);(function(e){for(var t=0;t<256;++t){var r=t,i=t,n=7;for(r>>>=1;r;r>>>=1){i<<=1;i|=r&1;--n}e[t]=i<<n&255}})(a);r.reverse=function(e){return a[e&255]<<24|a[e>>>8&255]<<16|a[e>>>16&255]<<8|a[e>>>24&255]};r.interleave2=function(e,t){e&=65535;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;t&=65535;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;return e|t<<1};r.deinterleave2=function(e,t){e=e>>>t&1431655765;e=(e|e>>>1)&858993459;e=(e|e>>>2)&252645135;e=(e|e>>>4)&16711935;e=(e|e>>>16)&65535;return e<<16>>16};r.interleave3=function(e,t,r){e&=1023;e=(e|e<<16)&4278190335;e=(e|e<<8)&251719695;e=(e|e<<4)&3272356035;e=(e|e<<2)&1227133513;t&=1023;t=(t|t<<16)&4278190335;t=(t|t<<8)&251719695;t=(t|t<<4)&3272356035;t=(t|t<<2)&1227133513;e|=t<<1;r&=1023;r=(r|r<<16)&4278190335;r=(r|r<<8)&251719695;r=(r|r<<4)&3272356035;r=(r|r<<2)&1227133513;return e|r<<2};r.deinterleave3=function(e,t){e=e>>>t&1227133513;e=(e|e>>>2)&3272356035;e=(e|e>>>4)&251719695;e=(e|e>>>8)&4278190335;e=(e|e>>>16)&1023;return e<<22>>22};r.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>n(e)+1}},{}],64:[function(e,t,r){"use strict";"use restrict";t.exports=i;function i(e){this.roots=new Array(e);this.ranks=new Array(e);for(var t=0;t<e;++t){this.roots[t]=t;this.ranks[t]=0}}var n=i.prototype;Object.defineProperty(n,"length",{get:function(){return this.roots.length}});n.makeSet=function(){var e=this.roots.length;this.roots.push(e);this.ranks.push(0);return e};n.find=function(e){var t=this.roots;while(t[e]!==e){var r=t[e];t[e]=t[r];e=r}return e};n.link=function(e,t){var r=this.find(e),i=this.find(t);if(r===i){return}var n=this.ranks,a=this.roots,o=n[r],s=n[i];if(o<s){a[r]=i}else if(s<o){a[i]=r}else{a[i]=r;++n[r]}}},{}],65:[function(e,t,r){"use strict";"use restrict";var i=e("bit-twiddle"),n=e("union-find");function a(e){var t=0,r=Math.max;for(var i=0,n=e.length;i<n;++i){t=r(t,e[i].length)}return t-1}r.dimension=a;function o(e){var t=-1,r=Math.max;for(var i=0,n=e.length;i<n;++i){var a=e[i];for(var o=0,s=a.length;o<s;++o){t=r(t,a[o])}}return t+1}r.countVertices=o;function s(e){var t=new Array(e.length);for(var r=0,i=e.length;r<i;++r){t[r]=e[r].slice(0)}return t}r.cloneCells=s;function l(e,t){var r=e.length,i=e.length-t.length,n=Math.min;if(i){return i}switch(r){case 0:return 0;case 1:return e[0]-t[0];case 2:var a=e[0]+e[1]-t[0]-t[1];if(a){return a}return n(e[0],e[1])-n(t[0],t[1]);case 3:var o=e[0]+e[1],s=t[0]+t[1];a=o+e[2]-(s+t[2]);if(a){return a}var l=n(e[0],e[1]),h=n(t[0],t[1]),a=n(l,e[2])-n(h,t[2]);if(a){return a}return n(l+e[2],o)-n(h+t[2],s);default:var u=e.slice(0);u.sort();var f=t.slice(0);f.sort();for(var c=0;c<r;++c){i=u[c]-f[c];if(i){return i}}return 0}}r.compareCells=l;function h(e,t){return l(e[0],t[0])}function u(e,t){if(t){var r=e.length;var i=new Array(r);for(var n=0;n<r;++n){i[n]=[e[n],t[n]]}i.sort(h);for(var n=0;n<r;++n){e[n]=i[n][0];t[n]=i[n][1]}return e}else{e.sort(l);return e}}r.normalize=u;function f(e){if(e.length===0){return[]}var t=1,r=e.length;for(var i=1;i<r;++i){var n=e[i];if(l(n,e[i-1])){if(i===t){t++;continue}e[t++]=n}}e.length=t;return e}r.unique=f;function c(e,t){var r=0,i=e.length-1,n=-1;while(r<=i){var a=r+i>>1,o=l(e[a],t);if(o<=0){if(o===0){n=a}r=a+1}else if(o>0){i=a-1}}return n}r.findCell=c;function p(e,t){var r=new Array(e.length);for(var n=0,a=r.length;n<a;++n){r[n]=[]}var o=[];for(var n=0,s=t.length;n<s;++n){var h=t[n];var u=h.length;for(var f=1,p=1<<u;f<p;++f){o.length=i.popCount(f);var d=0;for(var v=0;v<u;++v){if(f&1<<v){o[d++]=h[v]}}var m=c(e,o);if(m<0){continue}while(true){r[m++].push(n);if(m>=e.length||l(e[m],o)!==0){break}}}}return r}r.incidence=p;function d(e,t){if(!t){return p(f(m(e,0)),e,0)}var r=new Array(t);for(var i=0;i<t;++i){r[i]=[]}for(var i=0,n=e.length;i<n;++i){var a=e[i];for(var o=0,s=a.length;o<s;++o){r[a[o]].push(i)}}return r}r.dual=d;function v(e){var t=[];for(var r=0,i=e.length;r<i;++r){var n=e[r],a=n.length|0;for(var o=1,s=1<<a;o<s;++o){var l=[];for(var h=0;h<a;++h){if(o>>>h&1){l.push(n[h])}}t.push(l)}}return u(t)}r.explode=v;function m(e,t){if(t<0){return[]}var r=[],n=(1<<t+1)-1;for(var a=0;a<e.length;++a){var o=e[a];for(var s=n;s<1<<o.length;s=i.nextCombination(s)){var l=new Array(t+1),h=0;for(var f=0;f<o.length;++f){if(s&1<<f){l[h++]=o[f]}}r.push(l)}}return u(r)}r.skeleton=m;function g(e){var t=[];for(var r=0,i=e.length;r<i;++r){var n=e[r];for(var a=0,o=n.length;a<o;++a){var s=new Array(n.length-1);for(var l=0,h=0;l<o;++l){if(l!==a){s[h++]=n[l]}}t.push(s)}}return u(t)}r.boundary=g;function y(e,t){var r=new n(t);for(var i=0;i<e.length;++i){var a=e[i];for(var o=0;o<a.length;++o){for(var s=o+1;s<a.length;++s){r.link(a[o],a[s])}}}var l=[],h=r.ranks;for(var i=0;i<h.length;++i){h[i]=-1}for(var i=0;i<e.length;++i){var u=r.find(e[i][0]);if(h[u]<0){h[u]=l.length;l.push([e[i].slice(0)])}else{l[h[u]].push(e[i].slice(0))}}return l}function _(e){var t=f(u(m(e,0))),r=new n(t.length);for(var i=0;i<e.length;++i){var a=e[i];for(var o=0;o<a.length;++o){var s=c(t,[a[o]]);for(var l=o+1;l<a.length;++l){r.link(s,c(t,[a[l]]))}}}var h=[],p=r.ranks;for(var i=0;i<p.length;++i){p[i]=-1}for(var i=0;i<e.length;++i){var d=r.find(c(t,[e[i][0]]));if(p[d]<0){p[d]=h.length;h.push([e[i].slice(0)])}else{h[p[d]].push(e[i].slice(0))}}return h}function x(e,t){if(t){return y(e,t)}return _(e)}r.connectedComponents=x},{"bit-twiddle":63,"union-find":64}],66:[function(e,t,r){"use strict";function i(e,t){var r=1,i=e.length,n=e[0],a=e[0];for(var o=1;o<i;++o){a=n;n=e[o];if(t(n,a)){if(o===r){r++;continue}e[r++]=n}}e.length=r;return e}function n(e){var t=1,r=e.length,i=e[0],n=e[0];for(var a=1;a<r;++a,n=i){n=i;i=e[a];if(i!==n){if(a===t){t++;continue}e[t++]=i}}e.length=t;return e}function a(e,t,r){if(e.length===0){return e}if(t){if(!r){e.sort(t)}return i(e,t)}if(!r){e.sort()}return n(e)}t.exports=a},{}],67:[function(e,t,r){"use strict";var i=e("incremental-convex-hull");var n=e("uniq");t.exports=l;function a(e,t){this.point=e;this.index=t}function o(e,t){var r=e.point;var i=t.point;var n=r.length;for(var a=0;a<n;++a){var o=i[a]-r[a];if(o){return o}}return 0}function s(e,t,r){if(e===1){if(r){return[[-1,0]]}else{return[]}}var i=t.map(function(e,t){return[e[0],t]});i.sort(function(e,t){return e[0]-t[0]});var n=new Array(e-1);for(var a=1;a<e;++a){var o=i[a-1];var s=i[a];n[a-1]=[o[1],s[1]]}if(r){n.push([-1,n[0][1]],[n[e-1][1],-1])}return n}function l(e,t){var r=e.length;if(r===0){return[]}var l=e[0].length;if(l<1){return[]}if(l===1){return s(r,e,t)}var h=new Array(r);var u=1;for(var f=0;f<r;++f){var c=e[f];var p=new Array(l+1);var d=0;for(var v=0;v<l;++v){var m=c[v];p[v]=m;d+=m*m}p[l]=d;h[f]=new a(p,f);u=Math.max(d,u)}n(h,o);r=h.length;var g=new Array(r+l+1);var y=new Array(r+l+1);var _=(l+1)*(l+1)*u;var x=new Array(l+1);for(var f=0;f<=l;++f){x[f]=0}x[l]=_;g[0]=x.slice();y[0]=-1;for(var f=0;f<=l;++f){var p=x.slice();p[f]=1;g[f+1]=p;y[f+1]=-1}for(var f=0;f<r;++f){var b=h[f];g[f+l+1]=b.point;y[f+l+1]=b.index}var w=i(g,false);if(t){w=w.filter(function(e){var t=0;for(var r=0;r<=l;++r){var i=y[e[r]];if(i<0){if(++t>=2){return false}}e[r]=i}return true})}else{w=w.filter(function(e){for(var t=0;t<=l;++t){var r=y[e[t]];if(r<0){return false}e[t]=r}return true})}if(l&1){for(var f=0;f<w.length;++f){var b=w[f];var p=b[0];b[0]=b[1];b[1]=p}}return w}},{"incremental-convex-hull":56,uniq:66}],68:[function(e,t,r){var i=e("./random-points");var n=e("randf");var a=e("delaunay-triangulate");var o=e("get-image-pixels");var s=e("color-style");var l=e("as-number");function h(e,t,r,i,n){t=~~t%i;r=~~r%n;var a=t+r*i;return[e[a*4+0],e[a*4+1],e[a*4+2],e[a*4+3]]}function u(e){return[[0,0],[e.width,0],[e.width,e.height],[0,e.height]]}function f(e,t,r,i,n){var a=e[t[0]],o=e[t[1]],l=e[t[2]];var u=(a[0]+a[0]+a[0])/3;var f=(a[1]+o[1]+l[1])/3;var c=h(r,u,f,i,n);return s(c)}t.exports=function c(e,t){var r=e.width,n=e.height;t=t||{};t.count=l(t.count,50);t.max=t.max||[r,n];var s=t.canvas||document.createElement("canvas");s.width=r;s.height=n;var h=s.getContext("2d");h.drawImage(e,0,0);var c=t.points||i(t).concat(u(e));var p=o(e);var d=a(c);d.forEach(function(e){var i=c[e[0]],a=c[e[1]],o=c[e[2]];h.beginPath();h.moveTo(i[0],i[1]);h.lineTo(a[0],a[1]);h.lineTo(o[0],o[1]);h.lineTo(i[0],i[1]);var s=f(c,e,p,r,n);h.strokeStyle=s;h.fillStyle=s;if(t.fill!==false)h.fill();if(t.stroke!==false)h.stroke()});return s}},{"./random-points":72,"as-number":3,"color-style":69,"delaunay-triangulate":67,"get-image-pixels":70,randf:71}],69:[function(e,t,r){t.exports=i.bind(this,n);t.exports.rgba=i.bind(this,n);t.exports.rgb=t.exports.rgba;t.exports.hsla=i.bind(this,a);t.exports.hsl=t.exports.hsla;function i(e,t,r,i,n){if(typeof t==="string"){return t}else if(Array.isArray(t)){var a=t;var o=r;t=a[0];r=a[1];i=a[2];n=typeof a[3]==="number"?a[3]:o}n=typeof n==="number"?n:1;return e(t||0,r||0,i||0,n)}function n(e,t,r,i){return"rgba("+~~e+","+~~t+","+~~r+","+i+")"}function a(e,t,r,i){return"hsla("+e+","+t+"%,"+r+"%,"+i+")"}},{}],70:[function(e,t,r){var i,n;t.exports=function(e,t){t=t||{};t.x=t.x||0;t.y=t.y||0;t.width=typeof t.width==="number"?t.width:e.width;t.height=typeof t.height==="number"?t.height:e.height;if(!i){n=document.createElement("canvas");i=n.getContext("2d")}n.width=t.width;n.height=t.height;i.clearRect(0,0,t.width,t.height);i.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);var r=i.getImageData(0,0,t.width,t.height);return r.data};t.exports.dispose=function(){i=undefined;n=undefined}},{}],71:[function(e,t,r){function i(e,t){var r=typeof e==="number",i=typeof t==="number";if(r&&!i){t=e;e=0}else if(!r&&!i){e=0;t=1}return e+Math.random()*(t-e)}t.exports=i},{}],72:[function(e,t,r){var i=e("randf");t.exports=function n(e){e=e||{};var t=e.min||[0,0];var r=e.max||[1,1];var n=e.count||0;var a=[];for(var o=0;o<n;o++){var s=i(t[0],r[0]),l=i(t[1],r[1]);a.push([s,l])}return a}},{randf:71}],73:[function(e,t,r){t.exports=e(53)},{"/projects/xmas/node_modules/canvas-testbed/node_modules/domready/ready.js":53}],74:[function(e,t,r){function i(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}t.exports=i;i.EventEmitter=i;i.prototype._events=undefined;i.prototype._maxListeners=undefined;i.defaultMaxListeners=10;i.prototype.setMaxListeners=function(e){if(!a(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};i.prototype.emit=function(e){var t,r,i,a,l,h;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||o(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}throw TypeError('Uncaught, unspecified "error" event.')}}r=this._events[e];if(s(r))return false;if(n(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:i=arguments.length;a=new Array(i-1);for(l=1;l<i;l++)a[l-1]=arguments[l];r.apply(this,a)}}else if(o(r)){i=arguments.length;a=new Array(i-1);for(l=1;l<i;l++)a[l-1]=arguments[l];h=r.slice();i=h.length;for(l=0;l<i;l++)h[l].apply(this,a)}return true};i.prototype.addListener=function(e,t){var r;if(!n(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,n(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(o(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(o(this._events[e])&&!this._events[e].warned){var r;if(!s(this._maxListeners)){r=this._maxListeners}else{r=i.defaultMaxListeners}if(r&&r>0&&this._events[e].length>r){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};i.prototype.on=i.prototype.addListener;i.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var r=false;
function i(){this.removeListener(e,i);if(!r){r=true;t.apply(this,arguments)}}i.listener=t;this.on(e,i);return this};i.prototype.removeListener=function(e,t){var r,i,a,s;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;r=this._events[e];a=r.length;i=-1;if(r===t||n(r.listener)&&r.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(o(r)){for(s=a;s-->0;){if(r[s]===t||r[s].listener&&r[s].listener===t){i=s;break}}if(i<0)return this;if(r.length===1){r.length=0;delete this._events[e]}else{r.splice(i,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};i.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}r=this._events[e];if(n(r)){this.removeListener(e,r)}else{while(r.length)this.removeListener(e,r[r.length-1])}delete this._events[e];return this};i.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(n(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};i.listenerCount=function(e,t){var r;if(!e._events||!e._events[t])r=0;else if(n(e._events[t]))r=1;else r=e._events[t].length;return r};function n(e){return typeof e==="function"}function a(e){return typeof e==="number"}function o(e){return typeof e==="object"&&e!==null}function s(e){return e===void 0}},{}],75:[function(e,t,r){t.exports=i;function i(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],h=t[7],u=t[8],f=t[9],c=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15];e[0]=s*(c*g-p*m)-f*(l*g-h*m)+v*(l*p-h*c);e[1]=-(i*(c*g-p*m)-f*(n*g-a*m)+v*(n*p-a*c));e[2]=i*(l*g-h*m)-s*(n*g-a*m)+v*(n*h-a*l);e[3]=-(i*(l*p-h*c)-s*(n*p-a*c)+f*(n*h-a*l));e[4]=-(o*(c*g-p*m)-u*(l*g-h*m)+d*(l*p-h*c));e[5]=r*(c*g-p*m)-u*(n*g-a*m)+d*(n*p-a*c);e[6]=-(r*(l*g-h*m)-o*(n*g-a*m)+d*(n*h-a*l));e[7]=r*(l*p-h*c)-o*(n*p-a*c)+u*(n*h-a*l);e[8]=o*(f*g-p*v)-u*(s*g-h*v)+d*(s*p-h*f);e[9]=-(r*(f*g-p*v)-u*(i*g-a*v)+d*(i*p-a*f));e[10]=r*(s*g-h*v)-o*(i*g-a*v)+d*(i*h-a*s);e[11]=-(r*(s*p-h*f)-o*(i*p-a*f)+u*(i*h-a*s));e[12]=-(o*(f*m-c*v)-u*(s*m-l*v)+d*(s*c-l*f));e[13]=r*(f*m-c*v)-u*(i*m-n*v)+d*(i*c-n*f);e[14]=-(r*(s*m-l*v)-o*(i*m-n*v)+d*(i*l-n*s));e[15]=r*(s*c-l*f)-o*(i*c-n*f)+u*(i*l-n*s);return e}},{}],76:[function(e,t,r){t.exports=i;function i(e){var t=new Float32Array(16);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t}},{}],77:[function(e,t,r){t.exports=i;function i(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e}},{}],78:[function(e,t,r){t.exports=i;function i(){var e=new Float32Array(16);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],79:[function(e,t,r){t.exports=i;function i(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],h=e[8],u=e[9],f=e[10],c=e[11],p=e[12],d=e[13],v=e[14],m=e[15],g=t*o-r*a,y=t*s-i*a,_=t*l-n*a,x=r*s-i*o,b=r*l-n*o,w=i*l-n*s,T=h*d-u*p,S=h*v-f*p,M=h*m-c*p,A=u*v-f*d,E=u*m-c*d,C=f*m-c*v;return g*C-y*E+_*A+x*M-b*S+w*T}},{}],80:[function(e,t,r){t.exports=i;function i(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r+r,s=i+i,l=n+n,h=r*o,u=i*o,f=i*s,c=n*o,p=n*s,d=n*l,v=a*o,m=a*s,g=a*l;e[0]=1-f-d;e[1]=u+g;e[2]=c-m;e[3]=0;e[4]=u-g;e[5]=1-h-d;e[6]=p+v;e[7]=0;e[8]=c+m;e[9]=p-v;e[10]=1-h-f;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],81:[function(e,t,r){t.exports=i;function i(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=i+i,l=n+n,h=a+a,u=i*s,f=i*l,c=i*h,p=n*l,d=n*h,v=a*h,m=o*s,g=o*l,y=o*h;e[0]=1-(p+v);e[1]=f+y;e[2]=c-g;e[3]=0;e[4]=f-y;e[5]=1-(u+v);e[6]=d+m;e[7]=0;e[8]=c+g;e[9]=d-m;e[10]=1-(u+p);e[11]=0;e[12]=r[0];e[13]=r[1];e[14]=r[2];e[15]=1;return e}},{}],82:[function(e,t,r){t.exports=i;function i(e,t,r,i,n,a,o){var s=1/(r-t),l=1/(n-i),h=1/(a-o);e[0]=a*2*s;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=a*2*l;e[6]=0;e[7]=0;e[8]=(r+t)*s;e[9]=(n+i)*l;e[10]=(o+a)*h;e[11]=-1;e[12]=0;e[13]=0;e[14]=o*a*2*h;e[15]=0;return e}},{}],83:[function(e,t,r){t.exports=i;function i(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],84:[function(e,t,r){t.exports={create:e("./create"),clone:e("./clone"),copy:e("./copy"),identity:e("./identity"),transpose:e("./transpose"),invert:e("./invert"),adjoint:e("./adjoint"),determinant:e("./determinant"),multiply:e("./multiply"),translate:e("./translate"),scale:e("./scale"),rotate:e("./rotate"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),fromRotationTranslation:e("./fromRotationTranslation"),fromQuat:e("./fromQuat"),frustum:e("./frustum"),perspective:e("./perspective"),ortho:e("./ortho"),lookAt:e("./lookAt"),str:e("./str")}},{"./adjoint":75,"./clone":76,"./copy":77,"./create":78,"./determinant":79,"./fromQuat":80,"./fromRotationTranslation":81,"./frustum":82,"./identity":83,"./invert":85,"./lookAt":86,"./multiply":87,"./ortho":88,"./perspective":89,"./rotate":90,"./rotateX":91,"./rotateY":92,"./rotateZ":93,"./scale":94,"./str":95,"./translate":96,"./transpose":97}],85:[function(e,t,r){t.exports=i;function i(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],h=t[7],u=t[8],f=t[9],c=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15],y=r*s-i*o,_=r*l-n*o,x=r*h-a*o,b=i*l-n*s,w=i*h-a*s,T=n*h-a*l,S=u*v-f*d,M=u*m-c*d,A=u*g-p*d,E=f*m-c*v,C=f*g-p*v,P=c*g-p*m,R=y*P-_*C+x*E+b*A-w*M+T*S;if(!R){return null}R=1/R;e[0]=(s*P-l*C+h*E)*R;e[1]=(n*C-i*P-a*E)*R;e[2]=(v*T-m*w+g*b)*R;e[3]=(c*w-f*T-p*b)*R;e[4]=(l*A-o*P-h*M)*R;e[5]=(r*P-n*A+a*M)*R;e[6]=(m*x-d*T-g*_)*R;e[7]=(u*T-c*x+p*_)*R;e[8]=(o*C-s*A+h*S)*R;e[9]=(i*A-r*C-a*S)*R;e[10]=(d*w-v*x+g*y)*R;e[11]=(f*x-u*w-p*y)*R;e[12]=(s*M-o*E-l*S)*R;e[13]=(r*E-i*M+n*S)*R;e[14]=(v*_-d*b-m*y)*R;e[15]=(u*b-f*_+c*y)*R;return e}},{}],86:[function(e,t,r){t.exports=i;function i(e,t,r,i){var n,a,o,s,l,h,u,f,c,p,d=t[0],v=t[1],m=t[2],g=i[0],y=i[1],_=i[2],x=r[0],b=r[1],w=r[2];if(Math.abs(d-x)<1e-6&&Math.abs(v-b)<1e-6&&Math.abs(m-w)<1e-6){return mat4.identity(e)}u=d-x;f=v-b;c=m-w;p=1/Math.sqrt(u*u+f*f+c*c);u*=p;f*=p;c*=p;n=y*c-_*f;a=_*u-g*c;o=g*f-y*u;p=Math.sqrt(n*n+a*a+o*o);if(!p){n=0;a=0;o=0}else{p=1/p;n*=p;a*=p;o*=p}s=f*o-c*a;l=c*n-u*o;h=u*a-f*n;p=Math.sqrt(s*s+l*l+h*h);if(!p){s=0;l=0;h=0}else{p=1/p;s*=p;l*=p;h*=p}e[0]=n;e[1]=s;e[2]=u;e[3]=0;e[4]=a;e[5]=l;e[6]=f;e[7]=0;e[8]=o;e[9]=h;e[10]=c;e[11]=0;e[12]=-(n*d+a*v+o*m);e[13]=-(s*d+l*v+h*m);e[14]=-(u*d+f*v+c*m);e[15]=1;return e}},{}],87:[function(e,t,r){t.exports=i;function i(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],h=t[6],u=t[7],f=t[8],c=t[9],p=t[10],d=t[11],v=t[12],m=t[13],g=t[14],y=t[15];var _=r[0],x=r[1],b=r[2],w=r[3];e[0]=_*i+x*s+b*f+w*v;e[1]=_*n+x*l+b*c+w*m;e[2]=_*a+x*h+b*p+w*g;e[3]=_*o+x*u+b*d+w*y;_=r[4];x=r[5];b=r[6];w=r[7];e[4]=_*i+x*s+b*f+w*v;e[5]=_*n+x*l+b*c+w*m;e[6]=_*a+x*h+b*p+w*g;e[7]=_*o+x*u+b*d+w*y;_=r[8];x=r[9];b=r[10];w=r[11];e[8]=_*i+x*s+b*f+w*v;e[9]=_*n+x*l+b*c+w*m;e[10]=_*a+x*h+b*p+w*g;e[11]=_*o+x*u+b*d+w*y;_=r[12];x=r[13];b=r[14];w=r[15];e[12]=_*i+x*s+b*f+w*v;e[13]=_*n+x*l+b*c+w*m;e[14]=_*a+x*h+b*p+w*g;e[15]=_*o+x*u+b*d+w*y;return e}},{}],88:[function(e,t,r){t.exports=i;function i(e,t,r,i,n,a,o){var s=1/(t-r),l=1/(i-n),h=1/(a-o);e[0]=-2*s;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=-2*l;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=2*h;e[11]=0;e[12]=(t+r)*s;e[13]=(n+i)*l;e[14]=(o+a)*h;e[15]=1;return e}},{}],89:[function(e,t,r){t.exports=i;function i(e,t,r,i,n){var a=1/Math.tan(t/2),o=1/(i-n);e[0]=a/r;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=a;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=(n+i)*o;e[11]=-1;e[12]=0;e[13]=0;e[14]=2*n*i*o;e[15]=0;return e}},{}],90:[function(e,t,r){t.exports=i;function i(e,t,r,i){var n=i[0],a=i[1],o=i[2],s=Math.sqrt(n*n+a*a+o*o),l,h,u,f,c,p,d,v,m,g,y,_,x,b,w,T,S,M,A,E,C,P,R,L;if(Math.abs(s)<1e-6){return null}s=1/s;n*=s;a*=s;o*=s;l=Math.sin(r);h=Math.cos(r);u=1-h;f=t[0];c=t[1];p=t[2];d=t[3];v=t[4];m=t[5];g=t[6];y=t[7];_=t[8];x=t[9];b=t[10];w=t[11];T=n*n*u+h;S=a*n*u+o*l;M=o*n*u-a*l;A=n*a*u-o*l;E=a*a*u+h;C=o*a*u+n*l;P=n*o*u+a*l;R=a*o*u-n*l;L=o*o*u+h;e[0]=f*T+v*S+_*M;e[1]=c*T+m*S+x*M;e[2]=p*T+g*S+b*M;e[3]=d*T+y*S+w*M;e[4]=f*A+v*E+_*C;e[5]=c*A+m*E+x*C;e[6]=p*A+g*E+b*C;e[7]=d*A+y*E+w*C;e[8]=f*P+v*R+_*L;e[9]=c*P+m*R+x*L;e[10]=p*P+g*R+b*L;e[11]=d*P+y*R+w*L;if(t!==e){e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}return e}},{}],91:[function(e,t,r){t.exports=i;function i(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[4],o=t[5],s=t[6],l=t[7],h=t[8],u=t[9],f=t[10],c=t[11];if(t!==e){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[4]=a*n+h*i;e[5]=o*n+u*i;e[6]=s*n+f*i;e[7]=l*n+c*i;e[8]=h*n-a*i;e[9]=u*n-o*i;e[10]=f*n-s*i;e[11]=c*n-l*i;return e}},{}],92:[function(e,t,r){t.exports=i;function i(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],h=t[8],u=t[9],f=t[10],c=t[11];if(t!==e){e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=a*n-h*i;e[1]=o*n-u*i;e[2]=s*n-f*i;e[3]=l*n-c*i;e[8]=a*i+h*n;e[9]=o*i+u*n;e[10]=s*i+f*n;e[11]=l*i+c*n;return e}},{}],93:[function(e,t,r){t.exports=i;function i(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],h=t[4],u=t[5],f=t[6],c=t[7];if(t!==e){e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=a*n+h*i;e[1]=o*n+u*i;e[2]=s*n+f*i;e[3]=l*n+c*i;e[4]=h*n-a*i;e[5]=u*n-o*i;e[6]=f*n-s*i;e[7]=c*n-l*i;return e}},{}],94:[function(e,t,r){t.exports=i;function i(e,t,r){var i=r[0],n=r[1],a=r[2];e[0]=t[0]*i;e[1]=t[1]*i;e[2]=t[2]*i;e[3]=t[3]*i;e[4]=t[4]*n;e[5]=t[5]*n;e[6]=t[6]*n;e[7]=t[7]*n;e[8]=t[8]*a;e[9]=t[9]*a;e[10]=t[10]*a;e[11]=t[11]*a;e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e}},{}],95:[function(e,t,r){t.exports=i;function i(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}},{}],96:[function(e,t,r){t.exports=i;function i(e,t,r){var i=r[0],n=r[1],a=r[2],o,s,l,h,u,f,c,p,d,v,m,g;if(t===e){e[12]=t[0]*i+t[4]*n+t[8]*a+t[12];e[13]=t[1]*i+t[5]*n+t[9]*a+t[13];e[14]=t[2]*i+t[6]*n+t[10]*a+t[14];e[15]=t[3]*i+t[7]*n+t[11]*a+t[15]}else{o=t[0];s=t[1];l=t[2];h=t[3];u=t[4];f=t[5];c=t[6];p=t[7];d=t[8];v=t[9];m=t[10];g=t[11];e[0]=o;e[1]=s;e[2]=l;e[3]=h;e[4]=u;e[5]=f;e[6]=c;e[7]=p;e[8]=d;e[9]=v;e[10]=m;e[11]=g;e[12]=o*i+u*n+d*a+t[12];e[13]=s*i+f*n+v*a+t[13];e[14]=l*i+c*n+m*a+t[14];e[15]=h*i+p*n+g*a+t[15]}return e}},{}],97:[function(e,t,r){t.exports=i;function i(e,t){if(e===t){var r=t[1],i=t[2],n=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4];e[2]=t[8];e[3]=t[12];e[4]=r;e[6]=t[9];e[7]=t[13];e[8]=i;e[9]=a;e[11]=t[14];e[12]=n;e[13]=o;e[14]=s}else{e[0]=t[0];e[1]=t[4];e[2]=t[8];e[3]=t[12];e[4]=t[1];e[5]=t[5];e[6]=t[9];e[7]=t[13];e[8]=t[2];e[9]=t[6];e[10]=t[10];e[11]=t[14];e[12]=t[3];e[13]=t[7];e[14]=t[11];e[15]=t[15]}return e}},{}],98:[function(e,t,r){t.exports=i;function i(e,t){t=t||1;var r=Math.random()*2*Math.PI;var i=Math.random()*2-1;var n=Math.sqrt(1-i*i)*t;e[0]=Math.cos(r)*n;e[1]=Math.sin(r)*n;e[2]=i*t;return e}},{}],99:[function(e,t,r){var i=e("gl-shader-core");var n=e("deepcopy");var a=["position","normal","color"];var o="texcoord";function s(e){var t=a.indexOf(e);if(t!==-1)return t;if(e.indexOf(o)===0)return parseInt(e.substring(o.length),10)|0+3;return undefined}function l(e){e.location=s(e.name)}t.exports=function(e){return function(t){var r=n(e);r.attributes.forEach(l);return i(t,r.vertex,r.fragment,r.uniforms,r.attributes)}}},{deepcopy:101,"gl-shader-core":127}],100:[function(e,t,r){var i=e("glslify");var n=e("gl-quad");var a=e("inherits");var o=e("./create-shader")(e("glslify/simple-adapter.js")("\n#define GLSLIFY 1\n\nattribute vec4 position;\nattribute vec2 uv;\nuniform mat4 projection;\nuniform mat4 view;\nuniform mat4 model;\nvarying vec2 vUv;\nvoid main() {\n  gl_Position = projection * view * model * position;\n  vUv = uv;\n}","\n#define GLSLIFY 1\n\n#ifdef GL_ES\n\nprecision mediump float;\n#endif\n\nvarying vec2 vUv;\nhighp float a_x_random(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float dt = dot(co.xy, vec2(a, b));\n  highp float sn = mod(dt, 3.14);\n  return fract(sin(sn) * c);\n}\nuniform float aspect;\nuniform vec2 scale;\nuniform vec2 offset;\nuniform bool coloredNoise;\nuniform vec2 smoothing;\nuniform float noiseAlpha;\nuniform vec3 color1;\nuniform vec3 color2;\nvec3 BlendOverlay(vec3 base, vec3 blend) {\n  return vec3(base.r < 0.5 ? (2.0 * base.r * blend.r) : (1.0 - 2.0 * (1.0 - base.r) * (1.0 - blend.r)), base.g < 0.5 ? (2.0 * base.g * blend.g) : (1.0 - 2.0 * (1.0 - base.g) * (1.0 - blend.g)), base.b < 0.5 ? (2.0 * base.b * blend.b) : (1.0 - 2.0 * (1.0 - base.b) * (1.0 - blend.b)));\n}\nvoid main() {\n  vec2 pos = vUv;\n  pos -= 0.5;\n  pos.x *= aspect;\n  pos /= scale;\n  pos -= offset;\n  float dist = length(pos);\n  dist = smoothstep(smoothing.x, smoothing.y, 1. - dist);\n  vec4 color = vec4(1.0);\n  color.rgb = mix(color2, color1, dist);\n  if(noiseAlpha > 0.0) {\n    vec3 noise = coloredNoise ? vec3(a_x_random(vUv * 1.5), a_x_random(vUv * 2.5), a_x_random(vUv)) : vec3(a_x_random(vUv));\n    color.rgb = mix(color.rgb, BlendOverlay(color.rgb, noise), noiseAlpha);\n  }\n  gl_FragColor = color;\n}",[{name:"projection",type:"mat4"},{name:"view",type:"mat4"},{name:"model",type:"mat4"},{name:"aspect",type:"float"},{name:"scale",type:"vec2"},{name:"offset",type:"vec2"},{name:"coloredNoise",type:"bool"},{name:"smoothing",type:"vec2"},{name:"noiseAlpha",type:"float"},{name:"color1",type:"vec3"},{name:"color2",type:"vec3"}],[{name:"position",type:"vec4"},{name:"uv",type:"vec2"}]));var s=e("gl-mat4/identity");var l=e("gl-mat4/create");function h(e,t){if(!(this instanceof h))return new h(e,t);n.call(this,e);t=t||{};this.gl=e;var r=t.shader;if(!r)this.defaultShader=o(e);this.shader=r||this.defaultShader;var i=s(l());this.style({aspect:e.canvas.width/e.canvas.height,smoothing:[-.4,.8],noiseAlpha:.04,coloredNoise:true,offset:[0,0],color1:[1,1,1],color2:[0,0,0],scale:[1,1],projection:i,view:i,model:i});if(t)this.style(t)}a(h,n);h.prototype.style=function(e){if(!e)return;this.shader.bind();var t=this.shader.uniforms;for(var r in e){if(e.hasOwnProperty(r)&&(e[r]||typeof e[r]==="number")){t[r]=e[r]}}};h.prototype.draw=function(){n.prototype.draw.call(this,this.shader)};h.prototype.dispose=function(){if(this.defaultShader){this.defaultShader.dispose();this.defaultShader=undefined}n.prototype.dispose.call(this)};t.exports=h},{"./create-shader":99,"gl-mat4/create":78,"gl-mat4/identity":83,"gl-quad":103,glslify:128,"glslify/simple-adapter.js":129,inherits:132}],101:[function(e,t,r){t.exports=e("./lib/deepcopy")},{"./lib/deepcopy":102}],102:[function(e,t,r){(function(){var r=typeof t!=="undefined"?e("util"):function(){var e=Object.prototype.toString;function t(t){return typeof t==="object"&&e.call(t)==="[object Array]"}function r(t){return typeof t==="object"&&e.call(t)==="[object Date]"}function i(t){return typeof t==="object"&&e.call(t)==="[object RegExp]"}return{isArray:Array.isArray||t,isDate:r,isRegExp:i}}();var i=Object.keys||function(e){var t=[],r;if(e===null||typeof e!=="object"){throw new TypeError("parameter type is not an Object")}for(r in e){e.hasOwnProperty(r)&&t.push(r)}return t};function n(e,t){var i,n;if(!r.isArray(e)){throw new TypeError("parameter type is not an Array")}for(i=0,n=e.length;i<n;++i){if(e[i]===t){return i}}return-1}function a(e){var t=r.isArray(e)?[]:{},a=[e],o=[t];function s(e,t,a,o){var l,h,u,f,c,p,d,v;if(e===null||typeof e!=="object"){return e}if(r.isDate(e)){return new Date(Number(e))}if(r.isRegExp(e)){return new RegExp(e.source,String(e).slice(e.source.length+2))}l=i(e);for(h=0,u=l.length;h<u;++h){f=l[h];c=e[f];if(c!==null&&typeof c==="object"){p=n(a,c);if(p===-1){d=r.isArray(c)?[]:{};a.push(c);o.push(d)}else{v=o[p]}}t[f]=v||s(c,d,a,o);p=d=v=null}return t}return s(e,t,a,o)}if(typeof t!=="undefined"){t.exports=a}else{this.deepcopy=a}})()},{util:45}],103:[function(e,t,r){var i=e("gl-buffer");var n=e("gl-vao");function a(e){if(!(this instanceof a))return new a(e);this.gl=e;this.vertices=i(e,new Float32Array([-1,-1,-1,1,1,1,1,-1]),e.ARRAY_BUFFER,e.STATIC_DRAW);this.texcoords=i(e,new Float32Array([0,1,0,0,1,0,1,1]),e.ARRAY_BUFFER,e.STATIC_DRAW);this.elements=i(e,new Uint16Array([0,1,2,0,2,3]),e.ELEMENT_ARRAY_BUFFER,e.STATIC_DRAW);this.vao=n(e,[{buffer:this.vertices,size:2,noramlized:false},{buffer:this.texcoords,size:2,normalized:false}],this.elements)}a.prototype.draw=function(e){if(e)e.bind();this.vao.bind();this.vao.draw(this.gl.TRIANGLES,6);this.vao.unbind()};a.prototype.dispose=function(){this.vertices.dispose();this.texcoords.dispose();this.elements.dispose();this.vao.dispose();this.gl=null};t.exports=a},{"gl-buffer":104,"gl-vao":122}],104:[function(e,t,r){"use strict";var i=e("typedarray-pool");var n=e("ndarray-ops");var a=e("ndarray");var o=e("webglew");var s=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function l(e,t,r,i,n){this.gl=e;this.type=t;this.handle=r;this.length=i;this.usage=n}var h=l.prototype;h.bind=function(){this.gl.bindBuffer(this.type,this.handle)};h.unbind=function(){this.gl.bindBuffer(this.type,null)};h.dispose=function(){this.gl.deleteBuffer(this.handle)};function u(e,t,r,i,n,a){var o=n.length*n.BYTES_PER_ELEMENT;if(a<0){e.bufferData(t,n,i);return o}if(o+a>r){throw new Error("gl-buffer: If resizing buffer, must not specify offset")}e.bufferSubData(t,a,n);return r}function f(e,t){var r=i.malloc(e.length,t);var n=e.length;for(var a=0;a<n;++a){r[a]=e[a]}return r}function c(e,t){var r=1;for(var i=t.length-1;i>=0;--i){if(t[i]!==r){return false}r*=e[i]}return true}h.update=function(e,t){if(typeof t!=="number"){t=-1}this.bind();if(typeof e==="object"&&typeof e.shape!=="undefined"){var r=e.dtype;if(s.indexOf(r)<0){r="float32"}if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){var l=o(this.gl);var h=l.OES_element_index_uint;if(h&&r!=="uint16"){r="uint32"}else{r="uint16"}}if(r===e.dtype&&c(e.shape,e.stride)){if(e.offset===0&&e.data.length===e.shape[0]){this.length=u(this.gl,this.type,this.length,this.usage,e.data,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,e.data.subarray(e.offset,e.shape[0]),t)}}else{var p=i.malloc(e.size,r);var d=a(p,e.shape);n.assign(d,e);if(t<0){this.length=u(this.gl,this.type,this.length,this.usage,p,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,p.subarray(0,e.size),t)}i.free(p)}}else if(Array.isArray(e)){var v;if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){v=f(e,"uint16")}else{v=f(e,"float32")}if(t<0){this.length=u(this.gl,this.type,this.length,this.usage,v,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,v.subarray(0,e.length),t)}i.free(v)}else if(typeof e==="object"&&typeof e.length==="number"){this.length=u(this.gl,this.type,this.length,this.usage,e,t)}else if(typeof e==="number"||e===undefined){if(t>=0){throw new Error("gl-buffer: Cannot specify offset when resizing buffer")}e=e|0;if(e<=0){e=1}this.gl.bufferData(this.type,e|0,this.usage);this.length=e}else{throw new Error("gl-buffer: Invalid data type")}};function p(e,t,r,i){o(e);r=r||e.ARRAY_BUFFER;i=i||e.DYNAMIC_DRAW;if(r!==e.ARRAY_BUFFER&&r!==e.ELEMENT_ARRAY_BUFFER){throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER")}if(i!==e.DYNAMIC_DRAW&&i!==e.STATIC_DRAW&&i!==e.STREAM_DRAW){throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW")}var n=e.createBuffer();var a=new l(e,r,n,0,i);a.update(t);return a}t.exports=p},{ndarray:110,"ndarray-ops":105,"typedarray-pool":114,webglew:116}],105:[function(e,t,r){"use strict";var i=e("cwise-compiler");var n={body:"",args:[],thisVars:[],localVars:[]};function a(e){if(!e){return n}for(var t=0;t<e.args.length;++t){var r=e.args[t];if(t===0){e.args[t]={name:r,lvalue:true,rvalue:!!e.rvalue,count:e.count||1}}else{e.args[t]={name:r,lvalue:false,rvalue:true,count:1}}}if(!e.thisVars){e.thisVars=[]}if(!e.localVars){e.localVars=[]}return e}function o(e){return i({args:e.args,pre:a(e.pre),body:a(e.body),post:a(e.proc),funcName:e.funcName})}function s(e){var t=[];for(var r=0;r<e.args.length;++r){t.push("a"+r)}var i=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return i(o(e))}var l={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var e in l){var t=l[e];r[e]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e});r[e+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:true,funcName:e+"eq"});r[e+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"});r[e+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:true,funcName:e+"seq"})}})();var h={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var e in h){var t=h[e];r[e]=s({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e});r[e+"eq"]=s({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:true,count:2,funcName:e+"eq"})}})();var u={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var e in u){var t=u[e];r[e]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e});r[e+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"});r[e+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:true,count:2,funcName:e+"eq"});r[e+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:true,count:2,funcName:e+"seq"})}})();var f=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var e=0;e<f.length;++e){var t=f[e];r[t]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t});r[t+"eq"]=s({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"eq"})}})();var c=["max","min","atan2","pow"];(function(){for(var e=0;e<c.length;++e){var t=c[e];r[t]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t});r[t+"s"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"});r[t+"eq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"eq"});r[t+"seq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"seq"})}})();var p=["atan2","pow"];(function(){for(var e=0;e<p.length;++e){var t=p[e];r[t+"op"]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"});r[t+"ops"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"});r[t+"opeq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"opeq"});r[t+"opseq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"opseq"})}})();r.any=i({args:["array"],pre:n,body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"});r.all=i({args:["array"],pre:n,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"});r.sum=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"});r.prod=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"});r.norm2squared=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"});r.norm2=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"});r.norminf=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"});r.norm1=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"});r.sup=i({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});r.inf=i({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});r.argmin=i({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});r.argmax=i({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});r.random=s({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"});r.assign=s({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"});r.assigns=s({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"});r.equals=i({args:["array","array"],pre:n,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1},{name:"y",lvalue:false,rvalue:true,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":106}],106:[function(e,t,r){"use strict";var i=e("./lib/thunk.js");function n(){this.argTypes=[];this.shimArgs=[];this.arrayArgs=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.pre=null;this.body=null;this.post=null;this.debug=false}function a(e){var t=new n;t.pre=e.pre;t.body=e.body;t.post=e.post;var r=e.args.slice(0);t.argTypes=r;for(var a=0;a<r.length;++a){var o=r[a];if(o==="array"){t.arrayArgs.push(a);t.shimArgs.push("array"+a);if(a<t.pre.args.length&&t.pre.args[a].count>0){throw new Error("cwise: pre() block may not reference array args")}if(a<t.post.args.length&&t.post.args[a].count>0){throw new Error("cwise: post() block may not reference array args")}}else if(o==="scalar"){t.scalarArgs.push(a);t.shimArgs.push("scalar"+a)}else if(o==="index"){t.indexArgs.push(a);if(a<t.pre.args.length&&t.pre.args[a].count>0){throw new Error("cwise: pre() block may not reference array index")}if(a<t.body.args.length&&t.body.args[a].lvalue){throw new Error("cwise: body() block may not write to array index")}if(a<t.post.args.length&&t.post.args[a].count>0){throw new Error("cwise: post() block may not reference array index")}}else if(o==="shape"){t.shapeArgs.push(a);if(a<t.pre.args.length&&t.pre.args[a].lvalue){throw new Error("cwise: pre() block may not write to array shape")}if(a<t.body.args.length&&t.body.args[a].lvalue){throw new Error("cwise: body() block may not write to array shape")}if(a<t.post.args.length&&t.post.args[a].lvalue){throw new Error("cwise: post() block may not write to array shape")}}else if(typeof o==="object"&&o.offset){t.argTypes[a]="offset";t.offsetArgs.push({array:o.array,offset:o.offset});t.offsetArgIndex.push(a)}else{throw new Error("cwise: Unknown argument type "+r[a])}}if(t.arrayArgs.length<=0){throw new Error("cwise: No array arguments specified")}if(t.pre.args.length>r.length){throw new Error("cwise: Too many arguments in pre() block")}if(t.body.args.length>r.length){throw new Error("cwise: Too many arguments in body() block")}if(t.post.args.length>r.length){throw new Error("cwise: Too many arguments in post() block")}t.debug=!!e.printCode||!!e.debug;t.funcName=e.funcName||"cwise";t.blockSize=e.blockSize||64;return i(t)}t.exports=a},{"./lib/thunk.js":108}],107:[function(e,t,r){"use strict";var i=e("uniq");function n(e,t,r){var i=e.length,n=t.arrayArgs.length,a=t.indexArgs.length>0,o=[],s=[],l=0,h=0,u,f;for(u=0;u<i;++u){s.push(["i",u,"=0"].join(""))}for(f=0;f<n;++f){for(u=0;u<i;++u){h=l;l=e[u];if(u===0){s.push(["d",f,"s",u,"=t",f,"p",l].join(""))
}else{s.push(["d",f,"s",u,"=(t",f,"p",l,"-s",h,"*t",f,"p",h,")"].join(""))}}}o.push("var "+s.join(","));for(u=i-1;u>=0;--u){l=e[u];o.push(["for(i",u,"=0;i",u,"<s",l,";++i",u,"){"].join(""))}o.push(r);for(u=0;u<i;++u){h=l;l=e[u];for(f=0;f<n;++f){o.push(["p",f,"+=d",f,"s",u].join(""))}if(a){if(u>0){o.push(["index[",h,"]-=s",h].join(""))}o.push(["++index[",l,"]"].join(""))}o.push("}")}return o.join("\n")}function a(e,t,r,i){var a=t.length,o=r.arrayArgs.length,s=r.blockSize,l=r.indexArgs.length>0,h=[];for(var u=0;u<o;++u){h.push(["var offset",u,"=p",u].join(""))}for(var u=e;u<a;++u){h.push(["for(var j"+u+"=SS[",t[u],"]|0;j",u,">0;){"].join(""));h.push(["if(j",u,"<",s,"){"].join(""));h.push(["s",t[u],"=j",u].join(""));h.push(["j",u,"=0"].join(""));h.push(["}else{s",t[u],"=",s].join(""));h.push(["j",u,"-=",s,"}"].join(""));if(l){h.push(["index[",t[u],"]=j",u].join(""))}}for(var u=0;u<o;++u){var f=["offset"+u];for(var c=e;c<a;++c){f.push(["j",c,"*t",u,"p",t[c]].join(""))}h.push(["p",u,"=(",f.join("+"),")"].join(""))}h.push(n(t,r,i));for(var u=e;u<a;++u){h.push("}")}return h.join("\n")}function o(e){var t=0,r=e[0].length;while(t<r){for(var i=1;i<e.length;++i){if(e[i][t]!==e[0][t]){return t}}++t}return t}function s(e,t,r){var i=e.body;var n=[];var a=[];for(var o=0;o<e.args.length;++o){var s=e.args[o];if(s.count<=0){continue}var l=new RegExp(s.name,"g");var h="";var u=t.arrayArgs.indexOf(o);switch(t.argTypes[o]){case"offset":var f=t.offsetArgIndex.indexOf(o);var c=t.offsetArgs[f];u=c.array;h="+q"+f;case"array":h="p"+u+h;var p="l"+o;var d="a"+u;if(s.count===1){if(r[u]==="generic"){if(s.lvalue){n.push(["var ",p,"=",d,".get(",h,")"].join(""));i=i.replace(l,p);a.push([d,".set(",h,",",p,")"].join(""))}else{i=i.replace(l,[d,".get(",h,")"].join(""))}}else{i=i.replace(l,[d,"[",h,"]"].join(""))}}else if(r[u]==="generic"){n.push(["var ",p,"=",d,".get(",h,")"].join(""));i=i.replace(l,p);if(s.lvalue){a.push([d,".set(",h,",",p,")"].join(""))}}else{n.push(["var ",p,"=",d,"[",h,"]"].join(""));i=i.replace(l,p);if(s.lvalue){a.push([d,"[",h,"]=",p].join(""))}}break;case"scalar":i=i.replace(l,"Y"+t.scalarArgs.indexOf(o));break;case"index":i=i.replace(l,"index");break;case"shape":i=i.replace(l,"shape");break}}return[n.join("\n"),i,a.join("\n")].join("\n").trim()}function l(e){var t=new Array(e.length);var r=true;for(var i=0;i<e.length;++i){var n=e[i];var a=n.match(/\d+/);if(!a){a=""}else{a=a[0]}if(n.charAt(0)===0){t[i]="u"+n.charAt(1)+a}else{t[i]=n.charAt(0)+a}if(i>0){r=r&&t[i]===t[i-1]}}if(r){return t[0]}return t.join("")}function h(e,t){var r=t[1].length|0;var h=new Array(e.arrayArgs.length);var u=new Array(e.arrayArgs.length);var f=["SS"];var c=["'use strict'"];var p=[];for(var d=0;d<r;++d){p.push(["s",d,"=SS[",d,"]"].join(""))}for(var v=0;v<e.arrayArgs.length;++v){f.push("a"+v);f.push("t"+v);f.push("p"+v);u[v]=t[2*v];h[v]=t[2*v+1];for(var d=0;d<r;++d){p.push(["t",v,"p",d,"=t",v,"[",d,"]"].join(""))}}for(var v=0;v<e.scalarArgs.length;++v){f.push("Y"+v)}if(e.shapeArgs.length>0){p.push("shape=SS.slice(0)")}if(e.indexArgs.length>0){var m=new Array(r);for(var v=0;v<r;++v){m[v]="0"}p.push(["index=[",m.join(","),"]"].join(""))}for(var v=0;v<e.offsetArgs.length;++v){var g=e.offsetArgs[v];var y=[];for(var d=0;d<g.offset.length;++d){if(g.offset[d]===0){continue}else if(g.offset[d]===1){y.push(["t",g.array,"p",d].join(""))}else{y.push([g.offset[d],"*t",g.array,"p",d].join(""))}}if(y.length===0){p.push("q"+v+"=0")}else{p.push(["q",v,"=",y.join("+")].join(""))}}var _=i([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));p=p.concat(_);c.push("var "+p.join(","));for(var v=0;v<e.arrayArgs.length;++v){c.push("p"+v+"|=0")}if(e.pre.body.length>3){c.push(s(e.pre,e,u))}var x=s(e.body,e,u);var b=o(h);if(b<r){c.push(a(b,h[0],e,x))}else{c.push(n(h[0],e,x))}if(e.post.body.length>3){c.push(s(e.post,e,u))}if(e.debug){console.log("Generated cwise routine for ",t,":\n\n",c.join("\n"))}var w=[e.funcName||"unnamed","_cwise_loop_",h[0].join("s"),"m",b,l(u)].join("");var T=new Function(["function ",w,"(",f.join(","),"){",c.join("\n"),"} return ",w].join(""));return T()}t.exports=h},{uniq:109}],108:[function(e,t,r){"use strict";var i=e("./compile.js");function n(e){var t=["'use strict'","var CACHED={}"];var r=[];var n=e.funcName+"_cwise_thunk";t.push(["return function ",n,"(",e.shimArgs.join(","),"){"].join(""));var a=[];var o=[];var s=[["array",e.arrayArgs[0],".shape"].join("")];for(var l=0;l<e.arrayArgs.length;++l){var h=e.arrayArgs[l];r.push(["t",h,"=array",h,".dtype,","r",h,"=array",h,".order"].join(""));a.push("t"+h);a.push("r"+h);o.push("t"+h);o.push("r"+h+".join()");s.push("array"+h+".data");s.push("array"+h+".stride");s.push("array"+h+".offset|0")}for(var l=0;l<e.scalarArgs.length;++l){s.push("scalar"+e.scalarArgs[l])}r.push(["type=[",o.join(","),"].join()"].join(""));r.push("proc=CACHED[type]");t.push("var "+r.join(","));t.push(["if(!proc){","CACHED[type]=proc=compile([",a.join(","),"])}","return proc(",s.join(","),")}"].join(""));if(e.debug){console.log("Generated thunk:",t.join("\n"))}var u=new Function("compile",t.join("\n"));return u(i.bind(undefined,e))}t.exports=n},{"./compile.js":107}],109:[function(e,t,r){t.exports=e(66)},{"/projects/xmas/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":66}],110:[function(e,t,r){(function(r){var i=e("iota-array");var n=["concat","join","slice","toString","indexOf","lastIndexOf","forEach","every","some","filter","map","reduce","reduceRight"];var a=typeof Float64Array!=="undefined";var o=typeof r!=="undefined";function s(e,t){return e[0]-t[0]}function l(){var e=this.stride;var t=new Array(e.length);var r;for(r=0;r<t.length;++r){t[r]=[Math.abs(e[r]),r]}t.sort(s);var i=new Array(t.length);for(r=0;r<i.length;++r){i[r]=t[r][1]}return i}function h(e,t){var r=["View",t,"d",e].join("");if(t<0){r="View_Nil"+e}var a=e==="generic";if(t===-1){var o="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}";var s=new Function(o);return s()}else if(t===0){var o="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(a?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(a?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}";var s=new Function("TrivialArray",o);return s(f[e][0])}var o=["'use strict'"];var h=i(t);var u=h.map(function(e){return"i"+e});var c="this.offset+"+h.map(function(e){return"this._stride"+e+"*i"+e}).join("+");o.push("function "+r+"(a,"+h.map(function(e){return"b"+e}).join(",")+","+h.map(function(e){return"c"+e}).join(",")+",d){this.data=a");for(var p=0;p<t;++p){o.push("this._shape"+p+"=b"+p+"|0")}for(var p=0;p<t;++p){o.push("this._stride"+p+"=c"+p+"|0")}o.push("this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+e+"'","proto.dimension="+t);var d="VStride"+t+"d"+e;var v="VShape"+t+"d"+e;var m={stride:d,shape:v};for(var g in m){var y=m[g];o.push("function "+y+"(v) {this._v=v} var aproto="+y+".prototype","aproto.length="+t);var _=[];for(var p=0;p<t;++p){_.push(["this._v._",g,p].join(""))}o.push("aproto.toJSON=function "+y+"_toJSON(){return ["+_.join(",")+"]}","aproto.valueOf=aproto.toString=function "+y+"_toString(){return ["+_.join(",")+"].join()}");for(var p=0;p<t;++p){o.push("Object.defineProperty(aproto,"+p+",{get:function(){return this._v._"+g+p+"},set:function(v){return this._v._"+g+p+"=v|0},enumerable:true})")}for(var p=0;p<n.length;++p){if(n[p]in Array.prototype){o.push("aproto."+n[p]+"=Array.prototype."+n[p])}}o.push(["Object.defineProperty(proto,'",g,"',{get:function ",y,"_get(){return new ",y,"(this)},set: function ",y,"_set(v){"].join(""));for(var p=0;p<t;++p){o.push("this._"+g+p+"=v["+p+"]|0")}o.push("return v}})")}o.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+h.map(function(e){return"this._shape"+e}).join("*"),"}})");if(t===1){o.push("proto.order=[0]")}else{o.push("Object.defineProperty(proto,'order',{get:");if(t<4){o.push("function "+r+"_order(){");if(t===2){o.push("return (Math.abs(this._stride0)>Math.abs(this._stride1))?[1,0]:[0,1]}})")}else if(t===3){o.push("var s0=Math.abs(this._stride0),s1=Math.abs(this._stride1),s2=Math.abs(this._stride2);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")}}else{o.push("ORDER})")}}o.push("proto.set=function "+r+"_set("+u.join(",")+",v){");if(a){o.push("return this.data.set("+c+",v)}")}else{o.push("return this.data["+c+"]=v}")}o.push("proto.get=function "+r+"_get("+u.join(",")+"){");if(a){o.push("return this.data.get("+c+")}")}else{o.push("return this.data["+c+"]}")}o.push("proto.index=function "+r+"_index(",u.join(),"){return "+c+"}");o.push("proto.hi=function "+r+"_hi("+u.join(",")+"){return new "+r+"(this.data,"+h.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this._shape",e,":i",e,"|0"].join("")}).join(",")+","+h.map(function(e){return"this._stride"+e}).join(",")+",this.offset)}");var x=h.map(function(e){return"a"+e+"=this._shape"+e});var b=h.map(function(e){return"c"+e+"=this._stride"+e});o.push("proto.lo=function "+r+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+x.join(",")+","+b.join(","));for(var p=0;p<t;++p){o.push("if(typeof i"+p+"==='number'&&i"+p+">=0){d=i"+p+"|0;b+=c"+p+"*d;a"+p+"-=d}")}o.push("return new "+r+"(this.data,"+h.map(function(e){return"a"+e}).join(",")+","+h.map(function(e){return"c"+e}).join(",")+",b)}");o.push("proto.step=function "+r+"_step("+u.join(",")+"){var "+h.map(function(e){return"a"+e+"=this._shape"+e}).join(",")+","+h.map(function(e){return"b"+e+"=this._stride"+e}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var p=0;p<t;++p){o.push("if(typeof i"+p+"==='number'){d=i"+p+"|0;if(d<0){c+=b"+p+"*(a"+p+"-1);a"+p+"=ceil(-a"+p+"/d)}else{a"+p+"=ceil(a"+p+"/d)}b"+p+"*=d}")}o.push("return new "+r+"(this.data,"+h.map(function(e){return"a"+e}).join(",")+","+h.map(function(e){return"b"+e}).join(",")+",c)}");var w=new Array(t);var T=new Array(t);for(var p=0;p<t;++p){w[p]="a[i"+p+"]";T[p]="b[i"+p+"]"}o.push("proto.transpose=function "+r+"_transpose("+u+"){"+u.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+w.join(",")+","+T.join(",")+",this.offset)}");o.push("proto.pick=function "+r+"_pick("+u+"){var a=[],b=[],c=this.offset");for(var p=0;p<t;++p){o.push("if(typeof i"+p+"==='number'&&i"+p+">=0){c=(c+this._stride"+p+"*i"+p+")|0}else{a.push(this._shape"+p+");b.push(this._stride"+p+")}")}o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");o.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+h.map(function(e){return"shape["+e+"]"}).join(",")+","+h.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var s=new Function("CTOR_LIST","ORDER",o.join("\n"));return s(f[e],l)}function u(e){if(o){if(r.isBuffer(e)){return"buffer"}}if(a){switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}}if(Array.isArray(e)){return"array"}return"generic"}var f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};(function(){for(var e in f){f[e].push(h(e,-1))}});function c(e,t,r,i){if(e===undefined){var n=f.array[0];return n([])}else if(typeof e==="number"){e=[e]}if(t===undefined){t=[e.length]}var a=t.length;if(r===undefined){r=new Array(a);for(var o=a-1,s=1;o>=0;--o){r[o]=s;s*=t[o]}}if(i===undefined){i=0;for(var o=0;o<a;++o){if(r[o]<0){i-=(t[o]-1)*r[o]}}}var l=u(e);var c=f[l];while(c.length<=a+1){c.push(h(l,c.length-1))}var n=c[a+1];return n(e,t,r,i)}t.exports=c}).call(this,e("buffer").Buffer)},{buffer:39,"iota-array":111}],111:[function(e,t,r){"use strict";function i(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=r}return t}t.exports=i},{}],112:[function(e,t,r){t.exports=e(63)},{"/projects/xmas/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/node_modules/bit-twiddle/twiddle.js":63}],113:[function(e,t,r){"use strict";function i(e,t,r){var n=e[r]|0;if(n<=0){return[]}var a=new Array(n),o;if(r===e.length-1){for(o=0;o<n;++o){a[o]=t}}else{for(o=0;o<n;++o){a[o]=i(e,t,r+1)}}return a}function n(e,t){var r,i;r=new Array(e);for(i=0;i<e;++i){r[i]=t}return r}function a(e,t){if(typeof t==="undefined"){t=0}switch(typeof e){case"number":if(e>0){return n(e|0,t)}break;case"object":if(typeof e.length==="number"){return i(e,t,0)}break}return[]}t.exports=a},{}],114:[function(e,t,r){(function(t,i){"use strict";var n=e("bit-twiddle");var a=e("dup");if(!t.__TYPEDARRAY_POOL){t.__TYPEDARRAY_POOL={UINT8:a([32,0]),UINT16:a([32,0]),UINT32:a([32,0]),INT8:a([32,0]),INT16:a([32,0]),INT32:a([32,0]),FLOAT:a([32,0]),DOUBLE:a([32,0]),DATA:a([32,0]),UINT8C:a([32,0]),BUFFER:a([32,0])}}var o=typeof Uint8ClampedArray!=="undefined";var s=t.__TYPEDARRAY_POOL;if(!s.UINT8C){s.UINT8C=a([32,0])}if(!s.BUFFER){s.BUFFER=a([32,0])}var l=s.DATA,h=s.BUFFER;r.free=function S(e){if(i.isBuffer(e)){h[n.log2(e.length)].push(e)}else{if(Object.prototype.toString.call(e)!=="[object ArrayBuffer]"){e=e.buffer}if(!e){return}var t=e.length||e.byteLength;var r=n.log2(t)|0;l[r].push(e)}};function u(e){if(!e){return}var t=e.length||e.byteLength;var r=n.log2(t);l[r].push(e)}function f(e){u(e.buffer)}r.freeUint8=r.freeUint16=r.freeUint32=r.freeInt8=r.freeInt16=r.freeInt32=r.freeFloat32=r.freeFloat=r.freeFloat64=r.freeDouble=r.freeUint8Clamped=r.freeDataView=f;r.freeArrayBuffer=u;r.freeBuffer=function M(e){h[n.log2(e.length)].push(e)};r.malloc=function A(e,t){if(t===undefined||t==="arraybuffer"){return c(e)}else{switch(t){case"uint8":return p(e);case"uint16":return d(e);case"uint32":return v(e);case"int8":return m(e);case"int16":return g(e);case"int32":return y(e);case"float":case"float32":return _(e);case"double":case"float64":return x(e);case"uint8_clamped":return b(e);case"buffer":return T(e);case"data":case"dataview":return w(e);default:return null}}return null};function c(e){var e=n.nextPow2(e);var t=n.log2(e);var r=l[t];if(r.length>0){return r.pop()}return new ArrayBuffer(e)}r.mallocArrayBuffer=c;function p(e){return new Uint8Array(c(e),0,e)}r.mallocUint8=p;function d(e){return new Uint16Array(c(2*e),0,e)}r.mallocUint16=d;function v(e){return new Uint32Array(c(4*e),0,e)}r.mallocUint32=v;function m(e){return new Int8Array(c(e),0,e)}r.mallocInt8=m;function g(e){return new Int16Array(c(2*e),0,e)}r.mallocInt16=g;function y(e){return new Int32Array(c(4*e),0,e)}r.mallocInt32=y;function _(e){return new Float32Array(c(4*e),0,e)}r.mallocFloat32=r.mallocFloat=_;function x(e){return new Float64Array(c(8*e),0,e)}r.mallocFloat64=r.mallocDouble=x;function b(e){if(o){return new Uint8ClampedArray(c(e),0,e)}else{return p(e)}}r.mallocUint8Clamped=b;function w(e){return new DataView(c(e),0,e)}r.mallocDataView=w;function T(e){e=n.nextPow2(e);var t=n.log2(e);var r=h[t];if(r.length>0){return r.pop()}return new i(e)}r.mallocBuffer=T;r.clearCache=function E(){for(var e=0;e<32;++e){s.UINT8[e].length=0;s.UINT16[e].length=0;s.UINT32[e].length=0;s.INT8[e].length=0;s.INT16[e].length=0;s.INT32[e].length=0;s.FLOAT[e].length=0;s.DOUBLE[e].length=0;s.UINT8C[e].length=0;l[e].length=0;h[e].length=0}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer)},{"bit-twiddle":112,buffer:39,dup:113}],115:[function(e,t,r){void function(e,i,n){var a=Object.getOwnPropertyNames,o=Object.defineProperty,s=Function.prototype.toString,l=Object.create,h=Object.prototype.hasOwnProperty,u=/^\n?function\s?(\w*)?_?\(/;function f(e,t,r){if(typeof t==="function"){r=t;t=c(r).replace(/_$/,"")}return o(e,t,{configurable:true,writable:true,value:r})}function c(e){return typeof e!=="function"?"":"name"in e?e.name:s.call(e).match(u)[1]}var p=function(){var e={value:{writable:true,value:n}},t="return function(k){if(k===s)return l}",r=l(null),i=function(){var e=Math.random().toString(36).slice(2);return e in r?i():r[e]=e},s=i(),u=function(e){if(h.call(e,s))return e[s];if(!Object.isExtensible(e))throw new TypeError("Object must be extensible");var t=l(null);o(e,s,{value:t});return t};f(Object,function p(e){var t=a(e);if(h.call(e,s))t.splice(t.indexOf(s),1);return t});function c(){var r=i(),n={};this.unlock=function(i){var a=u(i);if(h.call(a,r))return a[r](n);var s=l(null,e);o(a,r,{value:new Function("s","l",t)(n,s)});return s}}f(c.prototype,function d(e){return this.unlock(e).value});f(c.prototype,function v(e,t){this.unlock(e).value=t});return c}();var d=function(t){var r=function(e){if(e==null||typeof e!=="object"&&typeof e!=="function")throw new TypeError("Invalid WeakMap key")};var a=function(e,r){var i=t.unlock(e);if(i.value)throw new TypeError("Object is already a WeakMap");i.value=r};var o=function(e){var r=t.unlock(e).value;if(!r)throw new TypeError("WeakMap is not generic");return r};var s=function(e,t){if(t!==null&&typeof t==="object"&&typeof t.forEach==="function"){t.forEach(function(r,i){if(r instanceof Array&&r.length===2)u.call(e,t[i][0],t[i][1])})}};function l(t){if(this===e||this==null||this===l.prototype)return new l(t);a(this,new p);s(this,t)}function h(e){r(e);var t=o(this).get(e);return t===i?n:t}function u(e,t){r(e);o(this).set(e,t===n?i:t)}function d(e){r(e);return o(this).get(e)!==n}function v(e){r(e);var t=o(this),i=t.get(e)!==n;t.set(e,n);return i}function m(){o(this);return"[object WeakMap]"}try{var g=("return "+v).replace("e_","\\u0065"),y=new Function("unwrap","validate",g)(o,r)}catch(_){var y=v}var g=(""+Object).split("Object");var x=function w(){return g[0]+c(this)+g[1]};f(x,x);var b={__proto__:[]}instanceof Array?function(e){e.__proto__=x}:function(e){f(e,x)};b(l);[m,h,u,d,y].forEach(function(e){f(l.prototype,e);b(e)});return l}(new p);var v=Object.create?function(){return Object.create(null)}:function(){return{}};function m(e){var t=new d;e||(e=v);function r(r,i){if(i||arguments.length===2){t.set(r,i)}else{i=t.get(r);if(i===n){i=e(r);t.set(r,i)}}return i}return r}if(typeof t!=="undefined"){t.exports=d}else if(typeof r!=="undefined"){r.WeakMap=d}else if(!("WeakMap"in e)){e.WeakMap=d}d.createStorage=m;if(e.WeakMap)e.WeakMap.createStorage=m}((0,eval)("this"))},{}],116:[function(e,t,r){"use strict";var i=typeof WeakMap==="undefined"?e("weakmap"):WeakMap;var n=new i;function a(e){return e.replace(/^[A-Z]+_/,"")}function o(e){var t=n.get(e);if(t){return t}var r={};var i=e.getSupportedExtensions();for(var o=0;o<i.length;++o){var s=i[o];if(s.indexOf("MOZ_")===0){continue}var l=e.getExtension(i[o]);if(!l){continue}while(true){r[s]=l;var h=a(s);if(h===s){break}s=h}}n.set(e,r);return r}t.exports=o},{weakmap:115}],117:[function(e,t,r){"use strict";function i(e,t,r){if(t){t.bind()}else{e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}var i=e.getParameter(e.MAX_VERTEX_ATTRIBS)|0;if(r){if(r.length>i){throw new Error("gl-vao: Too many vertex attributes")}for(var n=0;n<r.length;++n){var a=r[n];if(a.buffer){var o=a.buffer;var s=a.size||4;var l=a.type||e.FLOAT;var h=!!a.normalized;var u=a.stride||0;var f=a.offset||0;o.bind();e.enableVertexAttribArray(n);e.vertexAttribPointer(n,s,l,h,u,f)}else{if(typeof a==="number"){e.vertexAttrib1f(n,a)}else if(a.length===1){e.vertexAttrib1f(n,a[0])}else if(a.length===2){e.vertexAttrib2f(n,a[0],a[1])}else if(a.length===3){e.vertexAttrib3f(n,a[0],a[1],a[2])}else if(a.length===4){e.vertexAttrib4f(n,a[0],a[1],a[2],a[3])}else{throw new Error("gl-vao: Invalid vertex attribute")}e.disableVertexAttribArray(n)}}for(;n<i;++n){e.disableVertexAttribArray(n)}}else{e.bindBuffer(e.ARRAY_BUFFER,null);for(var n=0;n<i;++n){e.disableVertexAttribArray(n)}}}t.exports=i},{}],118:[function(e,t,r){"use strict";var i=e("./do-bind.js");function n(e){this.gl=e;this._elements=null;this._attributes=null;this._elementsType=e.UNSIGNED_SHORT}n.prototype.bind=function(){i(this.gl,this._elements,this._attributes)};n.prototype.update=function(e,t,r){this._elements=t;this._attributes=e;this._elementsType=r||this.gl.UNSIGNED_SHORT};n.prototype.dispose=function(){};n.prototype.unbind=function(){};n.prototype.draw=function(e,t,r){r=r||0;var i=this.gl;if(this._elements){i.drawElements(e,t,this._elementsType,r)}else{i.drawArrays(e,r,t)}};function a(e){return new n(e)}t.exports=a},{"./do-bind.js":117}],119:[function(e,t,r){"use strict";var i=e("./do-bind.js");function n(e,t,r,i,n,a){this.location=e;this.dimension=t;this.a=r;this.b=i;this.c=n;this.d=a}n.prototype.bind=function(e){switch(this.dimension){case 1:e.vertexAttrib1f(this.location,this.a);break;case 2:e.vertexAttrib2f(this.location,this.a,this.b);break;case 3:e.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:e.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function a(e,t,r){this.gl=e;this._ext=t;this.handle=r;this._attribs=[];this._useElements=false;this._elementsType=e.UNSIGNED_SHORT}a.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var e=0;e<this._attribs.length;++e){this._attribs[e].bind(this.gl)}};a.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)};a.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)};a.prototype.update=function(e,t,r){this.bind();i(this.gl,t,e);this.unbind();this._attribs.length=0;if(e)for(var a=0;a<e.length;++a){var o=e[a];if(typeof o==="number"){this._attribs.push(new n(a,1,o))}else if(Array.isArray(o)){this._attribs.push(new n(a,o.length,o[0],o[1],o[2],o[3]))}}this._useElements=!!t;this._elementsType=r||this.gl.UNSIGNED_SHORT};a.prototype.draw=function(e,t,r){r=r||0;var i=this.gl;if(this._useElements){i.drawElements(e,t,this._elementsType,r)}else{i.drawArrays(e,r,t)}};function o(e,t){return new a(e,t,t.createVertexArrayOES())}t.exports=o},{"./do-bind.js":117}],120:[function(e,t,r){t.exports=e(115)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/webglew/node_modules/weakmap/weakmap.js":115}],121:[function(e,t,r){t.exports=e(116)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/webglew/webglew.js":116,weakmap:120}],122:[function(e,t,r){"use strict";var i=e("webglew");var n=e("./lib/vao-native.js");var a=e("./lib/vao-emulated.js");function o(e,t,r,o){var s=i(e).OES_vertex_array_object;var l;if(s){l=n(e,s)}else{l=a(e)}l.update(t,r,o);return l}t.exports=o},{"./lib/vao-emulated.js":118,"./lib/vao-native.js":119,webglew:121}],123:[function(e,t,r){"use strict";t.exports=o;function i(e,t,r,i,n,a,o){this._gl=e;this._program=t;this._location=r;this._dimension=i;this._name=n;this._constFunc=a;this._relink=o}var n=i.prototype;n.pointer=function s(e,t,r,i){var n=this._gl;n.vertexAttribPointer(this._location,this._dimension,e||n.FLOAT,!!t,r||0,i||0);this._gl.enableVertexAttribArray(this._location)};Object.defineProperty(n,"location",{get:function(){return this._location},set:function(e){if(e!==this._location){this._location=e;this._gl.bindAttribLocation(this._program,e,this._name);this._gl.linkProgram(this._program);this._relink()}}});function a(e,t,r,n,a,o,s){var l=["gl","v"];var h=[];for(var u=0;u<n;++u){l.push("x"+u);h.push("x"+u)}l.push(["if(x0.length===void 0){return gl.vertexAttrib",n,"f(v,",h.join(),")}else{return gl.vertexAttrib",n,"fv(v,x0)}"].join(""));var f=Function.apply(undefined,l);var c=new i(e,t,r,n,o,f,s);Object.defineProperty(a,o,{set:function(t){e.disableVertexAttribArray(c._location);f(e,c._location,t);return t},get:function(){return c},enumerable:true})}function o(e,t,r,i){var n={};for(var o=0,s=r.length;o<s;++o){var l=r[o];var h=l.name;var u=l.type;var f=e.getAttribLocation(t,h);switch(u){case"bool":case"int":case"float":a(e,t,f,1,n,h,i);break;default:if(u.indexOf("vec")>=0){var c=u.charCodeAt(u.length-1)-48;if(c<2||c>4){throw new Error("gl-shader: Invalid data type for attribute "+h+": "+u)}a(e,t,f,c,n,h,i)}else{throw new Error("gl-shader: Unknown data type for attribute "+h+": "+u)}break}}return n}},{}],124:[function(e,t,r){"use strict";var i=e("dup");var n=e("./reflect");t.exports=o;function a(e){var t=new Function("y","return function(){return y}");return t(e)}function o(e,t,r,o){function s(r){var i=new Function("gl","prog","locations","return function(){return gl.getUniform(prog,locations["+r+"])}");return i(e,t,o)}function l(e,t,r){switch(r){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+t+"],obj"+e+")";case"float":return"gl.uniform1f(locations["+t+"],obj"+e+")";default:var i=r.indexOf("vec");if(0<=i&&i<=1&&r.length===4+i){var n=r.charCodeAt(r.length-1)-48;if(n<2||n>4){throw new Error("gl-shader: Invalid data type")}switch(r.charAt(0)){case"b":case"i":return"gl.uniform"+n+"iv(locations["+t+"],obj"+e+")";case"v":return"gl.uniform"+n+"fv(locations["+t+"],obj"+e+")";default:throw new Error("gl-shader: Unrecognized data type for vector "+name+": "+r)}}else if(r.indexOf("mat")===0&&r.length===4){var n=r.charCodeAt(r.length-1)-48;if(n<2||n>4){throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+r)}return"gl.uniformMatrix"+n+"fv(locations["+t+"],false,obj"+e+")"}else{throw new Error("gl-shader: Unknown uniform data type for "+name+": "+r)}break}}function h(e,t){if(typeof t!=="object"){return[[e,t]]}var r=[];for(var i in t){var n=t[i];var a=e;if(parseInt(i)+""===i){a+="["+i+"]"}else{a+="."+i}if(typeof n==="object"){r.push.apply(r,h(a,n))}else{r.push([a,n])}}return r}function u(i){var n=["return function updateProperty(obj){"];var a=h("",i);for(var s=0;s<a.length;++s){var u=a[s];var f=u[0];var c=u[1];if(o[c]){n.push(l(f,c,r[c].type))}}n.push("return obj}");var p=new Function("gl","prog","locations",n.join("\n"));return p(e,t,o)}function f(e){switch(e){case"bool":return false;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var t=e.indexOf("vec");if(0<=t&&t<=1&&e.length===4+t){var r=e.charCodeAt(e.length-1)-48;if(r<2||r>4){throw new Error("gl-shader: Invalid data type")}if(e.charAt(0)==="b"){return i(r,false)}return i(r)}else if(e.indexOf("mat")===0&&e.length===4){var r=e.charCodeAt(e.length-1)-48;if(r<2||r>4){throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+e)}return i([r,r])}else{throw new Error("gl-shader: Unknown uniform data type for "+name+": "+e)}break}}function c(e,t,i){if(typeof i==="object"){var n=p(i);Object.defineProperty(e,t,{get:a(n),set:u(i),enumerable:true,configurable:false})}else{if(o[i]){Object.defineProperty(e,t,{get:s(i),set:u(i),enumerable:true,configurable:false})}else{e[t]=f(r[i].type)}}}function p(e){var t;if(Array.isArray(e)){t=new Array(e.length);for(var r=0;r<e.length;++r){c(t,r,e[r])}}else{t={};for(var i in e){c(t,i,e[i])}}return t}var d=n(r,true);return{get:a(p(d)),set:u(d),enumerable:true,configurable:true}}},{"./reflect":125,dup:126}],125:[function(e,t,r){"use strict";t.exports=i;function i(e,t){var r={};for(var i=0;i<e.length;++i){var n=e[i].name;var a=n.split(".");var o=r;for(var s=0;s<a.length;++s){var l=a[s].split("[");if(l.length>1){if(!(l[0]in o)){o[l[0]]=[]}o=o[l[0]];for(var h=1;h<l.length;++h){var u=parseInt(l[h]);if(h<l.length-1||s<a.length-1){if(!(u in o)){if(h<l.length-1){o[u]=[]}else{o[u]={}}}o=o[u]}else{if(t){o[u]=i}else{o[u]=e[i].type}}}}else if(s<a.length-1){if(!(l[0]in o)){o[l[0]]={}}o=o[l[0]]}else{if(t){o[l[0]]=i}else{o[l[0]]=e[i].type}}}}return r}},{}],126:[function(e,t,r){t.exports=e(113)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/typedarray-pool/node_modules/dup/dup.js":113}],127:[function(e,t,r){"use strict";var i=e("./lib/create-uniforms");var n=e("./lib/create-attributes");var a=e("./lib/reflect");function o(e,t,r,i){this.gl=e;this.handle=t;this.attributes=null;this.uniforms=null;this.types=null;this.vertexShader=r;this.fragmentShader=i}o.prototype.bind=function(){this.gl.useProgram(this.handle)};o.prototype.dispose=function(){var e=this.gl;e.deleteShader(this.vertexShader);e.deleteShader(this.fragmentShader);e.deleteProgram(this.handle)};o.prototype.updateExports=function(e,t){var r=new Array(e.length);var o=this.handle;var l=this.gl;var h=s.bind(void 0,l,o,r,e);h();this.types={uniforms:a(e),attributes:a(t)};this.attributes=n(l,o,t,h);Object.defineProperty(this,"uniforms",i(l,o,e,r))};function s(e,t,r,i){for(var n=0;n<i.length;++n){r[n]=e.getUniformLocation(t,i[n].name)}}function l(e,t,r,i,n){var a=e.createShader(e.VERTEX_SHADER);e.shaderSource(a,t);e.compileShader(a);if(!e.getShaderParameter(a,e.COMPILE_STATUS)){var s=e.getShaderInfoLog(a);console.error("gl-shader: Error compling vertex shader:",s);throw new Error("gl-shader: Error compiling vertex shader:"+s)}var l=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(l,r);e.compileShader(l);if(!e.getShaderParameter(l,e.COMPILE_STATUS)){var s=e.getShaderInfoLog(l);console.error("gl-shader: Error compiling fragment shader:",s);throw new Error("gl-shader: Error compiling fragment shader:"+s)}var h=e.createProgram();e.attachShader(h,l);e.attachShader(h,a);n.forEach(function(t){if(typeof t.location==="number")e.bindAttribLocation(h,t.location,t.name)});e.linkProgram(h);if(!e.getProgramParameter(h,e.LINK_STATUS)){var s=e.getProgramInfoLog(h);console.error("gl-shader: Error linking shader program:",s);throw new Error("gl-shader: Error linking shader program:"+s)}var u=new o(e,h,a,l);u.updateExports(i,n);return u}t.exports=l},{"./lib/create-attributes":123,"./lib/create-uniforms":124,"./lib/reflect":125}],128:[function(e,t,r){t.exports=i;function i(){throw new Error("You should bundle your code "+"using `glslify` as a transform.")}},{}],129:[function(e,t,r){t.exports=i;function i(e,t,r,i){return{vertex:e,fragment:t,uniforms:r,attributes:i}}},{}],130:[function(e,t,r){(function(e){var r=typeof t!=="undefined"&&t.exports&&typeof e!=="undefined"?e:this||window;(r._gsQueue||(r._gsQueue=[])).push(function(){"use strict";r._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(e,t,r){var i=function(e){var t=[],r=e.length,i;for(i=0;i!==r;t.push(e[i++]));return t},n=function(e,t,i){r.call(this,e,t,i);this._cycle=0;this._yoyo=this.vars.yoyo===true;this._repeat=this.vars.repeat||0;this._repeatDelay=this.vars.repeatDelay||0;this._dirty=true;this.render=n.prototype.render},a=1e-10,o=r._internals,s=o.isSelector,l=o.isArray,h=n.prototype=r.to({},.1,{}),u=[];n.version="1.14.2";h.constructor=n;h.kill()._gc=false;n.killTweensOf=n.killDelayedCallsTo=r.killTweensOf;n.getTweensOf=r.getTweensOf;n.lagSmoothing=r.lagSmoothing;n.ticker=r.ticker;n.render=r.render;h.invalidate=function(){this._yoyo=this.vars.yoyo===true;this._repeat=this.vars.repeat||0;this._repeatDelay=this.vars.repeatDelay||0;this._uncache(true);return r.prototype.invalidate.call(this)};h.updateTo=function(e,t){var i=this.ratio,n=this.vars.immediateRender||e.immediateRender,a;if(t&&this._startTime<this._timeline._time){this._startTime=this._timeline._time;
this._uncache(false);if(this._gc){this._enabled(true,false)}else{this._timeline.insert(this,this._startTime-this._delay)}}for(a in e){this.vars[a]=e[a]}if(this._initted||n){if(t){this._initted=false}else{if(this._gc){this._enabled(true,false)}if(this._notifyPluginsOfEnabled&&this._firstPT){r._onPluginEvent("_onDisable",this)}if(this._time/this._duration>.998){var o=this._time;this.render(0,true,false);this._initted=false;this.render(o,true,false)}else if(this._time>0||n){this._initted=false;this._init();var s=1/(1-i),l=this._firstPT,h;while(l){h=l.s+l.c;l.c*=s;l.s=h-l.c;l=l._next}}}}return this};h.render=function(e,t,r){if(!this._initted)if(this._duration===0&&this.vars.repeat){this.invalidate()}var i=!this._dirty?this._totalDuration:this.totalDuration(),n=this._time,s=this._totalTime,l=this._cycle,h=this._duration,f=this._rawPrevTime,c,p,d,v,m,g,y,_,x;if(e>=i){this._totalTime=i;this._cycle=this._repeat;if(this._yoyo&&(this._cycle&1)!==0){this._time=0;this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0}else{this._time=h;this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1}if(!this._reversed){c=true;p="onComplete"}if(h===0)if(this._initted||!this.vars.lazy||r){if(this._startTime===this._timeline._duration){e=0}if(e===0||f<0||f===a)if(f!==e){r=true;if(f>a){p="onReverseComplete"}}this._rawPrevTime=_=!t||e||f===e?e:a}}else if(e<1e-7){this._totalTime=this._time=this._cycle=0;this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0;if(s!==0||h===0&&f>0&&f!==a){p="onReverseComplete";c=this._reversed}if(e<0){this._active=false;if(h===0)if(this._initted||!this.vars.lazy||r){if(f>=0){r=true}this._rawPrevTime=_=!t||e||f===e?e:a}}if(!this._initted){r=true}}else{this._totalTime=this._time=e;if(this._repeat!==0){v=h+this._repeatDelay;this._cycle=this._totalTime/v>>0;if(this._cycle!==0)if(this._cycle===this._totalTime/v){this._cycle--}this._time=this._totalTime-this._cycle*v;if(this._yoyo)if((this._cycle&1)!==0){this._time=h-this._time}if(this._time>h){this._time=h}else if(this._time<0){this._time=0}}if(this._easeType){m=this._time/h;g=this._easeType;y=this._easePower;if(g===1||g===3&&m>=.5){m=1-m}if(g===3){m*=2}if(y===1){m*=m}else if(y===2){m*=m*m}else if(y===3){m*=m*m*m}else if(y===4){m*=m*m*m*m}if(g===1){this.ratio=1-m}else if(g===2){this.ratio=m}else if(this._time/h<.5){this.ratio=m/2}else{this.ratio=1-m/2}}else{this.ratio=this._ease.getRatio(this._time/h)}}if(n===this._time&&!r&&l===this._cycle){if(s!==this._totalTime)if(this._onUpdate)if(!t){this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||u)}return}else if(!this._initted){this._init();if(!this._initted||this._gc){return}else if(!r&&this._firstPT&&(this.vars.lazy!==false&&this._duration||this.vars.lazy&&!this._duration)){this._time=n;this._totalTime=s;this._rawPrevTime=f;this._cycle=l;o.lazyTweens.push(this);this._lazy=[e,t];return}if(this._time&&!c){this.ratio=this._ease.getRatio(this._time/h)}else if(c&&this._ease._calcEnd){this.ratio=this._ease.getRatio(this._time===0?0:1)}}if(this._lazy!==false){this._lazy=false}if(!this._active)if(!this._paused&&this._time!==n&&e>=0){this._active=true}if(s===0){if(this._initted===2&&e>0){this._init()}if(this._startAt){if(e>=0){this._startAt.render(e,t,r)}else if(!p){p="_dummyGS"}}if(this.vars.onStart)if(this._totalTime!==0||h===0)if(!t){this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||u)}}d=this._firstPT;while(d){if(d.f){d.t[d.p](d.c*this.ratio+d.s)}else{d.t[d.p]=d.c*this.ratio+d.s}d=d._next}if(this._onUpdate){if(e<0)if(this._startAt&&this._startTime){this._startAt.render(e,t,r)}if(!t)if(this._totalTime!==s||c){this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||u)}}if(this._cycle!==l)if(!t)if(!this._gc)if(this.vars.onRepeat){this.vars.onRepeat.apply(this.vars.onRepeatScope||this,this.vars.onRepeatParams||u)}if(p)if(!this._gc||r){if(e<0&&this._startAt&&!this._onUpdate&&this._startTime){this._startAt.render(e,t,r)}if(c){if(this._timeline.autoRemoveChildren){this._enabled(false,false)}this._active=false}if(!t&&this.vars[p]){this.vars[p].apply(this.vars[p+"Scope"]||this,this.vars[p+"Params"]||u)}if(h===0&&this._rawPrevTime===a&&_!==a){this._rawPrevTime=0}}};n.to=function(e,t,r){return new n(e,t,r)};n.from=function(e,t,r){r.runBackwards=true;r.immediateRender=r.immediateRender!=false;return new n(e,t,r)};n.fromTo=function(e,t,r,i){i.startAt=r;i.immediateRender=i.immediateRender!=false&&r.immediateRender!=false;return new n(e,t,i)};n.staggerTo=n.allTo=function(e,t,a,o,h,f,c){o=o||0;var p=a.delay||0,d=[],v=function(){if(a.onComplete){a.onComplete.apply(a.onCompleteScope||this,arguments)}h.apply(c||this,f||u)},m,g,y,_;if(!l(e)){if(typeof e==="string"){e=r.selector(e)||e}if(s(e)){e=i(e)}}e=e||[];if(o<0){e=i(e);e.reverse();o*=-1}m=e.length-1;for(y=0;y<=m;y++){g={};for(_ in a){g[_]=a[_]}g.delay=p;if(y===m&&h){g.onComplete=v}d[y]=new n(e[y],t,g);p+=o}return d};n.staggerFrom=n.allFrom=function(e,t,r,i,a,o,s){r.runBackwards=true;r.immediateRender=r.immediateRender!=false;return n.staggerTo(e,t,r,i,a,o,s)};n.staggerFromTo=n.allFromTo=function(e,t,r,i,a,o,s,l){i.startAt=r;i.immediateRender=i.immediateRender!=false&&r.immediateRender!=false;return n.staggerTo(e,t,i,a,o,s,l)};n.delayedCall=function(e,t,r,i,a){return new n(t,0,{delay:e,onComplete:t,onCompleteParams:r,onCompleteScope:i,onReverseComplete:t,onReverseCompleteParams:r,onReverseCompleteScope:i,immediateRender:false,useFrames:a,overwrite:0})};n.set=function(e,t){return new n(e,0,t)};n.isTweening=function(e){return r.getTweensOf(e,true).length>0};var f=function(e,t){var i=[],n=0,a=e._first;while(a){if(a instanceof r){i[n++]=a}else{if(t){i[n++]=a}i=i.concat(f(a,t));n=i.length}a=a._next}return i},c=n.getAllTweens=function(t){return f(e._rootTimeline,t).concat(f(e._rootFramesTimeline,t))};n.killAll=function(e,r,i,n){if(r==null){r=true}if(i==null){i=true}var a=c(n!=false),o=a.length,s=r&&i&&n,l,h,u;for(u=0;u<o;u++){h=a[u];if(s||h instanceof t||(l=h.target===h.vars.onComplete)&&i||r&&!l){if(e){h.totalTime(h._reversed?0:h.totalDuration())}else{h._enabled(false,false)}}}};n.killChildTweensOf=function(e,t){if(e==null){return}var a=o.tweenLookup,h,u,f,c,p;if(typeof e==="string"){e=r.selector(e)||e}if(s(e)){e=i(e)}if(l(e)){c=e.length;while(--c>-1){n.killChildTweensOf(e[c],t)}return}h=[];for(f in a){u=a[f].target.parentNode;while(u){if(u===e){h=h.concat(a[f].tweens)}u=u.parentNode}}p=h.length;for(c=0;c<p;c++){if(t){h[c].totalTime(h[c].totalDuration())}h[c]._enabled(false,false)}};var p=function(e,r,i,n){r=r!==false;i=i!==false;n=n!==false;var a=c(n),o=r&&i&&n,s=a.length,l,h;while(--s>-1){h=a[s];if(o||h instanceof t||(l=h.target===h.vars.onComplete)&&i||r&&!l){h.paused(e)}}};n.pauseAll=function(e,t,r){p(true,e,t,r)};n.resumeAll=function(e,t,r){p(false,e,t,r)};n.globalTimeScale=function(t){var i=e._rootTimeline,n=r.ticker.time;if(!arguments.length){return i._timeScale}t=t||a;i._startTime=n-(n-i._startTime)*i._timeScale/t;i=e._rootFramesTimeline;n=r.ticker.frame;i._startTime=n-(n-i._startTime)*i._timeScale/t;i._timeScale=e._rootTimeline._timeScale=t;return t};h.progress=function(e){return!arguments.length?this._time/this.duration():this.totalTime(this.duration()*(this._yoyo&&(this._cycle&1)!==0?1-e:e)+this._cycle*(this._duration+this._repeatDelay),false)};h.totalProgress=function(e){return!arguments.length?this._totalTime/this.totalDuration():this.totalTime(this.totalDuration()*e,false)};h.time=function(e,t){if(!arguments.length){return this._time}if(this._dirty){this.totalDuration()}if(e>this._duration){e=this._duration}if(this._yoyo&&(this._cycle&1)!==0){e=this._duration-e+this._cycle*(this._duration+this._repeatDelay)}else if(this._repeat!==0){e+=this._cycle*(this._duration+this._repeatDelay)}return this.totalTime(e,t)};h.duration=function(t){if(!arguments.length){return this._duration}return e.prototype.duration.call(this,t)};h.totalDuration=function(e){if(!arguments.length){if(this._dirty){this._totalDuration=this._repeat===-1?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat;this._dirty=false}return this._totalDuration}return this._repeat===-1?this:this.duration((e-this._repeat*this._repeatDelay)/(this._repeat+1))};h.repeat=function(e){if(!arguments.length){return this._repeat}this._repeat=e;return this._uncache(true)};h.repeatDelay=function(e){if(!arguments.length){return this._repeatDelay}this._repeatDelay=e;return this._uncache(true)};h.yoyo=function(e){if(!arguments.length){return this._yoyo}this._yoyo=e;return this};return n},true);r._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(e,t,i){var n=function(e){t.call(this,e);this._labels={};this.autoRemoveChildren=this.vars.autoRemoveChildren===true;this.smoothChildTiming=this.vars.smoothChildTiming===true;this._sortChildren=true;this._onUpdate=this.vars.onUpdate;var r=this.vars,i,n;for(n in r){i=r[n];if(l(i))if(i.join("").indexOf("{self}")!==-1){r[n]=this._swapSelfInParams(i)}}if(l(r.tweens)){this.add(r.tweens,0,r.align,r.stagger)}},a=1e-10,o=i._internals,s=o.isSelector,l=o.isArray,h=o.lazyTweens,u=o.lazyRender,f=[],c=r._gsDefine.globals,p=function(e){var t={},r;for(r in e){t[r]=e[r]}return t},d=function(e,t,r,i){var n=e._timeline._totalTime;if(t||!this._forcingPlayhead){e._timeline.pause(e._startTime);if(t){t.apply(i||e._timeline,r||f)}if(this._forcingPlayhead){e._timeline.seek(n)}}},v=function(e){var t=[],r=e.length,i;for(i=0;i!==r;t.push(e[i++]));return t},m=n.prototype=new t;n.version="1.14.2";m.constructor=n;m.kill()._gc=m._forcingPlayhead=false;m.to=function(e,t,r,n){var a=r.repeat&&c.TweenMax||i;return t?this.add(new a(e,t,r),n):this.set(e,r,n)};m.from=function(e,t,r,n){return this.add((r.repeat&&c.TweenMax||i).from(e,t,r),n)};m.fromTo=function(e,t,r,n,a){var o=n.repeat&&c.TweenMax||i;return t?this.add(o.fromTo(e,t,r,n),a):this.set(e,n,a)};m.staggerTo=function(e,t,r,a,o,l,h,u){var f=new n({onComplete:l,onCompleteParams:h,onCompleteScope:u,smoothChildTiming:this.smoothChildTiming}),c;if(typeof e==="string"){e=i.selector(e)||e}e=e||[];if(s(e)){e=v(e)}a=a||0;if(a<0){e=v(e);e.reverse();a*=-1}for(c=0;c<e.length;c++){if(r.startAt){r.startAt=p(r.startAt)}f.to(e[c],t,p(r),c*a)}return this.add(f,o)};m.staggerFrom=function(e,t,r,i,n,a,o,s){r.immediateRender=r.immediateRender!=false;r.runBackwards=true;return this.staggerTo(e,t,r,i,n,a,o,s)};m.staggerFromTo=function(e,t,r,i,n,a,o,s,l){i.startAt=r;i.immediateRender=i.immediateRender!=false&&r.immediateRender!=false;return this.staggerTo(e,t,i,n,a,o,s,l)};m.call=function(e,t,r,n){return this.add(i.delayedCall(0,e,t,r),n)};m.set=function(e,t,r){r=this._parseTimeOrLabel(r,0,true);if(t.immediateRender==null){t.immediateRender=r===this._time&&!this._paused}return this.add(new i(e,0,t),r)};n.exportRoot=function(e,t){e=e||{};if(e.smoothChildTiming==null){e.smoothChildTiming=true}var r=new n(e),a=r._timeline,o,s;if(t==null){t=true}a._remove(r,true);r._startTime=0;r._rawPrevTime=r._time=r._totalTime=a._time;o=a._first;while(o){s=o._next;if(!t||!(o instanceof i&&o.target===o.vars.onComplete)){r.add(o,o._startTime-o._delay)}o=s}a.add(r,0);return r};m.add=function(r,a,o,s){var h,u,f,c,p,d;if(typeof a!=="number"){a=this._parseTimeOrLabel(a,0,true,r)}if(!(r instanceof e)){if(r instanceof Array||r&&r.push&&l(r)){o=o||"normal";s=s||0;h=a;u=r.length;for(f=0;f<u;f++){if(l(c=r[f])){c=new n({tweens:c})}this.add(c,h);if(typeof c!=="string"&&typeof c!=="function"){if(o==="sequence"){h=c._startTime+c.totalDuration()/c._timeScale}else if(o==="start"){c._startTime-=c.delay()}}h+=s}return this._uncache(true)}else if(typeof r==="string"){return this.addLabel(r,a)}else if(typeof r==="function"){r=i.delayedCall(0,r)}else{throw"Cannot add "+r+" into the timeline; it is not a tween, timeline, function, or string."}}t.prototype.add.call(this,r,a);if(this._gc||this._time===this._duration)if(!this._paused)if(this._duration<this.duration()){p=this;d=p.rawTime()>r._startTime;while(p._timeline){if(d&&p._timeline.smoothChildTiming){p.totalTime(p._totalTime,true)}else if(p._gc){p._enabled(true,false)}p=p._timeline}}return this};m.remove=function(t){if(t instanceof e){return this._remove(t,false)}else if(t instanceof Array||t&&t.push&&l(t)){var r=t.length;while(--r>-1){this.remove(t[r])}return this}else if(typeof t==="string"){return this.removeLabel(t)}return this.kill(null,t)};m._remove=function(e,r){t.prototype._remove.call(this,e,r);var i=this._last;if(!i){this._time=this._totalTime=this._duration=this._totalDuration=0}else if(this._time>i._startTime+i._totalDuration/i._timeScale){this._time=this.duration();this._totalTime=this._totalDuration}return this};m.append=function(e,t){return this.add(e,this._parseTimeOrLabel(null,t,true,e))};m.insert=m.insertMultiple=function(e,t,r,i){return this.add(e,t||0,r,i)};m.appendMultiple=function(e,t,r,i){return this.add(e,this._parseTimeOrLabel(null,t,true,e),r,i)};m.addLabel=function(e,t){this._labels[e]=this._parseTimeOrLabel(t);return this};m.addPause=function(e,t,r,i){return this.call(d,["{self}",t,r,i],this,e)};m.removeLabel=function(e){delete this._labels[e];return this};m.getLabelTime=function(e){return this._labels[e]!=null?this._labels[e]:-1};m._parseTimeOrLabel=function(t,r,i,n){var a;if(n instanceof e&&n.timeline===this){this.remove(n)}else if(n&&(n instanceof Array||n.push&&l(n))){a=n.length;while(--a>-1){if(n[a]instanceof e&&n[a].timeline===this){this.remove(n[a])}}}if(typeof r==="string"){return this._parseTimeOrLabel(r,i&&typeof t==="number"&&this._labels[r]==null?t-this.duration():0,i)}r=r||0;if(typeof t==="string"&&(isNaN(t)||this._labels[t]!=null)){a=t.indexOf("=");if(a===-1){if(this._labels[t]==null){return i?this._labels[t]=this.duration()+r:r}return this._labels[t]+r}r=parseInt(t.charAt(a-1)+"1",10)*Number(t.substr(a+1));t=a>1?this._parseTimeOrLabel(t.substr(0,a-1),0,i):this.duration()}else if(t==null){t=this.duration()}return Number(t)+r};m.seek=function(e,t){return this.totalTime(typeof e==="number"?e:this._parseTimeOrLabel(e),t!==false)};m.stop=function(){return this.paused(true)};m.gotoAndPlay=function(e,t){return this.play(e,t)};m.gotoAndStop=function(e,t){return this.pause(e,t)};m.render=function(e,t,r){if(this._gc){this._enabled(true,false)}var i=!this._dirty?this._totalDuration:this.totalDuration(),n=this._time,o=this._startTime,s=this._timeScale,l=this._paused,c,p,d,v,m;if(e>=i){this._totalTime=this._time=i;if(!this._reversed)if(!this._hasPausedChild()){p=true;v="onComplete";if(this._duration===0)if(e===0||this._rawPrevTime<0||this._rawPrevTime===a)if(this._rawPrevTime!==e&&this._first){m=true;if(this._rawPrevTime>a){v="onReverseComplete"}}}this._rawPrevTime=this._duration||!t||e||this._rawPrevTime===e?e:a;e=i+1e-4}else if(e<1e-7){this._totalTime=this._time=0;if(n!==0||this._duration===0&&this._rawPrevTime!==a&&(this._rawPrevTime>0||e<0&&this._rawPrevTime>=0)){v="onReverseComplete";p=this._reversed}if(e<0){this._active=false;if(this._rawPrevTime>=0&&this._first){m=true}this._rawPrevTime=e}else{this._rawPrevTime=this._duration||!t||e||this._rawPrevTime===e?e:a;e=0;if(!this._initted){m=true}}}else{this._totalTime=this._time=this._rawPrevTime=e}if((this._time===n||!this._first)&&!r&&!m){return}else if(!this._initted){this._initted=true}if(!this._active)if(!this._paused&&this._time!==n&&e>0){this._active=true}if(n===0)if(this.vars.onStart)if(this._time!==0)if(!t){this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||f)}if(this._time>=n){c=this._first;while(c){d=c._next;if(this._paused&&!l){break}else if(c._active||c._startTime<=this._time&&!c._paused&&!c._gc){if(!c._reversed){c.render((e-c._startTime)*c._timeScale,t,r)}else{c.render((!c._dirty?c._totalDuration:c.totalDuration())-(e-c._startTime)*c._timeScale,t,r)}}c=d}}else{c=this._last;while(c){d=c._prev;if(this._paused&&!l){break}else if(c._active||c._startTime<=n&&!c._paused&&!c._gc){if(!c._reversed){c.render((e-c._startTime)*c._timeScale,t,r)}else{c.render((!c._dirty?c._totalDuration:c.totalDuration())-(e-c._startTime)*c._timeScale,t,r)}}c=d}}if(this._onUpdate)if(!t){if(h.length){u()}this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||f)}if(v)if(!this._gc)if(o===this._startTime||s!==this._timeScale)if(this._time===0||i>=this.totalDuration()){if(p){if(h.length){u()}if(this._timeline.autoRemoveChildren){this._enabled(false,false)}this._active=false}if(!t&&this.vars[v]){this.vars[v].apply(this.vars[v+"Scope"]||this,this.vars[v+"Params"]||f)}}};m._hasPausedChild=function(){var e=this._first;while(e){if(e._paused||e instanceof n&&e._hasPausedChild()){return true}e=e._next}return false};m.getChildren=function(e,t,r,n){n=n||-9999999999;var a=[],o=this._first,s=0;while(o){if(o._startTime<n){}else if(o instanceof i){if(t!==false){a[s++]=o}}else{if(r!==false){a[s++]=o}if(e!==false){a=a.concat(o.getChildren(true,t,r));s=a.length}}o=o._next}return a};m.getTweensOf=function(e,t){var r=this._gc,n=[],a=0,o,s;if(r){this._enabled(true,true)}o=i.getTweensOf(e);s=o.length;while(--s>-1){if(o[s].timeline===this||t&&this._contains(o[s])){n[a++]=o[s]}}if(r){this._enabled(false,true)}return n};m.recent=function(){return this._recent};m._contains=function(e){var t=e.timeline;while(t){if(t===this){return true}t=t.timeline}return false};m.shiftChildren=function(e,t,r){r=r||0;var i=this._first,n=this._labels,a;while(i){if(i._startTime>=r){i._startTime+=e}i=i._next}if(t){for(a in n){if(n[a]>=r){n[a]+=e}}}return this._uncache(true)};m._kill=function(e,t){if(!e&&!t){return this._enabled(false,false)}var r=!t?this.getChildren(true,true,false):this.getTweensOf(t),i=r.length,n=false;while(--i>-1){if(r[i]._kill(e,t)){n=true}}return n};m.clear=function(e){var t=this.getChildren(false,true,true),r=t.length;this._time=this._totalTime=0;while(--r>-1){t[r]._enabled(false,false)}if(e!==false){this._labels={}}return this._uncache(true)};m.invalidate=function(){var t=this._first;while(t){t.invalidate();t=t._next}return e.prototype.invalidate.call(this)};m._enabled=function(e,r){if(e===this._gc){var i=this._first;while(i){i._enabled(e,true);i=i._next}}return t.prototype._enabled.call(this,e,r)};m.totalTime=function(t,r,i){this._forcingPlayhead=true;var n=e.prototype.totalTime.apply(this,arguments);this._forcingPlayhead=false;return n};m.duration=function(e){if(!arguments.length){if(this._dirty){this.totalDuration()}return this._duration}if(this.duration()!==0&&e!==0){this.timeScale(this._duration/e)}return this};m.totalDuration=function(e){if(!arguments.length){if(this._dirty){var t=0,r=this._last,i=999999999999,n,a;while(r){n=r._prev;if(r._dirty){r.totalDuration()}if(r._startTime>i&&this._sortChildren&&!r._paused){this.add(r,r._startTime-r._delay)}else{i=r._startTime}if(r._startTime<0&&!r._paused){t-=r._startTime;if(this._timeline.smoothChildTiming){this._startTime+=r._startTime/this._timeScale}this.shiftChildren(-r._startTime,false,-9999999999);i=0}a=r._startTime+r._totalDuration/r._timeScale;if(a>t){t=a}r=n}this._duration=this._totalDuration=t;this._dirty=false}return this._totalDuration}if(this.totalDuration()!==0)if(e!==0){this.timeScale(this._totalDuration/e)}return this};m.usesFrames=function(){var t=this._timeline;while(t._timeline){t=t._timeline}return t===e._rootFramesTimeline};m.rawTime=function(){return this._paused?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale};return n},true);r._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(e,t,r){var i=function(t){e.call(this,t);this._repeat=this.vars.repeat||0;this._repeatDelay=this.vars.repeatDelay||0;this._cycle=0;this._yoyo=this.vars.yoyo===true;this._dirty=true},n=1e-10,a=[],o=t._internals,s=o.lazyTweens,l=o.lazyRender,h=new r(null,null,1,0),u=i.prototype=new e;u.constructor=i;u.kill()._gc=false;i.version="1.14.2";u.invalidate=function(){this._yoyo=this.vars.yoyo===true;this._repeat=this.vars.repeat||0;this._repeatDelay=this.vars.repeatDelay||0;this._uncache(true);return e.prototype.invalidate.call(this)};u.addCallback=function(e,r,i,n){return this.add(t.delayedCall(0,e,i,n),r)};u.removeCallback=function(e,t){if(e){if(t==null){this._kill(null,e)}else{var r=this.getTweensOf(e,false),i=r.length,n=this._parseTimeOrLabel(t);while(--i>-1){if(r[i]._startTime===n){r[i]._enabled(false,false)}}}}return this};u.tweenTo=function(e,r){r=r||{};var i={ease:h,overwrite:r.delay?2:1,useFrames:this.usesFrames(),immediateRender:false},n,o,s;for(o in r){i[o]=r[o]}i.time=this._parseTimeOrLabel(e);n=Math.abs(Number(i.time)-this._time)/this._timeScale||.001;s=new t(this,n,i);i.onStart=function(){s.target.paused(true);if(s.vars.time!==s.target.time()&&n===s.duration()){s.duration(Math.abs(s.vars.time-s.target.time())/s.target._timeScale)}if(r.onStart){r.onStart.apply(r.onStartScope||s,r.onStartParams||a)}};return s};u.tweenFromTo=function(e,t,r){r=r||{};e=this._parseTimeOrLabel(e);r.startAt={onComplete:this.seek,onCompleteParams:[e],onCompleteScope:this};r.immediateRender=r.immediateRender!==false;var i=this.tweenTo(t,r);return i.duration(Math.abs(i.vars.time-e)/this._timeScale||.001)};u.render=function(e,t,r){if(this._gc){this._enabled(true,false)}var i=!this._dirty?this._totalDuration:this.totalDuration(),o=this._duration,h=this._time,u=this._totalTime,f=this._startTime,c=this._timeScale,p=this._rawPrevTime,d=this._paused,v=this._cycle,m,g,y,_,x,b;if(e>=i){if(!this._locked){this._totalTime=i;this._cycle=this._repeat}if(!this._reversed)if(!this._hasPausedChild()){g=true;_="onComplete";if(this._duration===0)if(e===0||p<0||p===n)if(p!==e&&this._first){x=true;if(p>n){_="onReverseComplete"}}}this._rawPrevTime=this._duration||!t||e||this._rawPrevTime===e?e:n;if(this._yoyo&&(this._cycle&1)!==0){this._time=e=0}else{this._time=o;e=o+1e-4}}else if(e<1e-7){if(!this._locked){this._totalTime=this._cycle=0}this._time=0;if(h!==0||o===0&&p!==n&&(p>0||e<0&&p>=0)&&!this._locked){_="onReverseComplete";g=this._reversed}if(e<0){this._active=false;if(p>=0&&this._first){x=true}this._rawPrevTime=e}else{this._rawPrevTime=o||!t||e||this._rawPrevTime===e?e:n;e=0;if(!this._initted){x=true}}}else{if(o===0&&p<0){x=true}this._time=this._rawPrevTime=e;if(!this._locked){this._totalTime=e;if(this._repeat!==0){b=o+this._repeatDelay;this._cycle=this._totalTime/b>>0;if(this._cycle!==0)if(this._cycle===this._totalTime/b){this._cycle--}this._time=this._totalTime-this._cycle*b;if(this._yoyo)if((this._cycle&1)!==0){this._time=o-this._time}if(this._time>o){this._time=o;e=o+1e-4}else if(this._time<0){this._time=e=0}else{e=this._time}}}}if(this._cycle!==v)if(!this._locked){var w=this._yoyo&&(v&1)!==0,T=w===(this._yoyo&&(this._cycle&1)!==0),S=this._totalTime,M=this._cycle,A=this._rawPrevTime,E=this._time;this._totalTime=v*o;if(this._cycle<v){w=!w}else{this._totalTime+=o}this._time=h;this._rawPrevTime=o===0?p-1e-4:p;this._cycle=v;this._locked=true;h=w?0:o;this.render(h,t,o===0);if(!t)if(!this._gc){if(this.vars.onRepeat){this.vars.onRepeat.apply(this.vars.onRepeatScope||this,this.vars.onRepeatParams||a)}}if(T){h=w?o+1e-4:-1e-4;this.render(h,true,false)}this._locked=false;if(this._paused&&!d){return}this._time=E;this._totalTime=S;this._cycle=M;this._rawPrevTime=A}if((this._time===h||!this._first)&&!r&&!x){if(u!==this._totalTime)if(this._onUpdate)if(!t){this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||a)}return}else if(!this._initted){this._initted=true}if(!this._active)if(!this._paused&&this._totalTime!==u&&e>0){this._active=true}if(u===0)if(this.vars.onStart)if(this._totalTime!==0)if(!t){this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||a)}if(this._time>=h){m=this._first;while(m){y=m._next;if(this._paused&&!d){break}else if(m._active||m._startTime<=this._time&&!m._paused&&!m._gc){if(!m._reversed){m.render((e-m._startTime)*m._timeScale,t,r)}else{m.render((!m._dirty?m._totalDuration:m.totalDuration())-(e-m._startTime)*m._timeScale,t,r)}}m=y}}else{m=this._last;while(m){y=m._prev;if(this._paused&&!d){break}else if(m._active||m._startTime<=h&&!m._paused&&!m._gc){if(!m._reversed){m.render((e-m._startTime)*m._timeScale,t,r)}else{m.render((!m._dirty?m._totalDuration:m.totalDuration())-(e-m._startTime)*m._timeScale,t,r)}}m=y}}if(this._onUpdate)if(!t){if(s.length){l()}this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||a)}if(_)if(!this._locked)if(!this._gc)if(f===this._startTime||c!==this._timeScale)if(this._time===0||i>=this.totalDuration()){if(g){if(s.length){l()}if(this._timeline.autoRemoveChildren){this._enabled(false,false)}this._active=false}if(!t&&this.vars[_]){this.vars[_].apply(this.vars[_+"Scope"]||this,this.vars[_+"Params"]||a)}}};u.getActive=function(e,t,r){if(e==null){e=true}if(t==null){t=true}if(r==null){r=false}var i=[],n=this.getChildren(e,t,r),a=0,o=n.length,s,l;for(s=0;s<o;s++){l=n[s];if(l.isActive()){i[a++]=l}}return i};u.getLabelAfter=function(e){if(!e)if(e!==0){e=this._time}var t=this.getLabelsArray(),r=t.length,i;for(i=0;i<r;i++){if(t[i].time>e){return t[i].name}}return null};u.getLabelBefore=function(e){if(e==null){e=this._time}var t=this.getLabelsArray(),r=t.length;while(--r>-1){if(t[r].time<e){return t[r].name}}return null};u.getLabelsArray=function(){var e=[],t=0,r;for(r in this._labels){e[t++]={time:this._labels[r],name:r}}e.sort(function(e,t){return e.time-t.time});return e};u.progress=function(e,t){return!arguments.length?this._time/this.duration():this.totalTime(this.duration()*(this._yoyo&&(this._cycle&1)!==0?1-e:e)+this._cycle*(this._duration+this._repeatDelay),t)};u.totalProgress=function(e,t){return!arguments.length?this._totalTime/this.totalDuration():this.totalTime(this.totalDuration()*e,t)};u.totalDuration=function(t){if(!arguments.length){if(this._dirty){e.prototype.totalDuration.call(this);this._totalDuration=this._repeat===-1?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat}return this._totalDuration}return this._repeat===-1?this:this.duration((t-this._repeat*this._repeatDelay)/(this._repeat+1))};u.time=function(e,t){if(!arguments.length){return this._time}if(this._dirty){this.totalDuration()}if(e>this._duration){e=this._duration}if(this._yoyo&&(this._cycle&1)!==0){e=this._duration-e+this._cycle*(this._duration+this._repeatDelay)}else if(this._repeat!==0){e+=this._cycle*(this._duration+this._repeatDelay)}return this.totalTime(e,t)};u.repeat=function(e){if(!arguments.length){return this._repeat}this._repeat=e;return this._uncache(true)};u.repeatDelay=function(e){if(!arguments.length){return this._repeatDelay}this._repeatDelay=e;return this._uncache(true)};u.yoyo=function(e){if(!arguments.length){return this._yoyo}this._yoyo=e;return this};u.currentLabel=function(e){if(!arguments.length){return this.getLabelBefore(this._time+1e-8)}return this.seek(e,true)};return i},true);(function(){var e=180/Math.PI,t=[],i=[],n=[],a={},o=function(e,t,r,i){this.a=e;this.b=t;this.c=r;this.d=i;this.da=i-e;this.ca=r-e;this.ba=t-e},s=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",l=function(e,t,r,i){var n={a:e},a={},o={},s={c:i},l=(e+t)/2,h=(t+r)/2,u=(r+i)/2,f=(l+h)/2,c=(h+u)/2,p=(c-f)/8;n.b=l+(e-l)/4;a.b=f+p;n.c=a.a=(n.b+a.b)/2;a.c=o.a=(f+c)/2;o.b=c-p;s.b=u+(i-u)/4;o.c=s.a=(o.b+s.b)/2;return[n,a,o,s]},h=function(e,r,a,o,s){var h=e.length-1,u=0,f=e[0].a,c,p,d,v,m,g,y,_,x,b,w,T,S;for(c=0;c<h;c++){m=e[u];p=m.a;d=m.d;v=e[u+1].d;if(s){w=t[c];T=i[c];S=(T+w)*r*.25/(o?.5:n[c]||.5);g=d-(d-p)*(o?r*.5:w!==0?S/w:0);y=d+(v-d)*(o?r*.5:T!==0?S/T:0);_=d-(g+((y-g)*(w*3/(w+T)+.5)/4||0))}else{g=d-(d-p)*r*.5;y=d+(v-d)*r*.5;_=d-(g+y)/2}g+=_;y+=_;m.c=x=g;if(c!==0){m.b=f}else{m.b=f=m.a+(m.c-m.a)*.6}m.da=d-p;m.ca=x-p;m.ba=f-p;if(a){b=l(p,f,x,d);e.splice(u,1,b[0],b[1],b[2],b[3]);u+=4}else{u++}f=y}m=e[u];m.b=f;m.c=f+(m.d-f)*.4;m.da=m.d-m.a;m.ca=m.c-m.a;m.ba=f-m.a;if(a){b=l(m.a,f,m.c,m.d);e.splice(u,1,b[0],b[1],b[2],b[3])}},u=function(e,r,n,a){var s=[],l,h,u,f,c,p;if(a){e=[a].concat(e);h=e.length;while(--h>-1){if(typeof(p=e[h][r])==="string")if(p.charAt(1)==="="){e[h][r]=a[r]+Number(p.charAt(0)+p.substr(2))}}}l=e.length-2;if(l<0){s[0]=new o(e[0][r],0,0,e[l<-1?0:1][r]);return s}for(h=0;h<l;h++){u=e[h][r];f=e[h+1][r];s[h]=new o(u,0,0,f);if(n){c=e[h+2][r];t[h]=(t[h]||0)+(f-u)*(f-u);i[h]=(i[h]||0)+(c-f)*(c-f)}}s[h]=new o(e[h][r],0,0,e[h+1][r]);return s},f=function(e,r,o,l,f,c){var p={},d=[],v=c||e[0],m,g,y,_,x,b,w,T;f=typeof f==="string"?","+f+",":s;if(r==null){r=1}for(g in e[0]){d.push(g)}if(e.length>1){T=e[e.length-1];w=true;m=d.length;while(--m>-1){g=d[m];if(Math.abs(v[g]-T[g])>.05){w=false;break}}if(w){e=e.concat();if(c){e.unshift(c)}e.push(e[1]);c=e[e.length-3]}}t.length=i.length=n.length=0;m=d.length;while(--m>-1){g=d[m];a[g]=f.indexOf(","+g+",")!==-1;p[g]=u(e,g,a[g],c)}m=t.length;while(--m>-1){t[m]=Math.sqrt(t[m]);i[m]=Math.sqrt(i[m])}if(!l){m=d.length;while(--m>-1){if(a[g]){y=p[d[m]];b=y.length-1;for(_=0;_<b;_++){x=y[_+1].da/i[_]+y[_].da/t[_];n[_]=(n[_]||0)+x*x}}}m=n.length;while(--m>-1){n[m]=Math.sqrt(n[m])}}m=d.length;_=o?4:1;while(--m>-1){g=d[m];y=p[g];h(y,r,o,l,a[g]);if(w){y.splice(0,_);y.splice(y.length-_,_)}}return p},c=function(e,t,r){t=t||"soft";var i={},n=t==="cubic"?3:2,a=t==="soft",s=[],l,h,u,f,c,p,d,v,m,g,y;if(a&&r){e=[r].concat(e)}if(e==null||e.length<n+1){throw"invalid Bezier data"}for(m in e[0]){s.push(m)}p=s.length;while(--p>-1){m=s[p];i[m]=c=[];g=0;v=e.length;for(d=0;d<v;d++){l=r==null?e[d][m]:typeof(y=e[d][m])==="string"&&y.charAt(1)==="="?r[m]+Number(y.charAt(0)+y.substr(2)):Number(y);if(a)if(d>1)if(d<v-1){c[g++]=(l+c[g-2])/2}c[g++]=l}v=g-n+1;g=0;for(d=0;d<v;d+=n){l=c[d];h=c[d+1];u=c[d+2];f=n===2?0:c[d+3];c[g++]=y=n===3?new o(l,h,u,f):new o(l,(2*h+l)/3,(2*h+u)/3,u)}c.length=g}return i},p=function(e,t,r){var i=1/r,n=e.length,a,o,s,l,h,u,f,c,p,d,v;while(--n>-1){d=e[n];s=d.a;l=d.d-s;h=d.c-s;u=d.b-s;a=o=0;for(c=1;c<=r;c++){f=i*c;p=1-f;a=o-(o=(f*f*l+3*p*(f*h+p*u))*f);v=n*r+c-1;t[v]=(t[v]||0)+a*a}}},d=function(e,t){t=t>>0||6;var r=[],i=[],n=0,a=0,o=t-1,s=[],l=[],h,u,f,c;for(h in e){p(e[h],r,t)}f=r.length;for(u=0;u<f;u++){n+=Math.sqrt(r[u]);c=u%t;l[c]=n;if(c===o){a+=n;c=u/t>>0;s[c]=l;i[c]=a;n=0;l=[]}}return{length:a,lengths:i,segments:s}},v=r._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.3",API:2,global:true,init:function(e,t,r){this._target=e;if(t instanceof Array){t={values:t}}this._func={};this._round={};this._props=[];this._timeRes=t.timeResolution==null?6:parseInt(t.timeResolution,10);var i=t.values||[],n={},a=i[0],o=t.autoRotate||r.vars.orientToBezier,s,l,h,u,p;this._autoRotate=o?o instanceof Array?o:[["x","y","rotation",o===true?0:Number(o)||0]]:null;for(s in a){this._props.push(s)}h=this._props.length;while(--h>-1){s=this._props[h];this._overwriteProps.push(s);l=this._func[s]=typeof e[s]==="function";n[s]=!l?parseFloat(e[s]):e[s.indexOf("set")||typeof e["get"+s.substr(3)]!=="function"?s:"get"+s.substr(3)]();if(!p)if(n[s]!==i[0][s]){p=n}}this._beziers=t.type!=="cubic"&&t.type!=="quadratic"&&t.type!=="soft"?f(i,isNaN(t.curviness)?1:t.curviness,false,t.type==="thruBasic",t.correlate,p):c(i,t.type,n);this._segCount=this._beziers[s].length;if(this._timeRes){var v=d(this._beziers,this._timeRes);this._length=v.length;this._lengths=v.lengths;this._segments=v.segments;this._l1=this._li=this._s1=this._si=0;this._l2=this._lengths[0];this._curSeg=this._segments[0];this._s2=this._curSeg[0];this._prec=1/this._curSeg.length}if(o=this._autoRotate){this._initialRotations=[];if(!(o[0]instanceof Array)){this._autoRotate=o=[o]}h=o.length;while(--h>-1){for(u=0;u<3;u++){s=o[h][u];this._func[s]=typeof e[s]==="function"?e[s.indexOf("set")||typeof e["get"+s.substr(3)]!=="function"?s:"get"+s.substr(3)]:false}s=o[h][2];this._initialRotations[h]=this._func[s]?this._func[s].call(this._target):this._target[s]}}this._startRatio=r.vars.runBackwards?1:0;return true},set:function(t){var r=this._segCount,i=this._func,n=this._target,a=t!==this._startRatio,o,s,l,h,u,f,c,p,d,v;if(!this._timeRes){o=t<0?0:t>=1?r-1:r*t>>0;f=(t-o*(1/r))*r}else{d=this._lengths;v=this._curSeg;t*=this._length;
l=this._li;if(t>this._l2&&l<r-1){p=r-1;while(l<p&&(this._l2=d[++l])<=t){}this._l1=d[l-1];this._li=l;this._curSeg=v=this._segments[l];this._s2=v[this._s1=this._si=0]}else if(t<this._l1&&l>0){while(l>0&&(this._l1=d[--l])>=t){}if(l===0&&t<this._l1){this._l1=0}else{l++}this._l2=d[l];this._li=l;this._curSeg=v=this._segments[l];this._s1=v[(this._si=v.length-1)-1]||0;this._s2=v[this._si]}o=l;t-=this._l1;l=this._si;if(t>this._s2&&l<v.length-1){p=v.length-1;while(l<p&&(this._s2=v[++l])<=t){}this._s1=v[l-1];this._si=l}else if(t<this._s1&&l>0){while(l>0&&(this._s1=v[--l])>=t){}if(l===0&&t<this._s1){this._s1=0}else{l++}this._s2=v[l];this._si=l}f=(l+(t-this._s1)/(this._s2-this._s1))*this._prec}s=1-f;l=this._props.length;while(--l>-1){h=this._props[l];u=this._beziers[h][o];c=(f*f*u.da+3*s*(f*u.ca+s*u.ba))*f+u.a;if(this._round[h]){c=Math.round(c)}if(i[h]){n[h](c)}else{n[h]=c}}if(this._autoRotate){var m=this._autoRotate,g,y,_,x,b,w,T;l=m.length;while(--l>-1){h=m[l][2];w=m[l][3]||0;T=m[l][4]===true?1:e;u=this._beziers[m[l][0]];g=this._beziers[m[l][1]];if(u&&g){u=u[o];g=g[o];y=u.a+(u.b-u.a)*f;x=u.b+(u.c-u.b)*f;y+=(x-y)*f;x+=(u.c+(u.d-u.c)*f-x)*f;_=g.a+(g.b-g.a)*f;b=g.b+(g.c-g.b)*f;_+=(b-_)*f;b+=(g.c+(g.d-g.c)*f-b)*f;c=a?Math.atan2(b-_,x-y)*T+w:this._initialRotations[l];if(i[h]){n[h](c)}else{n[h]=c}}}}}}),m=v.prototype;v.bezierThrough=f;v.cubicToQuadratic=l;v._autoCSS=true;v.quadraticToCubic=function(e,t,r){return new o(e,(2*t+e)/3,(2*t+r)/3,r)};v._cssRegister=function(){var e=r._gsDefine.globals.CSSPlugin;if(!e){return}var t=e._internals,i=t._parseToProxy,n=t._setPluginRatio,a=t.CSSPropTween;t._registerComplexSpecialProp("bezier",{parser:function(e,t,r,o,s,l){if(t instanceof Array){t={values:t}}l=new v;var h=t.values,u=h.length-1,f=[],c={},p,d,m;if(u<0){return s}for(p=0;p<=u;p++){m=i(e,h[p],o,s,l,u!==p);f[p]=m.end}for(d in t){c[d]=t[d]}c.values=f;s=new a(e,"bezier",0,0,m.pt,2);s.data=m;s.plugin=l;s.setRatio=n;if(c.autoRotate===0){c.autoRotate=true}if(c.autoRotate&&!(c.autoRotate instanceof Array)){p=c.autoRotate===true?0:Number(c.autoRotate);c.autoRotate=m.end.left!=null?[["left","top","rotation",p,false]]:m.end.x!=null?[["x","y","rotation",p,false]]:false}if(c.autoRotate){if(!o._transform){o._enableTransforms(false)}m.autoRotate=o._target._gsTransform}l._onInitTween(m.proxy,c,o._tween);return s}})};m._roundProps=function(e,t){var r=this._overwriteProps,i=r.length;while(--i>-1){if(e[r[i]]||e.bezier||e.bezierThrough){this._round[r[i]]=t}}};m._kill=function(e){var t=this._props,r,i;for(r in this._beziers){if(r in e){delete this._beziers[r];delete this._func[r];i=t.length;while(--i>-1){if(t[i]===r){t.splice(i,1)}}}}return this._super._kill.call(this,e)}})();r._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(e,t){var i=function(){e.call(this,"css");this._overwriteProps.length=0;this.setRatio=i.prototype.setRatio},n,a,o,s,l={},h=i.prototype=new e("css");h.constructor=i;i.version="1.14.2";i.API=2;i.defaultTransformPerspective=0;i.defaultSkewType="compensated";h="px";i.suffixMap={top:h,right:h,bottom:h,left:h,width:h,height:h,fontSize:h,padding:h,margin:h,perspective:h,lineHeight:""};var u=/(?:\d|\-\d|\.\d|\-\.\d)+/g,f=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,c=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,p=/(?![+-]?\d*\.?\d+|e[+-]\d+)[^0-9]/g,d=/(?:\d|\-|\+|=|#|\.)*/g,v=/opacity *= *([^)]*)/i,m=/opacity:([^;]*)/i,g=/alpha\(opacity *=.+?\)/i,y=/^(rgb|hsl)/,_=/([A-Z])/g,x=/-([a-z])/gi,b=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,w=function(e,t){return t.toUpperCase()},T=/(?:Left|Right|Width)/i,S=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,M=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,A=/,(?=[^\)]*(?:\(|$))/gi,E=Math.PI/180,C=180/Math.PI,P={},R=document,L=R.createElement("div"),k=R.createElement("img"),F=i._internals={_specialProps:l},D=navigator.userAgent,U,O,j,V,N,B,z=function(){var e=D.indexOf("Android"),t=R.createElement("div"),r;j=D.indexOf("Safari")!==-1&&D.indexOf("Chrome")===-1&&(e===-1||Number(D.substr(e+8,1))>3);N=j&&Number(D.substr(D.indexOf("Version/")+8,1))<6;V=D.indexOf("Firefox")!==-1;if(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(D)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(D)){B=parseFloat(RegExp.$1)}t.innerHTML="<a style='top:1px;opacity:.55;'>a</a>";r=t.getElementsByTagName("a")[0];return r?/^0.55/.test(r.style.opacity):false}(),I=function(e){return v.test(typeof e==="string"?e:(e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100:1},H=function(e){if(window.console){console.log(e)}},G="",W="",X=function(e,t){t=t||L;var r=t.style,i,n;if(r[e]!==undefined){return e}e=e.charAt(0).toUpperCase()+e.substr(1);i=["O","Moz","ms","Ms","Webkit"];n=5;while(--n>-1&&r[i[n]+e]===undefined){}if(n>=0){W=n===3?"ms":i[n];G="-"+W.toLowerCase()+"-";return W+e}return null},Y=R.defaultView?R.defaultView.getComputedStyle:function(){},q=i.getStyle=function(e,t,r,i,n){var a;if(!z)if(t==="opacity"){return I(e)}if(!i&&e.style[t]){a=e.style[t]}else if(r=r||Y(e)){a=r[t]||r.getPropertyValue(t)||r.getPropertyValue(t.replace(_,"-$1").toLowerCase())}else if(e.currentStyle){a=e.currentStyle[t]}return n!=null&&(!a||a==="none"||a==="auto"||a==="auto auto")?n:a},K=F.convertToPixels=function(e,r,n,a,o){if(a==="px"||!a){return n}if(a==="auto"||!n){return 0}var s=T.test(r),l=e,h=L.style,u=n<0,f,c,p;if(u){n=-n}if(a==="%"&&r.indexOf("border")!==-1){f=n/100*(s?e.clientWidth:e.clientHeight)}else{h.cssText="border:0 solid red;position:"+q(e,"position")+";line-height:0;";if(a==="%"||!l.appendChild){l=e.parentNode||R.body;c=l._gsCache;p=t.ticker.frame;if(c&&s&&c.time===p){return c.width*n/100}h[s?"width":"height"]=n+a}else{h[s?"borderLeftWidth":"borderTopWidth"]=n+a}l.appendChild(L);f=parseFloat(L[s?"offsetWidth":"offsetHeight"]);l.removeChild(L);if(s&&a==="%"&&i.cacheWidths!==false){c=l._gsCache=l._gsCache||{};c.time=p;c.width=f/n*100}if(f===0&&!o){f=K(e,r,n,a,true)}}return u?-f:f},Z=F.calculateOffset=function(e,t,r){if(q(e,"position",r)!=="absolute"){return 0}var i=t==="left"?"Left":"Top",n=q(e,"margin"+i,r);return e["offset"+i]-(K(e,t,parseFloat(n),n.replace(d,""))||0)},Q=function(e,t){var r={},i,n;if(t=t||Y(e,null)){if(i=t.length){while(--i>-1){r[t[i].replace(x,w)]=t.getPropertyValue(t[i])}}else{for(i in t){r[i]=t[i]}}}else if(t=e.currentStyle||e.style){for(i in t){if(typeof i==="string"&&r[i]===undefined){r[i.replace(x,w)]=t[i]}}}if(!z){r.opacity=I(e)}n=Ft(e,t,false);r.rotation=n.rotation;r.skewX=n.skewX;r.scaleX=n.scaleX;r.scaleY=n.scaleY;r.x=n.x;r.y=n.y;if(Mt){r.z=n.z;r.rotationX=n.rotationX;r.rotationY=n.rotationY;r.scaleZ=n.scaleZ}if(r.filters){delete r.filters}return r},$=function(e,t,r,i,n){var a={},o=e.style,s,l,h;for(l in r){if(l!=="cssText")if(l!=="length")if(isNaN(l))if(t[l]!==(s=r[l])||n&&n[l])if(l.indexOf("Origin")===-1)if(typeof s==="number"||typeof s==="string"){a[l]=s==="auto"&&(l==="left"||l==="top")?Z(e,l):(s===""||s==="auto"||s==="none")&&typeof t[l]==="string"&&t[l].replace(p,"")!==""?0:s;if(o[l]!==undefined){h=new pt(o,l,o[l],h)}}}if(i){for(l in i){if(l!=="className"){a[l]=i[l]}}}return{difs:a,firstMPT:h}},J={width:["Left","Right"],height:["Top","Bottom"]},et=["marginLeft","marginRight","marginTop","marginBottom"],tt=function(e,t,r){var i=parseFloat(t==="width"?e.offsetWidth:e.offsetHeight),n=J[t],a=n.length;r=r||Y(e,null);while(--a>-1){i-=parseFloat(q(e,"padding"+n[a],r,true))||0;i-=parseFloat(q(e,"border"+n[a]+"Width",r,true))||0}return i},rt=function(e,t){if(e==null||e===""||e==="auto"||e==="auto auto"){e="0 0"}var r=e.split(" "),i=e.indexOf("left")!==-1?"0%":e.indexOf("right")!==-1?"100%":r[0],n=e.indexOf("top")!==-1?"0%":e.indexOf("bottom")!==-1?"100%":r[1];if(n==null){n="0"}else if(n==="center"){n="50%"}if(i==="center"||isNaN(parseFloat(i))&&(i+"").indexOf("=")===-1){i="50%"}if(t){t.oxp=i.indexOf("%")!==-1;t.oyp=n.indexOf("%")!==-1;t.oxr=i.charAt(1)==="=";t.oyr=n.charAt(1)==="=";t.ox=parseFloat(i.replace(p,""));t.oy=parseFloat(n.replace(p,""))}return i+" "+n+(r.length>2?" "+r[2]:"")},it=function(e,t){return typeof e==="string"&&e.charAt(1)==="="?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2)):parseFloat(e)-parseFloat(t)},nt=function(e,t){return e==null?t:typeof e==="string"&&e.charAt(1)==="="?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2))+t:parseFloat(e)},at=function(e,t,r,i){var n=1e-6,a,o,s,l;if(e==null){l=t}else if(typeof e==="number"){l=e}else{a=360;o=e.split("_");s=Number(o[0].replace(p,""))*(e.indexOf("rad")===-1?1:C)-(e.charAt(1)==="="?0:t);if(o.length){if(i){i[r]=t+s}if(e.indexOf("short")!==-1){s=s%a;if(s!==s%(a/2)){s=s<0?s+a:s-a}}if(e.indexOf("_cw")!==-1&&s<0){s=(s+a*9999999999)%a-(s/a|0)*a}else if(e.indexOf("ccw")!==-1&&s>0){s=(s-a*9999999999)%a-(s/a|0)*a}}l=t+s}if(l<n&&l>-n){l=0}return l},ot={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},st=function(e,t,r){e=e<0?e+1:e>1?e-1:e;return(e*6<1?t+(r-t)*e*6:e<.5?r:e*3<2?t+(r-t)*(2/3-e)*6:t)*255+.5|0},lt=i.parseColor=function(e){var t,r,i,n,a,o;if(!e||e===""){return ot.black}if(typeof e==="number"){return[e>>16,e>>8&255,e&255]}if(e.charAt(e.length-1)===","){e=e.substr(0,e.length-1)}if(ot[e]){return ot[e]}if(e.charAt(0)==="#"){if(e.length===4){t=e.charAt(1),r=e.charAt(2),i=e.charAt(3);e="#"+t+t+r+r+i+i}e=parseInt(e.substr(1),16);return[e>>16,e>>8&255,e&255]}if(e.substr(0,3)==="hsl"){e=e.match(u);n=Number(e[0])%360/360;a=Number(e[1])/100;o=Number(e[2])/100;r=o<=.5?o*(a+1):o+a-o*a;t=o*2-r;if(e.length>3){e[3]=Number(e[3])}e[0]=st(n+1/3,t,r);e[1]=st(n,t,r);e[2]=st(n-1/3,t,r);return e}e=e.match(u)||ot.transparent;e[0]=Number(e[0]);e[1]=Number(e[1]);e[2]=Number(e[2]);if(e.length>3){e[3]=Number(e[3])}return e},ht="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#.+?\\b";for(h in ot){ht+="|"+h+"\\b"}ht=new RegExp(ht+")","gi");var ut=function(e,t,r,i){if(e==null){return function(e){return e}}var n=t?(e.match(ht)||[""])[0]:"",a=e.split(n).join("").match(c)||[],o=e.substr(0,e.indexOf(a[0])),s=e.charAt(e.length-1)===")"?")":"",l=e.indexOf(" ")!==-1?" ":",",h=a.length,f=h>0?a[0].replace(u,""):"",p;if(!h){return function(e){return e}}if(t){p=function(e){var t,u,d,v;if(typeof e==="number"){e+=f}else if(i&&A.test(e)){v=e.replace(A,"|").split("|");for(d=0;d<v.length;d++){v[d]=p(v[d])}return v.join(",")}t=(e.match(ht)||[n])[0];u=e.split(t).join("").match(c)||[];d=u.length;if(h>d--){while(++d<h){u[d]=r?u[(d-1)/2|0]:a[d]}}return o+u.join(l)+l+t+s+(e.indexOf("inset")!==-1?" inset":"")};return p}p=function(e){var t,n,u;if(typeof e==="number"){e+=f}else if(i&&A.test(e)){n=e.replace(A,"|").split("|");for(u=0;u<n.length;u++){n[u]=p(n[u])}return n.join(",")}t=e.match(c)||[];u=t.length;if(h>u--){while(++u<h){t[u]=r?t[(u-1)/2|0]:a[u]}}return o+t.join(l)+s};return p},ft=function(e){e=e.split(",");return function(t,r,i,n,a,o,s){var l=(r+"").split(" "),h;s={};for(h=0;h<4;h++){s[e[h]]=l[h]=l[h]||l[(h-1)/2>>0]}return n.parse(t,s,a,o)}},ct=F._setPluginRatio=function(e){this.plugin.setRatio(e);var t=this.data,r=t.proxy,i=t.firstMPT,n=1e-6,a,o,s,l;while(i){a=r[i.v];if(i.r){a=Math.round(a)}else if(a<n&&a>-n){a=0}i.t[i.p]=a;i=i._next}if(t.autoRotate){t.autoRotate.rotation=r.rotation}if(e===1){i=t.firstMPT;while(i){o=i.t;if(!o.type){o.e=o.s+o.xs0}else if(o.type===1){l=o.xs0+o.s+o.xs1;for(s=1;s<o.l;s++){l+=o["xn"+s]+o["xs"+(s+1)]}o.e=l}i=i._next}}},pt=function(e,t,r,i,n){this.t=e;this.p=t;this.v=r;this.r=n;if(i){i._prev=this;this._next=i}},dt=F._parseToProxy=function(e,t,r,i,n,a){var o=i,s={},l={},h=r._transform,u=P,f,c,p,d,v;r._transform=null;P=t;i=v=r.parse(e,t,i,n);P=u;if(a){r._transform=h;if(o){o._prev=null;if(o._prev){o._prev._next=null}}}while(i&&i!==o){if(i.type<=1){c=i.p;l[c]=i.s+i.c;s[c]=i.s;if(!a){d=new pt(i,"s",c,d,i.r);i.c=0}if(i.type===1){f=i.l;while(--f>0){p="xn"+f;c=i.p+"_"+p;l[c]=i.data[p];s[c]=i[p];if(!a){d=new pt(i,p,c,d,i.rxp[p])}}}}i=i._next}return{proxy:s,end:l,firstMPT:d,pt:v}},vt=F.CSSPropTween=function(e,t,r,i,a,o,l,h,u,f,c){this.t=e;this.p=t;this.s=r;this.c=i;this.n=l||t;if(!(e instanceof vt)){s.push(this.n)}this.r=h;this.type=o||0;if(u){this.pr=u;n=true}this.b=f===undefined?r:f;this.e=c===undefined?r+i:c;if(a){this._next=a;a._prev=this}},mt=i.parseComplex=function(e,t,r,i,n,a,o,s,l,h){r=r||a||"";o=new vt(e,t,0,0,o,h?2:1,null,false,s,r,i);i+="";var c=r.split(", ").join(",").split(" "),p=i.split(", ").join(",").split(" "),d=c.length,v=U!==false,m,g,_,x,b,w,T,S,M,E,C,P;if(i.indexOf(",")!==-1||r.indexOf(",")!==-1){c=c.join(" ").replace(A,", ").split(" ");p=p.join(" ").replace(A,", ").split(" ");d=c.length}if(d!==p.length){c=(a||"").split(" ");d=c.length}o.plugin=l;o.setRatio=h;for(m=0;m<d;m++){x=c[m];b=p[m];S=parseFloat(x);if(S||S===0){o.appendXtra("",S,it(b,S),b.replace(f,""),v&&b.indexOf("px")!==-1,true)}else if(n&&(x.charAt(0)==="#"||ot[x]||y.test(x))){P=b.charAt(b.length-1)===","?"),":")";x=lt(x);b=lt(b);M=x.length+b.length>6;if(M&&!z&&b[3]===0){o["xs"+o.l]+=o.l?" transparent":"transparent";o.e=o.e.split(p[m]).join("transparent")}else{if(!z){M=false}o.appendXtra(M?"rgba(":"rgb(",x[0],b[0]-x[0],",",true,true).appendXtra("",x[1],b[1]-x[1],",",true).appendXtra("",x[2],b[2]-x[2],M?",":P,true);if(M){x=x.length<4?1:x[3];o.appendXtra("",x,(b.length<4?1:b[3])-x,P,false)}}}else{w=x.match(u);if(!w){o["xs"+o.l]+=o.l?" "+x:x}else{T=b.match(f);if(!T||T.length!==w.length){return o}_=0;for(g=0;g<w.length;g++){C=w[g];E=x.indexOf(C,_);o.appendXtra(x.substr(_,E-_),Number(C),it(T[g],C),"",v&&x.substr(E+C.length,2)==="px",g===0);_=E+C.length}o["xs"+o.l]+=x.substr(_)}}}if(i.indexOf("=")!==-1)if(o.data){P=o.xs0+o.data.s;for(m=1;m<o.l;m++){P+=o["xs"+m]+o.data["xn"+m]}o.e=P+o["xs"+m]}if(!o.l){o.type=-1;o.xs0=o.e}return o.xfirst||o},gt=9;h=vt.prototype;h.l=h.pr=0;while(--gt>0){h["xn"+gt]=0;h["xs"+gt]=""}h.xs0="";h._next=h._prev=h.xfirst=h.data=h.plugin=h.setRatio=h.rxp=null;h.appendXtra=function(e,t,r,i,n,a){var o=this,s=o.l;o["xs"+s]+=a&&s?" "+e:e||"";if(!r)if(s!==0&&!o.plugin){o["xs"+s]+=t+(i||"");return o}o.l++;o.type=o.setRatio?2:1;o["xs"+o.l]=i||"";if(s>0){o.data["xn"+s]=t+r;o.rxp["xn"+s]=n;o["xn"+s]=t;if(!o.plugin){o.xfirst=new vt(o,"xn"+s,t,r,o.xfirst||o,0,o.n,n,o.pr);o.xfirst.xs0=0}return o}o.data={s:t+r};o.rxp={};o.s=t;o.c=r;o.r=n;return o};var yt=function(e,t){t=t||{};this.p=t.prefix?X(e)||e:e;l[e]=l[this.p]=this;this.format=t.formatter||ut(t.defaultValue,t.color,t.collapsible,t.multi);if(t.parser){this.parse=t.parser}this.clrs=t.color;this.multi=t.multi;this.keyword=t.keyword;this.dflt=t.defaultValue;this.pr=t.priority||0},_t=F._registerComplexSpecialProp=function(e,t,r){if(typeof t!=="object"){t={parser:r}}var i=e.split(","),n=t.defaultValue,a,o;r=r||[n];for(a=0;a<i.length;a++){t.prefix=a===0&&t.prefix;t.defaultValue=r[a]||n;o=new yt(i[a],t)}},xt=function(e){if(!l[e]){var t=e.charAt(0).toUpperCase()+e.substr(1)+"Plugin";_t(e,{parser:function(e,i,n,a,o,s,h){var u=(r.GreenSockGlobals||r).com.greensock.plugins[t];if(!u){H("Error: "+t+" js file not loaded.");return o}u._cssRegister();return l[n].parse(e,i,n,a,o,s,h)}})}};h=yt.prototype;h.parseComplex=function(e,t,r,i,n,a){var o=this.keyword,s,l,h,u,f,c;if(this.multi)if(A.test(r)||A.test(t)){l=t.replace(A,"|").split("|");h=r.replace(A,"|").split("|")}else if(o){l=[t];h=[r]}if(h){u=h.length>l.length?h.length:l.length;for(s=0;s<u;s++){t=l[s]=l[s]||this.dflt;r=h[s]=h[s]||this.dflt;if(o){f=t.indexOf(o);c=r.indexOf(o);if(f!==c){r=c===-1?h:l;r[s]+=" "+o}}}t=l.join(", ");r=h.join(", ")}return mt(e,this.p,t,r,this.clrs,this.dflt,i,this.pr,n,a)};h.parse=function(e,t,r,i,n,a,s){return this.parseComplex(e.style,this.format(q(e,this.p,o,false,this.dflt)),this.format(t),n,a)};i.registerSpecialProp=function(e,t,r){_t(e,{parser:function(e,i,n,a,o,s,l){var h=new vt(e,n,0,0,o,2,n,false,r);h.plugin=s;h.setRatio=t(e,i,a._tween,n);return h},priority:r})};var bt="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),wt=X("transform"),Tt=G+"transform",St=X("transformOrigin"),Mt=X("perspective")!==null,At=F.Transform=function(){this.skewY=0},Et=window.SVGElement,Ct,Pt=function(e,t,r){var i=R.createElementNS("http://www.w3.org/2000/svg",e),n=/([a-z])([A-Z])/g,a;for(a in r){i.setAttributeNS(null,a.replace(n,"$1-$2").toLowerCase(),r[a])}t.appendChild(i);return i},Rt=document.documentElement,Lt=function(){var e=B||/Android/i.test(D)&&!window.chrome,t,r,i;if(R.createElementNS&&!e){t=Pt("svg",Rt);r=Pt("rect",t,{width:100,height:50,x:100});i=r.getBoundingClientRect().left;r.style[St]="50% 50%";r.style[wt]="scale(0.5,0.5)";e=i===r.getBoundingClientRect().left;Rt.removeChild(t)}return e}(),kt=function(e,t,r){var i=e.getBBox();t=rt(t).split(" ");r.xOrigin=(t[0].indexOf("%")!==-1?parseFloat(t[0])/100*i.width:parseFloat(t[0]))+i.x;r.yOrigin=(t[1].indexOf("%")!==-1?parseFloat(t[1])/100*i.height:parseFloat(t[1]))+i.y},Ft=F.getTransform=function(e,t,r,n){if(e._gsTransform&&r&&!n){return e._gsTransform}var a=r?e._gsTransform||new At:new At,s=a.scaleX<0,l=2e-5,h=1e5,u=179.99,f=u*E,c=Mt?parseFloat(q(e,St,t,false,"0 0 0").split(" ")[2])||a.zOrigin||0:0,p=parseFloat(i.defaultTransformPerspective)||0,d,v,m,g,y,_,x,b,w,T,M,A,P;if(wt){d=q(e,Tt,t,true)}else if(e.currentStyle){d=e.currentStyle.filter.match(S);d=d&&d.length===4?[d[0].substr(4),Number(d[2].substr(4)),Number(d[1].substr(4)),d[3].substr(4),a.x||0,a.y||0].join(","):""}if(!d||d==="none"||d==="matrix(1, 0, 0, 1, 0, 0)"){a={x:0,y:0,z:0,scaleX:1,scaleY:1,scaleZ:1,skewX:0,skewY:0,perspective:p,rotation:0,rotationX:0,rotationY:0,zOrigin:0}}else{v=(d||"").match(/(?:\-|\b)[\d\-\.e]+\b/gi)||[];m=v.length;while(--m>-1){g=Number(v[m]);v[m]=(y=g-(g|=0))?(y*h+(y<0?-.5:.5)|0)/h+g:g}if(v.length===16){var R=v[8],L=v[9],k=v[10],F=v[12],D=v[13],U=v[14];if(a.zOrigin){U=-a.zOrigin;F=R*U-v[12];D=L*U-v[13];U=k*U+a.zOrigin-v[14]}if(!r||n||a.rotationX==null){var O=v[0],j=v[1],V=v[2],N=v[3],B=v[4],z=v[5],I=v[6],H=v[7],G=v[11],W=Math.atan2(I,k),X=W<-f||W>f,Y,K,Z,Q,$,J,et;a.rotationX=W*C;if(W){Q=Math.cos(-W);$=Math.sin(-W);Y=B*Q+R*$;K=z*Q+L*$;Z=I*Q+k*$;R=B*-$+R*Q;L=z*-$+L*Q;k=I*-$+k*Q;G=H*-$+G*Q;B=Y;z=K;I=Z}W=Math.atan2(R,O);a.rotationY=W*C;if(W){J=W<-f||W>f;Q=Math.cos(-W);$=Math.sin(-W);Y=O*Q-R*$;K=j*Q-L*$;Z=V*Q-k*$;L=j*$+L*Q;k=V*$+k*Q;G=N*$+G*Q;O=Y;j=K;V=Z}W=Math.atan2(j,z);a.rotation=W*C;if(W){et=W<-f||W>f;Q=Math.cos(-W);$=Math.sin(-W);O=O*Q+B*$;K=j*Q+z*$;z=j*-$+z*Q;I=V*-$+I*Q;j=K}if(et&&X){a.rotation=a.rotationX=0}else if(et&&J){a.rotation=a.rotationY=0}else if(J&&X){a.rotationY=a.rotationX=0}a.scaleX=(Math.sqrt(O*O+j*j)*h+.5|0)/h;a.scaleY=(Math.sqrt(z*z+L*L)*h+.5|0)/h;a.scaleZ=(Math.sqrt(I*I+k*k)*h+.5|0)/h;a.skewX=0;a.perspective=G?1/(G<0?-G:G):0;a.x=F;a.y=D;a.z=U}}else if((!Mt||n||!v.length||a.x!==v[4]||a.y!==v[5]||!a.rotationX&&!a.rotationY)&&!(a.x!==undefined&&q(e,"display",t)==="none")){var tt=v.length>=6,rt=tt?v[0]:1,it=v[1]||0,nt=v[2]||0,at=tt?v[3]:1;a.x=v[4]||0;a.y=v[5]||0;_=Math.sqrt(rt*rt+it*it);x=Math.sqrt(at*at+nt*nt);b=rt||it?Math.atan2(it,rt)*C:a.rotation||0;w=nt||at?Math.atan2(nt,at)*C+b:a.skewX||0;T=_-Math.abs(a.scaleX||0);M=x-Math.abs(a.scaleY||0);if(Math.abs(w)>90&&Math.abs(w)<270){if(s){_*=-1;w+=b<=0?180:-180;b+=b<=0?180:-180}else{x*=-1;w+=w<=0?180:-180}}A=(b-a.rotation)%180;P=(w-a.skewX)%180;if(a.skewX===undefined||T>l||T<-l||M>l||M<-l||A>-u&&A<u&&A*h|0!==0||P>-u&&P<u&&P*h|0!==0){a.scaleX=_;a.scaleY=x;a.rotation=b;a.skewX=w}if(Mt){a.rotationX=a.rotationY=a.z=0;a.perspective=p;a.scaleZ=1}}a.zOrigin=c;for(m in a){if(a[m]<l)if(a[m]>-l){a[m]=0}}}if(r){e._gsTransform=a}a.svg=Et&&e instanceof Et&&e.parentNode instanceof Et;if(a.svg){kt(e,q(e,St,o,false,"50% 50%")+"",a);Ct=i.useSVGTransformAttr||Lt}a.xPercent=a.yPercent=0;return a},Dt=function(e){var t=this.data,r=-t.rotation*E,i=r+t.skewX*E,n=1e5,a=(Math.cos(r)*t.scaleX*n|0)/n,o=(Math.sin(r)*t.scaleX*n|0)/n,s=(Math.sin(i)*-t.scaleY*n|0)/n,l=(Math.cos(i)*t.scaleY*n|0)/n,h=this.t.style,u=this.t.currentStyle,f,c;if(!u){return}c=o;o=-s;s=-c;f=u.filter;h.filter="";var p=this.t.offsetWidth,m=this.t.offsetHeight,g=u.position!=="absolute",y="progid:DXImageTransform.Microsoft.Matrix(M11="+a+", M12="+o+", M21="+s+", M22="+l,_=t.x+p*t.xPercent/100,x=t.y+m*t.yPercent/100,b,w;if(t.ox!=null){b=(t.oxp?p*t.ox*.01:t.ox)-p/2;w=(t.oyp?m*t.oy*.01:t.oy)-m/2;_+=b-(b*a+w*o);x+=w-(b*s+w*l)}if(!g){y+=", sizingMethod='auto expand')"}else{b=p/2;w=m/2;y+=", Dx="+(b-(b*a+w*o)+_)+", Dy="+(w-(b*s+w*l)+x)+")"}if(f.indexOf("DXImageTransform.Microsoft.Matrix(")!==-1){h.filter=f.replace(M,y)}else{h.filter=y+" "+f}if(e===0||e===1)if(a===1)if(o===0)if(s===0)if(l===1)if(!g||y.indexOf("Dx=0, Dy=0")!==-1)if(!v.test(f)||parseFloat(RegExp.$1)===100)if(f.indexOf("gradient("&&f.indexOf("Alpha"))===-1){h.removeAttribute("filter")}if(!g){var T=B<8?1:-1,S,A,C;b=t.ieOffsetX||0;w=t.ieOffsetY||0;t.ieOffsetX=Math.round((p-((a<0?-a:a)*p+(o<0?-o:o)*m))/2+_);t.ieOffsetY=Math.round((m-((l<0?-l:l)*m+(s<0?-s:s)*p))/2+x);for(gt=0;gt<4;gt++){A=et[gt];S=u[A];c=S.indexOf("px")!==-1?parseFloat(S):K(this.t,A,parseFloat(S),S.replace(d,""))||0;if(c!==t[A]){C=gt<2?-t.ieOffsetX:-t.ieOffsetY}else{C=gt<2?b-t.ieOffsetX:w-t.ieOffsetY}h[A]=(t[A]=Math.round(c-C*(gt===0||gt===2?1:T)))+"px"}}},Ut=F.set3DTransformRatio=function(e){var t=this.data,r=this.t.style,i=t.rotation*E,n=t.scaleX,a=t.scaleY,o=t.scaleZ,s=t.x,l=t.y,h=t.z,u=t.perspective,f,c,p,d,v,m,g,y,_,x,b,w,T,S,M,A,C,P,R,L,k,F,D;if(e===1||e===0)if(t.force3D==="auto")if(!t.rotationY&&!t.rotationX&&o===1&&!u&&!h){Ot.call(this,e);return}if(V){var U=1e-4;if(n<U&&n>-U){n=o=2e-5}if(a<U&&a>-U){a=o=2e-5}if(u&&!t.z&&!t.rotationX&&!t.rotationY){u=0}}if(i||t.skewX){P=Math.cos(i);R=Math.sin(i);f=P;v=R;if(t.skewX){i-=t.skewX*E;P=Math.cos(i);R=Math.sin(i);if(t.skewType==="simple"){L=Math.tan(t.skewX*E);L=Math.sqrt(1+L*L);P*=L;R*=L}}c=-R;m=P}else if(!t.rotationY&&!t.rotationX&&o===1&&!u&&!t.svg){r[wt]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) translate3d(":"translate3d(")+s+"px,"+l+"px,"+h+"px)"+(n!==1||a!==1?" scale("+n+","+a+")":"");return}else{f=m=1;c=v=0}b=1;p=d=g=y=_=x=w=T=S=0;M=u?-1/u:0;A=t.zOrigin;C=1e5;i=t.rotationY*E;if(i){P=Math.cos(i);R=Math.sin(i);_=b*-R;T=M*-R;p=f*R;g=v*R;b*=P;M*=P;f*=P;v*=P}i=t.rotationX*E;if(i){P=Math.cos(i);R=Math.sin(i);L=c*P+p*R;k=m*P+g*R;F=x*P+b*R;D=S*P+M*R;p=c*-R+p*P;g=m*-R+g*P;b=x*-R+b*P;M=S*-R+M*P;c=L;m=k;x=F;S=D}if(o!==1){p*=o;g*=o;b*=o;M*=o}if(a!==1){c*=a;m*=a;x*=a;S*=a}if(n!==1){f*=n;v*=n;_*=n;T*=n}if(A){w-=A;d=p*w;y=g*w;w=b*w+A}if(t.svg){d+=t.xOrigin-(t.xOrigin*f+t.yOrigin*c);y+=t.yOrigin-(t.xOrigin*v+t.yOrigin*m)}d=(L=(d+=s)-(d|=0))?(L*C+(L<0?-.5:.5)|0)/C+d:d;y=(L=(y+=l)-(y|=0))?(L*C+(L<0?-.5:.5)|0)/C+y:y;w=(L=(w+=h)-(w|=0))?(L*C+(L<0?-.5:.5)|0)/C+w:w;r[wt]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) matrix3d(":"matrix3d(")+[(f*C|0)/C,(v*C|0)/C,(_*C|0)/C,(T*C|0)/C,(c*C|0)/C,(m*C|0)/C,(x*C|0)/C,(S*C|0)/C,(p*C|0)/C,(g*C|0)/C,(b*C|0)/C,(M*C|0)/C,d,y,w,u?1+-w/u:1].join(",")+")"},Ot=F.set2DTransformRatio=function(e){var t=this.data,r=this.t,i=r.style,n=t.x,a=t.y,o,s,l,h,u,f,c,p,d,v,m;if((t.rotationX||t.rotationY||t.z||t.force3D===true||t.force3D==="auto"&&e!==1&&e!==0)&&!(t.svg&&Ct)&&Mt){this.setRatio=Ut;Ut.call(this,e);return}h=t.scaleX;u=t.scaleY;if(t.rotation||t.skewX||t.svg){o=t.rotation*E;s=o-t.skewX*E;l=1e5;f=Math.cos(o)*h;c=Math.sin(o)*h;p=Math.sin(s)*-u;d=Math.cos(s)*u;if(t.svg){n+=t.xOrigin-(t.xOrigin*f+t.yOrigin*p);a+=t.yOrigin-(t.xOrigin*c+t.yOrigin*d);m=1e-6;if(n<m)if(n>-m){n=0}if(a<m)if(a>-m){a=0}}v=(f*l|0)/l+","+(c*l|0)/l+","+(p*l|0)/l+","+(d*l|0)/l+","+n+","+a+")";if(t.svg&&Ct){r.setAttribute("transform","matrix("+v)}else{i[wt]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) matrix(":"matrix(")+v}}else{i[wt]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) matrix(":"matrix(")+h+",0,0,"+u+","+n+","+a+")"}};_t("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent",{parser:function(e,t,r,n,a,s,l){if(n._transform){return a}var h=n._transform=Ft(e,o,true,l.parseTransform),u=e.style,f=1e-6,c=bt.length,p=l,d={},v,m,g,y,_,x,b;if(typeof p.transform==="string"&&wt){g=L.style;g[wt]=p.transform;g.display="block";g.position="absolute";R.body.appendChild(L);v=Ft(L,null,false);R.body.removeChild(L)}else if(typeof p==="object"){v={scaleX:nt(p.scaleX!=null?p.scaleX:p.scale,h.scaleX),scaleY:nt(p.scaleY!=null?p.scaleY:p.scale,h.scaleY),scaleZ:nt(p.scaleZ,h.scaleZ),x:nt(p.x,h.x),y:nt(p.y,h.y),z:nt(p.z,h.z),xPercent:nt(p.xPercent,h.xPercent),yPercent:nt(p.yPercent,h.yPercent),perspective:nt(p.transformPerspective,h.perspective)};b=p.directionalRotation;if(b!=null){if(typeof b==="object"){for(g in b){p[g]=b[g]}}else{p.rotation=b}}if(typeof p.x==="string"&&p.x.indexOf("%")!==-1){v.x=0;v.xPercent=nt(p.x,h.xPercent)}if(typeof p.y==="string"&&p.y.indexOf("%")!==-1){v.y=0;v.yPercent=nt(p.y,h.yPercent)}v.rotation=at("rotation"in p?p.rotation:"shortRotation"in p?p.shortRotation+"_short":"rotationZ"in p?p.rotationZ:h.rotation,h.rotation,"rotation",d);if(Mt){v.rotationX=at("rotationX"in p?p.rotationX:"shortRotationX"in p?p.shortRotationX+"_short":h.rotationX||0,h.rotationX,"rotationX",d);v.rotationY=at("rotationY"in p?p.rotationY:"shortRotationY"in p?p.shortRotationY+"_short":h.rotationY||0,h.rotationY,"rotationY",d)}v.skewX=p.skewX==null?h.skewX:at(p.skewX,h.skewX);v.skewY=p.skewY==null?h.skewY:at(p.skewY,h.skewY);if(m=v.skewY-h.skewY){v.skewX+=m;v.rotation+=m}}if(Mt&&p.force3D!=null){h.force3D=p.force3D;x=true}h.skewType=p.skewType||h.skewType||i.defaultSkewType;_=h.force3D||h.z||h.rotationX||h.rotationY||v.z||v.rotationX||v.rotationY||v.perspective;if(!_&&p.scale!=null){v.scaleZ=1}while(--c>-1){r=bt[c];y=v[r]-h[r];if(y>f||y<-f||p[r]!=null||P[r]!=null){x=true;a=new vt(h,r,h[r],y,a);if(r in d){a.e=d[r]}a.xs0=0;a.plugin=s;n._overwriteProps.push(a.n)}}y=p.transformOrigin;if(y&&h.svg){kt(e,y,v);a=new vt(h,"xOrigin",h.xOrigin,v.xOrigin-h.xOrigin,a,-1,"transformOrigin");a.b=h.xOrigin;a.e=a.xs0=v.xOrigin;a=new vt(h,"yOrigin",h.yOrigin,v.yOrigin-h.yOrigin,a,-1,"transformOrigin");a.b=h.yOrigin;a.e=a.xs0=v.yOrigin;y="0px 0px"}if(y||Mt&&_&&h.zOrigin){if(wt){x=true;r=St;y=(y||q(e,r,o,false,"50% 50%"))+"";a=new vt(u,r,0,0,a,-1,"transformOrigin");a.b=u[r];a.plugin=s;if(Mt){g=h.zOrigin;y=y.split(" ");h.zOrigin=(y.length>2&&!(g!==0&&y[2]==="0px")?parseFloat(y[2]):g)||0;a.xs0=a.e=y[0]+" "+(y[1]||"50%")+" 0px";a=new vt(h,"zOrigin",0,0,a,-1,a.n);a.b=g;a.xs0=a.e=h.zOrigin}else{a.xs0=a.e=y}}else{rt(y+"",h)}}if(x){n._transformType=!(h.svg&&Ct)&&(_||this._transformType===3)?3:2}return a},prefix:true});_t("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:true,color:true,multi:true,keyword:"inset"});_t("borderRadius",{defaultValue:"0px",parser:function(e,t,r,i,n,s){t=this.format(t);var l=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],h=e.style,u,f,c,p,d,v,m,g,y,_,x,b,w,T,S,M;y=parseFloat(e.offsetWidth);_=parseFloat(e.offsetHeight);u=t.split(" ");for(f=0;f<l.length;f++){if(this.p.indexOf("border")){l[f]=X(l[f])}d=p=q(e,l[f],o,false,"0px");if(d.indexOf(" ")!==-1){p=d.split(" ");d=p[0];p=p[1]}v=c=u[f];m=parseFloat(d);b=d.substr((m+"").length);w=v.charAt(1)==="=";if(w){g=parseInt(v.charAt(0)+"1",10);v=v.substr(2);g*=parseFloat(v);x=v.substr((g+"").length-(g<0?1:0))||""}else{g=parseFloat(v);x=v.substr((g+"").length)}if(x===""){x=a[r]||b}if(x!==b){T=K(e,"borderLeft",m,b);S=K(e,"borderTop",m,b);if(x==="%"){d=T/y*100+"%";p=S/_*100+"%"}else if(x==="em"){M=K(e,"borderLeft",1,"em");d=T/M+"em";p=S/M+"em"}else{d=T+"px";p=S+"px"}if(w){v=parseFloat(d)+g+x;c=parseFloat(p)+g+x}}n=mt(h,l[f],d+" "+p,v+" "+c,false,"0px",n)}return n},prefix:true,formatter:ut("0px 0px 0px 0px",false,true)});_t("backgroundPosition",{defaultValue:"0 0",parser:function(e,t,r,i,n,a){var s="background-position",l=o||Y(e,null),h=this.format((l?B?l.getPropertyValue(s+"-x")+" "+l.getPropertyValue(s+"-y"):l.getPropertyValue(s):e.currentStyle.backgroundPositionX+" "+e.currentStyle.backgroundPositionY)||"0 0"),u=this.format(t),f,c,p,d,v,m;if(h.indexOf("%")!==-1!==(u.indexOf("%")!==-1)){m=q(e,"backgroundImage").replace(b,"");if(m&&m!=="none"){f=h.split(" ");c=u.split(" ");k.setAttribute("src",m);p=2;while(--p>-1){h=f[p];d=h.indexOf("%")!==-1;if(d!==(c[p].indexOf("%")!==-1)){v=p===0?e.offsetWidth-k.width:e.offsetHeight-k.height;f[p]=d?parseFloat(h)/100*v+"px":parseFloat(h)/v*100+"%"}}h=f.join(" ")}}return this.parseComplex(e.style,h,u,n,a)},formatter:rt});_t("backgroundSize",{defaultValue:"0 0",formatter:rt});_t("perspective",{defaultValue:"0px",prefix:true});_t("perspectiveOrigin",{defaultValue:"50% 50%",prefix:true});_t("transformStyle",{prefix:true});_t("backfaceVisibility",{prefix:true});_t("userSelect",{prefix:true});_t("margin",{parser:ft("marginTop,marginRight,marginBottom,marginLeft")});_t("padding",{parser:ft("paddingTop,paddingRight,paddingBottom,paddingLeft")});_t("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(e,t,r,i,n,a){var s,l,h;if(B<9){l=e.currentStyle;h=B<8?" ":",";s="rect("+l.clipTop+h+l.clipRight+h+l.clipBottom+h+l.clipLeft+")";t=this.format(t).split(",").join(h)}else{s=this.format(q(e,this.p,o,false,this.dflt));t=this.format(t)}return this.parseComplex(e.style,s,t,n,a)}});_t("textShadow",{defaultValue:"0px 0px 0px #999",color:true,multi:true});_t("autoRound,strictUnits",{parser:function(e,t,r,i,n){return n}});_t("border",{defaultValue:"0px solid #000",parser:function(e,t,r,i,n,a){return this.parseComplex(e.style,this.format(q(e,"borderTopWidth",o,false,"0px")+" "+q(e,"borderTopStyle",o,false,"solid")+" "+q(e,"borderTopColor",o,false,"#000")),this.format(t),n,a)},color:true,formatter:function(e){var t=e.split(" ");return t[0]+" "+(t[1]||"solid")+" "+(e.match(ht)||["#000"])[0]}});_t("borderWidth",{parser:ft("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")});_t("float,cssFloat,styleFloat",{parser:function(e,t,r,i,n,a){var o=e.style,s="cssFloat"in o?"cssFloat":"styleFloat";return new vt(o,s,0,0,n,-1,r,false,0,o[s],t)}});var jt=function(e){var t=this.t,r=t.filter||q(this.data,"filter")||"",i=this.s+this.c*e|0,n;if(i===100){if(r.indexOf("atrix(")===-1&&r.indexOf("radient(")===-1&&r.indexOf("oader(")===-1){t.removeAttribute("filter");n=!q(this.data,"filter")}else{t.filter=r.replace(g,"");n=true}}if(!n){if(this.xn1){t.filter=r=r||"alpha(opacity="+i+")"}if(r.indexOf("pacity")===-1){if(i!==0||!this.xn1){t.filter=r+" alpha(opacity="+i+")"}}else{t.filter=r.replace(v,"opacity="+i)}}};_t("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(e,t,r,i,n,a){var s=parseFloat(q(e,"opacity",o,false,"1")),l=e.style,h=r==="autoAlpha";if(typeof t==="string"&&t.charAt(1)==="="){t=(t.charAt(0)==="-"?-1:1)*parseFloat(t.substr(2))+s}if(h&&s===1&&q(e,"visibility",o)==="hidden"&&t!==0){s=0}if(z){n=new vt(l,"opacity",s,t-s,n)}else{n=new vt(l,"opacity",s*100,(t-s)*100,n);n.xn1=h?1:0;l.zoom=1;n.type=2;n.b="alpha(opacity="+n.s+")";n.e="alpha(opacity="+(n.s+n.c)+")";n.data=e;n.plugin=a;n.setRatio=jt}if(h){n=new vt(l,"visibility",0,0,n,-1,null,false,0,s!==0?"inherit":"hidden",t===0?"hidden":"inherit");n.xs0="inherit";i._overwriteProps.push(n.n);i._overwriteProps.push(r)}return n}});var Vt=function(e,t){if(t){if(e.removeProperty){if(t.substr(0,2)==="ms"){t="M"+t.substr(1)}e.removeProperty(t.replace(_,"-$1").toLowerCase())}else{e.removeAttribute(t)}}},Nt=function(e){this.t._gsClassPT=this;if(e===1||e===0){this.t.setAttribute("class",e===0?this.b:this.e);var t=this.data,r=this.t.style;while(t){if(!t.v){Vt(r,t.p)}else{r[t.p]=t.v}t=t._next}if(e===1&&this.t._gsClassPT===this){this.t._gsClassPT=null}}else if(this.t.getAttribute("class")!==this.e){this.t.setAttribute("class",this.e)}};_t("className",{parser:function(e,t,r,i,a,s,l){var h=e.getAttribute("class")||"",u=e.style.cssText,f,c,p,d,v;
a=i._classNamePT=new vt(e,r,0,0,a,2);a.setRatio=Nt;a.pr=-11;n=true;a.b=h;c=Q(e,o);p=e._gsClassPT;if(p){d={};v=p.data;while(v){d[v.p]=1;v=v._next}p.setRatio(1)}e._gsClassPT=a;a.e=t.charAt(1)!=="="?t:h.replace(new RegExp("\\s*\\b"+t.substr(2)+"\\b"),"")+(t.charAt(0)==="+"?" "+t.substr(2):"");if(i._tween._duration){e.setAttribute("class",a.e);f=$(e,c,Q(e),l,d);e.setAttribute("class",h);a.data=f.firstMPT;e.style.cssText=u;a=a.xfirst=i.parse(e,f.difs,a,s)}return a}});var Bt=function(e){if(e===1||e===0)if(this.data._totalTime===this.data._totalDuration&&this.data.data!=="isFromStart"){var t=this.t.style,r=l.transform.parse,i,n,a,o;if(this.e==="all"){t.cssText="";o=true}else{i=this.e.split(" ").join("").split(",");a=i.length;while(--a>-1){n=i[a];if(l[n]){if(l[n].parse===r){o=true}else{n=n==="transformOrigin"?St:l[n].p}}Vt(t,n)}}if(o){Vt(t,wt);if(this.t._gsTransform){delete this.t._gsTransform}}}};_t("clearProps",{parser:function(e,t,r,i,a){a=new vt(e,r,0,0,a,2);a.setRatio=Bt;a.e=t;a.pr=-10;a.data=i._tween;n=true;return a}});h="bezier,throwProps,physicsProps,physics2D".split(",");gt=h.length;while(gt--){xt(h[gt])}h=i.prototype;h._firstPT=null;h._onInitTween=function(e,t,r){if(!e.nodeType){return false}this._target=e;this._tween=r;this._vars=t;U=t.autoRound;n=false;a=t.suffixMap||i.suffixMap;o=Y(e,"");s=this._overwriteProps;var l=e.style,h,u,f,c,p,d,v,g,y;if(O)if(l.zIndex===""){h=q(e,"zIndex",o);if(h==="auto"||h===""){this._addLazySet(l,"zIndex",0)}}if(typeof t==="string"){c=l.cssText;h=Q(e,o);l.cssText=c+";"+t;h=$(e,h,Q(e)).difs;if(!z&&m.test(t)){h.opacity=parseFloat(RegExp.$1)}t=h;l.cssText=c}this._firstPT=u=this.parse(e,t,null);if(this._transformType){y=this._transformType===3;if(!wt){l.zoom=1}else if(j){O=true;if(l.zIndex===""){v=q(e,"zIndex",o);if(v==="auto"||v===""){this._addLazySet(l,"zIndex",0)}}if(N){this._addLazySet(l,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(y?"visible":"hidden"))}}f=u;while(f&&f._next){f=f._next}g=new vt(e,"transform",0,0,null,2);this._linkCSSP(g,null,f);g.setRatio=y&&Mt?Ut:wt?Ot:Dt;g.data=this._transform||Ft(e,o,true);s.pop()}if(n){while(u){d=u._next;f=c;while(f&&f.pr>u.pr){f=f._next}if(u._prev=f?f._prev:p){u._prev._next=u}else{c=u}if(u._next=f){f._prev=u}else{p=u}u=d}this._firstPT=c}return true};h.parse=function(e,t,r,i){var n=e.style,s,h,u,f,c,p,v,m,g,_;for(s in t){p=t[s];h=l[s];if(h){r=h.parse(e,p,s,this,r,i,t)}else{c=q(e,s,o)+"";g=typeof p==="string";if(s==="color"||s==="fill"||s==="stroke"||s.indexOf("Color")!==-1||g&&y.test(p)){if(!g){p=lt(p);p=(p.length>3?"rgba(":"rgb(")+p.join(",")+")"}r=mt(n,s,c,p,true,"transparent",r,0,i)}else if(g&&(p.indexOf(" ")!==-1||p.indexOf(",")!==-1)){r=mt(n,s,c,p,true,null,r,0,i)}else{u=parseFloat(c);v=u||u===0?c.substr((u+"").length):"";if(c===""||c==="auto"){if(s==="width"||s==="height"){u=tt(e,s,o);v="px"}else if(s==="left"||s==="top"){u=Z(e,s,o);v="px"}else{u=s!=="opacity"?0:1;v=""}}_=g&&p.charAt(1)==="=";if(_){f=parseInt(p.charAt(0)+"1",10);p=p.substr(2);f*=parseFloat(p);m=p.replace(d,"")}else{f=parseFloat(p);m=g?p.substr((f+"").length)||"":""}if(m===""){m=s in a?a[s]:v}p=f||f===0?(_?f+u:f)+m:t[s];if(v!==m)if(m!=="")if(f||f===0)if(u){u=K(e,s,u,v);if(m==="%"){u/=K(e,s,100,"%")/100;if(t.strictUnits!==true){c=u+"%"}}else if(m==="em"){u/=K(e,s,1,"em")}else if(m!=="px"){f=K(e,s,f,m);m="px"}if(_)if(f||f===0){p=f+u+m}}if(_){f+=u}if((u||u===0)&&(f||f===0)){r=new vt(n,s,u,f-u,r,0,s,U!==false&&(m==="px"||s==="zIndex"),0,c,p);r.xs0=m}else if(n[s]===undefined||!p&&(p+""==="NaN"||p==null)){H("invalid "+s+" tween value: "+t[s])}else{r=new vt(n,s,f||u||0,0,r,-1,s,false,0,c,p);r.xs0=p==="none"&&(s==="display"||s.indexOf("Style")!==-1)?c:p}}}if(i)if(r&&!r.plugin){r.plugin=i}}return r};h.setRatio=function(e){var t=this._firstPT,r=1e-6,i,n,a;if(e===1&&(this._tween._time===this._tween._duration||this._tween._time===0)){while(t){if(t.type!==2){t.t[t.p]=t.e}else{t.setRatio(e)}t=t._next}}else if(e||!(this._tween._time===this._tween._duration||this._tween._time===0)||this._tween._rawPrevTime===-1e-6){while(t){i=t.c*e+t.s;if(t.r){i=Math.round(i)}else if(i<r)if(i>-r){i=0}if(!t.type){t.t[t.p]=i+t.xs0}else if(t.type===1){a=t.l;if(a===2){t.t[t.p]=t.xs0+i+t.xs1+t.xn1+t.xs2}else if(a===3){t.t[t.p]=t.xs0+i+t.xs1+t.xn1+t.xs2+t.xn2+t.xs3}else if(a===4){t.t[t.p]=t.xs0+i+t.xs1+t.xn1+t.xs2+t.xn2+t.xs3+t.xn3+t.xs4}else if(a===5){t.t[t.p]=t.xs0+i+t.xs1+t.xn1+t.xs2+t.xn2+t.xs3+t.xn3+t.xs4+t.xn4+t.xs5}else{n=t.xs0+i+t.xs1;for(a=1;a<t.l;a++){n+=t["xn"+a]+t["xs"+(a+1)]}t.t[t.p]=n}}else if(t.type===-1){t.t[t.p]=t.xs0}else if(t.setRatio){t.setRatio(e)}t=t._next}}else{while(t){if(t.type!==2){t.t[t.p]=t.b}else{t.setRatio(e)}t=t._next}}};h._enableTransforms=function(e){this._transform=this._transform||Ft(this._target,o,true);this._transformType=!(this._transform.svg&&Ct)&&(e||this._transformType===3)?3:2};var zt=function(e){this.t[this.p]=this.e;this.data._linkCSSP(this,this._next,null,true)};h._addLazySet=function(e,t,r){var i=this._firstPT=new vt(e,t,0,0,this._firstPT,2);i.e=r;i.setRatio=zt;i.data=this};h._linkCSSP=function(e,t,r,i){if(e){if(t){t._prev=e}if(e._next){e._next._prev=e._prev}if(e._prev){e._prev._next=e._next}else if(this._firstPT===e){this._firstPT=e._next;i=true}if(r){r._next=e}else if(!i&&this._firstPT===null){this._firstPT=e}e._next=t;e._prev=r}return e};h._kill=function(t){var r=t,i,n,a;if(t.autoAlpha||t.alpha){r={};for(n in t){r[n]=t[n]}r.opacity=1;if(r.autoAlpha){r.visibility=1}}if(t.className&&(i=this._classNamePT)){a=i.xfirst;if(a&&a._prev){this._linkCSSP(a._prev,i._next,a._prev._prev)}else if(a===this._firstPT){this._firstPT=i._next}if(i._next){this._linkCSSP(i._next,i._next._next,a._prev)}this._classNamePT=null}return e.prototype._kill.call(this,r)};var It=function(e,t,r){var i,n,a,o;if(e.slice){n=e.length;while(--n>-1){It(e[n],t,r)}return}i=e.childNodes;n=i.length;while(--n>-1){a=i[n];o=a.type;if(a.style){t.push(Q(a));if(r){r.push(a)}}if((o===1||o===9||o===11)&&a.childNodes.length){It(a,t,r)}}};i.cascadeTo=function(e,r,i){var n=t.to(e,r,i),a=[n],o=[],s=[],l=[],h=t._internals.reservedProps,u,f,c;e=n._targets||n.target;It(e,o,l);n.render(r,true);It(e,s);n.render(0,true);n._enabled(true);u=l.length;while(--u>-1){f=$(l[u],o[u],s[u]);if(f.firstMPT){f=f.difs;for(c in i){if(h[c]){f[c]=i[c]}}a.push(t.to(l[u],r,f))}}return a};e.activate([i]);return i},true);(function(){var e=r._gsDefine.plugin({propName:"roundProps",priority:-1,API:2,init:function(e,t,r){this._tween=r;return true}}),t=e.prototype;t._onInitAllProps=function(){var e=this._tween,t=e.vars.roundProps instanceof Array?e.vars.roundProps:e.vars.roundProps.split(","),r=t.length,i={},n=e._propLookup.roundProps,a,o,s;while(--r>-1){i[t[r]]=1}r=t.length;while(--r>-1){a=t[r];o=e._firstPT;while(o){s=o._next;if(o.pg){o.t._roundProps(i,true)}else if(o.n===a){this._add(o.t,a,o.s,o.c);if(s){s._prev=o._prev}if(o._prev){o._prev._next=s}else if(e._firstPT===o){e._firstPT=s}o._next=o._prev=null;e._propLookup[a]=n}o=s}}return false};t._add=function(e,t,r,i){this._addTween(e,t,r,r+i,t,true);this._overwriteProps.push(t)}})();r._gsDefine.plugin({propName:"attr",API:2,version:"0.3.3",init:function(e,t,r){var i,n,a;if(typeof e.setAttribute!=="function"){return false}this._target=e;this._proxy={};this._start={};this._end={};for(i in t){this._start[i]=this._proxy[i]=n=e.getAttribute(i);a=this._addTween(this._proxy,i,parseFloat(n),t[i],i);this._end[i]=a?a.s+a.c:t[i];this._overwriteProps.push(i)}return true},set:function(e){this._super.setRatio.call(this,e);var t=this._overwriteProps,r=t.length,i=e===1?this._end:e?this._proxy:this._start,n;while(--r>-1){n=t[r];this._target.setAttribute(n,i[n]+"")}}});r._gsDefine.plugin({propName:"directionalRotation",version:"0.2.1",API:2,init:function(e,t,r){if(typeof t!=="object"){t={rotation:t}}this.finals={};var i=t.useRadians===true?Math.PI*2:360,n=1e-6,a,o,s,l,h,u;for(a in t){if(a!=="useRadians"){u=(t[a]+"").split("_");o=u[0];s=parseFloat(typeof e[a]!=="function"?e[a]:e[a.indexOf("set")||typeof e["get"+a.substr(3)]!=="function"?a:"get"+a.substr(3)]());l=this.finals[a]=typeof o==="string"&&o.charAt(1)==="="?s+parseInt(o.charAt(0)+"1",10)*Number(o.substr(2)):Number(o)||0;h=l-s;if(u.length){o=u.join("_");if(o.indexOf("short")!==-1){h=h%i;if(h!==h%(i/2)){h=h<0?h+i:h-i}}if(o.indexOf("_cw")!==-1&&h<0){h=(h+i*9999999999)%i-(h/i|0)*i}else if(o.indexOf("ccw")!==-1&&h>0){h=(h-i*9999999999)%i-(h/i|0)*i}}if(h>n||h<-n){this._addTween(e,a,s,s+h,a);this._overwriteProps.push(a)}}}return true},set:function(e){var t;if(e!==1){this._super.setRatio.call(this,e)}else{t=this._firstPT;while(t){if(t.f){t.t[t.p](this.finals[t.p])}else{t.t[t.p]=this.finals[t.p]}t=t._next}}}})._autoCSS=true;r._gsDefine("easing.Back",["easing.Ease"],function(e){var t=r.GreenSockGlobals||r,i=t.com.greensock,n=Math.PI*2,a=Math.PI/2,o=i._class,s=function(t,r){var i=o("easing."+t,function(){},true),n=i.prototype=new e;n.constructor=i;n.getRatio=r;return i},l=e.register||function(){},h=function(e,t,r,i,n){var a=o("easing."+e,{easeOut:new t,easeIn:new r,easeInOut:new i},true);l(a,e);return a},u=function(e,t,r){this.t=e;this.v=t;if(r){this.next=r;r.prev=this;this.c=r.v-t;this.gap=r.t-e}},f=function(t,r){var i=o("easing."+t,function(e){this._p1=e||e===0?e:1.70158;this._p2=this._p1*1.525},true),n=i.prototype=new e;n.constructor=i;n.getRatio=r;n.config=function(e){return new i(e)};return i},c=h("Back",f("BackOut",function(e){return(e=e-1)*e*((this._p1+1)*e+this._p1)+1}),f("BackIn",function(e){return e*e*((this._p1+1)*e-this._p1)}),f("BackInOut",function(e){return(e*=2)<1?.5*e*e*((this._p2+1)*e-this._p2):.5*((e-=2)*e*((this._p2+1)*e+this._p2)+2)})),p=o("easing.SlowMo",function(e,t,r){t=t||t===0?t:.7;if(e==null){e=.7}else if(e>1){e=1}this._p=e!==1?t:0;this._p1=(1-e)/2;this._p2=e;this._p3=this._p1+this._p2;this._calcEnd=r===true},true),d=p.prototype=new e,v,m,g;d.constructor=p;d.getRatio=function(e){var t=e+(.5-e)*this._p;if(e<this._p1){return this._calcEnd?1-(e=1-e/this._p1)*e:t-(e=1-e/this._p1)*e*e*e*t}else if(e>this._p3){return this._calcEnd?1-(e=(e-this._p3)/this._p1)*e:t+(e-t)*(e=(e-this._p3)/this._p1)*e*e*e}return this._calcEnd?1:t};p.ease=new p(.7,.7);d.config=p.config=function(e,t,r){return new p(e,t,r)};v=o("easing.SteppedEase",function(e){e=e||1;this._p1=1/e;this._p2=e+1},true);d=v.prototype=new e;d.constructor=v;d.getRatio=function(e){if(e<0){e=0}else if(e>=1){e=.999999999}return(this._p2*e>>0)*this._p1};d.config=v.config=function(e){return new v(e)};m=o("easing.RoughEase",function(t){t=t||{};var r=t.taper||"none",i=[],n=0,a=(t.points||20)|0,o=a,s=t.randomize!==false,l=t.clamp===true,h=t.template instanceof e?t.template:null,f=typeof t.strength==="number"?t.strength*.4:.4,c,p,d,v,m,g;while(--o>-1){c=s?Math.random():1/a*o;p=h?h.getRatio(c):c;if(r==="none"){d=f}else if(r==="out"){v=1-c;d=v*v*f}else if(r==="in"){d=c*c*f}else if(c<.5){v=c*2;d=v*v*.5*f}else{v=(1-c)*2;d=v*v*.5*f}if(s){p+=Math.random()*d-d*.5}else if(o%2){p+=d*.5}else{p-=d*.5}if(l){if(p>1){p=1}else if(p<0){p=0}}i[n++]={x:c,y:p}}i.sort(function(e,t){return e.x-t.x});g=new u(1,1,null);o=a;while(--o>-1){m=i[o];g=new u(m.x,m.y,g)}this._prev=new u(0,0,g.t!==0?g:g.next)},true);d=m.prototype=new e;d.constructor=m;d.getRatio=function(e){var t=this._prev;if(e>t.t){while(t.next&&e>=t.t){t=t.next}t=t.prev}else{while(t.prev&&e<=t.t){t=t.prev}}this._prev=t;return t.v+(e-t.t)/t.gap*t.c};d.config=function(e){return new m(e)};m.ease=new m;h("Bounce",s("BounceOut",function(e){if(e<1/2.75){return 7.5625*e*e}else if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}else if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}return 7.5625*(e-=2.625/2.75)*e+.984375}),s("BounceIn",function(e){if((e=1-e)<1/2.75){return 1-7.5625*e*e}else if(e<2/2.75){return 1-(7.5625*(e-=1.5/2.75)*e+.75)}else if(e<2.5/2.75){return 1-(7.5625*(e-=2.25/2.75)*e+.9375)}return 1-(7.5625*(e-=2.625/2.75)*e+.984375)}),s("BounceInOut",function(e){var t=e<.5;if(t){e=1-e*2}else{e=e*2-1}if(e<1/2.75){e=7.5625*e*e}else if(e<2/2.75){e=7.5625*(e-=1.5/2.75)*e+.75}else if(e<2.5/2.75){e=7.5625*(e-=2.25/2.75)*e+.9375}else{e=7.5625*(e-=2.625/2.75)*e+.984375}return t?(1-e)*.5:e*.5+.5}));h("Circ",s("CircOut",function(e){return Math.sqrt(1-(e=e-1)*e)}),s("CircIn",function(e){return-(Math.sqrt(1-e*e)-1)}),s("CircInOut",function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}));g=function(t,r,i){var a=o("easing."+t,function(e,t){this._p1=e||1;this._p2=t||i;this._p3=this._p2/n*(Math.asin(1/this._p1)||0)},true),s=a.prototype=new e;s.constructor=a;s.getRatio=r;s.config=function(e,t){return new a(e,t)};return a};h("Elastic",g("ElasticOut",function(e){return this._p1*Math.pow(2,-10*e)*Math.sin((e-this._p3)*n/this._p2)+1},.3),g("ElasticIn",function(e){return-(this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*n/this._p2))},.3),g("ElasticInOut",function(e){return(e*=2)<1?-.5*(this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*n/this._p2)):this._p1*Math.pow(2,-10*(e-=1))*Math.sin((e-this._p3)*n/this._p2)*.5+1},.45));h("Expo",s("ExpoOut",function(e){return 1-Math.pow(2,-10*e)}),s("ExpoIn",function(e){return Math.pow(2,10*(e-1))-.001}),s("ExpoInOut",function(e){return(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))}));h("Sine",s("SineOut",function(e){return Math.sin(e*a)}),s("SineIn",function(e){return-Math.cos(e*a)+1}),s("SineInOut",function(e){return-.5*(Math.cos(Math.PI*e)-1)}));o("easing.EaseLookup",{find:function(t){return e.map[t]}},true);l(t.SlowMo,"SlowMo","ease,");l(m,"RoughEase","ease,");l(v,"SteppedEase","ease,");return c},true)});if(r._gsDefine){r._gsQueue.pop()()}(function(e,r){"use strict";var i=e.GreenSockGlobals=e.GreenSockGlobals||e;if(i.TweenLite){return}var n=function(e){var t=e.split("."),r=i,n;for(n=0;n<t.length;n++){r[t[n]]=r=r[t[n]]||{}}return r},a=n("com.greensock"),o=1e-10,s=function(e){var t=[],r=e.length,i;for(i=0;i!==r;t.push(e[i++]));return t},l=function(){},h=function(){var e=Object.prototype.toString,t=e.call([]);return function(r){return r!=null&&(r instanceof Array||typeof r==="object"&&!!r.push&&e.call(r)===t)}}(),u,f,c,p,d,v={},m=function(a,o,s,l){this.sc=v[a]?v[a].sc:[];v[a]=this;this.gsClass=null;this.func=s;var h=[];this.check=function(u){var f=o.length,c=f,p,d,g,y;while(--f>-1){if((p=v[o[f]]||new m(o[f],[])).gsClass){h[f]=p.gsClass;c--}else if(u){p.sc.push(this)}}if(c===0&&s){d=("com.greensock."+a).split(".");g=d.pop();y=n(d.join("."))[g]=this.gsClass=s.apply(s,h);if(l){i[g]=y;if(typeof define==="function"&&define.amd){define((e.GreenSockAMDPath?e.GreenSockAMDPath+"/":"")+a.split(".").pop(),[],function(){return y})}else if(a===r&&typeof t!=="undefined"&&t.exports){t.exports=y}}for(f=0;f<this.sc.length;f++){this.sc[f].check()}}};this.check(true)},g=e._gsDefine=function(e,t,r,i){return new m(e,t,r,i)},y=a._class=function(e,t,r){t=t||function(){};g(e,[],function(){return t},r);return t};g.globals=i;var _=[0,0,1,1],x=[],b=y("easing.Ease",function(e,t,r,i){this._func=e;this._type=r||0;this._power=i||0;this._params=t?_.concat(t):_},true),w=b.map={},T=b.register=function(e,t,r,i){var n=t.split(","),o=n.length,s=(r||"easeIn,easeOut,easeInOut").split(","),l,h,u,f;while(--o>-1){h=n[o];l=i?y("easing."+h,null,true):a.easing[h]||{};u=s.length;while(--u>-1){f=s[u];w[h+"."+f]=w[f+h]=l[f]=e.getRatio?e:e[f]||new e}}};c=b.prototype;c._calcEnd=false;c.getRatio=function(e){if(this._func){this._params[0]=e;return this._func.apply(null,this._params)}var t=this._type,r=this._power,i=t===1?1-e:t===2?e:e<.5?e*2:(1-e)*2;if(r===1){i*=i}else if(r===2){i*=i*i}else if(r===3){i*=i*i*i}else if(r===4){i*=i*i*i*i}return t===1?1-i:t===2?i:e<.5?i/2:1-i/2};u=["Linear","Quad","Cubic","Quart","Quint,Strong"];f=u.length;while(--f>-1){c=u[f]+",Power"+f;T(new b(null,null,1,f),c,"easeOut",true);T(new b(null,null,2,f),c,"easeIn"+(f===0?",easeNone":""));T(new b(null,null,3,f),c,"easeInOut")}w.linear=a.easing.Linear.easeIn;w.swing=a.easing.Quad.easeInOut;var S=y("events.EventDispatcher",function(e){this._listeners={};this._eventTarget=e||this});c=S.prototype;c.addEventListener=function(e,t,r,i,n){n=n||0;var a=this._listeners[e],o=0,s,l;if(a==null){this._listeners[e]=a=[]}l=a.length;while(--l>-1){s=a[l];if(s.c===t&&s.s===r){a.splice(l,1)}else if(o===0&&s.pr<n){o=l+1}}a.splice(o,0,{c:t,s:r,up:i,pr:n});if(this===p&&!d){p.wake()}};c.removeEventListener=function(e,t){var r=this._listeners[e],i;if(r){i=r.length;while(--i>-1){if(r[i].c===t){r.splice(i,1);return}}}};c.dispatchEvent=function(e){var t=this._listeners[e],r,i,n;if(t){r=t.length;i=this._eventTarget;while(--r>-1){n=t[r];if(n){if(n.up){n.c.call(n.s||i,{type:e,target:i})}else{n.c.call(n.s||i)}}}}};var M=e.requestAnimationFrame,A=e.cancelAnimationFrame,E=Date.now||function(){return(new Date).getTime()},C=E();u=["ms","moz","webkit","o"];f=u.length;while(--f>-1&&!M){M=e[u[f]+"RequestAnimationFrame"];A=e[u[f]+"CancelAnimationFrame"]||e[u[f]+"CancelRequestAnimationFrame"]}y("Ticker",function(e,t){var r=this,i=E(),n=t!==false&&M,a=500,s=33,h,u,f,c,v,m=function(e){var t=E()-C,n,o;if(t>a){i+=t-s}C+=t;r.time=(C-i)/1e3;n=r.time-v;if(!h||n>0||e===true){r.frame++;v+=n+(n>=c?.004:c-n);o=true}if(e!==true){f=u(m)}if(o){r.dispatchEvent("tick")}};S.call(r);r.time=r.frame=0;r.tick=function(){m(true)};r.lagSmoothing=function(e,t){a=e||1/o;s=Math.min(t,a,0)};r.sleep=function(){if(f==null){return}if(!n||!A){clearTimeout(f)}else{A(f)}u=l;f=null;if(r===p){d=false}};r.wake=function(){if(f!==null){r.sleep()}else if(r.frame>10){C=E()-a+5}u=h===0?l:!n||!M?function(e){return setTimeout(e,(v-r.time)*1e3+1|0)}:M;if(r===p){d=true}m(2)};r.fps=function(e){if(!arguments.length){return h}h=e;c=1/(h||60);v=this.time+c;r.wake()};r.useRAF=function(e){if(!arguments.length){return n}r.sleep();n=e;r.fps(h)};r.fps(e);setTimeout(function(){if(n&&(!f||r.frame<5)){r.useRAF(false)}},1500)});c=a.Ticker.prototype=new a.events.EventDispatcher;c.constructor=a.Ticker;var P=y("core.Animation",function(e,t){this.vars=t=t||{};this._duration=this._totalDuration=e||0;this._delay=Number(t.delay)||0;this._timeScale=1;this._active=t.immediateRender===true;this.data=t.data;this._reversed=t.reversed===true;if(!G){return}if(!d){p.wake()}var r=this.vars.useFrames?H:G;r.add(this,r._time);if(this.vars.paused){this.paused(true)}});p=P.ticker=new a.Ticker;c=P.prototype;c._dirty=c._gc=c._initted=c._paused=false;c._totalTime=c._time=0;c._rawPrevTime=-1;c._next=c._last=c._onUpdate=c._timeline=c.timeline=null;c._paused=false;var R=function(){if(d&&E()-C>2e3){p.wake()}setTimeout(R,2e3)};R();c.play=function(e,t){if(e!=null){this.seek(e,t)}return this.reversed(false).paused(false)};c.pause=function(e,t){if(e!=null){this.seek(e,t)}return this.paused(true)};c.resume=function(e,t){if(e!=null){this.seek(e,t)}return this.paused(false)};c.seek=function(e,t){return this.totalTime(Number(e),t!==false)};c.restart=function(e,t){return this.reversed(false).paused(false).totalTime(e?-this._delay:0,t!==false,true)};c.reverse=function(e,t){if(e!=null){this.seek(e||this.totalDuration(),t)}return this.reversed(true).paused(false)};c.render=function(e,t,r){};c.invalidate=function(){this._time=this._totalTime=0;this._initted=this._gc=false;this._rawPrevTime=-1;if(this._gc||!this.timeline){this._enabled(true)}return this};c.isActive=function(){var e=this._timeline,t=this._startTime,r;return!e||!this._gc&&!this._paused&&e.isActive()&&(r=e.rawTime())>=t&&r<t+this.totalDuration()/this._timeScale};c._enabled=function(e,t){if(!d){p.wake()}this._gc=!e;this._active=this.isActive();if(t!==true){if(e&&!this.timeline){this._timeline.add(this,this._startTime-this._delay)}else if(!e&&this.timeline){this._timeline._remove(this,true)}}return false};c._kill=function(e,t){return this._enabled(false,false)};c.kill=function(e,t){this._kill(e,t);return this};c._uncache=function(e){var t=e?this:this.timeline;while(t){t._dirty=true;t=t.timeline}return this};c._swapSelfInParams=function(e){var t=e.length,r=e.concat();while(--t>-1){if(e[t]==="{self}"){r[t]=this}}return r};c.eventCallback=function(e,t,r,i){if((e||"").substr(0,2)==="on"){var n=this.vars;if(arguments.length===1){return n[e]}if(t==null){delete n[e]}else{n[e]=t;n[e+"Params"]=h(r)&&r.join("").indexOf("{self}")!==-1?this._swapSelfInParams(r):r;n[e+"Scope"]=i}if(e==="onUpdate"){this._onUpdate=t}}return this};c.delay=function(e){if(!arguments.length){return this._delay}if(this._timeline.smoothChildTiming){this.startTime(this._startTime+e-this._delay)}this._delay=e;return this};c.duration=function(e){if(!arguments.length){this._dirty=false;return this._duration}this._duration=this._totalDuration=e;this._uncache(true);if(this._timeline.smoothChildTiming)if(this._time>0)if(this._time<this._duration)if(e!==0){this.totalTime(this._totalTime*(e/this._duration),true)}return this};c.totalDuration=function(e){this._dirty=false;return!arguments.length?this._totalDuration:this.duration(e)};c.time=function(e,t){if(!arguments.length){return this._time}if(this._dirty){this.totalDuration()}return this.totalTime(e>this._duration?this._duration:e,t)};c.totalTime=function(e,t,r){if(!d){p.wake()}if(!arguments.length){return this._totalTime}if(this._timeline){if(e<0&&!r){e+=this.totalDuration()}if(this._timeline.smoothChildTiming){if(this._dirty){this.totalDuration()}var i=this._totalDuration,n=this._timeline;if(e>i&&!r){e=i}this._startTime=(this._paused?this._pauseTime:n._time)-(!this._reversed?e:i-e)/this._timeScale;if(!n._dirty){this._uncache(false)}if(n._timeline){while(n._timeline){if(n._timeline._time!==(n._startTime+n._totalTime)/n._timeScale){n.totalTime(n._totalTime,true)}n=n._timeline}}}if(this._gc){this._enabled(true,false)}if(this._totalTime!==e||this._duration===0){this.render(e,t,false);if(U.length){W()}}}return this};c.progress=c.totalProgress=function(e,t){return!arguments.length?this._time/this.duration():this.totalTime(this.duration()*e,t)};c.startTime=function(e){if(!arguments.length){return this._startTime}if(e!==this._startTime){this._startTime=e;if(this.timeline)if(this.timeline._sortChildren){this.timeline.add(this,e-this._delay)}}return this};c.endTime=function(e){return this._startTime+(e!=false?this.totalDuration():this.duration())/this._timeScale};c.timeScale=function(e){if(!arguments.length){return this._timeScale}e=e||o;if(this._timeline&&this._timeline.smoothChildTiming){var t=this._pauseTime,r=t||t===0?t:this._timeline.totalTime();this._startTime=r-(r-this._startTime)*this._timeScale/e}this._timeScale=e;return this._uncache(false)};c.reversed=function(e){if(!arguments.length){return this._reversed}if(e!=this._reversed){this._reversed=e;this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,true)}return this};c.paused=function(e){if(!arguments.length){return this._paused}if(e!=this._paused)if(this._timeline){if(!d&&!e){p.wake()}var t=this._timeline,r=t.rawTime(),i=r-this._pauseTime;if(!e&&t.smoothChildTiming){this._startTime+=i;this._uncache(false)}this._pauseTime=e?r:null;this._paused=e;this._active=this.isActive();if(!e&&i!==0&&this._initted&&this.duration()){this.render(t.smoothChildTiming?this._totalTime:(r-this._startTime)/this._timeScale,true,true)}}if(this._gc&&!e){this._enabled(true,false)}return this};var L=y("core.SimpleTimeline",function(e){P.call(this,0,e);this.autoRemoveChildren=this.smoothChildTiming=true});c=L.prototype=new P;c.constructor=L;c.kill()._gc=false;c._first=c._last=c._recent=null;c._sortChildren=false;c.add=c.insert=function(e,t,r,i){var n,a;e._startTime=Number(t||0)+e._delay;if(e._paused)if(this!==e._timeline){e._pauseTime=e._startTime+(this.rawTime()-e._startTime)/e._timeScale}if(e.timeline){e.timeline._remove(e,true)}e.timeline=e._timeline=this;if(e._gc){e._enabled(true,true)}n=this._last;if(this._sortChildren){a=e._startTime;while(n&&n._startTime>a){n=n._prev}}if(n){e._next=n._next;n._next=e}else{e._next=this._first;this._first=e}if(e._next){e._next._prev=e}else{this._last=e}e._prev=n;this._recent=e;if(this._timeline){this._uncache(true)}return this};c._remove=function(e,t){if(e.timeline===this){if(!t){e._enabled(false,true)}if(e._prev){e._prev._next=e._next}else if(this._first===e){this._first=e._next}if(e._next){e._next._prev=e._prev}else if(this._last===e){this._last=e._prev}e._next=e._prev=e.timeline=null;if(e===this._recent){this._recent=this._last}if(this._timeline){this._uncache(true)}}return this};c.render=function(e,t,r){var i=this._first,n;this._totalTime=this._time=this._rawPrevTime=e;while(i){n=i._next;if(i._active||e>=i._startTime&&!i._paused){if(!i._reversed){i.render((e-i._startTime)*i._timeScale,t,r)}else{i.render((!i._dirty?i._totalDuration:i.totalDuration())-(e-i._startTime)*i._timeScale,t,r)}}i=n}};c.rawTime=function(){if(!d){p.wake()}return this._totalTime};var k=y("TweenLite",function(t,r,i){P.call(this,r,i);this.render=k.prototype.render;if(t==null){throw"Cannot tween a null target."}this.target=t=typeof t!=="string"?t:k.selector(t)||t;var n=t.jquery||t.length&&t!==e&&t[0]&&(t[0]===e||t[0].nodeType&&t[0].style&&!t.nodeType),a=this.vars.overwrite,l,u,f;this._overwrite=a=a==null?I[k.defaultOverwrite]:typeof a==="number"?a>>0:I[a];if((n||t instanceof Array||t.push&&h(t))&&typeof t[0]!=="number"){this._targets=f=s(t);this._propLookup=[];this._siblings=[];for(l=0;l<f.length;l++){u=f[l];if(!u){f.splice(l--,1);continue}else if(typeof u==="string"){u=f[l--]=k.selector(u);if(typeof u==="string"){f.splice(l+1,1)}continue}else if(u.length&&u!==e&&u[0]&&(u[0]===e||u[0].nodeType&&u[0].style&&!u.nodeType)){f.splice(l--,1);this._targets=f=f.concat(s(u));continue}this._siblings[l]=X(u,this,false);if(a===1)if(this._siblings[l].length>1){q(u,this,null,1,this._siblings[l])}}}else{this._propLookup={};this._siblings=X(t,this,false);if(a===1)if(this._siblings.length>1){q(t,this,null,1,this._siblings)}}if(this.vars.immediateRender||r===0&&this._delay===0&&this.vars.immediateRender!==false){this._time=-o;this.render(-this._delay)}},true),F=function(t){return t&&t.length&&t!==e&&t[0]&&(t[0]===e||t[0].nodeType&&t[0].style&&!t.nodeType)},D=function(e,t){var r={},i;for(i in e){if(!z[i]&&(!(i in t)||i==="transform"||i==="x"||i==="y"||i==="width"||i==="height"||i==="className"||i==="border")&&(!V[i]||V[i]&&V[i]._autoCSS)){r[i]=e[i];delete e[i]}}e.css=r};c=k.prototype=new P;c.constructor=k;c.kill()._gc=false;c.ratio=0;c._firstPT=c._targets=c._overwrittenProps=c._startAt=null;c._notifyPluginsOfEnabled=c._lazy=false;k.version="1.14.2";k.defaultEase=c._ease=new b(null,null,1,1);k.defaultOverwrite="auto";k.ticker=p;k.autoSleep=true;k.lagSmoothing=function(e,t){p.lagSmoothing(e,t)};k.selector=e.$||e.jQuery||function(t){var r=e.$||e.jQuery;if(r){k.selector=r;return r(t)}return typeof document==="undefined"?t:document.querySelectorAll?document.querySelectorAll(t):document.getElementById(t.charAt(0)==="#"?t.substr(1):t)};var U=[],O={},j=k._internals={isArray:h,isSelector:F,lazyTweens:U},V=k._plugins={},N=j.tweenLookup={},B=0,z=j.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1},I={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},H=P._rootFramesTimeline=new L,G=P._rootTimeline=new L,W=j.lazyRender=function(){var e=U.length,t;O={};while(--e>-1){t=U[e];if(t&&t._lazy!==false){t.render(t._lazy[0],t._lazy[1],true);t._lazy=false}}U.length=0};G._startTime=p.time;H._startTime=p.frame;G._active=H._active=true;setTimeout(W,1);P._updateRoot=k.render=function(){var e,t,r;if(U.length){W()}G.render((p.time-G._startTime)*G._timeScale,false,false);H.render((p.frame-H._startTime)*H._timeScale,false,false);if(U.length){W()}if(!(p.frame%120)){for(r in N){t=N[r].tweens;e=t.length;while(--e>-1){if(t[e]._gc){t.splice(e,1)}}if(t.length===0){delete N[r]}}r=G._first;if(!r||r._paused)if(k.autoSleep&&!H._first&&p._listeners.tick.length===1){while(r&&r._paused){r=r._next}if(!r){p.sleep()}}}};p.addEventListener("tick",P._updateRoot);var X=function(e,t,r){var i=e._gsTweenID,n,a;if(!N[i||(e._gsTweenID=i="t"+B++)]){N[i]={target:e,tweens:[]}}if(t){n=N[i].tweens;n[a=n.length]=t;if(r){while(--a>-1){if(n[a]===t){n.splice(a,1)}}}}return N[i].tweens},Y=function(e,t,r,i){var n=e.vars.onOverwrite,a,o;if(n){a=n(e,t,r,i)}n=k.onOverwrite;if(n){o=n(e,t,r,i)}return a!==false&&o!==false},q=function(e,t,r,i,n){var a,s,l,h;if(i===1||i>=4){h=n.length;for(a=0;a<h;a++){if((l=n[a])!==t){if(!l._gc){if(Y(l,t)&&l._enabled(false,false)){s=true}}}else if(i===5){break}}return s}var u=t._startTime+o,f=[],c=0,p=t._duration===0,d;a=n.length;while(--a>-1){if((l=n[a])===t||l._gc||l._paused){}else if(l._timeline!==t._timeline){d=d||K(t,0,p);if(K(l,d,p)===0){f[c++]=l}}else if(l._startTime<=u)if(l._startTime+l.totalDuration()/l._timeScale>u)if(!((p||!l._initted)&&u-l._startTime<=2e-10)){f[c++]=l}}a=c;while(--a>-1){l=f[a];if(i===2)if(l._kill(r,e,t)){s=true}if(i!==2||!l._firstPT&&l._initted){if(i!==2&&!Y(l,t)){continue}if(l._enabled(false,false)){s=true}}}return s},K=function(e,t,r){var i=e._timeline,n=i._timeScale,a=e._startTime;while(i._timeline){a+=i._startTime;n*=i._timeScale;if(i._paused){return-100}i=i._timeline}a/=n;return a>t?a-t:r&&a===t||!e._initted&&a-t<2*o?o:(a+=e.totalDuration()/e._timeScale/n)>t+o?0:a-t-o};c._init=function(){var e=this.vars,t=this._overwrittenProps,r=this._duration,i=!!e.immediateRender,n=e.ease,a,o,s,l,h;if(e.startAt){if(this._startAt){this._startAt.render(-1,true);this._startAt.kill()}h={};for(l in e.startAt){h[l]=e.startAt[l]}h.overwrite=false;h.immediateRender=true;h.lazy=i&&e.lazy!==false;h.startAt=h.delay=null;this._startAt=k.to(this.target,0,h);if(i){if(this._time>0){this._startAt=null}else if(r!==0){return}}}else if(e.runBackwards&&r!==0){if(this._startAt){this._startAt.render(-1,true);this._startAt.kill();this._startAt=null}else{if(this._time!==0){i=false}s={};for(l in e){if(!z[l]||l==="autoCSS"){s[l]=e[l]}}s.overwrite=0;s.data="isFromStart";s.lazy=i&&e.lazy!==false;s.immediateRender=i;this._startAt=k.to(this.target,0,s);if(!i){this._startAt._init();this._startAt._enabled(false);if(this.vars.immediateRender){this._startAt=null}}else if(this._time===0){return}}}this._ease=n=!n?k.defaultEase:n instanceof b?n:typeof n==="function"?new b(n,e.easeParams):w[n]||k.defaultEase;if(e.easeParams instanceof Array&&n.config){this._ease=n.config.apply(n,e.easeParams)}this._easeType=this._ease._type;this._easePower=this._ease._power;this._firstPT=null;if(this._targets){a=this._targets.length;while(--a>-1){if(this._initProps(this._targets[a],this._propLookup[a]={},this._siblings[a],t?t[a]:null)){o=true}}}else{o=this._initProps(this.target,this._propLookup,this._siblings,t)}if(o){k._onPluginEvent("_onInitAllProps",this)}if(t)if(!this._firstPT)if(typeof this.target!=="function"){this._enabled(false,false)}if(e.runBackwards){s=this._firstPT;while(s){s.s+=s.c;s.c=-s.c;s=s._next}}this._onUpdate=e.onUpdate;this._initted=true};c._initProps=function(t,r,i,n){var a,o,s,l,u,f;if(t==null){return false}if(O[t._gsTweenID]){W()}if(!this.vars.css)if(t.style)if(t!==e&&t.nodeType)if(V.css)if(this.vars.autoCSS!==false){D(this.vars,t)}for(a in this.vars){f=this.vars[a];if(z[a]){if(f)if(f instanceof Array||f.push&&h(f))if(f.join("").indexOf("{self}")!==-1){this.vars[a]=f=this._swapSelfInParams(f,this)}}else if(V[a]&&(l=new V[a])._onInitTween(t,this.vars[a],this)){this._firstPT=u={_next:this._firstPT,t:l,p:"setRatio",s:0,c:1,f:true,n:a,pg:true,pr:l._priority};o=l._overwriteProps.length;while(--o>-1){r[l._overwriteProps[o]]=this._firstPT}if(l._priority||l._onInitAllProps){s=true}if(l._onDisable||l._onEnable){this._notifyPluginsOfEnabled=true}}else{this._firstPT=r[a]=u={_next:this._firstPT,t:t,p:a,f:typeof t[a]==="function",n:a,pg:false,pr:0};u.s=!u.f?parseFloat(t[a]):t[a.indexOf("set")||typeof t["get"+a.substr(3)]!=="function"?a:"get"+a.substr(3)]();u.c=typeof f==="string"&&f.charAt(1)==="="?parseInt(f.charAt(0)+"1",10)*Number(f.substr(2)):Number(f)-u.s||0
}if(u)if(u._next){u._next._prev=u}}if(n)if(this._kill(n,t)){return this._initProps(t,r,i,n)}if(this._overwrite>1)if(this._firstPT)if(i.length>1)if(q(t,this,r,this._overwrite,i)){this._kill(r,t);return this._initProps(t,r,i,n)}if(this._firstPT)if(this.vars.lazy!==false&&this._duration||this.vars.lazy&&!this._duration){O[t._gsTweenID]=true}return s};c.render=function(e,t,r){var i=this._time,n=this._duration,a=this._rawPrevTime,s,l,h,u;if(e>=n){this._totalTime=this._time=n;this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1;if(!this._reversed){s=true;l="onComplete"}if(n===0)if(this._initted||!this.vars.lazy||r){if(this._startTime===this._timeline._duration){e=0}if(e===0||a<0||a===o)if(a!==e){r=true;if(a>o){l="onReverseComplete"}}this._rawPrevTime=u=!t||e||a===e?e:o}}else if(e<1e-7){this._totalTime=this._time=0;this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0;if(i!==0||n===0&&a>0&&a!==o){l="onReverseComplete";s=this._reversed}if(e<0){this._active=false;if(n===0)if(this._initted||!this.vars.lazy||r){if(a>=0){r=true}this._rawPrevTime=u=!t||e||a===e?e:o}}if(!this._initted){r=true}}else{this._totalTime=this._time=e;if(this._easeType){var f=e/n,c=this._easeType,p=this._easePower;if(c===1||c===3&&f>=.5){f=1-f}if(c===3){f*=2}if(p===1){f*=f}else if(p===2){f*=f*f}else if(p===3){f*=f*f*f}else if(p===4){f*=f*f*f*f}if(c===1){this.ratio=1-f}else if(c===2){this.ratio=f}else if(e/n<.5){this.ratio=f/2}else{this.ratio=1-f/2}}else{this.ratio=this._ease.getRatio(e/n)}}if(this._time===i&&!r){return}else if(!this._initted){this._init();if(!this._initted||this._gc){return}else if(!r&&this._firstPT&&(this.vars.lazy!==false&&this._duration||this.vars.lazy&&!this._duration)){this._time=this._totalTime=i;this._rawPrevTime=a;U.push(this);this._lazy=[e,t];return}if(this._time&&!s){this.ratio=this._ease.getRatio(this._time/n)}else if(s&&this._ease._calcEnd){this.ratio=this._ease.getRatio(this._time===0?0:1)}}if(this._lazy!==false){this._lazy=false}if(!this._active)if(!this._paused&&this._time!==i&&e>=0){this._active=true}if(i===0){if(this._startAt){if(e>=0){this._startAt.render(e,t,r)}else if(!l){l="_dummyGS"}}if(this.vars.onStart)if(this._time!==0||n===0)if(!t){this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||x)}}h=this._firstPT;while(h){if(h.f){h.t[h.p](h.c*this.ratio+h.s)}else{h.t[h.p]=h.c*this.ratio+h.s}h=h._next}if(this._onUpdate){if(e<0)if(this._startAt&&e!==-1e-4){this._startAt.render(e,t,r)}if(!t)if(this._time!==i||s){this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||x)}}if(l)if(!this._gc||r){if(e<0&&this._startAt&&!this._onUpdate&&e!==-1e-4){this._startAt.render(e,t,r)}if(s){if(this._timeline.autoRemoveChildren){this._enabled(false,false)}this._active=false}if(!t&&this.vars[l]){this.vars[l].apply(this.vars[l+"Scope"]||this,this.vars[l+"Params"]||x)}if(n===0&&this._rawPrevTime===o&&u!==o){this._rawPrevTime=0}}};c._kill=function(e,t,r){if(e==="all"){e=null}if(e==null)if(t==null||t===this.target){this._lazy=false;return this._enabled(false,false)}t=typeof t!=="string"?t||this._targets||this.target:k.selector(t)||t;var i,n,a,o,s,l,u,f,c;if((h(t)||F(t))&&typeof t[0]!=="number"){i=t.length;while(--i>-1){if(this._kill(e,t[i])){l=true}}}else{if(this._targets){i=this._targets.length;while(--i>-1){if(t===this._targets[i]){s=this._propLookup[i]||{};this._overwrittenProps=this._overwrittenProps||[];n=this._overwrittenProps[i]=e?this._overwrittenProps[i]||{}:"all";break}}}else if(t!==this.target){return false}else{s=this._propLookup;n=this._overwrittenProps=e?this._overwrittenProps||{}:"all"}if(s){u=e||s;f=e!==n&&n!=="all"&&e!==s&&(typeof e!=="object"||!e._tempKill);if(r&&(k.onOverwrite||this.vars.onOverwrite)){for(a in u){if(s[a]){if(!c){c=[]}c.push(a)}}if(!Y(this,r,t,c)){return false}}for(a in u){if(o=s[a]){if(o.pg&&o.t._kill(u)){l=true}if(!o.pg||o.t._overwriteProps.length===0){if(o._prev){o._prev._next=o._next}else if(o===this._firstPT){this._firstPT=o._next}if(o._next){o._next._prev=o._prev}o._next=o._prev=null}delete s[a]}if(f){n[a]=1}}if(!this._firstPT&&this._initted){this._enabled(false,false)}}}return l};c.invalidate=function(){if(this._notifyPluginsOfEnabled){k._onPluginEvent("_onDisable",this)}this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null;this._notifyPluginsOfEnabled=this._active=this._lazy=false;this._propLookup=this._targets?{}:[];P.prototype.invalidate.call(this);if(this.vars.immediateRender){this._time=-o;this.render(-this._delay)}return this};c._enabled=function(e,t){if(!d){p.wake()}if(e&&this._gc){var r=this._targets,i;if(r){i=r.length;while(--i>-1){this._siblings[i]=X(r[i],this,true)}}else{this._siblings=X(this.target,this,true)}}P.prototype._enabled.call(this,e,t);if(this._notifyPluginsOfEnabled)if(this._firstPT){return k._onPluginEvent(e?"_onEnable":"_onDisable",this)}return false};k.to=function(e,t,r){return new k(e,t,r)};k.from=function(e,t,r){r.runBackwards=true;r.immediateRender=r.immediateRender!=false;return new k(e,t,r)};k.fromTo=function(e,t,r,i){i.startAt=r;i.immediateRender=i.immediateRender!=false&&r.immediateRender!=false;return new k(e,t,i)};k.delayedCall=function(e,t,r,i,n){return new k(t,0,{delay:e,onComplete:t,onCompleteParams:r,onCompleteScope:i,onReverseComplete:t,onReverseCompleteParams:r,onReverseCompleteScope:i,immediateRender:false,useFrames:n,overwrite:0})};k.set=function(e,t){return new k(e,0,t)};k.getTweensOf=function(e,t){if(e==null){return[]}e=typeof e!=="string"?e:k.selector(e)||e;var r,i,n,a;if((h(e)||F(e))&&typeof e[0]!=="number"){r=e.length;i=[];while(--r>-1){i=i.concat(k.getTweensOf(e[r],t))}r=i.length;while(--r>-1){a=i[r];n=r;while(--n>-1){if(a===i[n]){i.splice(r,1)}}}}else{i=X(e).concat();r=i.length;while(--r>-1){if(i[r]._gc||t&&!i[r].isActive()){i.splice(r,1)}}}return i};k.killTweensOf=k.killDelayedCallsTo=function(e,t,r){if(typeof t==="object"){r=t;t=false}var i=k.getTweensOf(e,t),n=i.length;while(--n>-1){i[n]._kill(r,e)}};var Z=y("plugins.TweenPlugin",function(e,t){this._overwriteProps=(e||"").split(",");this._propName=this._overwriteProps[0];this._priority=t||0;this._super=Z.prototype},true);c=Z.prototype;Z.version="1.10.1";Z.API=2;c._firstPT=null;c._addTween=function(e,t,r,i,n,a){var o,s;if(i!=null&&(o=typeof i==="number"||i.charAt(1)!=="="?Number(i)-r:parseInt(i.charAt(0)+"1",10)*Number(i.substr(2)))){this._firstPT=s={_next:this._firstPT,t:e,p:t,s:r,c:o,f:typeof e[t]==="function",n:n||t,r:a};if(s._next){s._next._prev=s}return s}};c.setRatio=function(e){var t=this._firstPT,r=1e-6,i;while(t){i=t.c*e+t.s;if(t.r){i=Math.round(i)}else if(i<r)if(i>-r){i=0}if(t.f){t.t[t.p](i)}else{t.t[t.p]=i}t=t._next}};c._kill=function(e){var t=this._overwriteProps,r=this._firstPT,i;if(e[this._propName]!=null){this._overwriteProps=[]}else{i=t.length;while(--i>-1){if(e[t[i]]!=null){t.splice(i,1)}}}while(r){if(e[r.n]!=null){if(r._next){r._next._prev=r._prev}if(r._prev){r._prev._next=r._next;r._prev=null}else if(this._firstPT===r){this._firstPT=r._next}}r=r._next}return false};c._roundProps=function(e,t){var r=this._firstPT;while(r){if(e[this._propName]||r.n!=null&&e[r.n.split(this._propName+"_").join("")]){r.r=t}r=r._next}};k._onPluginEvent=function(e,t){var r=t._firstPT,i,n,a,o,s;if(e==="_onInitAllProps"){while(r){s=r._next;n=a;while(n&&n.pr>r.pr){n=n._next}if(r._prev=n?n._prev:o){r._prev._next=r}else{a=r}if(r._next=n){n._prev=r}else{o=r}r=s}r=t._firstPT=a}while(r){if(r.pg)if(typeof r.t[e]==="function")if(r.t[e]()){i=true}r=r._next}return i};Z.activate=function(e){var t=e.length;while(--t>-1){if(e[t].API===Z.API){V[(new e[t])._propName]=e[t]}}return true};g.plugin=function(e){if(!e||!e.propName||!e.init||!e.API){throw"illegal plugin definition."}var t=e.propName,r=e.priority||0,i=e.overwriteProps,n={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},a=y("plugins."+t.charAt(0).toUpperCase()+t.substr(1)+"Plugin",function(){Z.call(this,t,r);this._overwriteProps=i||[]},e.global===true),o=a.prototype=new Z(t),s;o.constructor=a;a.API=e.API;for(s in n){if(typeof e[s]==="function"){o[n[s]]=e[s]}}a.version=e.version;Z.activate([a]);return a};u=e._gsQueue;if(u){for(f=0;f<u.length;f++){u[f]()}for(c in v){if(!v[c].func){e.console.log("GSAP encountered missing dependency: com.greensock."+c)}}}d=false})(typeof t!=="undefined"&&t.exports&&typeof e!=="undefined"?e:this||window,"TweenMax")}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],131:[function(e,t,r){t.exports=i;function i(e,t,r){if(typeof t==="function"){r=t;t=null}var i=document.createElement("img");var n;i.onload=function(){if(n)return;n=true;r&&r(undefined,i)};i.onerror=function(t){if(n)return;n=true;r&&r(new Error('Unable to load "'+e+'"'),i)};if(t&&t.crossOrigin)i.crossOrigin=t.crossOrigin;i.src=e;return i}},{}],132:[function(e,t,r){if(typeof Object.create==="function"){t.exports=function i(e,t){e.super_=t;e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}})}}else{t.exports=function n(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype;e.prototype=new r;e.prototype.constructor=e}}},{}],133:[function(e,t,r){function i(e,t,r){return e*(1-r)+t*r}t.exports=i},{}],134:[function(e,t,r){var i=e("xhr");t.exports=function a(e,t){t=typeof t==="function"?t:n;if(typeof e==="string")e={uri:e};else if(!e)e={};if(!e.headers)e.headers={"Content-Type":"application/json"};var r=/^json$/i.test(e.responseType);return i(e,function(e,i,n){if(e)return t(e);if(!/^2/.test(i.statusCode))return t(new Error("http status code: "+i.statusCode));if(r){t(null,n)}else{try{t(null,JSON.parse(n))}catch(a){t(new Error("cannot parse json: "+a))}}})};function n(){}},{xhr:135}],135:[function(e,t,r){var i=e("global/window");var n=e("once");var a=e("parse-headers");var o={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"};var s=i.XMLHttpRequest||u;var l="withCredentials"in new s?s:i.XDomainRequest;t.exports=h;function h(e,t){if(typeof e==="string"){e={uri:e}}e=e||{};t=n(t);var r=e.xhr||null;if(!r){if(e.cors||e.useXDR){r=new l}else{r=new s}}var i=r.url=e.uri||e.url;var h=r.method=e.method||"GET";var f=e.body||e.data;var c=r.headers=e.headers||{};var p=!!e.sync;var d=false;var v;var m=e.response?b:w;if("json"in e){d=true;c["Accept"]="application/json";if(h!=="GET"&&h!=="HEAD"){c["Content-Type"]="application/json";f=JSON.stringify(e.json)}}r.onreadystatechange=g;r.onload=m;r.onerror=T;r.onprogress=function(){};r.ontimeout=u;r.open(h,i,!p);if(e.withCredentials||e.cors&&e.withCredentials!==false){r.withCredentials=true}if(!p){r.timeout="timeout"in e?e.timeout:5e3}if(r.setRequestHeader){for(v in c){if(c.hasOwnProperty(v)){r.setRequestHeader(v,c[v])}}}else if(e.headers){throw new Error("Headers cannot be set on an XDomainRequest object")}if("responseType"in e){r.responseType=e.responseType}if("beforeSend"in e&&typeof e.beforeSend==="function"){e.beforeSend(r)}r.send(f);return r;function g(){if(r.readyState===4){m()}}function y(){var e=null;if(r.response){e=r.response}else if(r.responseType==="text"||!r.responseType){e=r.responseText||r.responseXML}if(d){try{e=JSON.parse(e)}catch(t){}}return e}function _(){return r.status===1223?204:r.status}function x(e){var t=null;if(e===0||e>=400&&e<600){var r=(typeof f==="string"?f:false)||o[String(e).charAt(0)];t=new Error(r);t.statusCode=e}return t}function b(){var e=_();var i=x(e);var n={body:y(),statusCode:e,statusText:r.statusText,raw:r};if(r.getAllResponseHeaders){n.headers=a(r.getAllResponseHeaders())}else{n.headers={}}t(i,n,n.body)}function w(){var e=_();var i=x(e);r.status=r.statusCode=e;r.body=y();r.headers=a(r.getAllResponseHeaders());t(i,r,r.body)}function T(e){t(e,r)}}function u(){}},{"global/window":136,once:137,"parse-headers":141}],136:[function(e,t,r){(function(e){if(typeof window!=="undefined"){t.exports=window}else if(typeof e!=="undefined"){t.exports=e}else if(typeof self!=="undefined"){t.exports=self}else{t.exports={}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],137:[function(e,t,r){t.exports=i;i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:true})});function i(e){var t=false;return function(){if(t)return;t=true;return e.apply(this,arguments)}}},{}],138:[function(e,t,r){var i=e("is-function");t.exports=o;var n=Object.prototype.toString;var a=Object.prototype.hasOwnProperty;function o(e,t,r){if(!i(t)){throw new TypeError("iterator must be a function")}if(arguments.length<3){r=this}if(n.call(e)==="[object Array]")s(e,t,r);else if(typeof e==="string")l(e,t,r);else h(e,t,r)}function s(e,t,r){for(var i=0,n=e.length;i<n;i++){if(a.call(e,i)){t.call(r,e[i],i,e)}}}function l(e,t,r){for(var i=0,n=e.length;i<n;i++){t.call(r,e.charAt(i),i,e)}}function h(e,t,r){for(var i in e){if(a.call(e,i)){t.call(r,e[i],i,e)}}}},{"is-function":139}],139:[function(e,t,r){t.exports=n;var i=Object.prototype.toString;function n(e){var t=i.call(e);return t==="[object Function]"||typeof e==="function"&&t!=="[object RegExp]"||typeof window!=="undefined"&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}},{}],140:[function(e,t,r){r=t.exports=i;function i(e){return e.replace(/^\s*|\s*$/g,"")}r.left=function(e){return e.replace(/^\s*/,"")};r.right=function(e){return e.replace(/\s*$/,"")}},{}],141:[function(e,t,r){var i=e("trim"),n=e("for-each"),a=function(e){return Object.prototype.toString.call(e)==="[object Array]"};t.exports=function(e){if(!e)return{};var t={};n(i(e).split("\n"),function(e){var r=e.indexOf(":"),n=i(e.slice(0,r)).toLowerCase(),o=i(e.slice(r+1));if(typeof t[n]==="undefined"){t[n]=o}else if(a(t[n])){t[n].push(o)}else{t[n]=[t[n],o]}});return t}},{"for-each":138,trim:140}],142:[function(e,t,r){var i=e("lodash.debounce"),n=e("lodash.isfunction"),a=e("lodash.isobject");var o={leading:false,maxWait:0,trailing:false};function s(e,t,r){var s=true,l=true;if(!n(e)){throw new TypeError}if(r===false){s=false}else if(a(r)){s="leading"in r?r.leading:s;l="trailing"in r?r.trailing:l}o.leading=s;o.maxWait=t;o.trailing=l;return i(e,t,o)}t.exports=s},{"lodash.debounce":143,"lodash.isfunction":146,"lodash.isobject":147}],143:[function(e,t,r){var i=e("lodash.isfunction"),n=e("lodash.isobject"),a=e("lodash.now");var o=Math.max;function s(e,t,r){var s,l,h,u,f,c,p,d=0,v=false,m=true;if(!i(e)){throw new TypeError}t=o(0,t)||0;if(r===true){var g=true;m=false}else if(n(r)){g=r.leading;v="maxWait"in r&&(o(t,r.maxWait)||0);m="trailing"in r?r.trailing:m}var y=function(){var r=t-(a()-u);if(r<=0){if(l){clearTimeout(l)}var i=p;l=c=p=undefined;if(i){d=a();h=e.apply(f,s);if(!c&&!l){s=f=null}}}else{c=setTimeout(y,r)}};var _=function(){if(c){clearTimeout(c)}l=c=p=undefined;if(m||v!==t){d=a();h=e.apply(f,s);if(!c&&!l){s=f=null}}};return function(){s=arguments;u=a();f=this;p=m&&(c||!g);if(v===false){var r=g&&!c}else{if(!l&&!g){d=u}var i=v-(u-d),n=i<=0;if(n){if(l){l=clearTimeout(l)}d=u;h=e.apply(f,s)}else if(!l){l=setTimeout(_,i)}}if(n&&c){c=clearTimeout(c)}else if(!c&&t!==v){c=setTimeout(y,t)}if(r){n=true;h=e.apply(f,s)}if(n&&!c&&!l){s=f=null}return h}}t.exports=s},{"lodash.isfunction":146,"lodash.isobject":147,"lodash.now":144}],144:[function(e,t,r){var i=e("lodash._isnative");var n=i(n=Date.now)&&n||function(){return(new Date).getTime()};t.exports=n},{"lodash._isnative":145}],145:[function(e,t,r){var i=Object.prototype;var n=i.toString;var a=RegExp("^"+String(n).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");function o(e){return typeof e=="function"&&a.test(e)}t.exports=o},{}],146:[function(e,t,r){function i(e){return typeof e=="function"}t.exports=i},{}],147:[function(e,t,r){var i=e("lodash._objecttypes");function n(e){return!!(e&&i[typeof e])}t.exports=n},{"lodash._objecttypes":148}],148:[function(e,t,r){var i={"boolean":false,"function":true,object:true,number:false,string:false,undefined:false};t.exports=i},{}],149:[function(e,t,r){t.exports=function a(e,t){e=e||window.event;var r=e.currentTarget||e.srcElement;var i=t&&t.clientRect||n(r),a=t&&t.clientX,o=t&&t.clientY;a=typeof a==="number"?a:e.clientX;o=typeof o==="number"?o:e.clientY;return{x:a-i.left,y:o-i.top}};var i={left:0,top:0};function n(e){if(e===document.body||e===window){i.left=0;i.top=0}else{var t=e.getBoundingClientRect();i.left=t.left;i.top=t.top}return i}},{}],150:[function(e,t,r){var i=e("as-number");var n=e("xtend");var a=e("no-op");function o(e){if(Array.isArray(e))return new google.maps.LatLng(e[0],e[1]);return e}var s={distance:google.maps.places.RankBy.DISTANCE,prominence:google.maps.places.RankBy.PROMINENCE};t.exports=function(e,t){if(Array.isArray(e))e={location:e};else e=e||{};t=typeof t==="function"?t:a;var r=e.element||document.createElement("div");if(!e.location)throw new Error("you must specify a location");var l=n(e);l.location=o(l.location);l.types=l.types||["cafe"];l.radius=i(l.radius,500);if(typeof l.rankBy==="string")l.rankBy=s[l.rankBy];if(l.rankBy===google.maps.places.RankBy.DISTANCE)l.radius=undefined;var h=new google.maps.places.PlacesService(r);h.nearbySearch(l,function(e,r){if(r===google.maps.places.PlacesServiceStatus.OK)t(null,e);else t("google API error code "+r)})}},{"as-number":3,"no-op":151,xtend:237}],151:[function(e,t,r){t.exports=function i(){}},{}],152:[function(e,t,r){t.exports=e(71)},{"/projects/xmas/node_modules/delaunify/node_modules/randf/index.js":71}],153:[function(e,t,r){t.exports=function i(e,t,r){var i=Math.max(0,Math.min(1,(r-e)/(t-e)));return i*i*(3-2*i)}},{}],154:[function(e,t,r){t.exports=e("./lib/renderer")},{"./lib/renderer":155}],155:[function(e,t,r){var i=e("gl-sprite-text");var n={create:e("gl-mat4/create"),scale:e("gl-mat4/scale"),multiply:e("gl-mat4/multiply")};var a=n.create();var o=n.create();n.scale(o,o,[1,-1,1]);var s=e("./texture-wrap");var l=e("as-number");var h=e("xtend");var u=e("gl-shader-core");var f="attribute vec4 position;\nattribute vec4 color;\nattribute vec2 texcoord0;\n\nuniform mat4 projection;\nuniform mat4 view;\nuniform mat4 model;\n\nvarying vec4 v_col;\nvarying vec2 v_tex0;\n\nvoid main() {\n gl_Position = projection * view * model * position;\n v_col = color;\n v_tex0 = texcoord0;\n gl_PointSize = 1.0;\n}";var c="#ifdef GL_ES\nprecision mediump float;\n#endif\n\nvarying vec4 v_col;\nvarying vec2 v_tex0;\nuniform sampler2D texture0;\n\nuniform float smoothing;\n// = 1.0/32.0;\n\n// drop shadow computed in fragment shader\nvoid main() {\n vec4 texColor = texture2D(texture0, v_tex0);\n\n float dst = texColor.a;\n float alpha = smoothstep(0.5 - smoothing, 0.5 + smoothing, dst);\n vec4 base = v_col * vec4(alpha);\n\n gl_FragColor = base;\n if (gl_FragColor.a<0.1)\n discard;\n}";var p=[{type:"float",name:"smoothing"},{type:"sampler2D",name:"texture0"},{type:"mat4",name:"projection"},{type:"mat4",name:"view"},{type:"mat4",name:"model"}],d=[{type:"vec4",name:"position"},{type:"vec4",name:"color"},{type:"vec2",name:"texcoord0"}];function v(e,t,r){e[0]=t.r;e[1]=t.g;e[2]=t.b;e[3]=r}t.exports=function(e){function t(r,a){if(!(this instanceof t))return new t(r,a);a=a||{};var o=r.getContext();this.gl=o;this.color=new e.Color;if(a.color!==null&&typeof a.color!=="undefined")this.color.set(a.color);this.opacity=l(a.opacity,1);var v=h(a);if(v.textures){v.textures=v.textures.map(function(t){if(t instanceof e.Texture)return s(r,t);return t})}this.element=i(o,v);this.transform=n.create();this.shader=u(o,f,c,p,d);this.shader.bind();this.padding=l(a.padding,0);var m=l(a.smoothing,1/32);this.shader.uniforms.smoothing=m;this.shader.uniforms.texture0=0}t.prototype.draw=function(e,t){var r=this.gl;if(!t.visible)return;if(!this.element.textures||this.element.textures.length===0)return;r.enable(r.BLEND);r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA);r.enable(r.DEPTH_TEST);r.depthFunc(r.LEQUAL);r.disable(r.CULL_FACE);r.colorMask(true,true,true,true);r.disable(r.STENCIL_TEST);r.activeTexture(r.TEXTURE0);r.depthMask(true);r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA);this.shader.bind();this.element.textures[0].bind(0);n.multiply(a,t.matrixWorld.elements,this.transform);n.multiply(a,a,o);this.shader.bind();this.shader.uniforms.projection=e.projectionMatrix.elements;this.shader.uniforms.view=e.matrixWorldInverse.elements;this.shader.uniforms.model=a;v(this.element.batch.color,this.color,this.opacity);this.element.draw(this.shader,this.padding,this.padding);r.enable(r.CULL_FACE);r.cullFace(r.BACK)};return t}},{"./texture-wrap":156,"as-number":157,"gl-mat4/create":158,"gl-mat4/multiply":159,"gl-mat4/scale":160,"gl-shader-core":165,"gl-sprite-text":166,xtend:214}],156:[function(e,t,r){function i(e,t){if(!(this instanceof i))return new i(e,t);this.renderer=e;this.texture=t;this._shape=[0,0]}i.prototype.bind=function(e){n(this._shape,this.texture);var t=this.renderer.getContext();this.renderer.setTexture(this.texture,e|0);t.bindTexture(t.TEXTURE_2D,this.texture.__webglTexture)};Object.defineProperty(i.prototype,"shape",{get:function(){n(this._shape,this.texture);return this._shape}});function n(e,t){e[0]=(t.image&&t.image.width)|0;e[1]=(t.image&&t.image.height)|0}t.exports=i},{}],157:[function(e,t,r){t.exports=e(3)},{"/projects/xmas/node_modules/as-number/index.js":3}],158:[function(e,t,r){t.exports=e(78)},{"/projects/xmas/node_modules/gl-mat4/create.js":78}],159:[function(e,t,r){t.exports=e(87)},{"/projects/xmas/node_modules/gl-mat4/multiply.js":87}],160:[function(e,t,r){t.exports=e(94)},{"/projects/xmas/node_modules/gl-mat4/scale.js":94}],161:[function(e,t,r){t.exports=e(123)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-shader-core/lib/create-attributes.js":123}],162:[function(e,t,r){t.exports=e(124)},{"./reflect":163,"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-shader-core/lib/create-uniforms.js":124,dup:164}],163:[function(e,t,r){t.exports=e(125)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-shader-core/lib/reflect.js":125}],164:[function(e,t,r){t.exports=e(113)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/typedarray-pool/node_modules/dup/dup.js":113}],165:[function(e,t,r){t.exports=e(127)},{"./lib/create-attributes":161,"./lib/create-uniforms":162,"./lib/reflect":163,"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-shader-core/shader-core.js":127}],166:[function(e,t,r){var n=e("fontpath-simple-renderer");var a=e("inherits");var o=e("fontpath-bmfont");var s=e("texcoord");var l=e("xtend");var h=e("gl-texture2d");var u=e("gl-sprite-batch");var f=[0,0],c=[0,0],p=[0,0],d=[0,0];var v=[0,0,1,1];var m=500;function g(e,t,r){p[0]=e.x;p[1]=e.y;d[0]=e.width;d[1]=e.height;return s(p,d,t,r)}function y(e,t){if(!(this instanceof y))return new y(e,t);t=t||{};if(!t.font)throw new Error("must specify bmfont at creation time");if(!t.textures&&Array.isArray(t.font.images)){t.textures=t.font.images.map(function(t){return h(e,t)})}t.font=o(t.font);n.call(this,t);this.textures=t.textures||[];this.gl=e;if(!e)throw new Error("must specify gl context");if(typeof t.dynamic!=="boolean")t.dynamic=true;var r=t.batch;if(!r)this.defaultBatch=u(e,t);this.batch=r||this.defaultBatch;if(typeof t.wrapWidth!=="number")this.layout()}a(y,n);y.prototype.dispose=function(e){if(this.defaultBatch)this.defaultBatch.dispose();if(e){this.textures.forEach(function(e){if(typeof e.dispose==="function")e.dispose()})}return this};y.prototype.uncache=function(){this._cache=false;this.batch.clear();return this};y.prototype.cache=function(e,t,r,i){this._cache=true;this.batch.ensureCapacity(this.text.length);this.batch.clear();this._build(e,t,r,i);return this};y.prototype.draw=function(e,t,r,i,n){var a=this.batch;a.bind(e);if(!this._cache){a.clear();this._build(t,r,i,n)}a.draw();a.unbind();return this};y.prototype._build=function(e,t,r,n){var a=this.render(e,t,r,n);var o=this.batch;if(!this._cache){o.texcoord=v;o.texture=null;for(i=0;i<a.underlines.length;i++){var s=a.underlines[i];o.position=s.position;o.shape=s.size;o.push()}}for(i=0;i<a.glyphs.length;i++){var l=a.glyphs[i];this._drawGlyph(o,l)}};y.prototype._drawGlyph=function(e,t){var r=t.glyph;var i=this.textures[r.page];f[0]=t.position[0]+r.hbx;f[1]=t.position[1]+r.hby-this.font.descender;c[0]=r.width*t.scale[0];c[1]=r.height*t.scale[1];e.texture=i;g(r,i&&i.shape,e.texcoord);e.position=f;e.shape=c;e.push()};t.exports=y},{"fontpath-bmfont":167,"fontpath-simple-renderer":168,"gl-sprite-batch":174,"gl-texture2d":210,inherits:211,texcoord:212,xtend:213}],167:[function(e,t,r){function i(e){return{page:e.page,hbx:e.xoffset,hby:e.yoffset,width:e.width,height:e.height,xoff:e.xadvance,x:e.x,y:e.y}}function n(e){var t={};e.forEach(function(e){t[String.fromCharCode(e.id)]=i(e)});return t}t.exports=function(e){return{pages:e.pages,resolution:72,size:e.info.size,units_per_EM:1,bitmap:true,family_name:e.info.face,height:e.common.lineHeight,descender:e.common.base,ascender:e.common.base,glyphs:n(e.chars),kerning:e.kernings.map(function(e){return[String.fromCharCode(e.first),String.fromCharCode(e.second),e.amount]})}}},{}],168:[function(e,t,r){var i=e("fontpath-renderer");var n=e("inherits");function a(e){if(!(this instanceof a))return new a(e);i.call(this,e);this.data={glyphs:[],underlines:[]}}n(a,i);a.prototype.renderGlyph=function(e,t,r,i,n){this.data.glyphs.push(new o(e,t,this.text.charCodeAt(e),[r,this.font.bitmap?r:-r],[i,n]))};a.prototype.renderUnderline=function(e,t,r,i){this.data.underlines.push(new s([e,t],[r,i]))};a.prototype.render=function(e,t,r,n){this.data.glyphs.length=0;this.data.underlines.length=0;i.prototype.render.call(this,e,t,r,n);return this.data};function o(e,t,r,i,n){this.glyph=t;this.index=e;this.charCode=r;this.position=n;this.scale=i}function s(e,t){this.position=e;this.size=t}t.exports=a},{"fontpath-renderer":169,inherits:211}],169:[function(e,t,r){var i=e("fontpath-glyph-iterator");var n=e("fontpath-wordwrap");var a={x:0,y:0,width:0,height:0,glyphs:0};function o(e){if(!(this instanceof o))return new o(e);e=e||{};this.iterator=new i(e.font,e.fontSize);this.wordwrap=new n;this.align="left";this.underline=false;this.underlineThickness=undefined;this.underlinePosition=undefined;this._text="";if(typeof e.align==="string")this.align=e.align;if(typeof e.underline==="boolean")this.underline=e.underline;if(typeof e.underlineThickness==="number")this.underlineThickness=e.underlineThickness;if(typeof e.underlinePosition==="number")this.underlinePosition=e.underlinePosition;if(typeof e.text==="string")this.text=e.text;if(typeof e.lineHeight==="number")this.lineHeight=e.lineHeight;if(typeof e.letterSpacing==="number")this.letterSpacing=e.letterSpacing;if(typeof e.wrapMode==="string")this.wordwrap.mode=e.wrapMode;if(typeof e.wrapWidth==="number")this.layout(e.wrapWidth)}var s=0,l=1,h=2;var u=["left","center","right"];Object.defineProperties(o.prototype,{font:{get:function(){return this.iterator.font},set:function(e){var t=this.iterator.font;this.iterator.font=e;if(t!==this.iterator.font)this.clearLayout()}},fontSize:{get:function(){return this.iterator.fontSize},set:function(e){var t=this.iterator.fontSize;this.iterator.fontSize=e;if(t!==this.iterator.fontSize)this.clearLayout()}},lineHeight:{get:function(){return this.iterator.lineHeight},set:function(e){this.iterator.lineHeight=e}},letterSpacing:{get:function(){return this.iterator.letterSpacing},set:function(e){this.iterator.letterSpacing=e}},text:{get:function(){return this._text},set:function(e){e=e||"";var t=this._text;this._text=e;this.wordwrap.text=this.text;if(this._text!==t)this.clearLayout()}}});o.prototype.clearLayout=function(){this.wordwrap.text=this.text;this.wordwrap.empty();if(this.iterator.font)this.wordwrap.clearLayout(this.iterator)};o.prototype.layout=function(e){this.wordwrap.text=this.text;this.wordwrap.empty();this.wordwrap.layout(this.iterator,e)};o.prototype.renderGlyph=function(){};o.prototype.renderUnderline=function(){};o.prototype.getBounds=function(e,t){if(!t)t={x:0,y:0,width:0,height:0};var r=this.wordwrap;var i=this.iterator;var n=0;if(r.lines.length>0){var o=r.lines[0];i.getBounds(this.text,o.start,o.end,undefined,a);n=a.height}t.width=r.getMaxLineWidth();t.height=Math.max(0,r.lines.length-1)*i.getLineGap()+n;t.x=0;t.y=-t.height;if(e){var s=this.computeUnderlineHeight();var l=this.computeUnderlinePosition();var h=l+s/2;t.height+=h}return t};o.prototype.computeUnderlineHeight=function(){var e=this.font;var t=this.iterator.fontScale;if(this.underlineThickness===0||this.underlineThickness){return this.underlineThickness}else if(e.underline_thickness){return e.underline_thickness*t}else if(e.bitmap)return e.size/8;else return e.units_per_EM/8*t};o.prototype.computeUnderlinePosition=function(){var e=this.font;var t=this.iterator.fontScale;if(this.underlinePosition===0||this.underlinePosition){return this.underlinePosition}else if(e.underline_position){return-e.underline_position*t}else if(e.bitmap){return e.size/4}else{return e.units_per_EM/4*t}};o.prototype.getDescender=function(){return Math.abs(this.iterator.fontScale*this.iterator.font.descender)};o.prototype.getAscender=function(){return Math.abs(this.iterator.fontScale*this.iterator.font.ascender)};o.prototype.onBegin=function(){};o.prototype.onEnd=function(){};o.prototype.onBeginLine=function(e){};o.prototype.onEndLine=function(e){};o.prototype.render=function(e,t,r,i){e=e||0;t=t||0;var n=this.text;var a=this.wordwrap;if(!n||a.lines.length===0)return;r=r||0;i=typeof i==="number"?i:n.length;var o=this.iterator;var f=o.fontScale;var c=o.font;var p=this.underline;var d=a.getMaxLineWidth();t-=Math.max(0,a.lines.length-1)*o.getLineGap();var v=u.indexOf(this.align||"");if(v===-1)v=s;var m=0;var g=0;var y=0;var _=0;var x=false;var b=this.computeUnderlinePosition();var w=this.computeUnderlineHeight();this.onBegin();o.begin(e,t);for(var T=0;T<a.lines.length;T++){var S=a.lines[T];x=false;var M=0;var A=o.pen.x;var E=o.pen.y;this.onBeginLine(T);for(var C=S.start;C<S.end;C++){var P=n.charAt(C);var R=o.step(n,C);if(!R)continue;if(C>=r&&C<i){var L=o.pen.x;var k=o.pen.y;if(v===l){L+=(d-S.width)/2}else if(v===h){L+=d-S.width}if(!x){m=L;g=L;y=k+b;_=0;x=true}else{_=L-g}this.renderGlyph(C,R,f,L,k)}var F=o.advance(R);if(C>=r&&C<i)M=F}this.onEndLine(T);if(p){_+=M;this.renderUnderline(m,y-w/2,_,w)}if(T<a.lines.length-1){o.advanceLine()}}o.end();this.onEnd()};t.exports=o},{"fontpath-glyph-iterator":170,"fontpath-wordwrap":172}],170:[function(e,t,r){var i=e("fontpath-util");var n=4;function a(e,t){this._fontSize=undefined;this._fontScale=undefined;this._font=undefined;this.fontScale=1;this.kerning=true;this.letterSpacing=0;this.lineHeight=undefined;this.fontSize=typeof t==="number"?t:e?e.size:undefined;this.font=e;this.tabWidth=n;this._tabGlyph=null;this.origin={x:0,y:0};this.pen={x:0,y:0}}Object.defineProperty(a.prototype,"font",{get:function(){return this._font},set:function(e){this._font=e;if(e){this.fontScale=i.getPxScale(e,this.fontSize);this.tabWidth=this._tabWidth}}});Object.defineProperty(a.prototype,"tabWidth",{get:function(){return this._tabWidth},set:function(e){this._tabWidth=e===0||e?e:n;this._tabGlyph={};var t=this.font?this.font.glyphs[" "]:null;if(t){this._tabGlyph={};for(var r in t){this._tabGlyph[r]=t[r]}if(this._tabGlyph.xoff)this._tabGlyph.xoff*=this._tabWidth}}});Object.defineProperty(a.prototype,"fontSize",{get:function(){if(typeof this._fontSize!=="number")return this.font.bitmap?this.font.size:i.pointToPixel(this.font.size);return this._fontSize},set:function(e){this._fontSize=e;if(this._font){this.fontScale=i.getPxScale(this._font,this._fontSize)}}});a.prototype.getKerning=function(e,t){var r=this.font;if(!r||!r.kerning)return 0;var i=this.kerningTable;for(var n=0;n<r.kerning.length;n++){var a=r.kerning[n];if(a[0]===e&&a[1]===t)return a[2]}return 0};a.prototype.begin=function(e,t){this.origin.x=e||0;this.origin.y=t||0;this.pen.x=this.origin.x;this.pen.y=this.origin.y};a.prototype.end=function(){};
a.prototype.getLineGap=function(){var e=this.font,t=this.fontScale;var r=(e.height-e.ascender+Math.abs(e.descender))*t;var i=this.lineHeight;i=i===0||i?i+r:this.fontSize;return i};a.prototype.translate=function(e,t){this.origin.x+=e||0;this.origin.y+=t||0;this.pen.x+=e||0;this.pen.y+=t||0};a.prototype.step=function(e,t){var r=this.fontScale,i=this._font;var n=e.charAt(t);if(n==="	"&&this._tabGlyph){return this._tabGlyph}if(!(n in i.glyphs))return;var a=i.glyphs[n];if(t>0&&this.kerning){var o=this.getKerning(e.charAt(t-1),n);this.pen.x+=o*r}return a};a.prototype.advanceLine=function(){this.pen.y+=this.getLineGap();this.pen.x=this.origin.x};a.prototype.advance=function(e){var t=e.xoff*this.fontScale;this.pen.x+=t+this.letterSpacing;return t};a.prototype.getBounds=function(e,t,r,i,n){if(!n)n={x:0,y:0,width:0,height:0,glyphs:0};var a=i===0||i;t=t||0;r=r===0||r?r:e.length;var o=0;n.x=0;n.y=0;n.glyphs=0;var s=this.pen.x,l=this.pen.y,h=this.origin.x,u=this.origin.y;var f=this.font;this.begin();for(var c=t;c<r;c++){var p=e.charAt(c);var d=this.step(e,c);if(d){var v=d.height*this.fontScale;n.y=Math.max(n.y,this.fontScale*(d.height-d.hby));o=Math.max(o,v);var m=this.advance(d);var g=this.pen.x-this.origin.x;if(a&&g-i>.001){this.pen.x-=m;break}n.glyphs++}}this.end();n.width=this.pen.x-this.origin.x;n.height=o;this.pen.x=s;this.pen.y=l;this.origin.x=h;this.origin.y=u;return n};t.exports=a},{"fontpath-util":171}],171:[function(e,t,r){t.exports.pointToPixel=function(e,t){t=t||t===0?t:96;e=e*t/72;return Math.round(e)};t.exports.getPxScale=function(e,t){if(e.bitmap)return 1;t=typeof t==="number"?t:this.pointToPixel(e.size);var r=e.units_per_EM/64;r=r/e.size*t;return e.resolution*1/72*r/e.units_per_EM};t.exports.getPtScale=function(e,t){t=typeof t==="number"?t:e.size;t=this.pointToPixel(t);return this.getPxScale(e,t)}},{}],172:[function(e,t,r){var i={x:0,y:0,width:0,height:0,glyphs:0};function n(e){return e===" "||e==="\n"||e==="\r"||e==="	"}function a(e,t,r,i){var n=e.indexOf(t,r);if(n===-1||n>i)return i;return n}function o(e){this.text=e||"";this.lines=[];this.newline="\n";this.clip=false;this.mode=o.Mode.NORMAL}o.Mode={PRE:"pre",NORMAL:"normal",NOWRAP:"nowrap"};o.prototype.clearLayout=function(e){this.lines.length=0;if(this.text.length>0){e.getBounds(this.text,0,this.text.length,undefined,i);var t=new o.Line(0,this.text.length,i.width);this.lines.push(t)}};o.prototype.empty=function(){this.lines.length=0};o.prototype.layout=function(e,t,r,s){var l=this.text;var h=this.lines;r=Math.max(0,r||0);s=s===0||s?s:l.length;e.begin();t=t===0||t?t:Number.MAX_VALUE;if(this.mode===o.Mode.PRE){var u=r;for(var f=r;f<s;f++){var c=l.charAt(f);if(c===this.newline||f===s-1){var p=this.clip?t:undefined;e.getBounds(l,u,f+1,p,i);h.push(new o.Line(u,u+i.glyphs,i.width));u=f+1}}}else{var d=t;if(this.mode===o.Mode.NOWRAP){d=Number.MAX_VALUE}while(r<s){var v=a(l,this.newline,r,s);while(r<v){if(!n(l.charAt(r)))break;r++}e.getBounds(l,r,v,d,i);var m=r+i.glyphs;var g=m+this.newline.length;if(m<v){while(m>r){if(n(l.charAt(m)))break;m--}if(m===r){if(g>r+this.newline.length)g--;m=g}else{g=m;while(m>r){if(!n(l.charAt(m-this.newline.length)))break;m--}}}if(m>r){var p=this.clip?t:undefined;e.getBounds(l,r,m,p,i);var y=i.width;var _=this.clip?r+i.glyphs:m;h.push(new o.Line(r,_,y))}r=g}}e.end()};o.prototype.getMaxLineWidth=function(){var e=0;for(var t=0;t<this.lines.length;t++){var r=this.lines[t];e=Math.max(r.width,e)}return e};o.Line=function(e,t,r){this.start=e;this.end=t;this.width=r};t.exports=o},{}],173:[function(e,t,r){var i=e("gl-aliased-vao");var n=e("gl-buffer");t.exports.floatsPerVertex=5;function a(e){var t=e*6;var r=new Uint16Array(t);for(var i=0,n=0;i<t;i+=6,n+=4){r[i+0]=n+0;r[i+1]=n+1;r[i+2]=n+2;r[i+3]=n+0;r[i+4]=n+2;r[i+5]=n+3}return r}t.exports.mixins={create:function o(e){e=e||{};this.clear();if(this.vao)this.dispose();var r=typeof e.capacity==="number"?e.capacity:100;if(r>10922)throw new Error("Can't have more than 10922 quads per batch: "+r);this._capacity=r;var o=r*4*t.exports.floatsPerVertex;this.vertices=new Float32Array(o);this.indices=a(r);var s=this.gl;var l=e.dynamic?s.DYNAMIC_DRAW:s.STATIC_DRAW;this.vertexBuffer=n(s,this.vertices,s.ARRAY_BUFFER,l);this.indexBuffer=n(s,this.indices,s.ELEMENT_ARRAY_BUFFER,s.STATIC_DRAW);var h=5*4;this.vao=i(s,[{name:"position",buffer:this.vertexBuffer,size:2,stride:h},{name:"texcoord0",buffer:this.vertexBuffer,size:2,offset:2*4,stride:h},{name:"color",buffer:this.vertexBuffer,size:4,stride:h,offset:4*4,type:s.UNSIGNED_BYTE,normalized:true}],this.indexBuffer);return this},ensureCapacity:function(e){if(this.capacity<e)this.create({capacity:e});return this}}},{"gl-aliased-vao":175,"gl-buffer":178}],174:[function(e,t,r){var i=e("./pack-rgba-float");var n=e("mixes");var a=e("premultiplied-rgba");var o=e("gl-white-texture");var s=e("./common").floatsPerVertex;var l=[0,0],h=[0,0],u=[0,0,0,0],f=[0,0,0,0];var c=[0,0,0,0],p=[0,0],d=[0,0];function v(e,t){if(!(this instanceof v))return new v(e,t);if(!e)throw new Error("must specify gl context");this.gl=e;t=t||{};this._bound=false;this.idx=0;this.transform=null;this._defaultTexture=o(e);this._lastTexture=this._defaultTexture;this._texture=this._defaultTexture;this.texture=null;this.mode=typeof t.mode==="number"?t.mode:e.TRIANGLES;this.premultiplied=t.premultiplied||false;this._dirty=true;this.create(t);this.defaults()}n(v,e("./common").mixins);n(v,{capacity:{get:function(){return this._capacity}},texture:{get:function(){return this._texture},set:function(e){this._texture=e||this._defaultTexture}},dispose:function(){if(this.vertexBuffer)this.vertexBuffer.dispose();if(this.indexBuffer)this.indexBuffer.dispose();if(this.vao)this.vao.dispose()},clear:function(){this.idx=0;return this},bind:function(e){e.bind();this.vao.bind(e);this._bound=true},unbind:function(){this.vao.unbind();this._bound=false},defaults:function(){this.position=m(l,0,0);this.texcoord=g(u,0,0,1,1);this.color=g(f,1,1,1,1);this.shape=m(h,0,0);return this},push:function(e){if(e){this.texture=e.texture;this.position=e.position||m(l,0,0);this.texcoord=e.texcoord||g(u,0,0,1,1);this.color=e.color||g(f,1,1,1,1);this.shape=e.shape||m(h,0,0)}if(this.texture!==this._lastTexture){if(this._bound)this.flush();this._lastTexture=this.texture}else if(this.idx===this.vertices.length){if(!this._bound)return this;this.flush()}this._dirty=true;var t=this.premultiplied?a(this.color,c):this.color;var r=i(t);var n=this.texcoord[0],o=this.texcoord[1],s=this.texcoord[2],p=this.texcoord[3];var d=this.position[0],v=this.position[1],y=this.shape[0],_=this.shape[1];this._vert(d,v,n,o,r);this._vert(d+y,v,s,o,r);this._vert(d+y,v+_,s,p,r);this._vert(d,v+_,n,p,r);return this},_vert:function(e,t,r,i,n){var a=this.idx,o=this.vertices,s=this.transform;if(s){var l=e,h=t;e=s[0]*l+s[4]*h+s[12];t=s[1]*l+s[5]*h+s[13]}o[a++]=e;o[a++]=t;o[a++]=r;o[a++]=i;o[a++]=n;this.idx=a},flush:function(){this.draw();return this.clear()},draw:function(){if(this.idx===0||!this._bound)return this;var e=this.gl;if(this._dirty){var t=this.vertices.subarray(0,this.idx);this.vertexBuffer.update(t,0);this._dirty=false}if(this._lastTexture)this._lastTexture.bind();this._lastTexture=this.texture;var r=this.idx/(s*4);if(r>0)this.vao.draw(this.mode,r*6,0);return this}});t.exports=v;function m(e,t,r){e[0]=t;e[1]=r;return e}function g(e,t,r,i,n){e[0]=t;e[1]=r;e[2]=i;e[3]=n;return e}function y(e,t){return m(e,t[0],t[1])}function _(e,t,r){var i=t[0],n=t[1];e[0]=r[0]*i+r[4]*n+r[12];e[1]=r[1]*i+r[5]*n+r[13];return e}},{"./common":173,"./pack-rgba-float":197,"gl-white-texture":191,mixes:194,"premultiplied-rgba":196}],175:[function(e,t,r){var i=e("./lib/vao-emulated.js");function n(e,t,r,n){var a=i(e);a.update(t,r,n);return a}t.exports=n},{"./lib/vao-emulated.js":177}],176:[function(e,t,r){function i(e,t){if(!e)return null;var r=t.attributes;if(r[e])return r[e].location;return null}var n=null;var a=null;function o(e,t,r,o){if(t){t.bind()}else{e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}if(n===null){n=e.getParameter(e.MAX_VERTEX_ATTRIBS)|0;a=new Array(n)}if(r){if(r.length>n){throw new Error("gl-vao: Too many vertex attributes")}var s=null;for(m=0;m<n;m++)a[m]=false;for(m=0;m<r.length;m++){var l=r[m];var h=i(l.name,o);if(h===null)continue;a[h]=true;if(l.buffer){var u=l.buffer;var f=l.size||4;var c=l.type||e.FLOAT;var p=!!l.normalized;var d=l.stride||0;var v=l.offset||0;if(s!==u){u.bind();s=u}e.enableVertexAttribArray(h);e.vertexAttribPointer(h,f,c,p,d,v)}else{if(typeof l==="number"){e.vertexAttrib1f(h,l)}else if(l.length===1){e.vertexAttrib1f(h,l[0])}else if(l.length===2){e.vertexAttrib2f(h,l[0],l[1])}else if(l.length===3){e.vertexAttrib3f(h,l[0],l[1],l[2])}else if(l.length===4){e.vertexAttrib4f(h,l[0],l[1],l[2],l[3])}else{throw new Error("gl-vao: Invalid vertex attribute")}e.disableVertexAttribArray(h)}}for(m=0;m<n;m++){if(!a[m])e.disableVertexAttribArray(m)}}else{e.bindBuffer(e.ARRAY_BUFFER,null);for(var m=0;m<n;++m){e.disableVertexAttribArray(m)}}}t.exports=o},{}],177:[function(e,t,r){var i=e("./do-bind.js");function n(e){this.gl=e;this._elements=null;this._attributes=null;this._elementsType=e.UNSIGNED_SHORT}n.prototype.bind=function(e){if(!e)throw new Error("must associate shader with vertex array");i(this.gl,this._elements,this._attributes,e)};n.prototype.update=function(e,t,r){this._elements=t;this._attributes=e;this._elementsType=r||this.gl.UNSIGNED_SHORT};n.prototype.dispose=function(){};n.prototype.unbind=function(){i(this.gl)};n.prototype.draw=function(e,t,r){r=r||0;var i=this.gl;if(this._elements){i.drawElements(e,t,this._elementsType,r)}else{i.drawArrays(e,r,t)}};function a(e){return new n(e)}t.exports=a},{"./do-bind.js":176}],178:[function(e,t,r){t.exports=e(104)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/buffer.js":104,ndarray:184,"ndarray-ops":179,"typedarray-pool":188,webglew:190}],179:[function(e,t,r){t.exports=e(105)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray-ops/ndarray-ops.js":105,"cwise-compiler":180}],180:[function(e,t,r){t.exports=e(106)},{"./lib/thunk.js":182,"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray-ops/node_modules/cwise-compiler/compiler.js":106}],181:[function(e,t,r){t.exports=e(107)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray-ops/node_modules/cwise-compiler/lib/compile.js":107,uniq:183}],182:[function(e,t,r){t.exports=e(108)},{"./compile.js":181,"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray-ops/node_modules/cwise-compiler/lib/thunk.js":108}],183:[function(e,t,r){t.exports=e(66)},{"/projects/xmas/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":66}],184:[function(e,t,r){t.exports=e(110)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray/ndarray.js":110,buffer:39,"iota-array":185}],185:[function(e,t,r){t.exports=e(111)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray/node_modules/iota-array/iota.js":111}],186:[function(e,t,r){t.exports=e(63)},{"/projects/xmas/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/node_modules/bit-twiddle/twiddle.js":63}],187:[function(e,t,r){t.exports=e(113)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/typedarray-pool/node_modules/dup/dup.js":113}],188:[function(e,t,r){t.exports=e(114)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/typedarray-pool/pool.js":114,"bit-twiddle":186,buffer:39,dup:187}],189:[function(e,t,r){t.exports=e(115)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/webglew/node_modules/weakmap/weakmap.js":115}],190:[function(e,t,r){t.exports=e(116)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/webglew/webglew.js":116,weakmap:189}],191:[function(e,t,r){var i=e("gl-texture2d");var n=e("ndarray");t.exports=function(e){var t=Array.apply(null,new Array(16)).map(Number.prototype.valueOf,255);var r=n(new Uint8Array(t),[2,2,4]);return i(e,r)}},{"gl-texture2d":210,ndarray:192}],192:[function(e,t,r){t.exports=e(110)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray/ndarray.js":110,buffer:39,"iota-array":193}],193:[function(e,t,r){t.exports=e(111)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray/node_modules/iota-array/iota.js":111}],194:[function(e,t,r){var i=e("xtend");var n={enumerable:true,configurable:true};function a(e,t){for(var r in t){if(!t.hasOwnProperty(r))continue;var a=t[r];if(typeof a==="function"){e[r]=a}else if(a&&typeof a==="object"){var o=i(n,a);Object.defineProperty(e,r,o)}}}t.exports=function o(e,t){a(e.prototype,t)};t.exports.mix=a},{xtend:213}],195:[function(e,t,r){var i=new Int8Array(4);var n=new Int32Array(i.buffer,0,1);var a=new Float32Array(i.buffer,0,1);var o=function(){};o.intBitsToFloat=function(e){n[0]=e;return a[0]};o.floatToIntBits=function(e){a[0]=e;return n[0]};o.intToFloatColor=function(e){return o.intBitsToFloat(e&4278190079)};o.colorToFloat=function(e,t,r,i){var n=i<<24|r<<16|t<<8|e;return o.intToFloatColor(n)};o.isPowerOfTwo=function(e){return(e&e-1)===0};o.nextPowerOfTwo=function(e){e--;e|=e>>1;e|=e>>2;e|=e>>4;e|=e>>8;e|=e>>16;return e+1};t.exports=o},{}],196:[function(e,t,r){function i(e,t){if(!t||typeof t==="number")t=[0,0,0,0];t[0]=e[0]*e[3];t[1]=e[1]*e[3];t[2]=e[2]*e[3];t[3]=e[3];return t}t.exports=i},{}],197:[function(e,t,r){var i=e("number-util").colorToFloat;t.exports=function n(e){return i(~~(e[0]*255),~~(e[1]*255),~~(e[2]*255),~~(e[3]*255))}},{"number-util":195}],198:[function(e,t,r){t.exports=e(105)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray-ops/ndarray-ops.js":105,"cwise-compiler":199}],199:[function(e,t,r){t.exports=e(106)},{"./lib/thunk.js":201,"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray-ops/node_modules/cwise-compiler/compiler.js":106}],200:[function(e,t,r){t.exports=e(107)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray-ops/node_modules/cwise-compiler/lib/compile.js":107,uniq:202}],201:[function(e,t,r){t.exports=e(108)},{"./compile.js":200,"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray-ops/node_modules/cwise-compiler/lib/thunk.js":108}],202:[function(e,t,r){t.exports=e(66)},{"/projects/xmas/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":66}],203:[function(e,t,r){t.exports=e(110)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray/ndarray.js":110,buffer:39,"iota-array":204}],204:[function(e,t,r){t.exports=e(111)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/ndarray/node_modules/iota-array/iota.js":111}],205:[function(e,t,r){t.exports=e(63)},{"/projects/xmas/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/node_modules/bit-twiddle/twiddle.js":63}],206:[function(e,t,r){t.exports=e(113)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/typedarray-pool/node_modules/dup/dup.js":113}],207:[function(e,t,r){t.exports=e(114)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/typedarray-pool/pool.js":114,"bit-twiddle":205,buffer:39,dup:206}],208:[function(e,t,r){t.exports=e(115)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/webglew/node_modules/weakmap/weakmap.js":115}],209:[function(e,t,r){t.exports=e(116)},{"/projects/xmas/node_modules/gl-vignette-background/node_modules/gl-quad/node_modules/gl-buffer/node_modules/webglew/webglew.js":116,weakmap:208}],210:[function(e,t,r){"use strict";var i=e("ndarray");var n=e("ndarray-ops");var a=e("typedarray-pool");var o=e("webglew");t.exports=b;var s=null;var l=null;var h=null;function u(e){s=[e.LINEAR,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_NEAREST];l=[e.NEAREST,e.LINEAR,e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR];h=[e.REPEAT,e.CLAMP_TO_EDGE,e.MIRRORED_REPEAT]}var f=function(e,t){n.muls(e,t,255)};function c(e,t,r){var i=e.gl;var n=i.getParameter(i.MAX_TEXTURE_SIZE);if(t<0||t>n||r<0||r>n){throw new Error("gl-texture2d: Invalid texture size")}e._shape=[t,r];e.bind();i.texImage2D(i.TEXTURE_2D,0,e.format,t,r,0,e.format,e.type,null);e._mipLevels=[0];return e}function p(e,t,r,i,n,a){this.gl=e;this.handle=t;this.format=n;this.type=a;this._shape=[r,i];this._mipLevels=[0];this._magFilter=e.NEAREST;this._minFilter=e.NEAREST;this._wrapS=e.CLAMP_TO_EDGE;this._wrapT=e.CLAMP_TO_EDGE;this._anisoSamples=1;var o=this;var s=[this._wrapS,this._wrapT];Object.defineProperties(s,[{get:function(){return o._wrapS},set:function(e){return o.wrapS=e}},{get:function(){return o._wrapT},set:function(e){return o.wrapT=e}}]);this._wrapVector=s;var l=[this._shape[0],this._shape[1]];Object.defineProperties(l,[{get:function(){return o._shape[0]},set:function(e){return o.width=e}},{get:function(){return o._shape[1]},set:function(e){return o.height=e}}]);this._shapeVector=l}var d=p.prototype;Object.defineProperties(d,{minFilter:{get:function(){return this._minFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&s.indexOf(e)>=0){if(!o(t).texture_float_linear){e=t.NEAREST}}if(l.indexOf(e)<0){throw new Error("gl-texture2d: Unknown filter mode "+e)}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e);return this._minFilter=e}},magFilter:{get:function(){return this._magFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&s.indexOf(e)>=0){if(!o(t).texture_float_linear){e=t.NEAREST}}if(l.indexOf(e)<0){throw new Error("gl-texture2d: Unknown filter mode "+e)}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e);return this._magFilter=e}},mipSamples:{get:function(){return this._anisoSamples},set:function(e){var t=this._anisoSamples;this._anisoSamples=Math.max(e,1)|0;if(t!==this._anisoSamples){var r=o(this.gl).EXT_texture_filter_anisotropic;if(r){this.gl.texParameterf(this.gl.TEXTURE_2D,r.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(e){this.bind();if(h.indexOf(e)<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,e);return this._wrapS=e}},wrapT:{get:function(){return this._wrapT},set:function(e){this.bind();if(h.indexOf(e)<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,e);return this._wrapT=e}},wrap:{get:function(){return this._wrapVector},set:function(e){if(!Array.isArray(e)){e=[e,e]}if(e.length!==2){throw new Error("gl-texture2d: Must specify wrap mode for rows and columns")}for(var t=0;t<2;++t){if(h.indexOf(e[t])<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}}this._wrapS=e[0];this._wrapT=e[1];var r=this.gl;this.bind();r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,this._wrapS);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,this._wrapT);return e}},shape:{get:function(){return this._shapeVector},set:function(e){if(!Array.isArray(e)){e=[e|0,e|0]}else{if(e.length!==2){throw new Error("gl-texture2d: Invalid texture shape")}}c(this,e[0]|0,e[1]|0);return[e[0]|0,e[1]|0]}},width:{get:function(){return this._shape[0]},set:function(e){e=e|0;c(this,e,this._shape[1]);return e}},height:{get:function(){return this._shape[1]},set:function(e){e=e|0;c(this,this._shape[0],e);return e}}});d.bind=function(e){var t=this.gl;if(e!==undefined){t.activeTexture(t.TEXTURE0+(e|0))}t.bindTexture(t.TEXTURE_2D,this.handle);if(e!==undefined){return e|0}return t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0};d.dispose=function(){this.gl.deleteTexture(this.handle)};d.generateMipmap=function(){this.bind();this.gl.generateMipmap(this.gl.TEXTURE_2D);var e=Math.min(this._shape[0],this._shape[1]);for(var t=0;e>0;++t,e>>>=1){if(this._mipLevels.indexOf(t)<0){this._mipLevels.push(t)}}};d.setPixels=function(e,t,r,i){var n=this.gl;this.bind();if(Array.isArray(t)){i=r;r=t[1]|0;t=t[0]|0}else{t=t||0;r=r||0}i=i||0;if(e instanceof HTMLCanvasElement||e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLVideoElement){var a=this._mipLevels.indexOf(i)<0;if(a){n.texImage2D(n.TEXTURE_2D,0,this.format,this.format,this.type,e);this._mipLevels.push(i)}else{n.texSubImage2D(n.TEXTURE_2D,i,t,r,this.format,this.type,e)}}else if(e.shape&&e.stride&&e.data){if(e.shape.length<2||t+e.shape[1]>this._shape[1]>>>i||r+e.shape[0]>this._shape[0]>>>i||t<0||r<0){throw new Error("gl-texture2d: Texture dimensions are out of bounds")}m(n,t,r,i,this.format,this.type,this._mipLevels,e)}else{throw new Error("gl-texture2d: Unsupported data type")}};function v(e,t){if(e.length===3){return t[2]===1&&t[1]===e[0]*e[2]&&t[0]===e[2]}return t[0]===1&&t[1]===e[0]}function m(e,t,r,o,s,l,h,u){var c=u.dtype;var p=u.shape.slice();if(p.length<2||p.length>3){throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d")}var d=0,m=0;var g=v(p,u.stride.slice());if(c==="float32"){d=e.FLOAT}else if(c==="float64"){d=e.FLOAT;g=false;c="float32"}else if(c==="uint8"){d=e.UNSIGNED_BYTE}else{d=e.UNSIGNED_BYTE;g=false;c="uint8"}var y=1;if(p.length===2){m=e.LUMINANCE;p=[p[0],p[1],1];u=i(u.data,p,[u.stride[0],u.stride[1],1],u.offset)}else if(p.length===3){if(p[2]===1){m=e.ALPHA}else if(p[2]===2){m=e.LUMINANCE_ALPHA}else if(p[2]===3){m=e.RGB}else if(p[2]===4){m=e.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}y=p[2]}else{throw new Error("gl-texture2d: Invalid shape for texture")}if((m===e.LUMINANCE||m===e.ALPHA)&&(s===e.LUMINANCE||s===e.ALPHA)){m=s}if(m!==s){throw new Error("gl-texture2d: Incompatible texture format for setPixels")}var _=u.size;var x=h.indexOf(o)<0;if(x){h.push(o)}if(d===l&&g){if(u.offset===0&&u.data.length===_){if(x){e.texImage2D(e.TEXTURE_2D,o,s,p[0],p[1],0,s,l,u.data)}else{e.texSubImage2D(e.TEXTURE_2D,o,t,r,p[0],p[1],s,l,u.data)}}else{if(x){e.texImage2D(e.TEXTURE_2D,o,s,p[0],p[1],0,s,l,u.data.subarray(u.offset,u.offset+_))}else{e.texSubImage2D(e.TEXTURE_2D,o,t,r,p[0],p[1],s,l,u.data.subarray(u.offset,u.offset+_))}}}else{var b;if(l===e.FLOAT){b=a.mallocFloat32(_)}else{b=a.mallocUint8(_)}var w=i(b,p,[p[2],p[2]*p[0],1]);if(d===e.FLOAT&&l===e.UNSIGNED_BYTE){f(w,u)}else{n.assign(w,u)}if(x){e.texImage2D(e.TEXTURE_2D,o,s,p[0],p[1],0,s,l,b.subarray(0,_))}else{e.texSubImage2D(e.TEXTURE_2D,o,t,r,p[0],p[1],s,l,b.subarray(0,_))}if(l===e.FLOAT){a.freeFloat32(b)}else{a.freeUint8(b)}}}function g(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);return t}function y(e,t,r,i,n){var a=e.getParameter(e.MAX_TEXTURE_SIZE);if(t<0||t>a||r<0||r>a){throw new Error("gl-texture2d: Invalid texture shape")}if(n===e.FLOAT&&!o(e).texture_float){throw new Error("gl-texture2d: Floating point textures not supported on this platform")}var s=g(e);e.texImage2D(e.TEXTURE_2D,0,i,t,r,0,i,n,null);return new p(e,s,t,r,i,n)}function _(e,t,r,i){var n=g(e);e.texImage2D(e.TEXTURE_2D,0,r,r,i,t);return new p(e,n,t.width|0,t.height|0,r,i)}function x(e,t){var r=t.dtype;var s=t.shape.slice();var l=e.getParameter(e.MAX_TEXTURE_SIZE);if(s[0]<0||s[0]>l||s[1]<0||s[1]>l){throw new Error("gl-texture2d: Invalid texture size")}var h=v(s,t.stride.slice());var u=0;if(r==="float32"){u=e.FLOAT}else if(r==="float64"){u=e.FLOAT;h=false;r="float32"}else if(r==="uint8"){u=e.UNSIGNED_BYTE}else{u=e.UNSIGNED_BYTE;h=false;r="uint8"}var c=0;if(s.length===2){c=e.LUMINANCE;s=[s[0],s[1],1];t=i(t.data,s,[t.stride[0],t.stride[1],1],t.offset)}else if(s.length===3){if(s[2]===1){c=e.ALPHA}else if(s[2]===2){c=e.LUMINANCE_ALPHA}else if(s[2]===3){c=e.RGB}else if(s[2]===4){c=e.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}}else{throw new Error("gl-texture2d: Invalid shape for texture")}if(u===e.FLOAT&&!o(e).texture_float){u=e.UNSIGNED_BYTE;h=false}var d,m;var y=t.size;if(!h){var _=[s[2],s[2]*s[0],1];m=a.malloc(y,r);var x=i(m,s,_,0);if((r==="float32"||r==="float64")&&u===e.UNSIGNED_BYTE){f(x,t)}else{n.assign(x,t)}d=m.subarray(0,y)}else if(t.offset===0&&t.data.length===y){d=t.data}else{d=t.data.subarray(t.offset,t.offset+y)}var b=g(e);e.texImage2D(e.TEXTURE_2D,0,c,s[0],s[1],0,c,u,d);if(!h){a.free(m)}return new p(e,b,s[0],s[1],c,u)}function b(e){if(arguments.length<=1){throw new Error("gl-texture2d: Missing arguments for texture2d constructor")}if(!s){u(e)}if(typeof arguments[1]==="number"){return y(e,arguments[1],arguments[2],arguments[3]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE)}if(Array.isArray(arguments[1])){return y(e,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE)}if(typeof arguments[1]==="object"){var t=arguments[1];if(t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement||t instanceof ImageData){return _(e,t,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE)}else if(t.shape&&t.data&&t.stride){return x(e,t)}}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:203,"ndarray-ops":198,"typedarray-pool":207,webglew:209}],211:[function(e,t,r){t.exports=e(132)},{"/projects/xmas/node_modules/inherits/inherits_browser.js":132}],212:[function(e,t,r){t.exports=function i(e,t,r,n){if(!n)n=[0,0,1,1];e=e||[0,0];t=t||[1,1];r=r||t;var a=1/r[0];var o=1/r[1];var s=e[0],l=e[1],h=t[0],u=t[1];n[0]=s*a;n[1]=l*o;n[2]=(s+h)*a;n[3]=(l+u)*o;return n}},{}],213:[function(e,t,r){t.exports=i;function i(){var e={};for(var t=0;t<arguments.length;t++){var r=arguments[t];for(var i in r){if(r.hasOwnProperty(i)){e[i]=r[i]}}}return e}},{}],214:[function(e,t,r){t.exports=e(213)},{"/projects/xmas/node_modules/three-sdf-text/node_modules/gl-sprite-text/node_modules/xtend/immutable.js":213}],215:[function(e,t,r){var i={REVISION:"69"};if(typeof t==="object"){t.exports=i}if(Math.sign===undefined){Math.sign=function(e){return e<0?-1:e>0?1:0}}i.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};i.CullFaceNone=0;i.CullFaceBack=1;i.CullFaceFront=2;i.CullFaceFrontBack=3;i.FrontFaceDirectionCW=0;i.FrontFaceDirectionCCW=1;i.BasicShadowMap=0;i.PCFShadowMap=1;i.PCFSoftShadowMap=2;i.FrontSide=0;i.BackSide=1;i.DoubleSide=2;i.NoShading=0;i.FlatShading=1;i.SmoothShading=2;i.NoColors=0;i.FaceColors=1;i.VertexColors=2;i.NoBlending=0;i.NormalBlending=1;i.AdditiveBlending=2;i.SubtractiveBlending=3;i.MultiplyBlending=4;i.CustomBlending=5;i.AddEquation=100;i.SubtractEquation=101;i.ReverseSubtractEquation=102;i.MinEquation=103;i.MaxEquation=104;i.ZeroFactor=200;i.OneFactor=201;i.SrcColorFactor=202;i.OneMinusSrcColorFactor=203;i.SrcAlphaFactor=204;i.OneMinusSrcAlphaFactor=205;i.DstAlphaFactor=206;i.OneMinusDstAlphaFactor=207;i.DstColorFactor=208;i.OneMinusDstColorFactor=209;i.SrcAlphaSaturateFactor=210;i.MultiplyOperation=0;i.MixOperation=1;i.AddOperation=2;i.UVMapping=function(){};i.CubeReflectionMapping=function(){};i.CubeRefractionMapping=function(){};i.SphericalReflectionMapping=function(){};i.SphericalRefractionMapping=function(){};i.RepeatWrapping=1e3;i.ClampToEdgeWrapping=1001;i.MirroredRepeatWrapping=1002;i.NearestFilter=1003;i.NearestMipMapNearestFilter=1004;i.NearestMipMapLinearFilter=1005;i.LinearFilter=1006;i.LinearMipMapNearestFilter=1007;i.LinearMipMapLinearFilter=1008;i.UnsignedByteType=1009;i.ByteType=1010;i.ShortType=1011;i.UnsignedShortType=1012;i.IntType=1013;i.UnsignedIntType=1014;i.FloatType=1015;i.UnsignedShort4444Type=1016;i.UnsignedShort5551Type=1017;i.UnsignedShort565Type=1018;i.AlphaFormat=1019;i.RGBFormat=1020;i.RGBAFormat=1021;i.LuminanceFormat=1022;i.LuminanceAlphaFormat=1023;i.RGB_S3TC_DXT1_Format=2001;i.RGBA_S3TC_DXT1_Format=2002;i.RGBA_S3TC_DXT3_Format=2003;i.RGBA_S3TC_DXT5_Format=2004;i.RGB_PVRTC_4BPPV1_Format=2100;i.RGB_PVRTC_2BPPV1_Format=2101;i.RGBA_PVRTC_4BPPV1_Format=2102;i.RGBA_PVRTC_2BPPV1_Format=2103;i.Color=function(e){if(arguments.length===3){return this.setRGB(arguments[0],arguments[1],arguments[2])}return this.set(e)};i.Color.prototype={constructor:i.Color,r:1,g:1,b:1,set:function(e){if(e instanceof i.Color){this.copy(e)}else if(typeof e==="number"){this.setHex(e)}else if(typeof e==="string"){this.setStyle(e)}return this},setHex:function(e){e=Math.floor(e);this.r=(e>>16&255)/255;this.g=(e>>8&255)/255;this.b=(e&255)/255;return this},setRGB:function(e,t,r){this.r=e;this.g=t;this.b=r;return this},setHSL:function(e,t,r){if(t===0){this.r=this.g=this.b=r}else{var i=function(e,t,r){if(r<0)r+=1;if(r>1)r-=1;if(r<1/6)return e+(t-e)*6*r;if(r<1/2)return t;if(r<2/3)return e+(t-e)*6*(2/3-r);return e};var n=r<=.5?r*(1+t):r+t-r*t;var a=2*r-n;this.r=i(a,n,e+1/3);this.g=i(a,n,e);this.b=i(a,n,e-1/3)}return this},setStyle:function(e){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(e)){var t=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(e);this.r=Math.min(255,parseInt(t[1],10))/255;this.g=Math.min(255,parseInt(t[2],10))/255;this.b=Math.min(255,parseInt(t[3],10))/255;return this}if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(e)){var t=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(e);this.r=Math.min(100,parseInt(t[1],10))/100;this.g=Math.min(100,parseInt(t[2],10))/100;this.b=Math.min(100,parseInt(t[3],10))/100;return this}if(/^\#([0-9a-f]{6})$/i.test(e)){var t=/^\#([0-9a-f]{6})$/i.exec(e);this.setHex(parseInt(t[1],16));return this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e)){var t=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);this.setHex(parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3],16));return this}if(/^(\w+)$/i.test(e)){this.setHex(i.ColorKeywords[e]);return this}},copy:function(e){this.r=e.r;this.g=e.g;this.b=e.b;return this},copyGammaToLinear:function(e){this.r=e.r*e.r;this.g=e.g*e.g;this.b=e.b*e.b;return this},copyLinearToGamma:function(e){this.r=Math.sqrt(e.r);this.g=Math.sqrt(e.g);this.b=Math.sqrt(e.b);return this},convertGammaToLinear:function(){var e=this.r,t=this.g,r=this.b;this.r=e*e;this.g=t*t;this.b=r*r;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t=e||{h:0,s:0,l:0};var r=this.r,i=this.g,n=this.b;var a=Math.max(r,i,n);var o=Math.min(r,i,n);var s,l;var h=(o+a)/2;if(o===a){s=0;l=0}else{var u=a-o;l=h<=.5?u/(a+o):u/(2-a-o);switch(a){case r:s=(i-n)/u+(i<n?6:0);break;case i:s=(n-r)/u+2;break;case n:s=(r-i)/u+4;break}s/=6}t.h=s;t.s=l;t.l=h;return t},getStyle:function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},offsetHSL:function(e,t,r){var i=this.getHSL();i.h+=e;i.s+=t;i.l+=r;this.setHSL(i.h,i.s,i.l);return this},add:function(e){this.r+=e.r;this.g+=e.g;this.b+=e.b;return this},addColors:function(e,t){this.r=e.r+t.r;this.g=e.g+t.g;this.b=e.b+t.b;return this},addScalar:function(e){this.r+=e;this.g+=e;this.b+=e;return this},multiply:function(e){this.r*=e.r;this.g*=e.g;this.b*=e.b;return this},multiplyScalar:function(e){this.r*=e;
this.g*=e;this.b*=e;return this},lerp:function(e,t){this.r+=(e.r-this.r)*t;this.g+=(e.g-this.g)*t;this.b+=(e.b-this.b)*t;return this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e){this.r=e[0];this.g=e[1];this.b=e[2];return this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return(new i.Color).setRGB(this.r,this.g,this.b)}};i.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};i.Quaternion=function(e,t,r,i){this._x=e||0;this._y=t||0;this._z=r||0;this._w=i!==undefined?i:1};i.Quaternion.prototype={constructor:i.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(e){this._x=e;this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e;this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e;this.onChangeCallback()},get w(){return this._w},set w(e){this._w=e;this.onChangeCallback()},set:function(e,t,r,i){this._x=e;this._y=t;this._z=r;this._w=i;this.onChangeCallback();return this},copy:function(e){this._x=e.x;this._y=e.y;this._z=e.z;this._w=e.w;this.onChangeCallback();return this},setFromEuler:function(e,t){if(e instanceof i.Euler===false){throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.")}var r=Math.cos(e._x/2);var n=Math.cos(e._y/2);var a=Math.cos(e._z/2);var o=Math.sin(e._x/2);var s=Math.sin(e._y/2);var l=Math.sin(e._z/2);if(e.order==="XYZ"){this._x=o*n*a+r*s*l;this._y=r*s*a-o*n*l;this._z=r*n*l+o*s*a;this._w=r*n*a-o*s*l}else if(e.order==="YXZ"){this._x=o*n*a+r*s*l;this._y=r*s*a-o*n*l;this._z=r*n*l-o*s*a;this._w=r*n*a+o*s*l}else if(e.order==="ZXY"){this._x=o*n*a-r*s*l;this._y=r*s*a+o*n*l;this._z=r*n*l+o*s*a;this._w=r*n*a-o*s*l}else if(e.order==="ZYX"){this._x=o*n*a-r*s*l;this._y=r*s*a+o*n*l;this._z=r*n*l-o*s*a;this._w=r*n*a+o*s*l}else if(e.order==="YZX"){this._x=o*n*a+r*s*l;this._y=r*s*a+o*n*l;this._z=r*n*l-o*s*a;this._w=r*n*a-o*s*l}else if(e.order==="XZY"){this._x=o*n*a-r*s*l;this._y=r*s*a-o*n*l;this._z=r*n*l+o*s*a;this._w=r*n*a+o*s*l}if(t!==false)this.onChangeCallback();return this},setFromAxisAngle:function(e,t){var r=t/2,i=Math.sin(r);this._x=e.x*i;this._y=e.y*i;this._z=e.z*i;this._w=Math.cos(r);this.onChangeCallback();return this},setFromRotationMatrix:function(e){var t=e.elements,r=t[0],i=t[4],n=t[8],a=t[1],o=t[5],s=t[9],l=t[2],h=t[6],u=t[10],f=r+o+u,c;if(f>0){c=.5/Math.sqrt(f+1);this._w=.25/c;this._x=(h-s)*c;this._y=(n-l)*c;this._z=(a-i)*c}else if(r>o&&r>u){c=2*Math.sqrt(1+r-o-u);this._w=(h-s)/c;this._x=.25*c;this._y=(i+a)/c;this._z=(n+l)/c}else if(o>u){c=2*Math.sqrt(1+o-r-u);this._w=(n-l)/c;this._x=(i+a)/c;this._y=.25*c;this._z=(s+h)/c}else{c=2*Math.sqrt(1+u-r-o);this._w=(a-i)/c;this._x=(n+l)/c;this._y=(s+h)/c;this._z=.25*c}this.onChangeCallback();return this},setFromUnitVectors:function(){var e,t;var r=1e-6;return function(n,a){if(e===undefined)e=new i.Vector3;t=n.dot(a)+1;if(t<r){t=0;if(Math.abs(n.x)>Math.abs(n.z)){e.set(-n.y,n.x,0)}else{e.set(0,-n.z,n.y)}}else{e.crossVectors(n,a)}this._x=e.x;this._y=e.y;this._z=e.z;this._w=t;this.normalize();return this}}(),inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();if(e===0){this._x=0;this._y=0;this._z=0;this._w=1}else{e=1/e;this._x=this._x*e;this._y=this._y*e;this._z=this._z*e;this._w=this._w*e}this.onChangeCallback();return this},multiply:function(e,t){if(t!==undefined){console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.");return this.multiplyQuaternions(e,t)}return this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var r=e._x,i=e._y,n=e._z,a=e._w;var o=t._x,s=t._y,l=t._z,h=t._w;this._x=r*h+a*o+i*l-n*s;this._y=i*h+a*s+n*o-r*l;this._z=n*h+a*l+r*s-i*o;this._w=a*h-r*o-i*s-n*l;this.onChangeCallback();return this},multiplyVector3:function(e){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return e.applyQuaternion(this)},slerp:function(e,t){if(t===0)return this;if(t===1)return this.copy(e);var r=this._x,i=this._y,n=this._z,a=this._w;var o=a*e._w+r*e._x+i*e._y+n*e._z;if(o<0){this._w=-e._w;this._x=-e._x;this._y=-e._y;this._z=-e._z;o=-o}else{this.copy(e)}if(o>=1){this._w=a;this._x=r;this._y=i;this._z=n;return this}var s=Math.acos(o);var l=Math.sqrt(1-o*o);if(Math.abs(l)<.001){this._w=.5*(a+this._w);this._x=.5*(r+this._x);this._y=.5*(i+this._y);this._z=.5*(n+this._z);return this}var h=Math.sin((1-t)*s)/l,u=Math.sin(t*s)/l;this._w=a*h+this._w*u;this._x=r*h+this._x*u;this._y=i*h+this._y*u;this._z=n*h+this._z*u;this.onChangeCallback();return this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){if(t===undefined)t=0;this._x=e[t];this._y=e[t+1];this._z=e[t+2];this._w=e[t+3];this.onChangeCallback();return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;e[t]=this._x;e[t+1]=this._y;e[t+2]=this._z;e[t+3]=this._w;return e},onChange:function(e){this.onChangeCallback=e;return this},onChangeCallback:function(){},clone:function(){return new i.Quaternion(this._x,this._y,this._z,this._w)}};i.Quaternion.slerp=function(e,t,r,i){return r.copy(e).slerp(t,i)};i.Vector2=function(e,t){this.x=e||0;this.y=t||0};i.Vector2.prototype={constructor:i.Vector2,set:function(e,t){this.x=e;this.y=t;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},copy:function(e){this.x=e.x;this.y=e.y;return this},add:function(e,t){if(t!==undefined){console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(e,t)}this.x+=e.x;this.y+=e.y;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;return this},addScalar:function(e){this.x+=e;this.y+=e;return this},sub:function(e,t){if(t!==undefined){console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(e,t)}this.x-=e.x;this.y-=e.y;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;return this},multiply:function(e){this.x*=e.x;this.y*=e.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divide:function(e){this.x/=e.x;this.y/=e.y;return this},divideScalar:function(e){if(e!==0){var t=1/e;this.x*=t;this.y*=t}else{this.x=0;this.y=0}return this},min:function(e){if(this.x>e.x){this.x=e.x}if(this.y>e.y){this.y=e.y}return this},max:function(e){if(this.x<e.x){this.x=e.x}if(this.y<e.y){this.y=e.y}return this},clamp:function(e,t){if(this.x<e.x){this.x=e.x}else if(this.x>t.x){this.x=t.x}if(this.y<e.y){this.y=e.y}else if(this.y>t.y){this.y=t.y}return this},clampScalar:function(){var e,t;return function(r,n){if(e===undefined){e=new i.Vector2;t=new i.Vector2}e.set(r,r);t.set(n,n);return this.clamp(e,t)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},setLength:function(e){var t=this.length();if(t!==0&&e!==t){this.multiplyScalar(e/t)}return this},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;return this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){if(t===undefined)t=0;this.x=e[t];this.y=e[t+1];return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;e[t]=this.x;e[t+1]=this.y;return e},clone:function(){return new i.Vector2(this.x,this.y)}};i.Vector3=function(e,t,r){this.x=e||0;this.y=t||0;this.z=r||0};i.Vector3.prototype={constructor:i.Vector3,set:function(e,t,r){this.x=e;this.y=t;this.z=r;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;return this},add:function(e,t){if(t!==undefined){console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(e,t)}this.x+=e.x;this.y+=e.y;this.z+=e.z;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;return this},sub:function(e,t){if(t!==undefined){console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(e,t)}this.x-=e.x;this.y-=e.y;this.z-=e.z;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;return this},multiply:function(e,t){if(t!==undefined){console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.");return this.multiplyVectors(e,t)}this.x*=e.x;this.y*=e.y;this.z*=e.z;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;this.z*=e;return this},multiplyVectors:function(e,t){this.x=e.x*t.x;this.y=e.y*t.y;this.z=e.z*t.z;return this},applyEuler:function(){var e;return function(t){if(t instanceof i.Euler===false){console.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.")}if(e===undefined)e=new i.Quaternion;this.applyQuaternion(e.setFromEuler(t));return this}}(),applyAxisAngle:function(){var e;return function(t,r){if(e===undefined)e=new i.Quaternion;this.applyQuaternion(e.setFromAxisAngle(t,r));return this}}(),applyMatrix3:function(e){var t=this.x;var r=this.y;var i=this.z;var n=e.elements;this.x=n[0]*t+n[3]*r+n[6]*i;this.y=n[1]*t+n[4]*r+n[7]*i;this.z=n[2]*t+n[5]*r+n[8]*i;return this},applyMatrix4:function(e){var t=this.x,r=this.y,i=this.z;var n=e.elements;this.x=n[0]*t+n[4]*r+n[8]*i+n[12];this.y=n[1]*t+n[5]*r+n[9]*i+n[13];this.z=n[2]*t+n[6]*r+n[10]*i+n[14];return this},applyProjection:function(e){var t=this.x,r=this.y,i=this.z;var n=e.elements;var a=1/(n[3]*t+n[7]*r+n[11]*i+n[15]);this.x=(n[0]*t+n[4]*r+n[8]*i+n[12])*a;this.y=(n[1]*t+n[5]*r+n[9]*i+n[13])*a;this.z=(n[2]*t+n[6]*r+n[10]*i+n[14])*a;return this},applyQuaternion:function(e){var t=this.x;var r=this.y;var i=this.z;var n=e.x;var a=e.y;var o=e.z;var s=e.w;var l=s*t+a*i-o*r;var h=s*r+o*t-n*i;var u=s*i+n*r-a*t;var f=-n*t-a*r-o*i;this.x=l*s+f*-n+h*-o-u*-a;this.y=h*s+f*-a+u*-n-l*-o;this.z=u*s+f*-o+l*-a-h*-n;return this},project:function(){var e;return function(t){if(e===undefined)e=new i.Matrix4;e.multiplyMatrices(t.projectionMatrix,e.getInverse(t.matrixWorld));return this.applyProjection(e)}}(),unproject:function(){var e;return function(t){if(e===undefined)e=new i.Matrix4;e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix));return this.applyProjection(e)}}(),transformDirection:function(e){var t=this.x,r=this.y,i=this.z;var n=e.elements;this.x=n[0]*t+n[4]*r+n[8]*i;this.y=n[1]*t+n[5]*r+n[9]*i;this.z=n[2]*t+n[6]*r+n[10]*i;this.normalize();return this},divide:function(e){this.x/=e.x;this.y/=e.y;this.z/=e.z;return this},divideScalar:function(e){if(e!==0){var t=1/e;this.x*=t;this.y*=t;this.z*=t}else{this.x=0;this.y=0;this.z=0}return this},min:function(e){if(this.x>e.x){this.x=e.x}if(this.y>e.y){this.y=e.y}if(this.z>e.z){this.z=e.z}return this},max:function(e){if(this.x<e.x){this.x=e.x}if(this.y<e.y){this.y=e.y}if(this.z<e.z){this.z=e.z}return this},clamp:function(e,t){if(this.x<e.x){this.x=e.x}else if(this.x>t.x){this.x=t.x}if(this.y<e.y){this.y=e.y}else if(this.y>t.y){this.y=t.y}if(this.z<e.z){this.z=e.z}else if(this.z>t.z){this.z=t.z}return this},clampScalar:function(){var e,t;return function(r,n){if(e===undefined){e=new i.Vector3;t=new i.Vector3}e.set(r,r,r);t.set(n,n,n);return this.clamp(e,t)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();if(t!==0&&e!==t){this.multiplyScalar(e/t)}return this},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;return this},cross:function(e,t){if(t!==undefined){console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.");return this.crossVectors(e,t)}var r=this.x,i=this.y,n=this.z;this.x=i*e.z-n*e.y;this.y=n*e.x-r*e.z;this.z=r*e.y-i*e.x;return this},crossVectors:function(e,t){var r=e.x,i=e.y,n=e.z;var a=t.x,o=t.y,s=t.z;this.x=i*s-n*o;this.y=n*a-r*s;this.z=r*o-i*a;return this},projectOnVector:function(){var e,t;return function(r){if(e===undefined)e=new i.Vector3;e.copy(r).normalize();t=this.dot(e);return this.copy(e).multiplyScalar(t)}}(),projectOnPlane:function(){var e;return function(t){if(e===undefined)e=new i.Vector3;e.copy(this).projectOnVector(t);return this.sub(e)}}(),reflect:function(){var e;return function(t){if(e===undefined)e=new i.Vector3;return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos(i.Math.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x;var r=this.y-e.y;var i=this.z-e.z;return t*t+r*r+i*i},setEulerFromRotationMatrix:function(e,t){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(e,t){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){this.x=e.elements[12];this.y=e.elements[13];this.z=e.elements[14];return this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length();var r=this.set(e.elements[4],e.elements[5],e.elements[6]).length();var i=this.set(e.elements[8],e.elements[9],e.elements[10]).length();this.x=t;this.y=r;this.z=i;return this},setFromMatrixColumn:function(e,t){var r=e*4;var i=t.elements;this.x=i[r];this.y=i[r+1];this.z=i[r+2];return this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){if(t===undefined)t=0;this.x=e[t];this.y=e[t+1];this.z=e[t+2];return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;e[t]=this.x;e[t+1]=this.y;e[t+2]=this.z;return e},clone:function(){return new i.Vector3(this.x,this.y,this.z)}};i.Vector4=function(e,t,r,i){this.x=e||0;this.y=t||0;this.z=r||0;this.w=i!==undefined?i:1};i.Vector4.prototype={constructor:i.Vector4,set:function(e,t,r,i){this.x=e;this.y=t;this.z=r;this.w=i;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setW:function(e){this.w=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;this.w=e.w!==undefined?e.w:1;return this},add:function(e,t){if(t!==undefined){console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(e,t)}this.x+=e.x;this.y+=e.y;this.z+=e.z;this.w+=e.w;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;this.w+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;this.w=e.w+t.w;return this},sub:function(e,t){if(t!==undefined){console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(e,t)}this.x-=e.x;this.y-=e.y;this.z-=e.z;this.w-=e.w;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;this.w=e.w-t.w;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;this.z*=e;this.w*=e;return this},applyMatrix4:function(e){var t=this.x;var r=this.y;var i=this.z;var n=this.w;var a=e.elements;this.x=a[0]*t+a[4]*r+a[8]*i+a[12]*n;this.y=a[1]*t+a[5]*r+a[9]*i+a[13]*n;this.z=a[2]*t+a[6]*r+a[10]*i+a[14]*n;this.w=a[3]*t+a[7]*r+a[11]*i+a[15]*n;return this},divideScalar:function(e){if(e!==0){var t=1/e;this.x*=t;this.y*=t;this.z*=t;this.w*=t}else{this.x=0;this.y=0;this.z=0;this.w=1}return this},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);if(t<1e-4){this.x=1;this.y=0;this.z=0}else{this.x=e.x/t;this.y=e.y/t;this.z=e.z/t}return this},setAxisAngleFromRotationMatrix:function(e){var t,r,i,n,a=.01,o=.1,s=e.elements,l=s[0],h=s[4],u=s[8],f=s[1],c=s[5],p=s[9],d=s[2],v=s[6],m=s[10];if(Math.abs(h-f)<a&&Math.abs(u-d)<a&&Math.abs(p-v)<a){if(Math.abs(h+f)<o&&Math.abs(u+d)<o&&Math.abs(p+v)<o&&Math.abs(l+c+m-3)<o){this.set(1,0,0,0);return this}t=Math.PI;var g=(l+1)/2;var y=(c+1)/2;var _=(m+1)/2;var x=(h+f)/4;var b=(u+d)/4;var w=(p+v)/4;if(g>y&&g>_){if(g<a){r=0;i=.707106781;n=.707106781}else{r=Math.sqrt(g);i=x/r;n=b/r}}else if(y>_){if(y<a){r=.707106781;i=0;n=.707106781}else{i=Math.sqrt(y);r=x/i;n=w/i}}else{if(_<a){r=.707106781;i=.707106781;n=0}else{n=Math.sqrt(_);r=b/n;i=w/n}}this.set(r,i,n,t);return this}var T=Math.sqrt((v-p)*(v-p)+(u-d)*(u-d)+(f-h)*(f-h));if(Math.abs(T)<.001)T=1;this.x=(v-p)/T;this.y=(u-d)/T;this.z=(f-h)/T;this.w=Math.acos((l+c+m-1)/2);return this},min:function(e){if(this.x>e.x){this.x=e.x}if(this.y>e.y){this.y=e.y}if(this.z>e.z){this.z=e.z}if(this.w>e.w){this.w=e.w}return this},max:function(e){if(this.x<e.x){this.x=e.x}if(this.y<e.y){this.y=e.y}if(this.z<e.z){this.z=e.z}if(this.w<e.w){this.w=e.w}return this},clamp:function(e,t){if(this.x<e.x){this.x=e.x}else if(this.x>t.x){this.x=t.x}if(this.y<e.y){this.y=e.y}else if(this.y>t.y){this.y=t.y}if(this.z<e.z){this.z=e.z}else if(this.z>t.z){this.z=t.z}if(this.w<e.w){this.w=e.w}else if(this.w>t.w){this.w=t.w}return this},clampScalar:function(){var e,t;return function(r,n){if(e===undefined){e=new i.Vector4;t=new i.Vector4}e.set(r,r,r,r);t.set(n,n,n,n);return this.clamp(e,t)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z);this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();if(t!==0&&e!==t){this.multiplyScalar(e/t)}return this},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;this.w+=(e.w-this.w)*t;return this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){if(t===undefined)t=0;this.x=e[t];this.y=e[t+1];this.z=e[t+2];this.w=e[t+3];return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;e[t]=this.x;e[t+1]=this.y;e[t+2]=this.z;e[t+3]=this.w;return e},clone:function(){return new i.Vector4(this.x,this.y,this.z,this.w)}};i.Euler=function(e,t,r,n){this._x=e||0;this._y=t||0;this._z=r||0;this._order=n||i.Euler.DefaultOrder};i.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];i.Euler.DefaultOrder="XYZ";i.Euler.prototype={constructor:i.Euler,_x:0,_y:0,_z:0,_order:i.Euler.DefaultOrder,get x(){return this._x},set x(e){this._x=e;this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e;this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e;this.onChangeCallback()},get order(){return this._order},set order(e){this._order=e;this.onChangeCallback()},set:function(e,t,r,i){this._x=e;this._y=t;this._z=r;this._order=i||this._order;this.onChangeCallback();return this},copy:function(e){this._x=e._x;this._y=e._y;this._z=e._z;this._order=e._order;this.onChangeCallback();return this},setFromRotationMatrix:function(e,t){var r=i.Math.clamp;var n=e.elements;var a=n[0],o=n[4],s=n[8];var l=n[1],h=n[5],u=n[9];var f=n[2],c=n[6],p=n[10];t=t||this._order;if(t==="XYZ"){this._y=Math.asin(r(s,-1,1));if(Math.abs(s)<.99999){this._x=Math.atan2(-u,p);this._z=Math.atan2(-o,a)}else{this._x=Math.atan2(c,h);this._z=0}}else if(t==="YXZ"){this._x=Math.asin(-r(u,-1,1));if(Math.abs(u)<.99999){this._y=Math.atan2(s,p);this._z=Math.atan2(l,h)}else{this._y=Math.atan2(-f,a);this._z=0}}else if(t==="ZXY"){this._x=Math.asin(r(c,-1,1));if(Math.abs(c)<.99999){this._y=Math.atan2(-f,p);this._z=Math.atan2(-o,h)}else{this._y=0;this._z=Math.atan2(l,a)}}else if(t==="ZYX"){this._y=Math.asin(-r(f,-1,1));if(Math.abs(f)<.99999){this._x=Math.atan2(c,p);this._z=Math.atan2(l,a)}else{this._x=0;this._z=Math.atan2(-o,h)}}else if(t==="YZX"){this._z=Math.asin(r(l,-1,1));if(Math.abs(l)<.99999){this._x=Math.atan2(-u,h);this._y=Math.atan2(-f,a)}else{this._x=0;this._y=Math.atan2(s,p)}}else if(t==="XZY"){this._z=Math.asin(-r(o,-1,1));if(Math.abs(o)<.99999){this._x=Math.atan2(c,h);this._y=Math.atan2(s,a)}else{this._x=Math.atan2(-u,p);this._y=0}}else{console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t)}this._order=t;this.onChangeCallback();return this},setFromQuaternion:function(e,t,r){var n=i.Math.clamp;var a=e.x*e.x;var o=e.y*e.y;var s=e.z*e.z;var l=e.w*e.w;t=t||this._order;if(t==="XYZ"){this._x=Math.atan2(2*(e.x*e.w-e.y*e.z),l-a-o+s);this._y=Math.asin(n(2*(e.x*e.z+e.y*e.w),-1,1));this._z=Math.atan2(2*(e.z*e.w-e.x*e.y),l+a-o-s)}else if(t==="YXZ"){this._x=Math.asin(n(2*(e.x*e.w-e.y*e.z),-1,1));this._y=Math.atan2(2*(e.x*e.z+e.y*e.w),l-a-o+s);this._z=Math.atan2(2*(e.x*e.y+e.z*e.w),l-a+o-s)}else if(t==="ZXY"){this._x=Math.asin(n(2*(e.x*e.w+e.y*e.z),-1,1));this._y=Math.atan2(2*(e.y*e.w-e.z*e.x),l-a-o+s);this._z=Math.atan2(2*(e.z*e.w-e.x*e.y),l-a+o-s)}else if(t==="ZYX"){this._x=Math.atan2(2*(e.x*e.w+e.z*e.y),l-a-o+s);this._y=Math.asin(n(2*(e.y*e.w-e.x*e.z),-1,1));this._z=Math.atan2(2*(e.x*e.y+e.z*e.w),l+a-o-s)}else if(t==="YZX"){this._x=Math.atan2(2*(e.x*e.w-e.z*e.y),l-a+o-s);this._y=Math.atan2(2*(e.y*e.w-e.x*e.z),l+a-o-s);this._z=Math.asin(n(2*(e.x*e.y+e.z*e.w),-1,1))}else if(t==="XZY"){this._x=Math.atan2(2*(e.x*e.w+e.y*e.z),l-a+o-s);this._y=Math.atan2(2*(e.x*e.z+e.y*e.w),l+a-o-s);this._z=Math.asin(n(2*(e.z*e.w-e.x*e.y),-1,1))}else{console.warn("THREE.Euler: .setFromQuaternion() given unsupported order: "+t)}this._order=t;if(r!==false)this.onChangeCallback();return this},reorder:function(){var e=new i.Quaternion;return function(t){e.setFromEuler(this);this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){this._x=e[0];this._y=e[1];this._z=e[2];if(e[3]!==undefined)this._order=e[3];this.onChangeCallback();return this},toArray:function(){return[this._x,this._y,this._z,this._order]},onChange:function(e){this.onChangeCallback=e;return this},onChangeCallback:function(){},clone:function(){return new i.Euler(this._x,this._y,this._z,this._order)}};i.Line3=function(e,t){this.start=e!==undefined?e:new i.Vector3;this.end=t!==undefined?t:new i.Vector3};i.Line3.prototype={constructor:i.Line3,set:function(e,t){this.start.copy(e);this.end.copy(t);return this},copy:function(e){this.start.copy(e.start);this.end.copy(e.end);return this},center:function(e){var t=e||new i.Vector3;return t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){var t=e||new i.Vector3;return t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var r=t||new i.Vector3;return this.delta(r).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new i.Vector3;var t=new i.Vector3;return function(r,n){e.subVectors(r,this.start);t.subVectors(this.end,this.start);var a=t.dot(t);var o=t.dot(e);var s=o/a;if(n){s=i.Math.clamp(s,0,1)}return s}}(),closestPointToPoint:function(e,t,r){var n=this.closestPointToPointParameter(e,t);var a=r||new i.Vector3;return this.delta(a).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){this.start.applyMatrix4(e);this.end.applyMatrix4(e);return this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},clone:function(){return(new i.Line3).copy(this)}};i.Box2=function(e,t){this.min=e!==undefined?e:new i.Vector2(Infinity,Infinity);this.max=t!==undefined?t:new i.Vector2(-Infinity,-Infinity)};i.Box2.prototype={constructor:i.Box2,set:function(e,t){this.min.copy(e);this.max.copy(t);return this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++){this.expandByPoint(e[t])}return this},setFromCenterAndSize:function(){var e=new i.Vector2;return function(t,r){var i=e.copy(r).multiplyScalar(.5);this.min.copy(t).sub(i);this.max.copy(t).add(i);return this}}(),copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){var t=e||new i.Vector2;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new i.Vector2;return t.subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},containsPoint:function(e){if(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y){return false}return true},containsBox:function(e){if(this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y){return true}return false},getParameter:function(e,t){var r=t||new i.Vector2;return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){if(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y){return false
}return true},clampPoint:function(e,t){var r=t||new i.Vector2;return r.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new i.Vector2;return function(t){var r=e.copy(t).clamp(this.min,this.max);return r.sub(t).length()}}(),intersect:function(e){this.min.max(e.min);this.max.min(e.max);return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new i.Box2).copy(this)}};i.Box3=function(e,t){this.min=e!==undefined?e:new i.Vector3(Infinity,Infinity,Infinity);this.max=t!==undefined?t:new i.Vector3(-Infinity,-Infinity,-Infinity)};i.Box3.prototype={constructor:i.Box3,set:function(e,t){this.min.copy(e);this.max.copy(t);return this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++){this.expandByPoint(e[t])}return this},setFromCenterAndSize:function(){var e=new i.Vector3;return function(t,r){var i=e.copy(r).multiplyScalar(.5);this.min.copy(t).sub(i);this.max.copy(t).add(i);return this}}(),setFromObject:function(){var e=new i.Vector3;return function(t){var r=this;t.updateMatrixWorld(true);this.makeEmpty();t.traverse(function(t){var n=t.geometry;if(n!==undefined){if(n instanceof i.Geometry){var a=n.vertices;for(var o=0,s=a.length;o<s;o++){e.copy(a[o]);e.applyMatrix4(t.matrixWorld);r.expandByPoint(e)}}else if(n instanceof i.BufferGeometry&&n.attributes["position"]!==undefined){var l=n.attributes["position"].array;for(var o=0,s=l.length;o<s;o+=3){e.set(l[o],l[o+1],l[o+2]);e.applyMatrix4(t.matrixWorld);r.expandByPoint(e)}}}});return this}}(),copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){var t=e||new i.Vector3;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new i.Vector3;return t.subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},containsPoint:function(e){if(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z){return false}return true},containsBox:function(e){if(this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z){return true}return false},getParameter:function(e,t){var r=t||new i.Vector3;return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){if(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z){return false}return true},clampPoint:function(e,t){var r=t||new i.Vector3;return r.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new i.Vector3;return function(t){var r=e.copy(t).clamp(this.min,this.max);return r.sub(t).length()}}(),getBoundingSphere:function(){var e=new i.Vector3;return function(t){var r=t||new i.Sphere;r.center=this.center();r.radius=this.size(e).length()*.5;return r}}(),intersect:function(e){this.min.max(e.min);this.max.min(e.max);return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},applyMatrix4:function(){var e=[new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3];return function(t){e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t);e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t);e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t);e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t);e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t);e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t);e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t);e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t);this.makeEmpty();this.setFromPoints(e);return this}}(),translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new i.Box3).copy(this)}};i.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]);if(arguments.length>0){console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}};i.Matrix3.prototype={constructor:i.Matrix3,set:function(e,t,r,i,n,a,o,s,l){var h=this.elements;h[0]=e;h[3]=t;h[6]=r;h[1]=i;h[4]=n;h[7]=a;h[2]=o;h[5]=s;h[8]=l;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(e){var t=e.elements;this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]);return this},multiplyVector3:function(e){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return e.applyMatrix3(this)},multiplyVector3Array:function(e){console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(e)},applyToVector3Array:function(){var e=new i.Vector3;return function(t,r,i){if(r===undefined)r=0;if(i===undefined)i=t.length;for(var n=0,a=r,o;n<i;n+=3,a+=3){e.x=t[a];e.y=t[a+1];e.z=t[a+2];e.applyMatrix3(this);t[a]=e.x;t[a+1]=e.y;t[a+2]=e.z}return t}}(),multiplyScalar:function(e){var t=this.elements;t[0]*=e;t[3]*=e;t[6]*=e;t[1]*=e;t[4]*=e;t[7]*=e;t[2]*=e;t[5]*=e;t[8]*=e;return this},determinant:function(){var e=this.elements;var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],h=e[8];return t*a*h-t*o*l-r*n*h+r*o*s+i*n*l-i*a*s},getInverse:function(e,t){var r=e.elements;var i=this.elements;i[0]=r[10]*r[5]-r[6]*r[9];i[1]=-r[10]*r[1]+r[2]*r[9];i[2]=r[6]*r[1]-r[2]*r[5];i[3]=-r[10]*r[4]+r[6]*r[8];i[4]=r[10]*r[0]-r[2]*r[8];i[5]=-r[6]*r[0]+r[2]*r[4];i[6]=r[9]*r[4]-r[5]*r[8];i[7]=-r[9]*r[0]+r[1]*r[8];i[8]=r[5]*r[0]-r[1]*r[4];var n=r[0]*i[0]+r[1]*i[3]+r[2]*i[6];if(n===0){var a="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(t||false){throw new Error(a)}else{console.warn(a)}this.identity();return this}this.multiplyScalar(1/n);return this},transpose:function(){var e,t=this.elements;e=t[1];t[1]=t[3];t[3]=e;e=t[2];t[2]=t[6];t[6]=e;e=t[5];t[5]=t[7];t[7]=e;return this},flattenToArrayOffset:function(e,t){var r=this.elements;e[t]=r[0];e[t+1]=r[1];e[t+2]=r[2];e[t+3]=r[3];e[t+4]=r[4];e[t+5]=r[5];e[t+6]=r[6];e[t+7]=r[7];e[t+8]=r[8];return e},getNormalMatrix:function(e){this.getInverse(e).transpose();return this},transposeIntoArray:function(e){var t=this.elements;e[0]=t[0];e[1]=t[3];e[2]=t[6];e[3]=t[1];e[4]=t[4];e[5]=t[7];e[6]=t[2];e[7]=t[5];e[8]=t[8];return this},fromArray:function(e){this.elements.set(e);return this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},clone:function(){return(new i.Matrix3).fromArray(this.elements)}};i.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);if(arguments.length>0){console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}};i.Matrix4.prototype={constructor:i.Matrix4,set:function(e,t,r,i,n,a,o,s,l,h,u,f,c,p,d,v){var m=this.elements;m[0]=e;m[4]=t;m[8]=r;m[12]=i;m[1]=n;m[5]=a;m[9]=o;m[13]=s;m[2]=l;m[6]=h;m[10]=u;m[14]=f;m[3]=c;m[7]=p;m[11]=d;m[15]=v;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(e){this.elements.set(e.elements);return this},extractPosition:function(e){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(e)},copyPosition:function(e){var t=this.elements;var r=e.elements;t[12]=r[12];t[13]=r[13];t[14]=r[14];return this},extractRotation:function(){var e=new i.Vector3;return function(t){var r=this.elements;var i=t.elements;var n=1/e.set(i[0],i[1],i[2]).length();var a=1/e.set(i[4],i[5],i[6]).length();var o=1/e.set(i[8],i[9],i[10]).length();r[0]=i[0]*n;r[1]=i[1]*n;r[2]=i[2]*n;r[4]=i[4]*a;r[5]=i[5]*a;r[6]=i[6]*a;r[8]=i[8]*o;r[9]=i[9]*o;r[10]=i[10]*o;return this}}(),makeRotationFromEuler:function(e){if(e instanceof i.Euler===false){console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.")}var t=this.elements;var r=e.x,n=e.y,a=e.z;var o=Math.cos(r),s=Math.sin(r);var l=Math.cos(n),h=Math.sin(n);var u=Math.cos(a),f=Math.sin(a);if(e.order==="XYZ"){var c=o*u,p=o*f,d=s*u,v=s*f;t[0]=l*u;t[4]=-l*f;t[8]=h;t[1]=p+d*h;t[5]=c-v*h;t[9]=-s*l;t[2]=v-c*h;t[6]=d+p*h;t[10]=o*l}else if(e.order==="YXZ"){var m=l*u,g=l*f,y=h*u,_=h*f;t[0]=m+_*s;t[4]=y*s-g;t[8]=o*h;t[1]=o*f;t[5]=o*u;t[9]=-s;t[2]=g*s-y;t[6]=_+m*s;t[10]=o*l}else if(e.order==="ZXY"){var m=l*u,g=l*f,y=h*u,_=h*f;t[0]=m-_*s;t[4]=-o*f;t[8]=y+g*s;t[1]=g+y*s;t[5]=o*u;t[9]=_-m*s;t[2]=-o*h;t[6]=s;t[10]=o*l}else if(e.order==="ZYX"){var c=o*u,p=o*f,d=s*u,v=s*f;t[0]=l*u;t[4]=d*h-p;t[8]=c*h+v;t[1]=l*f;t[5]=v*h+c;t[9]=p*h-d;t[2]=-h;t[6]=s*l;t[10]=o*l}else if(e.order==="YZX"){var x=o*l,b=o*h,w=s*l,T=s*h;t[0]=l*u;t[4]=T-x*f;t[8]=w*f+b;t[1]=f;t[5]=o*u;t[9]=-s*u;t[2]=-h*u;t[6]=b*f+w;t[10]=x-T*f}else if(e.order==="XZY"){var x=o*l,b=o*h,w=s*l,T=s*h;t[0]=l*u;t[4]=-f;t[8]=h*u;t[1]=x*f+T;t[5]=o*u;t[9]=b*f-w;t[2]=w*f-b;t[6]=s*u;t[10]=T*f+x}t[3]=0;t[7]=0;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this},setRotationFromQuaternion:function(e){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");return this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements;var r=e.x,i=e.y,n=e.z,a=e.w;var o=r+r,s=i+i,l=n+n;var h=r*o,u=r*s,f=r*l;var c=i*s,p=i*l,d=n*l;var v=a*o,m=a*s,g=a*l;t[0]=1-(c+d);t[4]=u-g;t[8]=f+m;t[1]=u+g;t[5]=1-(h+d);t[9]=p-v;t[2]=f-m;t[6]=p+v;t[10]=1-(h+c);t[3]=0;t[7]=0;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this},lookAt:function(){var e=new i.Vector3;var t=new i.Vector3;var r=new i.Vector3;return function(i,n,a){var o=this.elements;r.subVectors(i,n).normalize();if(r.length()===0){r.z=1}e.crossVectors(a,r).normalize();if(e.length()===0){r.x+=1e-4;e.crossVectors(a,r).normalize()}t.crossVectors(r,e);o[0]=e.x;o[4]=t.x;o[8]=r.x;o[1]=e.y;o[5]=t.y;o[9]=r.y;o[2]=e.z;o[6]=t.z;o[10]=r.z;return this}}(),multiply:function(e,t){if(t!==undefined){console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.");return this.multiplyMatrices(e,t)}return this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var r=e.elements;var i=t.elements;var n=this.elements;var a=r[0],o=r[4],s=r[8],l=r[12];var h=r[1],u=r[5],f=r[9],c=r[13];var p=r[2],d=r[6],v=r[10],m=r[14];var g=r[3],y=r[7],_=r[11],x=r[15];var b=i[0],w=i[4],T=i[8],S=i[12];var M=i[1],A=i[5],E=i[9],C=i[13];var P=i[2],R=i[6],L=i[10],k=i[14];var F=i[3],D=i[7],U=i[11],O=i[15];n[0]=a*b+o*M+s*P+l*F;n[4]=a*w+o*A+s*R+l*D;n[8]=a*T+o*E+s*L+l*U;n[12]=a*S+o*C+s*k+l*O;n[1]=h*b+u*M+f*P+c*F;n[5]=h*w+u*A+f*R+c*D;n[9]=h*T+u*E+f*L+c*U;n[13]=h*S+u*C+f*k+c*O;n[2]=p*b+d*M+v*P+m*F;n[6]=p*w+d*A+v*R+m*D;n[10]=p*T+d*E+v*L+m*U;n[14]=p*S+d*C+v*k+m*O;n[3]=g*b+y*M+_*P+x*F;n[7]=g*w+y*A+_*R+x*D;n[11]=g*T+y*E+_*L+x*U;n[15]=g*S+y*C+_*k+x*O;return this},multiplyToArray:function(e,t,r){var i=this.elements;this.multiplyMatrices(e,t);r[0]=i[0];r[1]=i[1];r[2]=i[2];r[3]=i[3];r[4]=i[4];r[5]=i[5];r[6]=i[6];r[7]=i[7];r[8]=i[8];r[9]=i[9];r[10]=i[10];r[11]=i[11];r[12]=i[12];r[13]=i[13];r[14]=i[14];r[15]=i[15];return this},multiplyScalar:function(e){var t=this.elements;t[0]*=e;t[4]*=e;t[8]*=e;t[12]*=e;t[1]*=e;t[5]*=e;t[9]*=e;t[13]*=e;t[2]*=e;t[6]*=e;t[10]*=e;t[14]*=e;t[3]*=e;t[7]*=e;t[11]*=e;t[15]*=e;return this},multiplyVector3:function(e){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return e.applyProjection(this)},multiplyVector4:function(e){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},multiplyVector3Array:function(e){console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(e)},applyToVector3Array:function(){var e=new i.Vector3;return function(t,r,i){if(r===undefined)r=0;if(i===undefined)i=t.length;for(var n=0,a=r,o;n<i;n+=3,a+=3){e.x=t[a];e.y=t[a+1];e.z=t[a+2];e.applyMatrix4(this);t[a]=e.x;t[a+1]=e.y;t[a+2]=e.z}return t}}(),rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");e.transformDirection(this)},crossVector:function(e){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},determinant:function(){var e=this.elements;var t=e[0],r=e[4],i=e[8],n=e[12];var a=e[1],o=e[5],s=e[9],l=e[13];var h=e[2],u=e[6],f=e[10],c=e[14];var p=e[3],d=e[7],v=e[11],m=e[15];return p*(+n*s*u-i*l*u-n*o*f+r*l*f+i*o*c-r*s*c)+d*(+t*s*c-t*l*f+n*a*f-i*a*c+i*l*h-n*s*h)+v*(+t*l*u-t*o*c-n*a*u+r*a*c+n*o*h-r*l*h)+m*(-i*o*h-t*s*u+t*o*f+i*a*u-r*a*f+r*s*h)},transpose:function(){var e=this.elements;var t;t=e[1];e[1]=e[4];e[4]=t;t=e[2];e[2]=e[8];e[8]=t;t=e[6];e[6]=e[9];e[9]=t;t=e[3];e[3]=e[12];e[12]=t;t=e[7];e[7]=e[13];e[13]=t;t=e[11];e[11]=e[14];e[14]=t;return this},flattenToArrayOffset:function(e,t){var r=this.elements;e[t]=r[0];e[t+1]=r[1];e[t+2]=r[2];e[t+3]=r[3];e[t+4]=r[4];e[t+5]=r[5];e[t+6]=r[6];e[t+7]=r[7];e[t+8]=r[8];e[t+9]=r[9];e[t+10]=r[10];e[t+11]=r[11];e[t+12]=r[12];e[t+13]=r[13];e[t+14]=r[14];e[t+15]=r[15];return e},getPosition:function(){var e=new i.Vector3;return function(){console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;t[12]=e.x;t[13]=e.y;t[14]=e.z;return this},getInverse:function(e,t){var r=this.elements;var i=e.elements;var n=i[0],a=i[4],o=i[8],s=i[12];var l=i[1],h=i[5],u=i[9],f=i[13];var c=i[2],p=i[6],d=i[10],v=i[14];var m=i[3],g=i[7],y=i[11],_=i[15];r[0]=u*v*g-f*d*g+f*p*y-h*v*y-u*p*_+h*d*_;r[4]=s*d*g-o*v*g-s*p*y+a*v*y+o*p*_-a*d*_;r[8]=o*f*g-s*u*g+s*h*y-a*f*y-o*h*_+a*u*_;r[12]=s*u*p-o*f*p-s*h*d+a*f*d+o*h*v-a*u*v;r[1]=f*d*m-u*v*m-f*c*y+l*v*y+u*c*_-l*d*_;r[5]=o*v*m-s*d*m+s*c*y-n*v*y-o*c*_+n*d*_;r[9]=s*u*m-o*f*m-s*l*y+n*f*y+o*l*_-n*u*_;r[13]=o*f*c-s*u*c+s*l*d-n*f*d-o*l*v+n*u*v;r[2]=h*v*m-f*p*m+f*c*g-l*v*g-h*c*_+l*p*_;r[6]=s*p*m-a*v*m-s*c*g+n*v*g+a*c*_-n*p*_;r[10]=a*f*m-s*h*m+s*l*g-n*f*g-a*l*_+n*h*_;r[14]=s*h*c-a*f*c-s*l*p+n*f*p+a*l*v-n*h*v;r[3]=u*p*m-h*d*m-u*c*g+l*d*g+h*c*y-l*p*y;r[7]=a*d*m-o*p*m+o*c*g-n*d*g-a*c*y+n*p*y;r[11]=o*h*m-a*u*m-o*l*g+n*u*g+a*l*y-n*h*y;r[15]=a*u*c-o*h*c+o*l*p-n*u*p-a*l*d+n*h*d;var x=n*r[0]+l*r[4]+c*r[8]+m*r[12];if(x==0){var b="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t||false){throw new Error(b)}else{console.warn(b)}this.identity();return this}this.multiplyScalar(1/x);return this},translate:function(e){console.warn("THREE.Matrix4: .translate() has been removed.")},rotateX:function(e){console.warn("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(e){console.warn("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(e){console.warn("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(e,t){console.warn("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements;var r=e.x,i=e.y,n=e.z;t[0]*=r;t[4]*=i;t[8]*=n;t[1]*=r;t[5]*=i;t[9]*=n;t[2]*=r;t[6]*=i;t[10]*=n;t[3]*=r;t[7]*=i;t[11]*=n;return this},getMaxScaleOnAxis:function(){var e=this.elements;var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];var r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6];var i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(r,i)))},makeTranslation:function(e,t,r){this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1);return this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1);return this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1);return this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(e,t){var r=Math.cos(t);var i=Math.sin(t);var n=1-r;var a=e.x,o=e.y,s=e.z;var l=n*a,h=n*o;this.set(l*a+r,l*o-i*s,l*s+i*o,0,l*o+i*s,h*o+r,h*s-i*a,0,l*s-i*o,h*s+i*a,n*s*s+r,0,0,0,0,1);return this},makeScale:function(e,t,r){this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1);return this},compose:function(e,t,r){this.makeRotationFromQuaternion(t);this.scale(r);this.setPosition(e);return this},decompose:function(){var e=new i.Vector3;var t=new i.Matrix4;return function(r,i,n){var a=this.elements;var o=e.set(a[0],a[1],a[2]).length();var s=e.set(a[4],a[5],a[6]).length();var l=e.set(a[8],a[9],a[10]).length();var h=this.determinant();if(h<0){o=-o}r.x=a[12];r.y=a[13];r.z=a[14];t.elements.set(this.elements);var u=1/o;var f=1/s;var c=1/l;t.elements[0]*=u;t.elements[1]*=u;t.elements[2]*=u;t.elements[4]*=f;t.elements[5]*=f;t.elements[6]*=f;t.elements[8]*=c;t.elements[9]*=c;t.elements[10]*=c;i.setFromRotationMatrix(t);n.x=o;n.y=s;n.z=l;return this}}(),makeFrustum:function(e,t,r,i,n,a){var o=this.elements;var s=2*n/(t-e);var l=2*n/(i-r);var h=(t+e)/(t-e);var u=(i+r)/(i-r);var f=-(a+n)/(a-n);var c=-2*a*n/(a-n);o[0]=s;o[4]=0;o[8]=h;o[12]=0;o[1]=0;o[5]=l;o[9]=u;o[13]=0;o[2]=0;o[6]=0;o[10]=f;o[14]=c;o[3]=0;o[7]=0;o[11]=-1;o[15]=0;return this},makePerspective:function(e,t,r,n){var a=r*Math.tan(i.Math.degToRad(e*.5));var o=-a;var s=o*t;var l=a*t;return this.makeFrustum(s,l,o,a,r,n)},makeOrthographic:function(e,t,r,i,n,a){var o=this.elements;var s=t-e;var l=r-i;var h=a-n;var u=(t+e)/s;var f=(r+i)/l;var c=(a+n)/h;o[0]=2/s;o[4]=0;o[8]=0;o[12]=-u;o[1]=0;o[5]=2/l;o[9]=0;o[13]=-f;o[2]=0;o[6]=0;o[10]=-2/h;o[14]=-c;o[3]=0;o[7]=0;o[11]=0;o[15]=1;return this},fromArray:function(e){this.elements.set(e);return this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){return(new i.Matrix4).fromArray(this.elements)}};i.Ray=function(e,t){this.origin=e!==undefined?e:new i.Vector3;this.direction=t!==undefined?t:new i.Vector3};i.Ray.prototype={constructor:i.Ray,set:function(e,t){this.origin.copy(e);this.direction.copy(t);return this},copy:function(e){this.origin.copy(e.origin);this.direction.copy(e.direction);return this},at:function(e,t){var r=t||new i.Vector3;return r.copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new i.Vector3;return function(t){this.origin.copy(this.at(t,e));return this}}(),closestPointToPoint:function(e,t){var r=t||new i.Vector3;r.subVectors(e,this.origin);var n=r.dot(this.direction);if(n<0){return r.copy(this.origin)}return r.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(){var e=new i.Vector3;return function(t){var r=e.subVectors(t,this.origin).dot(this.direction);if(r<0){return this.origin.distanceTo(t)}e.copy(this.direction).multiplyScalar(r).add(this.origin);return e.distanceTo(t)}}(),distanceSqToSegment:function(e,t,r,i){var n=e.clone().add(t).multiplyScalar(.5);var a=t.clone().sub(e).normalize();var o=e.distanceTo(t)*.5;var s=this.origin.clone().sub(n);var l=-this.direction.dot(a);var h=s.dot(this.direction);var u=-s.dot(a);var f=s.lengthSq();var c=Math.abs(1-l*l);var p,d,v,m;if(c>=0){p=l*u-h;d=l*h-u;m=o*c;if(p>=0){if(d>=-m){if(d<=m){var g=1/c;p*=g;d*=g;v=p*(p+l*d+2*h)+d*(l*p+d+2*u)+f}else{d=o;p=Math.max(0,-(l*d+h));v=-p*p+d*(d+2*u)+f}}else{d=-o;p=Math.max(0,-(l*d+h));v=-p*p+d*(d+2*u)+f}}else{if(d<=-m){p=Math.max(0,-(-l*o+h));d=p>0?-o:Math.min(Math.max(-o,-u),o);v=-p*p+d*(d+2*u)+f}else if(d<=m){p=0;d=Math.min(Math.max(-o,-u),o);v=d*(d+2*u)+f}else{p=Math.max(0,-(l*o+h));d=p>0?o:Math.min(Math.max(-o,-u),o);v=-p*p+d*(d+2*u)+f}}}else{d=l>0?-o:o;p=Math.max(0,-(l*d+h));v=-p*p+d*(d+2*u)+f}if(r){r.copy(this.direction.clone().multiplyScalar(p).add(this.origin))}if(i){i.copy(a.clone().multiplyScalar(d).add(n))}return v},isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},intersectSphere:function(){var e=new i.Vector3;return function(t,r){e.subVectors(t.center,this.origin);var i=e.dot(this.direction);var n=e.dot(e)-i*i;var a=t.radius*t.radius;if(n>a)return null;var o=Math.sqrt(a-n);var s=i-o;var l=i+o;if(s<0&&l<0)return null;if(s<0)return this.at(l,r);return this.at(s,r)}}(),isIntersectionPlane:function(e){var t=e.distanceToPoint(this.origin);if(t===0){return true}var r=e.normal.dot(this.direction);if(r*t<0){return true}return false},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(t==0){if(e.distanceToPoint(this.origin)==0){return 0}return null}var r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);if(r===null){return null}return this.at(r,t)},isIntersectionBox:function(){var e=new i.Vector3;return function(t){return this.intersectBox(t,e)!==null}}(),intersectBox:function(e,t){var r,i,n,a,o,s;var l=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z;var f=this.origin;if(l>=0){r=(e.min.x-f.x)*l;i=(e.max.x-f.x)*l}else{r=(e.max.x-f.x)*l;i=(e.min.x-f.x)*l}if(h>=0){n=(e.min.y-f.y)*h;a=(e.max.y-f.y)*h}else{n=(e.max.y-f.y)*h;a=(e.min.y-f.y)*h}if(r>a||n>i)return null;if(n>r||r!==r)r=n;if(a<i||i!==i)i=a;if(u>=0){o=(e.min.z-f.z)*u;s=(e.max.z-f.z)*u}else{o=(e.max.z-f.z)*u;s=(e.min.z-f.z)*u}if(r>s||o>i)return null;if(o>r||r!==r)r=o;if(s<i||i!==i)i=s;if(i<0)return null;return this.at(r>=0?r:i,t)},intersectTriangle:function(){var e=new i.Vector3;var t=new i.Vector3;var r=new i.Vector3;var n=new i.Vector3;return function(i,a,o,s,l){t.subVectors(a,i);r.subVectors(o,i);n.crossVectors(t,r);var h=this.direction.dot(n);var u;if(h>0){if(s)return null;u=1}else if(h<0){u=-1;h=-h}else{return null}e.subVectors(this.origin,i);var f=u*this.direction.dot(r.crossVectors(e,r));if(f<0){return null}var c=u*this.direction.dot(t.cross(e));if(c<0){return null}if(f+c>h){return null}var p=-u*e.dot(n);if(p<0){return null}return this.at(p/h,l)}}(),applyMatrix4:function(e){this.direction.add(this.origin).applyMatrix4(e);this.origin.applyMatrix4(e);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return(new i.Ray).copy(this)}};i.Sphere=function(e,t){this.center=e!==undefined?e:new i.Vector3;this.radius=t!==undefined?t:0};i.Sphere.prototype={constructor:i.Sphere,set:function(e,t){this.center.copy(e);this.radius=t;return this},setFromPoints:function(){var e=new i.Box3;return function(t,r){var i=this.center;if(r!==undefined){i.copy(r)}else{e.setFromPoints(t).center(i)}var n=0;for(var a=0,o=t.length;a<o;a++){n=Math.max(n,i.distanceToSquared(t[a]))}this.radius=Math.sqrt(n);return this}}(),copy:function(e){this.center.copy(e.center);this.radius=e.radius;return this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,t){var r=this.center.distanceToSquared(e);var n=t||new i.Vector3;n.copy(e);if(r>this.radius*this.radius){n.sub(this.center).normalize();n.multiplyScalar(this.radius).add(this.center)}return n},getBoundingBox:function(e){var t=e||new i.Box3;t.set(this.center,this.center);t.expandByScalar(this.radius);return t},applyMatrix4:function(e){this.center.applyMatrix4(e);this.radius=this.radius*e.getMaxScaleOnAxis();return this},translate:function(e){this.center.add(e);return this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius},clone:function(){return(new i.Sphere).copy(this)}};i.Frustum=function(e,t,r,n,a,o){this.planes=[e!==undefined?e:new i.Plane,t!==undefined?t:new i.Plane,r!==undefined?r:new i.Plane,n!==undefined?n:new i.Plane,a!==undefined?a:new i.Plane,o!==undefined?o:new i.Plane]};i.Frustum.prototype={constructor:i.Frustum,set:function(e,t,r,i,n,a){var o=this.planes;o[0].copy(e);o[1].copy(t);o[2].copy(r);o[3].copy(i);o[4].copy(n);o[5].copy(a);return this},copy:function(e){var t=this.planes;for(var r=0;r<6;r++){t[r].copy(e.planes[r])}return this},setFromMatrix:function(e){var t=this.planes;var r=e.elements;var i=r[0],n=r[1],a=r[2],o=r[3];var s=r[4],l=r[5],h=r[6],u=r[7];var f=r[8],c=r[9],p=r[10],d=r[11];var v=r[12],m=r[13],g=r[14],y=r[15];t[0].setComponents(o-i,u-s,d-f,y-v).normalize();t[1].setComponents(o+i,u+s,d+f,y+v).normalize();t[2].setComponents(o+n,u+l,d+c,y+m).normalize();t[3].setComponents(o-n,u-l,d-c,y-m).normalize();t[4].setComponents(o-a,u-h,d-p,y-g).normalize();t[5].setComponents(o+a,u+h,d+p,y+g).normalize();return this},intersectsObject:function(){var e=new i.Sphere;return function(t){var r=t.geometry;if(r.boundingSphere===null)r.computeBoundingSphere();e.copy(r.boundingSphere);e.applyMatrix4(t.matrixWorld);return this.intersectsSphere(e)}}(),intersectsSphere:function(e){var t=this.planes;var r=e.center;var i=-e.radius;for(var n=0;n<6;n++){var a=t[n].distanceToPoint(r);if(a<i){return false}}return true},intersectsBox:function(){var e=new i.Vector3,t=new i.Vector3;return function(r){var i=this.planes;for(var n=0;n<6;n++){var a=i[n];e.x=a.normal.x>0?r.min.x:r.max.x;t.x=a.normal.x>0?r.max.x:r.min.x;e.y=a.normal.y>0?r.min.y:r.max.y;t.y=a.normal.y>0?r.max.y:r.min.y;e.z=a.normal.z>0?r.min.z:r.max.z;t.z=a.normal.z>0?r.max.z:r.min.z;var o=a.distanceToPoint(e);var s=a.distanceToPoint(t);if(o<0&&s<0){return false}}return true}}(),containsPoint:function(e){var t=this.planes;for(var r=0;r<6;r++){if(t[r].distanceToPoint(e)<0){return false}}return true},clone:function(){return(new i.Frustum).copy(this)}};i.Plane=function(e,t){this.normal=e!==undefined?e:new i.Vector3(1,0,0);this.constant=t!==undefined?t:0};i.Plane.prototype={constructor:i.Plane,set:function(e,t){this.normal.copy(e);this.constant=t;return this},setComponents:function(e,t,r,i){this.normal.set(e,t,r);this.constant=i;return this},setFromNormalAndCoplanarPoint:function(e,t){this.normal.copy(e);this.constant=-t.dot(this.normal);return this},setFromCoplanarPoints:function(){var e=new i.Vector3;var t=new i.Vector3;return function(r,i,n){var a=e.subVectors(n,i).cross(t.subVectors(r,i)).normalize();this.setFromNormalAndCoplanarPoint(a,r);return this}}(),copy:function(e){this.normal.copy(e.normal);this.constant=e.constant;return this},normalize:function(){var e=1/this.normal.length();this.normal.multiplyScalar(e);this.constant*=e;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var r=this.distanceToPoint(e);var n=t||new i.Vector3;return n.copy(this.normal).multiplyScalar(r)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start);var r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0},intersectLine:function(){var e=new i.Vector3;return function(t,r){var n=r||new i.Vector3;var a=t.delta(e);var o=this.normal.dot(a);if(o==0){if(this.distanceToPoint(t.start)==0){return n.copy(t.start)}return undefined}var s=-(t.start.dot(this.normal)+this.constant)/o;if(s<0||s>1){return undefined}return n.copy(a).multiplyScalar(s).add(t.start)}}(),coplanarPoint:function(e){var t=e||new i.Vector3;return t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new i.Vector3;var t=new i.Vector3;var r=new i.Matrix3;return function(i,n){var a=n||r.getNormalMatrix(i);var o=e.copy(this.normal).applyMatrix3(a);var s=this.coplanarPoint(t);s.applyMatrix4(i);this.setFromNormalAndCoplanarPoint(o,s);return this}}(),translate:function(e){this.constant=this.constant-e.dot(this.normal);return this},equals:function(e){return e.normal.equals(this.normal)&&e.constant==this.constant},clone:function(){return(new i.Plane).copy(this)}};i.Math={generateUUID:function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");var t=new Array(36);var r=0,i;return function(){for(var n=0;n<36;n++){if(n==8||n==13||n==18||n==23){t[n]="-"}else if(n==14){t[n]="4"}else{if(r<=2)r=33554432+Math.random()*16777216|0;i=r&15;r=r>>4;t[n]=e[n==19?i&3|8:i]}}return t.join("")}}(),clamp:function(e,t,r){return e<t?t:e>r?r:e},clampBottom:function(e,t){return e<t?t:e},mapLinear:function(e,t,r,i,n){return i+(e-t)*(n-i)/(r-t)},smoothstep:function(e,t,r){if(e<=t)return 0;if(e>=r)return 1;e=(e-t)/(r-t);return e*e*(3-2*e)},smootherstep:function(e,t,r){if(e<=t)return 0;if(e>=r)return 1;e=(e-t)/(r-t);return e*e*e*(e*(e*6-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}(),isPowerOfTwo:function(e){return(e&e-1)===0&&e!==0}};i.Spline=function(e){this.points=e;var t=[],r={x:0,y:0,z:0},n,a,o,s,l,h,u,f,c;this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++){this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}}};this.getPoint=function(e){n=(this.points.length-1)*e;a=Math.floor(n);o=n-a;t[0]=a===0?a:a-1;t[1]=a;t[2]=a>this.points.length-2?this.points.length-1:a+1;t[3]=a>this.points.length-3?this.points.length-1:a+2;h=this.points[t[0]];u=this.points[t[1]];f=this.points[t[2]];c=this.points[t[3]];s=o*o;l=o*s;r.x=p(h.x,u.x,f.x,c.x,o,s,l);r.y=p(h.y,u.y,f.y,c.y,o,s,l);r.z=p(h.z,u.z,f.z,c.z,o,s,l);return r};this.getControlPointsArray=function(){var e,t,r=this.points.length,i=[];for(e=0;e<r;e++){t=this.points[e];i[e]=[t.x,t.y,t.z]}return i};this.getLength=function(e){var t,r,n,a,o=0,s=0,l=0,h=new i.Vector3,u=new i.Vector3,f=[],c=0;f[0]=0;if(!e)e=100;n=this.points.length*e;h.copy(this.points[0]);for(t=1;t<n;t++){r=t/n;a=this.getPoint(r);u.copy(a);c+=u.distanceTo(h);h.copy(a);o=(this.points.length-1)*r;s=Math.floor(o);if(s!=l){f[s]=c;l=s}}f[f.length]=c;return{chunks:f,total:c}};this.reparametrizeByArcLength=function(e){var t,r,n,a,o,s,l,h,u,f=[],c=new i.Vector3,p=this.getLength();f.push(c.copy(this.points[0]).clone());for(t=1;t<this.points.length;t++){l=p.chunks[t]-p.chunks[t-1];h=Math.ceil(e*l/p.total);a=(t-1)/(this.points.length-1);o=t/(this.points.length-1);for(r=1;r<h-1;r++){n=a+r*(1/h)*(o-a);u=this.getPoint(n);f.push(c.copy(u).clone())}f.push(c.copy(this.points[t]).clone())}this.points=f};function p(e,t,r,i,n,a,o){var s=(r-e)*.5,l=(i-t)*.5;return(2*(t-r)+s+l)*o+(-3*(t-r)-2*s-l)*a+s*n+t}};i.Triangle=function(e,t,r){this.a=e!==undefined?e:new i.Vector3;this.b=t!==undefined?t:new i.Vector3;this.c=r!==undefined?r:new i.Vector3};i.Triangle.normal=function(){var e=new i.Vector3;return function(t,r,n,a){var o=a||new i.Vector3;o.subVectors(n,r);e.subVectors(t,r);o.cross(e);var s=o.lengthSq();if(s>0){return o.multiplyScalar(1/Math.sqrt(s))}return o.set(0,0,0)}}();i.Triangle.barycoordFromPoint=function(){var e=new i.Vector3;var t=new i.Vector3;var r=new i.Vector3;return function(n,a,o,s,l){e.subVectors(s,a);t.subVectors(o,a);r.subVectors(n,a);var h=e.dot(e);var u=e.dot(t);var f=e.dot(r);var c=t.dot(t);var p=t.dot(r);var d=h*c-u*u;var v=l||new i.Vector3;if(d==0){return v.set(-2,-1,-1)}var m=1/d;var g=(c*f-u*p)*m;var y=(h*p-u*f)*m;return v.set(1-g-y,y,g)
}}();i.Triangle.containsPoint=function(){var e=new i.Vector3;return function(t,r,n,a){var o=i.Triangle.barycoordFromPoint(t,r,n,a,e);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}();i.Triangle.prototype={constructor:i.Triangle,set:function(e,t,r){this.a.copy(e);this.b.copy(t);this.c.copy(r);return this},setFromPointsAndIndices:function(e,t,r,i){this.a.copy(e[t]);this.b.copy(e[r]);this.c.copy(e[i]);return this},copy:function(e){this.a.copy(e.a);this.b.copy(e.b);this.c.copy(e.c);return this},area:function(){var e=new i.Vector3;var t=new i.Vector3;return function(){e.subVectors(this.c,this.b);t.subVectors(this.a,this.b);return e.cross(t).length()*.5}}(),midpoint:function(e){var t=e||new i.Vector3;return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return i.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){var t=e||new i.Plane;return t.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return i.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return i.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},clone:function(){return(new i.Triangle).copy(this)}};i.Clock=function(e){this.autoStart=e!==undefined?e:true;this.startTime=0;this.oldTime=0;this.elapsedTime=0;this.running=false};i.Clock.prototype={constructor:i.Clock,start:function(){this.startTime=self.performance!==undefined&&self.performance.now!==undefined?self.performance.now():Date.now();this.oldTime=this.startTime;this.running=true},stop:function(){this.getElapsedTime();this.running=false},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running){this.start()}if(this.running){var t=self.performance!==undefined&&self.performance.now!==undefined?self.performance.now():Date.now();e=.001*(t-this.oldTime);this.oldTime=t;this.elapsedTime+=e}return e}};i.EventDispatcher=function(){};i.EventDispatcher.prototype={constructor:i.EventDispatcher,apply:function(e){e.addEventListener=i.EventDispatcher.prototype.addEventListener;e.hasEventListener=i.EventDispatcher.prototype.hasEventListener;e.removeEventListener=i.EventDispatcher.prototype.removeEventListener;e.dispatchEvent=i.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){if(this._listeners===undefined)this._listeners={};var r=this._listeners;if(r[e]===undefined){r[e]=[]}if(r[e].indexOf(t)===-1){r[e].push(t)}},hasEventListener:function(e,t){if(this._listeners===undefined)return false;var r=this._listeners;if(r[e]!==undefined&&r[e].indexOf(t)!==-1){return true}return false},removeEventListener:function(e,t){if(this._listeners===undefined)return;var r=this._listeners;var i=r[e];if(i!==undefined){var n=i.indexOf(t);if(n!==-1){i.splice(n,1)}}},dispatchEvent:function(e){if(this._listeners===undefined)return;var t=this._listeners;var r=t[e.type];if(r!==undefined){e.target=this;var i=[];var n=r.length;for(var a=0;a<n;a++){i[a]=r[a]}for(var a=0;a<n;a++){i[a].call(this,e)}}}};(function(e){e.Raycaster=function(t,r,i,n){this.ray=new e.Ray(t,r);this.near=i||0;this.far=n||Infinity;this.params={Sprite:{},Mesh:{},PointCloud:{threshold:1},LOD:{},Line:{}}};var t=function(e,t){return e.distance-t.distance};var r=function(e,t,i,n){e.raycast(t,i);if(n===true){var a=e.children;for(var o=0,s=a.length;o<s;o++){r(a[o],t,i,true)}}};e.Raycaster.prototype={constructor:e.Raycaster,precision:1e-4,linePrecision:1,set:function(e,t){this.ray.set(e,t)},intersectObject:function(e,i){var n=[];r(e,this,n,i);n.sort(t);return n},intersectObjects:function(e,i){var n=[];if(e instanceof Array===false){console.log("THREE.Raycaster.intersectObjects: objects is not an Array.");return n}for(var a=0,o=e.length;a<o;a++){r(e[a],this,n,i)}n.sort(t);return n}}})(i);i.Object3D=function(){Object.defineProperty(this,"id",{value:i.Object3DIdCount++});this.uuid=i.Math.generateUUID();this.name="";this.type="Object3D";this.parent=undefined;this.children=[];this.up=i.Object3D.DefaultUp.clone();var e=this;var t=new i.Vector3;var r=new i.Euler;var n=new i.Quaternion;var a=new i.Vector3(1,1,1);var o=function(){n.setFromEuler(r,false)};var s=function(){r.setFromQuaternion(n,undefined,false)};r.onChange(o);n.onChange(s);Object.defineProperties(this,{position:{enumerable:true,value:t},rotation:{enumerable:true,value:r},quaternion:{enumerable:true,value:n},scale:{enumerable:true,value:a}});this.renderDepth=null;this.rotationAutoUpdate=true;this.matrix=new i.Matrix4;this.matrixWorld=new i.Matrix4;this.matrixAutoUpdate=true;this.matrixWorldNeedsUpdate=false;this.visible=true;this.castShadow=false;this.receiveShadow=false;this.frustumCulled=true;this.userData={}};i.Object3D.DefaultUp=new i.Vector3(0,1,0);i.Object3D.prototype={constructor:i.Object3D,get eulerOrder(){console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order.");return this.rotation.order},set eulerOrder(e){console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order.");this.rotation.order=e},get useQuaternion(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(e){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,true)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new i.Quaternion;return function(t,r){e.setFromAxisAngle(t,r);this.quaternion.multiply(e);return this}}(),rotateX:function(){var e=new i.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new i.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new i.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new i.Vector3;return function(t,r){e.copy(t).applyQuaternion(this.quaternion);this.position.add(e.multiplyScalar(r));return this}}(),translate:function(e,t){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(t,e)},translateX:function(){var e=new i.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new i.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new i.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new i.Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new i.Matrix4;return function(t){e.lookAt(t,this.position,this.up);this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++){this.add(arguments[t])}return this}if(e===this){console.error("THREE.Object3D.add:",e,"can't be added as a child of itself.");return this}if(e instanceof i.Object3D){if(e.parent!==undefined){e.parent.remove(e)}e.parent=this;e.dispatchEvent({type:"added"});this.children.push(e)}else{console.error("THREE.Object3D.add:",e,"is not an instance of THREE.Object3D.")}return this},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++){this.remove(arguments[t])}}var r=this.children.indexOf(e);if(r!==-1){e.parent=undefined;e.dispatchEvent({type:"removed"});this.children.splice(r,1)}},getChildByName:function(e,t){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(e,t)},getObjectById:function(e,t){if(this.id===e)return this;for(var r=0,i=this.children.length;r<i;r++){var n=this.children[r];var a=n.getObjectById(e,t);if(a!==undefined){return a}}return undefined},getObjectByName:function(e,t){if(this.name===e)return this;for(var r=0,i=this.children.length;r<i;r++){var n=this.children[r];var a=n.getObjectByName(e,t);if(a!==undefined){return a}}return undefined},getWorldPosition:function(e){var t=e||new i.Vector3;this.updateMatrixWorld(true);return t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new i.Vector3;var t=new i.Vector3;return function(r){var n=r||new i.Quaternion;this.updateMatrixWorld(true);this.matrixWorld.decompose(e,n,t);return n}}(),getWorldRotation:function(){var e=new i.Quaternion;return function(t){var r=t||new i.Euler;this.getWorldQuaternion(e);return r.setFromQuaternion(e,this.rotation.order,false)}}(),getWorldScale:function(){var e=new i.Vector3;var t=new i.Quaternion;return function(r){var n=r||new i.Vector3;this.updateMatrixWorld(true);this.matrixWorld.decompose(e,t,n);return n}}(),getWorldDirection:function(){var e=new i.Quaternion;return function(t){var r=t||new i.Vector3;this.getWorldQuaternion(e);return r.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=0,r=this.children.length;t<r;t++){this.children[t].traverse(e)}},traverseVisible:function(e){if(this.visible===false)return;e(this);for(var t=0,r=this.children.length;t<r;t++){this.children[t].traverseVisible(e)}},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=true},updateMatrixWorld:function(e){if(this.matrixAutoUpdate===true)this.updateMatrix();if(this.matrixWorldNeedsUpdate===true||e===true){if(this.parent===undefined){this.matrixWorld.copy(this.matrix)}else{this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)}this.matrixWorldNeedsUpdate=false;e=true}for(var t=0,r=this.children.length;t<r;t++){this.children[t].updateMatrixWorld(e)}},toJSON:function(){var e={metadata:{version:4.3,type:"Object",generator:"ObjectExporter"}};var t={};var r=function(r){if(e.geometries===undefined){e.geometries=[]}if(t[r.uuid]===undefined){var i=r.toJSON();delete i.metadata;t[r.uuid]=i;e.geometries.push(i)}return r.uuid};var n={};var a=function(t){if(e.materials===undefined){e.materials=[]}if(n[t.uuid]===undefined){var r=t.toJSON();delete r.metadata;n[t.uuid]=r;e.materials.push(r)}return t.uuid};var o=function(e){var t={};t.uuid=e.uuid;t.type=e.type;if(e.name!=="")t.name=e.name;if(JSON.stringify(e.userData)!=="{}")t.userData=e.userData;if(e.visible!==true)t.visible=e.visible;if(e instanceof i.PerspectiveCamera){t.fov=e.fov;t.aspect=e.aspect;t.near=e.near;t.far=e.far}else if(e instanceof i.OrthographicCamera){t.left=e.left;t.right=e.right;t.top=e.top;t.bottom=e.bottom;t.near=e.near;t.far=e.far}else if(e instanceof i.AmbientLight){t.color=e.color.getHex()}else if(e instanceof i.DirectionalLight){t.color=e.color.getHex();t.intensity=e.intensity}else if(e instanceof i.PointLight){t.color=e.color.getHex();t.intensity=e.intensity;t.distance=e.distance}else if(e instanceof i.SpotLight){t.color=e.color.getHex();t.intensity=e.intensity;t.distance=e.distance;t.angle=e.angle;t.exponent=e.exponent}else if(e instanceof i.HemisphereLight){t.color=e.color.getHex();t.groundColor=e.groundColor.getHex()}else if(e instanceof i.Mesh){t.geometry=r(e.geometry);t.material=a(e.material)}else if(e instanceof i.Line){t.geometry=r(e.geometry);t.material=a(e.material)}else if(e instanceof i.Sprite){t.material=a(e.material)}t.matrix=e.matrix.toArray();if(e.children.length>0){t.children=[];for(var n=0;n<e.children.length;n++){t.children.push(o(e.children[n]))}}return t};e.object=o(this);return e},clone:function(e,t){if(e===undefined)e=new i.Object3D;if(t===undefined)t=true;e.name=this.name;e.up.copy(this.up);e.position.copy(this.position);e.quaternion.copy(this.quaternion);e.scale.copy(this.scale);e.renderDepth=this.renderDepth;e.rotationAutoUpdate=this.rotationAutoUpdate;e.matrix.copy(this.matrix);e.matrixWorld.copy(this.matrixWorld);e.matrixAutoUpdate=this.matrixAutoUpdate;e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;e.visible=this.visible;e.castShadow=this.castShadow;e.receiveShadow=this.receiveShadow;e.frustumCulled=this.frustumCulled;e.userData=JSON.parse(JSON.stringify(this.userData));if(t===true){for(var r=0;r<this.children.length;r++){var n=this.children[r];e.add(n.clone())}}return e}};i.EventDispatcher.prototype.apply(i.Object3D.prototype);i.Object3DIdCount=0;i.Projector=function(){console.warn("THREE.Projector has been moved to /examples/renderers/Projector.js.");this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project().");e.project(t)};this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");e.unproject(t)};this.pickingRay=function(e,t){console.error("THREE.Projector: .pickingRay() has been removed.")}};i.Face3=function(e,t,r,n,a,o){this.a=e;this.b=t;this.c=r;this.normal=n instanceof i.Vector3?n:new i.Vector3;this.vertexNormals=n instanceof Array?n:[];this.color=a instanceof i.Color?a:new i.Color;this.vertexColors=a instanceof Array?a:[];this.vertexTangents=[];this.materialIndex=o!==undefined?o:0};i.Face3.prototype={constructor:i.Face3,clone:function(){var e=new i.Face3(this.a,this.b,this.c);e.normal.copy(this.normal);e.color.copy(this.color);e.materialIndex=this.materialIndex;for(var t=0,r=this.vertexNormals.length;t<r;t++){e.vertexNormals[t]=this.vertexNormals[t].clone()}for(var t=0,r=this.vertexColors.length;t<r;t++){e.vertexColors[t]=this.vertexColors[t].clone()}for(var t=0,r=this.vertexTangents.length;t<r;t++){e.vertexTangents[t]=this.vertexTangents[t].clone()}return e}};i.Face4=function(e,t,r,n,a,o,s){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new i.Face3(e,t,r,a,o,s)};i.BufferAttribute=function(e,t){this.array=e;this.itemSize=t;this.needsUpdate=false};i.BufferAttribute.prototype={constructor:i.BufferAttribute,get length(){return this.array.length},copyAt:function(e,t,r){e*=this.itemSize;r*=t.itemSize;for(var i=0,n=this.itemSize;i<n;i++){this.array[e+i]=t.array[r+i]}},set:function(e){this.array.set(e);return this},setX:function(e,t){this.array[e*this.itemSize]=t;return this},setY:function(e,t){this.array[e*this.itemSize+1]=t;return this},setZ:function(e,t){this.array[e*this.itemSize+2]=t;return this},setXY:function(e,t,r){e*=this.itemSize;this.array[e]=t;this.array[e+1]=r;return this},setXYZ:function(e,t,r,i){e*=this.itemSize;this.array[e]=t;this.array[e+1]=r;this.array[e+2]=i;return this},setXYZW:function(e,t,r,i,n){e*=this.itemSize;this.array[e]=t;this.array[e+1]=r;this.array[e+2]=i;this.array[e+3]=n;return this},clone:function(){return new i.BufferAttribute(new this.array.constructor(this.array),this.itemSize)}};i.Int8Attribute=function(e,t){console.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new i.BufferAttribute(e,t)};i.Uint8Attribute=function(e,t){console.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new i.BufferAttribute(e,t)};i.Uint8ClampedAttribute=function(e,t){console.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new i.BufferAttribute(e,t)};i.Int16Attribute=function(e,t){console.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new i.BufferAttribute(e,t)};i.Uint16Attribute=function(e,t){console.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new i.BufferAttribute(e,t)};i.Int32Attribute=function(e,t){console.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new i.BufferAttribute(e,t)};i.Uint32Attribute=function(e,t){console.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new i.BufferAttribute(e,t)};i.Float32Attribute=function(e,t){console.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new i.BufferAttribute(e,t)};i.Float64Attribute=function(e,t){console.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new i.BufferAttribute(e,t)};i.BufferGeometry=function(){Object.defineProperty(this,"id",{value:i.GeometryIdCount++});this.uuid=i.Math.generateUUID();this.name="";this.type="BufferGeometry";this.attributes={};this.attributesKeys=[];this.drawcalls=[];this.offsets=this.drawcalls;this.boundingBox=null;this.boundingSphere=null};i.BufferGeometry.prototype={constructor:i.BufferGeometry,addAttribute:function(e,t){if(t instanceof i.BufferAttribute===false){console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).");this.attributes[e]={array:arguments[1],itemSize:arguments[2]};return}this.attributes[e]=t;this.attributesKeys=Object.keys(this.attributes)},getAttribute:function(e){return this.attributes[e]},addDrawCall:function(e,t,r){this.drawcalls.push({start:e,count:t,index:r!==undefined?r:0})},applyMatrix:function(e){var t=this.attributes.position;if(t!==undefined){e.applyToVector3Array(t.array);t.needsUpdate=true}var r=this.attributes.normal;if(r!==undefined){var n=(new i.Matrix3).getNormalMatrix(e);n.applyToVector3Array(r.array);r.needsUpdate=true}},center:function(){},fromGeometry:function(e,t){t=t||{vertexColors:i.NoColors};var r=e.vertices;var n=e.faces;var a=e.faceVertexUvs;var o=t.vertexColors;var s=a[0].length>0;var l=n[0].vertexNormals.length==3;var h=new Float32Array(n.length*3*3);this.addAttribute("position",new i.BufferAttribute(h,3));var u=new Float32Array(n.length*3*3);this.addAttribute("normal",new i.BufferAttribute(u,3));if(o!==i.NoColors){var f=new Float32Array(n.length*3*3);this.addAttribute("color",new i.BufferAttribute(f,3))}if(s===true){var c=new Float32Array(n.length*3*2);this.addAttribute("uv",new i.BufferAttribute(c,2))}for(var p=0,d=0,v=0;p<n.length;p++,d+=6,v+=9){var m=n[p];var g=r[m.a];var y=r[m.b];var _=r[m.c];h[v]=g.x;h[v+1]=g.y;h[v+2]=g.z;h[v+3]=y.x;h[v+4]=y.y;h[v+5]=y.z;h[v+6]=_.x;h[v+7]=_.y;h[v+8]=_.z;if(l===true){var x=m.vertexNormals[0];var b=m.vertexNormals[1];var w=m.vertexNormals[2];u[v]=x.x;u[v+1]=x.y;u[v+2]=x.z;u[v+3]=b.x;u[v+4]=b.y;u[v+5]=b.z;u[v+6]=w.x;u[v+7]=w.y;u[v+8]=w.z}else{var T=m.normal;u[v]=T.x;u[v+1]=T.y;u[v+2]=T.z;u[v+3]=T.x;u[v+4]=T.y;u[v+5]=T.z;u[v+6]=T.x;u[v+7]=T.y;u[v+8]=T.z}if(o===i.FaceColors){var S=m.color;f[v]=S.r;f[v+1]=S.g;f[v+2]=S.b;f[v+3]=S.r;f[v+4]=S.g;f[v+5]=S.b;f[v+6]=S.r;f[v+7]=S.g;f[v+8]=S.b}else if(o===i.VertexColors){var M=m.vertexColors[0];var A=m.vertexColors[1];var E=m.vertexColors[2];f[v]=M.r;f[v+1]=M.g;f[v+2]=M.b;f[v+3]=A.r;f[v+4]=A.g;f[v+5]=A.b;f[v+6]=E.r;f[v+7]=E.g;f[v+8]=E.b}if(s===true){var C=a[0][p][0];var P=a[0][p][1];var R=a[0][p][2];c[d]=C.x;c[d+1]=C.y;c[d+2]=P.x;c[d+3]=P.y;c[d+4]=R.x;c[d+5]=R.y}}this.computeBoundingSphere();return this},computeBoundingBox:function(){var e=new i.Vector3;return function(){if(this.boundingBox===null){this.boundingBox=new i.Box3}var t=this.attributes.position.array;if(t){var r=this.boundingBox;r.makeEmpty();for(var n=0,a=t.length;n<a;n+=3){e.set(t[n],t[n+1],t[n+2]);r.expandByPoint(e)}}if(t===undefined||t.length===0){this.boundingBox.min.set(0,0,0);this.boundingBox.max.set(0,0,0)}if(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)){console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')}}}(),computeBoundingSphere:function(){var e=new i.Box3;var t=new i.Vector3;return function(){if(this.boundingSphere===null){this.boundingSphere=new i.Sphere}var r=this.attributes.position.array;if(r){e.makeEmpty();var n=this.boundingSphere.center;for(var a=0,o=r.length;a<o;a+=3){t.set(r[a],r[a+1],r[a+2]);e.expandByPoint(t)}e.center(n);var s=0;for(var a=0,o=r.length;a<o;a+=3){t.set(r[a],r[a+1],r[a+2]);s=Math.max(s,n.distanceToSquared(t))}this.boundingSphere.radius=Math.sqrt(s);if(isNaN(this.boundingSphere.radius)){console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.attributes;if(e.position){var t=e.position.array;if(e.normal===undefined){this.addAttribute("normal",new i.BufferAttribute(new Float32Array(t.length),3))}else{var r=e.normal.array;for(var n=0,a=r.length;n<a;n++){r[n]=0}}var r=e.normal.array;var o,s,l,h=new i.Vector3,u=new i.Vector3,f=new i.Vector3,c=new i.Vector3,p=new i.Vector3;if(e.index){var d=e.index.array;var v=this.offsets.length>0?this.offsets:[{start:0,count:d.length,index:0}];for(var m=0,g=v.length;m<g;++m){var y=v[m].start;var _=v[m].count;var x=v[m].index;for(var n=y,a=y+_;n<a;n+=3){o=(x+d[n])*3;s=(x+d[n+1])*3;l=(x+d[n+2])*3;h.fromArray(t,o);u.fromArray(t,s);f.fromArray(t,l);c.subVectors(f,u);p.subVectors(h,u);c.cross(p);r[o]+=c.x;r[o+1]+=c.y;r[o+2]+=c.z;r[s]+=c.x;r[s+1]+=c.y;r[s+2]+=c.z;r[l]+=c.x;r[l+1]+=c.y;r[l+2]+=c.z}}}else{for(var n=0,a=t.length;n<a;n+=9){h.fromArray(t,n);u.fromArray(t,n+3);f.fromArray(t,n+6);c.subVectors(f,u);p.subVectors(h,u);c.cross(p);r[n]=c.x;r[n+1]=c.y;r[n+2]=c.z;r[n+3]=c.x;r[n+4]=c.y;r[n+5]=c.z;r[n+6]=c.x;r[n+7]=c.y;r[n+8]=c.z}}this.normalizeNormals();e.normal.needsUpdate=true}},computeTangents:function(){if(this.attributes.index===undefined||this.attributes.position===undefined||this.attributes.normal===undefined||this.attributes.uv===undefined){console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");return}var e=this.attributes.index.array;var t=this.attributes.position.array;var r=this.attributes.normal.array;var n=this.attributes.uv.array;var a=t.length/3;if(this.attributes.tangent===undefined){this.addAttribute("tangent",new i.BufferAttribute(new Float32Array(4*a),4))}var o=this.attributes.tangent.array;var s=[],l=[];for(var h=0;h<a;h++){s[h]=new i.Vector3;l[h]=new i.Vector3}var u=new i.Vector3,f=new i.Vector3,c=new i.Vector3,p=new i.Vector2,d=new i.Vector2,v=new i.Vector2,m,g,y,_,x,b,w,T,S,M,A;var E=new i.Vector3,C=new i.Vector3;function P(e,r,i){u.fromArray(t,e*3);f.fromArray(t,r*3);c.fromArray(t,i*3);p.fromArray(n,e*2);d.fromArray(n,r*2);v.fromArray(n,i*2);m=f.x-u.x;g=c.x-u.x;y=f.y-u.y;_=c.y-u.y;x=f.z-u.z;b=c.z-u.z;w=d.x-p.x;T=v.x-p.x;S=d.y-p.y;M=v.y-p.y;A=1/(w*M-T*S);E.set((M*m-S*g)*A,(M*y-S*_)*A,(M*x-S*b)*A);C.set((w*g-T*m)*A,(w*_-T*y)*A,(w*b-T*x)*A);s[e].add(E);s[r].add(E);s[i].add(E);l[e].add(C);l[r].add(C);l[i].add(C)}var R,L;var k,F;var D,U,O;if(this.drawcalls.length===0){this.addDrawCall(0,e.length,0)}var j=this.drawcalls;for(k=0,F=j.length;k<F;++k){var V=j[k].start;var N=j[k].count;var B=j[k].index;for(R=V,L=V+N;R<L;R+=3){D=B+e[R];U=B+e[R+1];O=B+e[R+2];P(D,U,O)}}var z=new i.Vector3,I=new i.Vector3;var H=new i.Vector3,G=new i.Vector3;var W,X,Y;function q(e){H.fromArray(r,e*3);G.copy(H);X=s[e];z.copy(X);z.sub(H.multiplyScalar(H.dot(X))).normalize();I.crossVectors(G,X);Y=I.dot(l[e]);W=Y<0?-1:1;o[e*4]=z.x;o[e*4+1]=z.y;o[e*4+2]=z.z;o[e*4+3]=W}for(k=0,F=j.length;k<F;++k){var V=j[k].start;var N=j[k].count;var B=j[k].index;for(R=V,L=V+N;R<L;R+=3){D=B+e[R];U=B+e[R+1];O=B+e[R+2];q(D);q(U);q(O)}}},computeOffsets:function(e){var t=e;if(e===undefined)t=65535;var r=Date.now();var i=this.attributes.index.array;var n=this.attributes.position.array;var a=n.length/3;var o=i.length/3;var s=new Uint16Array(i.length);var l=0;var h=0;var u=[{start:0,count:0,index:0}];var f=u[0];var c=0;var p=0;var d=new Int32Array(6);var v=new Int32Array(n.length);var m=new Int32Array(n.length);for(var g=0;g<n.length;g++){v[g]=-1;m[g]=-1}for(var y=0;y<o;y++){p=0;for(var _=0;_<3;_++){var x=i[y*3+_];if(v[x]==-1){d[_*2]=x;d[_*2+1]=-1;p++}else if(v[x]<f.index){d[_*2]=x;d[_*2+1]=-1;c++}else{d[_*2]=x;d[_*2+1]=v[x]}}var b=h+p;if(b>f.index+t){var w={start:l,count:0,index:h};u.push(w);f=w;for(var T=0;T<6;T+=2){var S=d[T+1];if(S>-1&&S<f.index)d[T+1]=-1}}for(var T=0;T<6;T+=2){var x=d[T];var S=d[T+1];if(S===-1)S=h++;v[x]=S;m[S]=x;s[l++]=S-f.index;f.count++}}this.reorderBuffers(s,m,h);this.offsets=u;return u},merge:function(){console.log("BufferGeometry.merge(): TODO")},normalizeNormals:function(){var e=this.attributes.normal.array;var t,r,i,n;for(var a=0,o=e.length;a<o;a+=3){t=e[a];r=e[a+1];i=e[a+2];n=1/Math.sqrt(t*t+r*r+i*i);e[a]*=n;e[a+1]*=n;e[a+2]*=n}},reorderBuffers:function(e,t,r){var i={};for(var n in this.attributes){if(n=="index")continue;var a=this.attributes[n].array;i[n]=new a.constructor(this.attributes[n].itemSize*r)}for(var o=0;o<r;o++){var s=t[o];for(var n in this.attributes){if(n=="index")continue;var l=this.attributes[n].array;var h=this.attributes[n].itemSize;var u=i[n];for(var f=0;f<h;f++)u[o*h+f]=l[s*h+f]}}this.attributes["index"].array=e;for(var n in this.attributes){if(n=="index")continue;this.attributes[n].array=i[n];this.attributes[n].numItems=this.attributes[n].itemSize*r}},toJSON:function(){var e={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type,data:{attributes:{}}};var t=this.attributes;var r=this.offsets;var i=this.boundingSphere;for(var n in t){var a=t[n];var o=[],s=a.array;for(var l=0,h=s.length;l<h;l++){o[l]=s[l]}e.data.attributes[n]={itemSize:a.itemSize,type:a.array.constructor.name,array:o}}if(r.length>0){e.data.offsets=JSON.parse(JSON.stringify(r))}if(i!==null){e.data.boundingSphere={center:i.center.toArray(),radius:i.radius}}return e},clone:function(){var e=new i.BufferGeometry;for(var t in this.attributes){var r=this.attributes[t];e.addAttribute(t,r.clone())}for(var n=0,a=this.offsets.length;n<a;n++){var o=this.offsets[n];e.offsets.push({start:o.start,index:o.index,count:o.count})}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}};i.EventDispatcher.prototype.apply(i.BufferGeometry.prototype);i.Geometry=function(){Object.defineProperty(this,"id",{value:i.GeometryIdCount++});this.uuid=i.Math.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingBox=null;this.boundingSphere=null;this.hasTangents=false;this.dynamic=true;this.verticesNeedUpdate=false;this.elementsNeedUpdate=false;this.uvsNeedUpdate=false;this.normalsNeedUpdate=false;this.tangentsNeedUpdate=false;this.colorsNeedUpdate=false;this.lineDistancesNeedUpdate=false;this.groupsNeedUpdate=false};i.Geometry.prototype={constructor:i.Geometry,applyMatrix:function(e){var t=(new i.Matrix3).getNormalMatrix(e);for(var r=0,n=this.vertices.length;r<n;r++){var a=this.vertices[r];a.applyMatrix4(e)}for(var r=0,n=this.faces.length;r<n;r++){var o=this.faces[r];o.normal.applyMatrix3(t).normalize();for(var s=0,l=o.vertexNormals.length;s<l;s++){o.vertexNormals[s].applyMatrix3(t).normalize()}}if(this.boundingBox instanceof i.Box3){this.computeBoundingBox()}if(this.boundingSphere instanceof i.Sphere){this.computeBoundingSphere()}},fromBufferGeometry:function(e){var t=this;var r=e.attributes;var n=r.position.array;var a=r.index!==undefined?r.index.array:undefined;var o=r.normal!==undefined?r.normal.array:undefined;var s=r.color!==undefined?r.color.array:undefined;var l=r.uv!==undefined?r.uv.array:undefined;var h=[];var u=[];for(var f=0,c=0;f<n.length;f+=3,c+=2){t.vertices.push(new i.Vector3(n[f],n[f+1],n[f+2]));if(o!==undefined){h.push(new i.Vector3(o[f],o[f+1],o[f+2]))}if(s!==undefined){t.colors.push(new i.Color(s[f],s[f+1],s[f+2]))}if(l!==undefined){u.push(new i.Vector2(l[c],l[c+1]))}}var p=function(e,r,n){var a=o!==undefined?[h[e].clone(),h[r].clone(),h[n].clone()]:[];var l=s!==undefined?[t.colors[e].clone(),t.colors[r].clone(),t.colors[n].clone()]:[];t.faces.push(new i.Face3(e,r,n,a,l));t.faceVertexUvs[0].push([u[e],u[r],u[n]])};if(a!==undefined){for(var f=0;f<a.length;f+=3){p(a[f],a[f+1],a[f+2])}}else{for(var f=0;f<n.length/3;f+=3){p(f,f+1,f+2)}}this.computeFaceNormals();if(e.boundingBox!==null){this.boundingBox=e.boundingBox.clone()}if(e.boundingSphere!==null){this.boundingSphere=e.boundingSphere.clone()}return this},center:function(){this.computeBoundingBox();var e=new i.Vector3;e.addVectors(this.boundingBox.min,this.boundingBox.max);e.multiplyScalar(-.5);this.applyMatrix((new i.Matrix4).makeTranslation(e.x,e.y,e.z));this.computeBoundingBox();return e},computeFaceNormals:function(){var e=new i.Vector3,t=new i.Vector3;for(var r=0,n=this.faces.length;r<n;r++){var a=this.faces[r];var o=this.vertices[a.a];var s=this.vertices[a.b];var l=this.vertices[a.c];e.subVectors(l,s);t.subVectors(o,s);e.cross(t);e.normalize();a.normal.copy(e)}},computeVertexNormals:function(e){var t,r,n,a,o,s;s=new Array(this.vertices.length);for(t=0,r=this.vertices.length;t<r;t++){s[t]=new i.Vector3}if(e){var l,h,u,f;var c=new i.Vector3,p=new i.Vector3,d=new i.Vector3,v=new i.Vector3,m=new i.Vector3;for(n=0,a=this.faces.length;n<a;n++){o=this.faces[n];l=this.vertices[o.a];h=this.vertices[o.b];u=this.vertices[o.c];c.subVectors(u,h);p.subVectors(l,h);c.cross(p);s[o.a].add(c);s[o.b].add(c);s[o.c].add(c)}}else{for(n=0,a=this.faces.length;n<a;n++){o=this.faces[n];s[o.a].add(o.normal);s[o.b].add(o.normal);s[o.c].add(o.normal)}}for(t=0,r=this.vertices.length;t<r;t++){s[t].normalize()}for(n=0,a=this.faces.length;n<a;n++){o=this.faces[n];o.vertexNormals[0]=s[o.a].clone();o.vertexNormals[1]=s[o.b].clone();o.vertexNormals[2]=s[o.c].clone()}},computeMorphNormals:function(){var e,t,r,n,a;for(r=0,n=this.faces.length;r<n;r++){a=this.faces[r];if(!a.__originalFaceNormal){a.__originalFaceNormal=a.normal.clone()}else{a.__originalFaceNormal.copy(a.normal)}if(!a.__originalVertexNormals)a.__originalVertexNormals=[];for(e=0,t=a.vertexNormals.length;e<t;e++){if(!a.__originalVertexNormals[e]){a.__originalVertexNormals[e]=a.vertexNormals[e].clone()}else{a.__originalVertexNormals[e].copy(a.vertexNormals[e])}}}var o=new i.Geometry;o.faces=this.faces;for(e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={};this.morphNormals[e].faceNormals=[];this.morphNormals[e].vertexNormals=[];var s=this.morphNormals[e].faceNormals;var l=this.morphNormals[e].vertexNormals;var h,u;for(r=0,n=this.faces.length;r<n;r++){h=new i.Vector3;u={a:new i.Vector3,b:new i.Vector3,c:new i.Vector3};s.push(h);l.push(u)}}var f=this.morphNormals[e];o.vertices=this.morphTargets[e].vertices;o.computeFaceNormals();o.computeVertexNormals();var h,u;for(r=0,n=this.faces.length;r<n;r++){a=this.faces[r];h=f.faceNormals[r];u=f.vertexNormals[r];h.copy(a.normal);u.a.copy(a.vertexNormals[0]);u.b.copy(a.vertexNormals[1]);u.c.copy(a.vertexNormals[2])}}for(r=0,n=this.faces.length;r<n;r++){a=this.faces[r];a.normal=a.__originalFaceNormal;a.vertexNormals=a.__originalVertexNormals}},computeTangents:function(){var e,t,r,n,a,o,s,l,h,u,f,c,p,d,v,m,g,y,_,x,b,w,T,S,M,A,E,C,P=[],R=[],L=new i.Vector3,k=new i.Vector3,F=new i.Vector3,D=new i.Vector3,U=new i.Vector3,O;for(r=0,n=this.vertices.length;r<n;r++){P[r]=new i.Vector3;R[r]=new i.Vector3}function j(e,t,r,i,n,a,o){u=e.vertices[t];f=e.vertices[r];c=e.vertices[i];p=h[n];d=h[a];v=h[o];m=f.x-u.x;g=c.x-u.x;y=f.y-u.y;_=c.y-u.y;x=f.z-u.z;b=c.z-u.z;w=d.x-p.x;T=v.x-p.x;S=d.y-p.y;M=v.y-p.y;A=1/(w*M-T*S);L.set((M*m-S*g)*A,(M*y-S*_)*A,(M*x-S*b)*A);k.set((w*g-T*m)*A,(w*_-T*y)*A,(w*b-T*x)*A);P[t].add(L);P[r].add(L);P[i].add(L);R[t].add(k);R[r].add(k);R[i].add(k)}for(e=0,t=this.faces.length;e<t;e++){l=this.faces[e];h=this.faceVertexUvs[0][e];j(this,l.a,l.b,l.c,0,1,2)}var V=["a","b","c","d"];for(e=0,t=this.faces.length;e<t;e++){l=this.faces[e];for(a=0;a<Math.min(l.vertexNormals.length,3);a++){U.copy(l.vertexNormals[a]);s=l[V[a]];
E=P[s];F.copy(E);F.sub(U.multiplyScalar(U.dot(E))).normalize();D.crossVectors(l.vertexNormals[a],E);C=D.dot(R[s]);O=C<0?-1:1;l.vertexTangents[a]=new i.Vector4(F.x,F.y,F.z,O)}}this.hasTangents=true},computeLineDistances:function(){var e=0;var t=this.vertices;for(var r=0,i=t.length;r<i;r++){if(r>0){e+=t[r].distanceTo(t[r-1])}this.lineDistances[r]=e}},computeBoundingBox:function(){if(this.boundingBox===null){this.boundingBox=new i.Box3}this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){if(this.boundingSphere===null){this.boundingSphere=new i.Sphere}this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(e instanceof i.Geometry===false){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}var n,a=this.vertices.length,o=this.vertices,s=e.vertices,l=this.faces,h=e.faces,u=this.faceVertexUvs[0],f=e.faceVertexUvs[0];if(r===undefined)r=0;if(t!==undefined){n=(new i.Matrix3).getNormalMatrix(t)}for(var c=0,p=s.length;c<p;c++){var d=s[c];var v=d.clone();if(t!==undefined)v.applyMatrix4(t);o.push(v)}for(c=0,p=h.length;c<p;c++){var m=h[c],g,y,_,x=m.vertexNormals,b=m.vertexColors;g=new i.Face3(m.a+a,m.b+a,m.c+a);g.normal.copy(m.normal);if(n!==undefined){g.normal.applyMatrix3(n).normalize()}for(var w=0,T=x.length;w<T;w++){y=x[w].clone();if(n!==undefined){y.applyMatrix3(n).normalize()}g.vertexNormals.push(y)}g.color.copy(m.color);for(var w=0,T=b.length;w<T;w++){_=b[w];g.vertexColors.push(_.clone())}g.materialIndex=m.materialIndex+r;l.push(g)}for(c=0,p=f.length;c<p;c++){var S=f[c],M=[];if(S===undefined){continue}for(var w=0,T=S.length;w<T;w++){M.push(new i.Vector2(S[w].x,S[w].y))}u.push(M)}},mergeVertices:function(){var e={};var t=[],r=[];var i,n;var a=4;var o=Math.pow(10,a);var s,l,h;var u,f,c,p,d;for(s=0,l=this.vertices.length;s<l;s++){i=this.vertices[s];n=Math.round(i.x*o)+"_"+Math.round(i.y*o)+"_"+Math.round(i.z*o);if(e[n]===undefined){e[n]=s;t.push(this.vertices[s]);r[s]=t.length-1}else{r[s]=r[e[n]]}}var v=[];for(s=0,l=this.faces.length;s<l;s++){h=this.faces[s];h.a=r[h.a];h.b=r[h.b];h.c=r[h.c];u=[h.a,h.b,h.c];var m=-1;for(var g=0;g<3;g++){if(u[g]==u[(g+1)%3]){m=g;v.push(s);break}}}for(s=v.length-1;s>=0;s--){var y=v[s];this.faces.splice(y,1);for(c=0,p=this.faceVertexUvs.length;c<p;c++){this.faceVertexUvs[c].splice(y,1)}}var _=this.vertices.length-t.length;this.vertices=t;return _},toJSON:function(){var e={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type};if(this.name!=="")e.name=this.name;if(this.parameters!==undefined){var t=this.parameters;for(var r in t){if(t[r]!==undefined)e[r]=t[r]}return e}var i=[];for(var n=0;n<this.vertices.length;n++){var a=this.vertices[n];i.push(a.x,a.y,a.z)}var o=[];var s=[];var l={};var h=[];var u={};var f=[];var c={};for(var n=0;n<this.faces.length;n++){var p=this.faces[n];var d=false;var v=false;var m=this.faceVertexUvs[0][n]!==undefined;var g=p.normal.length()>0;var y=p.vertexNormals.length>0;var _=p.color.r!==1||p.color.g!==1||p.color.b!==1;var x=p.vertexColors.length>0;var b=0;b=M(b,0,0);b=M(b,1,d);b=M(b,2,v);b=M(b,3,m);b=M(b,4,g);b=M(b,5,y);b=M(b,6,_);b=M(b,7,x);o.push(b);o.push(p.a,p.b,p.c);if(m){var w=this.faceVertexUvs[0][n];o.push(C(w[0]),C(w[1]),C(w[2]))}if(g){o.push(A(p.normal))}if(y){var T=p.vertexNormals;o.push(A(T[0]),A(T[1]),A(T[2]))}if(_){o.push(E(p.color))}if(x){var S=p.vertexColors;o.push(E(S[0]),E(S[1]),E(S[2]))}}function M(e,t,r){return r?e|1<<t:e&~(1<<t)}function A(e){var t=e.x.toString()+e.y.toString()+e.z.toString();if(l[t]!==undefined){return l[t]}l[t]=s.length/3;s.push(e.x,e.y,e.z);return l[t]}function E(e){var t=e.r.toString()+e.g.toString()+e.b.toString();if(u[t]!==undefined){return u[t]}u[t]=h.length;h.push(e.getHex());return u[t]}function C(e){var t=e.x.toString()+e.y.toString();if(c[t]!==undefined){return c[t]}c[t]=f.length/2;f.push(e.x,e.y);return c[t]}e.data={};e.data.vertices=i;e.data.normals=s;if(h.length>0)e.data.colors=h;if(f.length>0)e.data.uvs=[f];e.data.faces=o;return e},clone:function(){var e=new i.Geometry;var t=this.vertices;for(var r=0,n=t.length;r<n;r++){e.vertices.push(t[r].clone())}var a=this.faces;for(var r=0,n=a.length;r<n;r++){e.faces.push(a[r].clone())}var o=this.faceVertexUvs[0];for(var r=0,n=o.length;r<n;r++){var s=o[r],l=[];for(var h=0,u=s.length;h<u;h++){l.push(new i.Vector2(s[h].x,s[h].y))}e.faceVertexUvs[0].push(l)}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}};i.EventDispatcher.prototype.apply(i.Geometry.prototype);i.GeometryIdCount=0;i.Camera=function(){i.Object3D.call(this);this.type="Camera";this.matrixWorldInverse=new i.Matrix4;this.projectionMatrix=new i.Matrix4};i.Camera.prototype=Object.create(i.Object3D.prototype);i.Camera.prototype.getWorldDirection=function(){var e=new i.Quaternion;return function(t){var r=t||new i.Vector3;this.getWorldQuaternion(e);return r.set(0,0,-1).applyQuaternion(e)}}();i.Camera.prototype.lookAt=function(){var e=new i.Matrix4;return function(t){e.lookAt(this.position,t,this.up);this.quaternion.setFromRotationMatrix(e)}}();i.Camera.prototype.clone=function(e){if(e===undefined)e=new i.Camera;i.Object3D.prototype.clone.call(this,e);e.matrixWorldInverse.copy(this.matrixWorldInverse);e.projectionMatrix.copy(this.projectionMatrix);return e};i.CubeCamera=function(e,t,r){i.Object3D.call(this);this.type="CubeCamera";var n=90,a=1;var o=new i.PerspectiveCamera(n,a,e,t);o.up.set(0,-1,0);o.lookAt(new i.Vector3(1,0,0));this.add(o);var s=new i.PerspectiveCamera(n,a,e,t);s.up.set(0,-1,0);s.lookAt(new i.Vector3(-1,0,0));this.add(s);var l=new i.PerspectiveCamera(n,a,e,t);l.up.set(0,0,1);l.lookAt(new i.Vector3(0,1,0));this.add(l);var h=new i.PerspectiveCamera(n,a,e,t);h.up.set(0,0,-1);h.lookAt(new i.Vector3(0,-1,0));this.add(h);var u=new i.PerspectiveCamera(n,a,e,t);u.up.set(0,-1,0);u.lookAt(new i.Vector3(0,0,1));this.add(u);var f=new i.PerspectiveCamera(n,a,e,t);f.up.set(0,-1,0);f.lookAt(new i.Vector3(0,0,-1));this.add(f);this.renderTarget=new i.WebGLRenderTargetCube(r,r,{format:i.RGBFormat,magFilter:i.LinearFilter,minFilter:i.LinearFilter});this.updateCubeMap=function(e,t){var r=this.renderTarget;var i=r.generateMipmaps;r.generateMipmaps=false;r.activeCubeFace=0;e.render(t,o,r);r.activeCubeFace=1;e.render(t,s,r);r.activeCubeFace=2;e.render(t,l,r);r.activeCubeFace=3;e.render(t,h,r);r.activeCubeFace=4;e.render(t,u,r);r.generateMipmaps=i;r.activeCubeFace=5;e.render(t,f,r)}};i.CubeCamera.prototype=Object.create(i.Object3D.prototype);i.OrthographicCamera=function(e,t,r,n,a,o){i.Camera.call(this);this.type="OrthographicCamera";this.zoom=1;this.left=e;this.right=t;this.top=r;this.bottom=n;this.near=a!==undefined?a:.1;this.far=o!==undefined?o:2e3;this.updateProjectionMatrix()};i.OrthographicCamera.prototype=Object.create(i.Camera.prototype);i.OrthographicCamera.prototype.updateProjectionMatrix=function(){var e=(this.right-this.left)/(2*this.zoom);var t=(this.top-this.bottom)/(2*this.zoom);var r=(this.right+this.left)/2;var i=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(r-e,r+e,i+t,i-t,this.near,this.far)};i.OrthographicCamera.prototype.clone=function(){var e=new i.OrthographicCamera;i.Camera.prototype.clone.call(this,e);e.zoom=this.zoom;e.left=this.left;e.right=this.right;e.top=this.top;e.bottom=this.bottom;e.near=this.near;e.far=this.far;e.projectionMatrix.copy(this.projectionMatrix);return e};i.PerspectiveCamera=function(e,t,r,n){i.Camera.call(this);this.type="PerspectiveCamera";this.zoom=1;this.fov=e!==undefined?e:50;this.aspect=t!==undefined?t:1;this.near=r!==undefined?r:.1;this.far=n!==undefined?n:2e3;this.updateProjectionMatrix()};i.PerspectiveCamera.prototype=Object.create(i.Camera.prototype);i.PerspectiveCamera.prototype.setLens=function(e,t){if(t===undefined)t=24;this.fov=2*i.Math.radToDeg(Math.atan(t/(e*2)));this.updateProjectionMatrix()};i.PerspectiveCamera.prototype.setViewOffset=function(e,t,r,i,n,a){this.fullWidth=e;this.fullHeight=t;this.x=r;this.y=i;this.width=n;this.height=a;this.updateProjectionMatrix()};i.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var e=i.Math.radToDeg(2*Math.atan(Math.tan(i.Math.degToRad(this.fov)*.5)/this.zoom));if(this.fullWidth){var t=this.fullWidth/this.fullHeight;var r=Math.tan(i.Math.degToRad(e*.5))*this.near;var n=-r;var a=t*n;var o=t*r;var s=Math.abs(o-a);var l=Math.abs(r-n);this.projectionMatrix.makeFrustum(a+this.x*s/this.fullWidth,a+(this.x+this.width)*s/this.fullWidth,r-(this.y+this.height)*l/this.fullHeight,r-this.y*l/this.fullHeight,this.near,this.far)}else{this.projectionMatrix.makePerspective(e,this.aspect,this.near,this.far)}};i.PerspectiveCamera.prototype.clone=function(){var e=new i.PerspectiveCamera;i.Camera.prototype.clone.call(this,e);e.zoom=this.zoom;e.fov=this.fov;e.aspect=this.aspect;e.near=this.near;e.far=this.far;e.projectionMatrix.copy(this.projectionMatrix);return e};i.Light=function(e){i.Object3D.call(this);this.type="Light";this.color=new i.Color(e)};i.Light.prototype=Object.create(i.Object3D.prototype);i.Light.prototype.clone=function(e){if(e===undefined)e=new i.Light;i.Object3D.prototype.clone.call(this,e);e.color.copy(this.color);return e};i.AmbientLight=function(e){i.Light.call(this,e);this.type="AmbientLight"};i.AmbientLight.prototype=Object.create(i.Light.prototype);i.AmbientLight.prototype.clone=function(){var e=new i.AmbientLight;i.Light.prototype.clone.call(this,e);return e};i.AreaLight=function(e,t){i.Light.call(this,e);this.type="AreaLight";this.normal=new i.Vector3(0,-1,0);this.right=new i.Vector3(1,0,0);this.intensity=t!==undefined?t:1;this.width=1;this.height=1;this.constantAttenuation=1.5;this.linearAttenuation=.5;this.quadraticAttenuation=.1};i.AreaLight.prototype=Object.create(i.Light.prototype);i.DirectionalLight=function(e,t){i.Light.call(this,e);this.type="DirectionalLight";this.position.set(0,1,0);this.target=new i.Object3D;this.intensity=t!==undefined?t:1;this.castShadow=false;this.onlyShadow=false;this.shadowCameraNear=50;this.shadowCameraFar=5e3;this.shadowCameraLeft=-500;this.shadowCameraRight=500;this.shadowCameraTop=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=false;this.shadowBias=0;this.shadowDarkness=.5;this.shadowMapWidth=512;this.shadowMapHeight=512;this.shadowCascade=false;this.shadowCascadeOffset=new i.Vector3(0,0,-1e3);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,.99,.998];this.shadowCascadeFarZ=[.99,.998,1];this.shadowCascadeArray=[];this.shadowMap=null;this.shadowMapSize=null;this.shadowCamera=null;this.shadowMatrix=null};i.DirectionalLight.prototype=Object.create(i.Light.prototype);i.DirectionalLight.prototype.clone=function(){var e=new i.DirectionalLight;i.Light.prototype.clone.call(this,e);e.target=this.target.clone();e.intensity=this.intensity;e.castShadow=this.castShadow;e.onlyShadow=this.onlyShadow;e.shadowCameraNear=this.shadowCameraNear;e.shadowCameraFar=this.shadowCameraFar;e.shadowCameraLeft=this.shadowCameraLeft;e.shadowCameraRight=this.shadowCameraRight;e.shadowCameraTop=this.shadowCameraTop;e.shadowCameraBottom=this.shadowCameraBottom;e.shadowCameraVisible=this.shadowCameraVisible;e.shadowBias=this.shadowBias;e.shadowDarkness=this.shadowDarkness;e.shadowMapWidth=this.shadowMapWidth;e.shadowMapHeight=this.shadowMapHeight;e.shadowCascade=this.shadowCascade;e.shadowCascadeOffset.copy(this.shadowCascadeOffset);e.shadowCascadeCount=this.shadowCascadeCount;e.shadowCascadeBias=this.shadowCascadeBias.slice(0);e.shadowCascadeWidth=this.shadowCascadeWidth.slice(0);e.shadowCascadeHeight=this.shadowCascadeHeight.slice(0);e.shadowCascadeNearZ=this.shadowCascadeNearZ.slice(0);e.shadowCascadeFarZ=this.shadowCascadeFarZ.slice(0);return e};i.HemisphereLight=function(e,t,r){i.Light.call(this,e);this.type="HemisphereLight";this.position.set(0,100,0);this.groundColor=new i.Color(t);this.intensity=r!==undefined?r:1};i.HemisphereLight.prototype=Object.create(i.Light.prototype);i.HemisphereLight.prototype.clone=function(){var e=new i.HemisphereLight;i.Light.prototype.clone.call(this,e);e.groundColor.copy(this.groundColor);e.intensity=this.intensity;return e};i.PointLight=function(e,t,r){i.Light.call(this,e);this.type="PointLight";this.intensity=t!==undefined?t:1;this.distance=r!==undefined?r:0};i.PointLight.prototype=Object.create(i.Light.prototype);i.PointLight.prototype.clone=function(){var e=new i.PointLight;i.Light.prototype.clone.call(this,e);e.intensity=this.intensity;e.distance=this.distance;return e};i.SpotLight=function(e,t,r,n,a){i.Light.call(this,e);this.type="SpotLight";this.position.set(0,1,0);this.target=new i.Object3D;this.intensity=t!==undefined?t:1;this.distance=r!==undefined?r:0;this.angle=n!==undefined?n:Math.PI/3;this.exponent=a!==undefined?a:10;this.castShadow=false;this.onlyShadow=false;this.shadowCameraNear=50;this.shadowCameraFar=5e3;this.shadowCameraFov=50;this.shadowCameraVisible=false;this.shadowBias=0;this.shadowDarkness=.5;this.shadowMapWidth=512;this.shadowMapHeight=512;this.shadowMap=null;this.shadowMapSize=null;this.shadowCamera=null;this.shadowMatrix=null};i.SpotLight.prototype=Object.create(i.Light.prototype);i.SpotLight.prototype.clone=function(){var e=new i.SpotLight;i.Light.prototype.clone.call(this,e);e.target=this.target.clone();e.intensity=this.intensity;e.distance=this.distance;e.angle=this.angle;e.exponent=this.exponent;e.castShadow=this.castShadow;e.onlyShadow=this.onlyShadow;e.shadowCameraNear=this.shadowCameraNear;e.shadowCameraFar=this.shadowCameraFar;e.shadowCameraFov=this.shadowCameraFov;e.shadowCameraVisible=this.shadowCameraVisible;e.shadowBias=this.shadowBias;e.shadowDarkness=this.shadowDarkness;e.shadowMapWidth=this.shadowMapWidth;e.shadowMapHeight=this.shadowMapHeight;return e};i.Cache=function(){this.files={}};i.Cache.prototype={constructor:i.Cache,add:function(e,t){this.files[e]=t},get:function(e){return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};i.Loader=function(e){this.showStatus=e;this.statusDomElement=e?i.Loader.prototype.addStatusElement():null;this.imageLoader=new i.ImageLoader;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};i.Loader.prototype={constructor:i.Loader,crossOrigin:undefined,addStatusElement:function(){var e=document.createElement("div");e.style.position="absolute";e.style.right="0px";e.style.top="0px";e.style.fontSize="0.8em";e.style.textAlign="left";e.style.background="rgba(0,0,0,0.25)";e.style.color="#fff";e.style.width="120px";e.style.padding="0.5em 0.5em 0.5em 0.5em";e.style.zIndex=1e3;e.innerHTML="Loading ...";return e},updateProgress:function(e){var t="Loaded ";if(e.total){t+=(100*e.loaded/e.total).toFixed(0)+"%"}else{t+=(e.loaded/1024).toFixed(2)+" KB"}this.statusDomElement.innerHTML=t},extractUrlBase:function(e){var t=e.split("/");if(t.length===1)return"./";t.pop();return t.join("/")+"/"},initMaterials:function(e,t){var r=[];for(var i=0;i<e.length;++i){r[i]=this.createMaterial(e[i],t)}return r},needsTangents:function(e){for(var t=0,r=e.length;t<r;t++){var n=e[t];if(n instanceof i.ShaderMaterial)return true}return false},createMaterial:function(e,t){var r=this;function n(e){var t=Math.log(e)/Math.LN2;return Math.pow(2,Math.round(t))}function a(e,a,o,s,l,h,u){var f=t+o;var c;var p=i.Loader.Handlers.get(f);if(p!==null){c=p.load(f)}else{c=new i.Texture;p=r.imageLoader;p.crossOrigin=r.crossOrigin;p.load(f,function(e){if(i.Math.isPowerOfTwo(e.width)===false||i.Math.isPowerOfTwo(e.height)===false){var t=n(e.width);var r=n(e.height);var a=document.createElement("canvas");a.width=t;a.height=r;var o=a.getContext("2d");o.drawImage(e,0,0,t,r);c.image=a}else{c.image=e}c.needsUpdate=true})}c.sourceFile=o;if(s){c.repeat.set(s[0],s[1]);if(s[0]!==1)c.wrapS=i.RepeatWrapping;if(s[1]!==1)c.wrapT=i.RepeatWrapping}if(l){c.offset.set(l[0],l[1])}if(h){var d={repeat:i.RepeatWrapping,mirror:i.MirroredRepeatWrapping};if(d[h[0]]!==undefined)c.wrapS=d[h[0]];if(d[h[1]]!==undefined)c.wrapT=d[h[1]]}if(u){c.anisotropy=u}e[a]=c}function o(e){return(e[0]*255<<16)+(e[1]*255<<8)+e[2]*255}var s="MeshLambertMaterial";var l={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:false};if(e.shading){var h=e.shading.toLowerCase();if(h==="phong")s="MeshPhongMaterial";else if(h==="basic")s="MeshBasicMaterial"}if(e.blending!==undefined&&i[e.blending]!==undefined){l.blending=i[e.blending]}if(e.transparent!==undefined||e.opacity<1){l.transparent=e.transparent}if(e.depthTest!==undefined){l.depthTest=e.depthTest}if(e.depthWrite!==undefined){l.depthWrite=e.depthWrite}if(e.visible!==undefined){l.visible=e.visible}if(e.flipSided!==undefined){l.side=i.BackSide}if(e.doubleSided!==undefined){l.side=i.DoubleSide}if(e.wireframe!==undefined){l.wireframe=e.wireframe}if(e.vertexColors!==undefined){if(e.vertexColors==="face"){l.vertexColors=i.FaceColors}else if(e.vertexColors){l.vertexColors=i.VertexColors}}if(e.colorDiffuse){l.color=o(e.colorDiffuse)}else if(e.DbgColor){l.color=e.DbgColor}if(e.colorSpecular){l.specular=o(e.colorSpecular)}if(e.colorAmbient){l.ambient=o(e.colorAmbient)}if(e.colorEmissive){l.emissive=o(e.colorEmissive)}if(e.transparency){l.opacity=e.transparency}if(e.specularCoef){l.shininess=e.specularCoef}if(e.mapDiffuse&&t){a(l,"map",e.mapDiffuse,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy)}if(e.mapLight&&t){a(l,"lightMap",e.mapLight,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy)}if(e.mapBump&&t){a(l,"bumpMap",e.mapBump,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy)}if(e.mapNormal&&t){a(l,"normalMap",e.mapNormal,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy)}if(e.mapSpecular&&t){a(l,"specularMap",e.mapSpecular,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy)}if(e.mapAlpha&&t){a(l,"alphaMap",e.mapAlpha,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy)}if(e.mapBumpScale){l.bumpScale=e.mapBumpScale}if(e.mapNormal){var u=i.ShaderLib["normalmap"];var f=i.UniformsUtils.clone(u.uniforms);f["tNormal"].value=l.normalMap;if(e.mapNormalFactor){f["uNormalScale"].value.set(e.mapNormalFactor,e.mapNormalFactor)}if(l.map){f["tDiffuse"].value=l.map;f["enableDiffuse"].value=true}if(l.specularMap){f["tSpecular"].value=l.specularMap;f["enableSpecular"].value=true}if(l.lightMap){f["tAO"].value=l.lightMap;f["enableAO"].value=true}f["diffuse"].value.setHex(l.color);f["specular"].value.setHex(l.specular);f["ambient"].value.setHex(l.ambient);f["shininess"].value=l.shininess;if(l.opacity!==undefined){f["opacity"].value=l.opacity}var c={fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:f,lights:true,fog:true};var p=new i.ShaderMaterial(c);if(l.transparent){p.transparent=true}}else{var p=new i[s](l)}if(e.DbgName!==undefined)p.name=e.DbgName;return p}};i.Loader.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=0,r=this.handlers.length;t<r;t+=2){var i=this.handlers[t];var n=this.handlers[t+1];if(i.test(e)){return n}}return null}};i.XHRLoader=function(e){this.cache=new i.Cache;this.manager=e!==undefined?e:i.DefaultLoadingManager};i.XHRLoader.prototype={constructor:i.XHRLoader,load:function(e,t,r,i){var n=this;var a=n.cache.get(e);if(a!==undefined){if(t)t(a);return}var o=new XMLHttpRequest;o.open("GET",e,true);o.addEventListener("load",function(r){n.cache.add(e,this.response);if(t)t(this.response);n.manager.itemEnd(e)},false);if(r!==undefined){o.addEventListener("progress",function(e){r(e)},false)}if(i!==undefined){o.addEventListener("error",function(e){i(e)},false)}if(this.crossOrigin!==undefined)o.crossOrigin=this.crossOrigin;if(this.responseType!==undefined)o.responseType=this.responseType;o.send(null);n.manager.itemStart(e)},setResponseType:function(e){this.responseType=e},setCrossOrigin:function(e){this.crossOrigin=e}};i.ImageLoader=function(e){this.cache=new i.Cache;this.manager=e!==undefined?e:i.DefaultLoadingManager};i.ImageLoader.prototype={constructor:i.ImageLoader,load:function(e,t,r,i){var n=this;var a=n.cache.get(e);if(a!==undefined){t(a);return}var o=document.createElement("img");if(t!==undefined){o.addEventListener("load",function(r){n.cache.add(e,this);t(this);n.manager.itemEnd(e)},false)}if(r!==undefined){o.addEventListener("progress",function(e){r(e)},false)}if(i!==undefined){o.addEventListener("error",function(e){i(e)},false)}if(this.crossOrigin!==undefined)o.crossOrigin=this.crossOrigin;o.src=e;n.manager.itemStart(e);return o},setCrossOrigin:function(e){this.crossOrigin=e}};i.JSONLoader=function(e){i.Loader.call(this,e);this.withCredentials=false};i.JSONLoader.prototype=Object.create(i.Loader.prototype);i.JSONLoader.prototype.load=function(e,t,r){var i=this;r=r&&typeof r==="string"?r:this.extractUrlBase(e);this.onLoadStart();this.loadAjaxJSON(this,e,t,r)};i.JSONLoader.prototype.loadAjaxJSON=function(e,t,r,i,n){var a=new XMLHttpRequest;var o=0;a.onreadystatechange=function(){if(a.readyState===a.DONE){if(a.status===200||a.status===0){if(a.responseText){var s=JSON.parse(a.responseText);if(s.metadata!==undefined&&s.metadata.type==="scene"){console.error('THREE.JSONLoader: "'+t+'" seems to be a Scene. Use THREE.SceneLoader instead.');return}var l=e.parse(s,i);r(l.geometry,l.materials)}else{console.error('THREE.JSONLoader: "'+t+'" seems to be unreachable or the file is empty.')}e.onLoadComplete()}else{console.error("THREE.JSONLoader: Couldn't load \""+t+'" ('+a.status+")")}}else if(a.readyState===a.LOADING){if(n){if(o===0){o=a.getResponseHeader("Content-Length")}n({total:o,loaded:a.responseText.length})}}else if(a.readyState===a.HEADERS_RECEIVED){if(n!==undefined){o=a.getResponseHeader("Content-Length")}}};a.open("GET",t,true);a.withCredentials=this.withCredentials;a.send(null)};i.JSONLoader.prototype.parse=function(e,t){var r=this,n=new i.Geometry,a=e.scale!==undefined?1/e.scale:1;o(a);s();l(a);n.computeFaceNormals();n.computeBoundingSphere();function o(t){function r(e,t){return e&1<<t}var a,o,s,l,h,u,f,c,p,d,v,m,g,y,_,x,b,w,T,S,M,A,E,C,P,R,L,k,F=e.faces,D=e.vertices,U=e.normals,O=e.colors,j=0;if(e.uvs!==undefined){for(a=0;a<e.uvs.length;a++){if(e.uvs[a].length)j++}for(a=0;a<j;a++){n.faceVertexUvs[a]=[]}}l=0;h=D.length;while(l<h){w=new i.Vector3;w.x=D[l++]*t;w.y=D[l++]*t;w.z=D[l++]*t;n.vertices.push(w)}l=0;h=F.length;while(l<h){d=F[l++];v=r(d,0);m=r(d,1);g=r(d,3);y=r(d,4);_=r(d,5);x=r(d,6);b=r(d,7);if(v){S=new i.Face3;S.a=F[l];S.b=F[l+1];S.c=F[l+3];M=new i.Face3;M.a=F[l+1];M.b=F[l+2];M.c=F[l+3];l+=4;if(m){p=F[l++];S.materialIndex=p;M.materialIndex=p}s=n.faces.length;if(g){for(a=0;a<j;a++){P=e.uvs[a];n.faceVertexUvs[a][s]=[];n.faceVertexUvs[a][s+1]=[];for(o=0;o<4;o++){c=F[l++];L=P[c*2];k=P[c*2+1];R=new i.Vector2(L,k);if(o!==2)n.faceVertexUvs[a][s].push(R);if(o!==0)n.faceVertexUvs[a][s+1].push(R)}}}if(y){f=F[l++]*3;S.normal.set(U[f++],U[f++],U[f]);M.normal.copy(S.normal)}if(_){for(a=0;a<4;a++){f=F[l++]*3;C=new i.Vector3(U[f++],U[f++],U[f]);if(a!==2)S.vertexNormals.push(C);if(a!==0)M.vertexNormals.push(C)}}if(x){u=F[l++];E=O[u];S.color.setHex(E);M.color.setHex(E)}if(b){for(a=0;a<4;a++){u=F[l++];E=O[u];if(a!==2)S.vertexColors.push(new i.Color(E));if(a!==0)M.vertexColors.push(new i.Color(E))}}n.faces.push(S);n.faces.push(M)}else{T=new i.Face3;T.a=F[l++];T.b=F[l++];T.c=F[l++];if(m){p=F[l++];T.materialIndex=p}s=n.faces.length;if(g){for(a=0;a<j;a++){P=e.uvs[a];n.faceVertexUvs[a][s]=[];for(o=0;o<3;o++){c=F[l++];L=P[c*2];k=P[c*2+1];R=new i.Vector2(L,k);n.faceVertexUvs[a][s].push(R)}}}if(y){f=F[l++]*3;T.normal.set(U[f++],U[f++],U[f])}if(_){for(a=0;a<3;a++){f=F[l++]*3;C=new i.Vector3(U[f++],U[f++],U[f]);T.vertexNormals.push(C)}}if(x){u=F[l++];T.color.setHex(O[u])}if(b){for(a=0;a<3;a++){u=F[l++];T.vertexColors.push(new i.Color(O[u]))}}n.faces.push(T)}}}function s(){var t=e.influencesPerVertex!==undefined?e.influencesPerVertex:2;if(e.skinWeights){for(var r=0,a=e.skinWeights.length;r<a;r+=t){var o=e.skinWeights[r];var s=t>1?e.skinWeights[r+1]:0;var l=t>2?e.skinWeights[r+2]:0;var h=t>3?e.skinWeights[r+3]:0;n.skinWeights.push(new i.Vector4(o,s,l,h))}}if(e.skinIndices){for(var r=0,a=e.skinIndices.length;r<a;r+=t){var u=e.skinIndices[r];var f=t>1?e.skinIndices[r+1]:0;var c=t>2?e.skinIndices[r+2]:0;var p=t>3?e.skinIndices[r+3]:0;n.skinIndices.push(new i.Vector4(u,f,c,p))}}n.bones=e.bones;if(n.bones&&n.bones.length>0&&(n.skinWeights.length!==n.skinIndices.length||n.skinIndices.length!==n.vertices.length)){console.warn("When skinning, number of vertices ("+n.vertices.length+"), skinIndices ("+n.skinIndices.length+"), and skinWeights ("+n.skinWeights.length+") should match.")}n.animation=e.animation;n.animations=e.animations}function l(t){if(e.morphTargets!==undefined){var r,a,o,s,l,h;for(r=0,a=e.morphTargets.length;r<a;r++){n.morphTargets[r]={};n.morphTargets[r].name=e.morphTargets[r].name;n.morphTargets[r].vertices=[];l=n.morphTargets[r].vertices;h=e.morphTargets[r].vertices;for(o=0,s=h.length;o<s;o+=3){var u=new i.Vector3;u.x=h[o]*t;u.y=h[o+1]*t;u.z=h[o+2]*t;l.push(u)}}}if(e.morphColors!==undefined){var r,a,f,c,p,d,v;for(r=0,a=e.morphColors.length;r<a;r++){n.morphColors[r]={};n.morphColors[r].name=e.morphColors[r].name;n.morphColors[r].colors=[];p=n.morphColors[r].colors;d=e.morphColors[r].colors;for(f=0,c=d.length;f<c;f+=3){v=new i.Color(16755200);v.setRGB(d[f],d[f+1],d[f+2]);p.push(v)}}}}if(e.materials===undefined||e.materials.length===0){return{geometry:n}}else{var h=this.initMaterials(e.materials,t);if(this.needsTangents(h)){n.computeTangents()}return{geometry:n,materials:h}}};i.LoadingManager=function(e,t,r){var i=this;var n=0,a=0;this.onLoad=e;this.onProgress=t;this.onError=r;this.itemStart=function(e){a++};this.itemEnd=function(e){n++;if(i.onProgress!==undefined){i.onProgress(e,n,a)}if(n===a&&i.onLoad!==undefined){i.onLoad()}}};i.DefaultLoadingManager=new i.LoadingManager;i.BufferGeometryLoader=function(e){this.manager=e!==undefined?e:i.DefaultLoadingManager};i.BufferGeometryLoader.prototype={constructor:i.BufferGeometryLoader,load:function(e,t,r,n){var a=this;var o=new i.XHRLoader;o.setCrossOrigin(this.crossOrigin);o.load(e,function(e){t(a.parse(JSON.parse(e)))},r,n)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=new i.BufferGeometry;var r=e.attributes;for(var n in r){var a=r[n];var o=new self[a.type](a.array);t.addAttribute(n,new i.BufferAttribute(o,a.itemSize))}var s=e.offsets;if(s!==undefined){t.offsets=JSON.parse(JSON.stringify(s))}var l=e.boundingSphere;if(l!==undefined){var h=new i.Vector3;if(l.center!==undefined){h.fromArray(l.center)}t.boundingSphere=new i.Sphere(h,l.radius)}return t}};i.MaterialLoader=function(e){this.manager=e!==undefined?e:i.DefaultLoadingManager};i.MaterialLoader.prototype={constructor:i.MaterialLoader,load:function(e,t,r,n){var a=this;var o=new i.XHRLoader;o.setCrossOrigin(this.crossOrigin);o.load(e,function(e){t(a.parse(JSON.parse(e)))},r,n)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=new i[e.type];if(e.color!==undefined)t.color.setHex(e.color);if(e.ambient!==undefined)t.ambient.setHex(e.ambient);if(e.emissive!==undefined)t.emissive.setHex(e.emissive);if(e.specular!==undefined)t.specular.setHex(e.specular);if(e.shininess!==undefined)t.shininess=e.shininess;if(e.uniforms!==undefined)t.uniforms=e.uniforms;if(e.vertexShader!==undefined)t.vertexShader=e.vertexShader;if(e.fragmentShader!==undefined)t.fragmentShader=e.fragmentShader;if(e.vertexColors!==undefined)t.vertexColors=e.vertexColors;if(e.shading!==undefined)t.shading=e.shading;if(e.blending!==undefined)t.blending=e.blending;if(e.side!==undefined)t.side=e.side;if(e.opacity!==undefined)t.opacity=e.opacity;if(e.transparent!==undefined)t.transparent=e.transparent;if(e.wireframe!==undefined)t.wireframe=e.wireframe;if(e.materials!==undefined){for(var r=0,n=e.materials.length;r<n;r++){t.materials.push(this.parse(e.materials[r]))}}return t}};i.ObjectLoader=function(e){this.manager=e!==undefined?e:i.DefaultLoadingManager};i.ObjectLoader.prototype={constructor:i.ObjectLoader,load:function(e,t,r,n){var a=this;var o=new i.XHRLoader(a.manager);o.setCrossOrigin(this.crossOrigin);o.load(e,function(e){t(a.parse(JSON.parse(e)))},r,n)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=this.parseGeometries(e.geometries);var r=this.parseMaterials(e.materials);var i=this.parseObject(e.object,t,r);return i},parseGeometries:function(e){var t={};if(e!==undefined){var r=new i.JSONLoader;var n=new i.BufferGeometryLoader;for(var a=0,o=e.length;a<o;a++){var s;var l=e[a];switch(l.type){case"PlaneGeometry":s=new i.PlaneGeometry(l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"CubeGeometry":s=new i.BoxGeometry(l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":s=new i.CircleGeometry(l.radius,l.segments);break;case"CylinderGeometry":s=new i.CylinderGeometry(l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded);break;case"SphereGeometry":s=new i.SphereGeometry(l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"IcosahedronGeometry":s=new i.IcosahedronGeometry(l.radius,l.detail);break;case"TorusGeometry":s=new i.TorusGeometry(l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":s=new i.TorusKnotGeometry(l.radius,l.tube,l.radialSegments,l.tubularSegments,l.p,l.q,l.heightScale);break;case"BufferGeometry":s=n.parse(l.data);break;case"Geometry":s=r.parse(l.data).geometry;break}s.uuid=l.uuid;if(l.name!==undefined)s.name=l.name;t[l.uuid]=s}}return t},parseMaterials:function(e){var t={};if(e!==undefined){var r=new i.MaterialLoader;for(var n=0,a=e.length;n<a;n++){var o=e[n];var s=r.parse(o);s.uuid=o.uuid;if(o.name!==undefined)s.name=o.name;t[o.uuid]=s}}return t},parseObject:function(){var e=new i.Matrix4;return function(t,r,n){var a;switch(t.type){case"Scene":a=new i.Scene;break;case"PerspectiveCamera":a=new i.PerspectiveCamera(t.fov,t.aspect,t.near,t.far);break;case"OrthographicCamera":a=new i.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":a=new i.AmbientLight(t.color);break;case"DirectionalLight":a=new i.DirectionalLight(t.color,t.intensity);break;case"PointLight":a=new i.PointLight(t.color,t.intensity,t.distance);break;case"SpotLight":a=new i.SpotLight(t.color,t.intensity,t.distance,t.angle,t.exponent);break;case"HemisphereLight":a=new i.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":var o=r[t.geometry];var s=n[t.material];if(o===undefined){console.warn("THREE.ObjectLoader: Undefined geometry",t.geometry)}if(s===undefined){console.warn("THREE.ObjectLoader: Undefined material",t.material)}a=new i.Mesh(o,s);break;case"Line":var o=r[t.geometry];var s=n[t.material];if(o===undefined){console.warn("THREE.ObjectLoader: Undefined geometry",t.geometry)}if(s===undefined){console.warn("THREE.ObjectLoader: Undefined material",t.material)}a=new i.Line(o,s);break;case"Sprite":var s=n[t.material];if(s===undefined){console.warn("THREE.ObjectLoader: Undefined material",t.material)}a=new i.Sprite(s);break;case"Group":a=new i.Group;break;default:a=new i.Object3D}a.uuid=t.uuid;if(t.name!==undefined)a.name=t.name;if(t.matrix!==undefined){e.fromArray(t.matrix);e.decompose(a.position,a.quaternion,a.scale)}else{if(t.position!==undefined)a.position.fromArray(t.position);if(t.rotation!==undefined)a.rotation.fromArray(t.rotation);if(t.scale!==undefined)a.scale.fromArray(t.scale)}if(t.visible!==undefined)a.visible=t.visible;if(t.userData!==undefined)a.userData=t.userData;if(t.children!==undefined){for(var l in t.children){a.add(this.parseObject(t.children[l],r,n))}}return a}}()};i.TextureLoader=function(e){this.manager=e!==undefined?e:i.DefaultLoadingManager};i.TextureLoader.prototype={constructor:i.TextureLoader,load:function(e,t,r,n){var a=this;var o=new i.ImageLoader(a.manager);
o.setCrossOrigin(this.crossOrigin);o.load(e,function(e){var r=new i.Texture(e);r.needsUpdate=true;if(t!==undefined){t(r)}},r,n)},setCrossOrigin:function(e){this.crossOrigin=e}};i.CompressedTextureLoader=function(){this._parser=null};i.CompressedTextureLoader.prototype={constructor:i.CompressedTextureLoader,load:function(e,t,r){var n=this;var a=[];var o=new i.CompressedTexture;o.image=a;var s=new i.XHRLoader;s.setResponseType("arraybuffer");if(e instanceof Array){var l=0;var h=function(r){s.load(e[r],function(e){var s=n._parser(e,true);a[r]={width:s.width,height:s.height,format:s.format,mipmaps:s.mipmaps};l+=1;if(l===6){if(s.mipmapCount==1)o.minFilter=i.LinearFilter;o.format=s.format;o.needsUpdate=true;if(t)t(o)}})};for(var u=0,f=e.length;u<f;++u){h(u)}}else{s.load(e,function(e){var r=n._parser(e,true);if(r.isCubemap){var s=r.mipmaps.length/r.mipmapCount;for(var l=0;l<s;l++){a[l]={mipmaps:[]};for(var h=0;h<r.mipmapCount;h++){a[l].mipmaps.push(r.mipmaps[l*r.mipmapCount+h]);a[l].format=r.format;a[l].width=r.width;a[l].height=r.height}}}else{o.image.width=r.width;o.image.height=r.height;o.mipmaps=r.mipmaps}if(r.mipmapCount===1){o.minFilter=i.LinearFilter}o.format=r.format;o.needsUpdate=true;if(t)t(o)})}return o}};i.Material=function(){Object.defineProperty(this,"id",{value:i.MaterialIdCount++});this.uuid=i.Math.generateUUID();this.name="";this.type="Material";this.side=i.FrontSide;this.opacity=1;this.transparent=false;this.blending=i.NormalBlending;this.blendSrc=i.SrcAlphaFactor;this.blendDst=i.OneMinusSrcAlphaFactor;this.blendEquation=i.AddEquation;this.depthTest=true;this.depthWrite=true;this.polygonOffset=false;this.polygonOffsetFactor=0;this.polygonOffsetUnits=0;this.alphaTest=0;this.overdraw=0;this.visible=true;this.needsUpdate=true};i.Material.prototype={constructor:i.Material,setValues:function(e){if(e===undefined)return;for(var t in e){var r=e[t];if(r===undefined){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t in this){var n=this[t];if(n instanceof i.Color){n.set(r)}else if(n instanceof i.Vector3&&r instanceof i.Vector3){n.copy(r)}else if(t=="overdraw"){this[t]=Number(r)}else{this[t]=r}}}},toJSON:function(){var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type};if(this.name!=="")e.name=this.name;if(this instanceof i.MeshBasicMaterial){e.color=this.color.getHex();if(this.vertexColors!==i.NoColors)e.vertexColors=this.vertexColors;if(this.blending!==i.NormalBlending)e.blending=this.blending;if(this.side!==i.FrontSide)e.side=this.side}else if(this instanceof i.MeshLambertMaterial){e.color=this.color.getHex();e.ambient=this.ambient.getHex();e.emissive=this.emissive.getHex();if(this.vertexColors!==i.NoColors)e.vertexColors=this.vertexColors;if(this.blending!==i.NormalBlending)e.blending=this.blending;if(this.side!==i.FrontSide)e.side=this.side}else if(this instanceof i.MeshPhongMaterial){e.color=this.color.getHex();e.ambient=this.ambient.getHex();e.emissive=this.emissive.getHex();e.specular=this.specular.getHex();e.shininess=this.shininess;if(this.vertexColors!==i.NoColors)e.vertexColors=this.vertexColors;if(this.blending!==i.NormalBlending)e.blending=this.blending;if(this.side!==i.FrontSide)e.side=this.side}else if(this instanceof i.MeshNormalMaterial){if(this.shading!==i.FlatShading)e.shading=this.shading;if(this.blending!==i.NormalBlending)e.blending=this.blending;if(this.side!==i.FrontSide)e.side=this.side}else if(this instanceof i.MeshDepthMaterial){if(this.blending!==i.NormalBlending)e.blending=this.blending;if(this.side!==i.FrontSide)e.side=this.side}else if(this instanceof i.ShaderMaterial){e.uniforms=this.uniforms;e.vertexShader=this.vertexShader;e.fragmentShader=this.fragmentShader}else if(this instanceof i.SpriteMaterial){e.color=this.color.getHex()}if(this.opacity<1)e.opacity=this.opacity;if(this.transparent!==false)e.transparent=this.transparent;if(this.wireframe!==false)e.wireframe=this.wireframe;return e},clone:function(e){if(e===undefined)e=new i.Material;e.name=this.name;e.side=this.side;e.opacity=this.opacity;e.transparent=this.transparent;e.blending=this.blending;e.blendSrc=this.blendSrc;e.blendDst=this.blendDst;e.blendEquation=this.blendEquation;e.depthTest=this.depthTest;e.depthWrite=this.depthWrite;e.polygonOffset=this.polygonOffset;e.polygonOffsetFactor=this.polygonOffsetFactor;e.polygonOffsetUnits=this.polygonOffsetUnits;e.alphaTest=this.alphaTest;e.overdraw=this.overdraw;e.visible=this.visible;return e},dispose:function(){this.dispatchEvent({type:"dispose"})}};i.EventDispatcher.prototype.apply(i.Material.prototype);i.MaterialIdCount=0;i.LineBasicMaterial=function(e){i.Material.call(this);this.type="LineBasicMaterial";this.color=new i.Color(16777215);this.linewidth=1;this.linecap="round";this.linejoin="round";this.vertexColors=i.NoColors;this.fog=true;this.setValues(e)};i.LineBasicMaterial.prototype=Object.create(i.Material.prototype);i.LineBasicMaterial.prototype.clone=function(){var e=new i.LineBasicMaterial;i.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.linewidth=this.linewidth;e.linecap=this.linecap;e.linejoin=this.linejoin;e.vertexColors=this.vertexColors;e.fog=this.fog;return e};i.LineDashedMaterial=function(e){i.Material.call(this);this.type="LineDashedMaterial";this.color=new i.Color(16777215);this.linewidth=1;this.scale=1;this.dashSize=3;this.gapSize=1;this.vertexColors=false;this.fog=true;this.setValues(e)};i.LineDashedMaterial.prototype=Object.create(i.Material.prototype);i.LineDashedMaterial.prototype.clone=function(){var e=new i.LineDashedMaterial;i.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.linewidth=this.linewidth;e.scale=this.scale;e.dashSize=this.dashSize;e.gapSize=this.gapSize;e.vertexColors=this.vertexColors;e.fog=this.fog;return e};i.MeshBasicMaterial=function(e){i.Material.call(this);this.type="MeshBasicMaterial";this.color=new i.Color(16777215);this.map=null;this.lightMap=null;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.combine=i.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=true;this.shading=i.SmoothShading;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.vertexColors=i.NoColors;this.skinning=false;this.morphTargets=false;this.setValues(e)};i.MeshBasicMaterial.prototype=Object.create(i.Material.prototype);i.MeshBasicMaterial.prototype.clone=function(){var e=new i.MeshBasicMaterial;i.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.map=this.map;e.lightMap=this.lightMap;e.specularMap=this.specularMap;e.alphaMap=this.alphaMap;e.envMap=this.envMap;e.combine=this.combine;e.reflectivity=this.reflectivity;e.refractionRatio=this.refractionRatio;e.fog=this.fog;e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;e.wireframeLinecap=this.wireframeLinecap;e.wireframeLinejoin=this.wireframeLinejoin;e.vertexColors=this.vertexColors;e.skinning=this.skinning;e.morphTargets=this.morphTargets;return e};i.MeshLambertMaterial=function(e){i.Material.call(this);this.type="MeshLambertMaterial";this.color=new i.Color(16777215);this.ambient=new i.Color(16777215);this.emissive=new i.Color(0);this.wrapAround=false;this.wrapRGB=new i.Vector3(1,1,1);this.map=null;this.lightMap=null;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.combine=i.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=true;this.shading=i.SmoothShading;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.vertexColors=i.NoColors;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)};i.MeshLambertMaterial.prototype=Object.create(i.Material.prototype);i.MeshLambertMaterial.prototype.clone=function(){var e=new i.MeshLambertMaterial;i.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.ambient.copy(this.ambient);e.emissive.copy(this.emissive);e.wrapAround=this.wrapAround;e.wrapRGB.copy(this.wrapRGB);e.map=this.map;e.lightMap=this.lightMap;e.specularMap=this.specularMap;e.alphaMap=this.alphaMap;e.envMap=this.envMap;e.combine=this.combine;e.reflectivity=this.reflectivity;e.refractionRatio=this.refractionRatio;e.fog=this.fog;e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;e.wireframeLinecap=this.wireframeLinecap;e.wireframeLinejoin=this.wireframeLinejoin;e.vertexColors=this.vertexColors;e.skinning=this.skinning;e.morphTargets=this.morphTargets;e.morphNormals=this.morphNormals;return e};i.MeshPhongMaterial=function(e){i.Material.call(this);this.type="MeshPhongMaterial";this.color=new i.Color(16777215);this.ambient=new i.Color(16777215);this.emissive=new i.Color(0);this.specular=new i.Color(1118481);this.shininess=30;this.metal=false;this.wrapAround=false;this.wrapRGB=new i.Vector3(1,1,1);this.map=null;this.lightMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new i.Vector2(1,1);this.specularMap=null;this.alphaMap=null;this.envMap=null;this.combine=i.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=true;this.shading=i.SmoothShading;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.vertexColors=i.NoColors;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)};i.MeshPhongMaterial.prototype=Object.create(i.Material.prototype);i.MeshPhongMaterial.prototype.clone=function(){var e=new i.MeshPhongMaterial;i.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.ambient.copy(this.ambient);e.emissive.copy(this.emissive);e.specular.copy(this.specular);e.shininess=this.shininess;e.metal=this.metal;e.wrapAround=this.wrapAround;e.wrapRGB.copy(this.wrapRGB);e.map=this.map;e.lightMap=this.lightMap;e.bumpMap=this.bumpMap;e.bumpScale=this.bumpScale;e.normalMap=this.normalMap;e.normalScale.copy(this.normalScale);e.specularMap=this.specularMap;e.alphaMap=this.alphaMap;e.envMap=this.envMap;e.combine=this.combine;e.reflectivity=this.reflectivity;e.refractionRatio=this.refractionRatio;e.fog=this.fog;e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;e.wireframeLinecap=this.wireframeLinecap;e.wireframeLinejoin=this.wireframeLinejoin;e.vertexColors=this.vertexColors;e.skinning=this.skinning;e.morphTargets=this.morphTargets;e.morphNormals=this.morphNormals;return e};i.MeshDepthMaterial=function(e){i.Material.call(this);this.type="MeshDepthMaterial";this.morphTargets=false;this.wireframe=false;this.wireframeLinewidth=1;this.setValues(e)};i.MeshDepthMaterial.prototype=Object.create(i.Material.prototype);i.MeshDepthMaterial.prototype.clone=function(){var e=new i.MeshDepthMaterial;i.Material.prototype.clone.call(this,e);e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;return e};i.MeshNormalMaterial=function(e){i.Material.call(this,e);this.type="MeshNormalMaterial";this.shading=i.FlatShading;this.wireframe=false;this.wireframeLinewidth=1;this.morphTargets=false;this.setValues(e)};i.MeshNormalMaterial.prototype=Object.create(i.Material.prototype);i.MeshNormalMaterial.prototype.clone=function(){var e=new i.MeshNormalMaterial;i.Material.prototype.clone.call(this,e);e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;return e};i.MeshFaceMaterial=function(e){this.uuid=i.Math.generateUUID();this.type="MeshFaceMaterial";this.materials=e instanceof Array?e:[]};i.MeshFaceMaterial.prototype={constructor:i.MeshFaceMaterial,toJSON:function(){var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]};for(var t=0,r=this.materials.length;t<r;t++){e.materials.push(this.materials[t].toJSON())}return e},clone:function(){var e=new i.MeshFaceMaterial;for(var t=0;t<this.materials.length;t++){e.materials.push(this.materials[t].clone())}return e}};i.PointCloudMaterial=function(e){i.Material.call(this);this.type="PointCloudMaterial";this.color=new i.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=true;this.vertexColors=i.NoColors;this.fog=true;this.setValues(e)};i.PointCloudMaterial.prototype=Object.create(i.Material.prototype);i.PointCloudMaterial.prototype.clone=function(){var e=new i.PointCloudMaterial;i.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.map=this.map;e.size=this.size;e.sizeAttenuation=this.sizeAttenuation;e.vertexColors=this.vertexColors;e.fog=this.fog;return e};i.ParticleBasicMaterial=function(e){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial.");return new i.PointCloudMaterial(e)};i.ParticleSystemMaterial=function(e){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial.");return new i.PointCloudMaterial(e)};i.ShaderMaterial=function(e){i.Material.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms={};this.attributes=null;this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.shading=i.SmoothShading;this.linewidth=1;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.lights=false;this.vertexColors=i.NoColors;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=undefined;this.setValues(e)};i.ShaderMaterial.prototype=Object.create(i.Material.prototype);i.ShaderMaterial.prototype.clone=function(){var e=new i.ShaderMaterial;i.Material.prototype.clone.call(this,e);e.fragmentShader=this.fragmentShader;e.vertexShader=this.vertexShader;e.uniforms=i.UniformsUtils.clone(this.uniforms);e.attributes=this.attributes;e.defines=this.defines;e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;e.fog=this.fog;e.lights=this.lights;e.vertexColors=this.vertexColors;e.skinning=this.skinning;e.morphTargets=this.morphTargets;e.morphNormals=this.morphNormals;return e};i.RawShaderMaterial=function(e){i.ShaderMaterial.call(this,e);this.type="RawShaderMaterial"};i.RawShaderMaterial.prototype=Object.create(i.ShaderMaterial.prototype);i.RawShaderMaterial.prototype.clone=function(){var e=new i.RawShaderMaterial;i.ShaderMaterial.prototype.clone.call(this,e);return e};i.SpriteMaterial=function(e){i.Material.call(this);this.type="SpriteMaterial";this.color=new i.Color(16777215);this.map=null;this.rotation=0;this.fog=false;this.setValues(e)};i.SpriteMaterial.prototype=Object.create(i.Material.prototype);i.SpriteMaterial.prototype.clone=function(){var e=new i.SpriteMaterial;i.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.map=this.map;e.rotation=this.rotation;e.fog=this.fog;return e};i.Texture=function(e,t,r,n,a,o,s,l,h){Object.defineProperty(this,"id",{value:i.TextureIdCount++});this.uuid=i.Math.generateUUID();this.name="";this.image=e!==undefined?e:i.Texture.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=t!==undefined?t:i.Texture.DEFAULT_MAPPING;this.wrapS=r!==undefined?r:i.ClampToEdgeWrapping;this.wrapT=n!==undefined?n:i.ClampToEdgeWrapping;this.magFilter=a!==undefined?a:i.LinearFilter;this.minFilter=o!==undefined?o:i.LinearMipMapLinearFilter;this.anisotropy=h!==undefined?h:1;this.format=s!==undefined?s:i.RGBAFormat;this.type=l!==undefined?l:i.UnsignedByteType;this.offset=new i.Vector2(0,0);this.repeat=new i.Vector2(1,1);this.generateMipmaps=true;this.premultiplyAlpha=false;this.flipY=true;this.unpackAlignment=4;this._needsUpdate=false;this.onUpdate=null};i.Texture.DEFAULT_IMAGE=undefined;i.Texture.DEFAULT_MAPPING=new i.UVMapping;i.Texture.prototype={constructor:i.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){if(e===true)this.update();this._needsUpdate=e},clone:function(e){if(e===undefined)e=new i.Texture;e.image=this.image;e.mipmaps=this.mipmaps.slice(0);e.mapping=this.mapping;e.wrapS=this.wrapS;e.wrapT=this.wrapT;e.magFilter=this.magFilter;e.minFilter=this.minFilter;e.anisotropy=this.anisotropy;e.format=this.format;e.type=this.type;e.offset.copy(this.offset);e.repeat.copy(this.repeat);e.generateMipmaps=this.generateMipmaps;e.premultiplyAlpha=this.premultiplyAlpha;e.flipY=this.flipY;e.unpackAlignment=this.unpackAlignment;return e},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}};i.EventDispatcher.prototype.apply(i.Texture.prototype);i.TextureIdCount=0;i.CubeTexture=function(e,t,r,n,a,o,s,l,h){i.Texture.call(this,e,t,r,n,a,o,s,l,h);this.images=e};i.CubeTexture.prototype=Object.create(i.Texture.prototype);i.CubeTexture.clone=function(e){if(e===undefined)e=new i.CubeTexture;i.Texture.prototype.clone.call(this,e);e.images=this.images;return e};i.CompressedTexture=function(e,t,r,n,a,o,s,l,h,u,f){i.Texture.call(this,null,o,s,l,h,u,n,a,f);this.image={width:t,height:r};this.mipmaps=e;this.flipY=false;this.generateMipmaps=false};i.CompressedTexture.prototype=Object.create(i.Texture.prototype);i.CompressedTexture.prototype.clone=function(){var e=new i.CompressedTexture;i.Texture.prototype.clone.call(this,e);return e};i.DataTexture=function(e,t,r,n,a,o,s,l,h,u,f){i.Texture.call(this,null,o,s,l,h,u,n,a,f);this.image={data:e,width:t,height:r}};i.DataTexture.prototype=Object.create(i.Texture.prototype);i.DataTexture.prototype.clone=function(){var e=new i.DataTexture;i.Texture.prototype.clone.call(this,e);return e};i.VideoTexture=function(e,t,r,n,a,o,s,l,h){i.Texture.call(this,e,t,r,n,a,o,s,l,h);this.generateMipmaps=false;var u=this;var f=function(){requestAnimationFrame(f);if(e.readyState===e.HAVE_ENOUGH_DATA){u.needsUpdate=true}};f()};i.VideoTexture.prototype=Object.create(i.Texture.prototype);i.Group=function(){i.Object3D.call(this);this.type="Group"};i.Group.prototype=Object.create(i.Object3D.prototype);i.PointCloud=function(e,t){i.Object3D.call(this);this.type="PointCloud";this.geometry=e!==undefined?e:new i.Geometry;this.material=t!==undefined?t:new i.PointCloudMaterial({color:Math.random()*16777215});this.sortParticles=false};i.PointCloud.prototype=Object.create(i.Object3D.prototype);i.PointCloud.prototype.raycast=function(){var e=new i.Matrix4;var t=new i.Ray;return function(r,n){var a=this;var o=a.geometry;var s=r.params.PointCloud.threshold;e.getInverse(this.matrixWorld);t.copy(r.ray).applyMatrix4(e);if(o.boundingBox!==null){if(t.isIntersectionBox(o.boundingBox)===false){return}}var l=s/((this.scale.x+this.scale.y+this.scale.z)/3);var h=new i.Vector3;var u=function(e,i){var o=t.distanceToPoint(e);if(o<l){var s=t.closestPointToPoint(e);s.applyMatrix4(a.matrixWorld);var h=r.ray.origin.distanceTo(s);n.push({distance:h,distanceToRay:o,point:s.clone(),index:i,face:null,object:a})}};if(o instanceof i.BufferGeometry){var f=o.attributes;var c=f.position.array;if(f.index!==undefined){var p=f.index.array;var d=o.offsets;if(d.length===0){var v={start:0,count:p.length,index:0};d=[v]}for(var m=0,g=d.length;m<g;++m){var y=d[m].start;var _=d[m].count;var x=d[m].index;for(var b=y,w=y+_;b<w;b++){var T=x+p[b];h.fromArray(c,T*3);u(h,T)}}}else{var S=c.length/3;for(var b=0;b<S;b++){h.set(c[3*b],c[3*b+1],c[3*b+2]);u(h,b)}}}else{var M=this.geometry.vertices;for(var b=0;b<M.length;b++){u(M[b],b)}}}}();i.PointCloud.prototype.clone=function(e){if(e===undefined)e=new i.PointCloud(this.geometry,this.material);e.sortParticles=this.sortParticles;i.Object3D.prototype.clone.call(this,e);return e};i.ParticleSystem=function(e,t){console.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud.");return new i.PointCloud(e,t)};i.Line=function(e,t,r){i.Object3D.call(this);this.type="Line";this.geometry=e!==undefined?e:new i.Geometry;this.material=t!==undefined?t:new i.LineBasicMaterial({color:Math.random()*16777215});this.mode=r!==undefined?r:i.LineStrip};i.LineStrip=0;i.LinePieces=1;i.Line.prototype=Object.create(i.Object3D.prototype);i.Line.prototype.raycast=function(){var e=new i.Matrix4;var t=new i.Ray;var r=new i.Sphere;return function(n,a){var o=n.linePrecision;var s=o*o;var l=this.geometry;if(l.boundingSphere===null)l.computeBoundingSphere();r.copy(l.boundingSphere);r.applyMatrix4(this.matrixWorld);if(n.ray.isIntersectionSphere(r)===false){return}e.getInverse(this.matrixWorld);t.copy(n.ray).applyMatrix4(e);if(l instanceof i.Geometry){var h=l.vertices;var u=h.length;var f=new i.Vector3;var c=new i.Vector3;var p=this.mode===i.LineStrip?1:2;for(var d=0;d<u-1;d=d+p){var v=t.distanceSqToSegment(h[d],h[d+1],c,f);if(v>s)continue;var m=t.origin.distanceTo(c);if(m<n.near||m>n.far)continue;a.push({distance:m,point:f.clone().applyMatrix4(this.matrixWorld),face:null,faceIndex:null,object:this})}}}}();i.Line.prototype.clone=function(e){if(e===undefined)e=new i.Line(this.geometry,this.material,this.mode);i.Object3D.prototype.clone.call(this,e);return e};i.Mesh=function(e,t){i.Object3D.call(this);this.type="Mesh";this.geometry=e!==undefined?e:new i.Geometry;this.material=t!==undefined?t:new i.MeshBasicMaterial({color:Math.random()*16777215});this.updateMorphTargets()};i.Mesh.prototype=Object.create(i.Object3D.prototype);i.Mesh.prototype.updateMorphTargets=function(){if(this.geometry.morphTargets!==undefined&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;e<t;e++){this.morphTargetInfluences.push(0);this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}}};i.Mesh.prototype.getMorphTargetIndexByName=function(e){if(this.morphTargetDictionary[e]!==undefined){return this.morphTargetDictionary[e]}console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0.");return 0};i.Mesh.prototype.raycast=function(){var e=new i.Matrix4;var t=new i.Ray;var r=new i.Sphere;var n=new i.Vector3;var a=new i.Vector3;var o=new i.Vector3;return function(s,l){var h=this.geometry;if(h.boundingSphere===null)h.computeBoundingSphere();r.copy(h.boundingSphere);r.applyMatrix4(this.matrixWorld);if(s.ray.isIntersectionSphere(r)===false){return}e.getInverse(this.matrixWorld);t.copy(s.ray).applyMatrix4(e);if(h.boundingBox!==null){if(t.isIntersectionBox(h.boundingBox)===false){return}}if(h instanceof i.BufferGeometry){var u=this.material;if(u===undefined)return;var f=h.attributes;var c,p,d;var v=s.precision;if(f.index!==undefined){var m=f.index.array;var g=f.position.array;var y=h.offsets;if(y.length===0){y=[{start:0,count:m.length,index:0}]}for(var _=0,x=y.length;_<x;++_){var b=y[_].start;var w=y[_].count;var T=y[_].index;for(var S=b,M=b+w;S<M;S+=3){c=T+m[S];p=T+m[S+1];d=T+m[S+2];n.fromArray(g,c*3);a.fromArray(g,p*3);o.fromArray(g,d*3);if(u.side===i.BackSide){var A=t.intersectTriangle(o,a,n,true)}else{var A=t.intersectTriangle(n,a,o,u.side!==i.DoubleSide)}if(A===null)continue;A.applyMatrix4(this.matrixWorld);var E=s.ray.origin.distanceTo(A);if(E<v||E<s.near||E>s.far)continue;l.push({distance:E,point:A,face:new i.Face3(c,p,d,i.Triangle.normal(n,a,o)),faceIndex:null,object:this})}}}else{var g=f.position.array;for(var S=0,C=0,M=g.length;S<M;S+=3,C+=9){c=S;p=S+1;d=S+2;n.fromArray(g,C);a.fromArray(g,C+3);o.fromArray(g,C+6);if(u.side===i.BackSide){var A=t.intersectTriangle(o,a,n,true)}else{var A=t.intersectTriangle(n,a,o,u.side!==i.DoubleSide)}if(A===null)continue;A.applyMatrix4(this.matrixWorld);var E=s.ray.origin.distanceTo(A);if(E<v||E<s.near||E>s.far)continue;l.push({distance:E,point:A,face:new i.Face3(c,p,d,i.Triangle.normal(n,a,o)),faceIndex:null,object:this})}}}else if(h instanceof i.Geometry){var P=this.material instanceof i.MeshFaceMaterial;var R=P===true?this.material.materials:null;var c,p,d,L;var v=s.precision;var k=h.vertices;for(var F=0,D=h.faces.length;F<D;F++){var U=h.faces[F];var u=P===true?R[U.materialIndex]:this.material;if(u===undefined)continue;c=k[U.a];p=k[U.b];d=k[U.c];if(u.morphTargets===true){var O=h.morphTargets;var j=this.morphTargetInfluences;n.set(0,0,0);a.set(0,0,0);o.set(0,0,0);for(var V=0,N=O.length;V<N;V++){var B=j[V];if(B===0)continue;var z=O[V].vertices;n.x+=(z[U.a].x-c.x)*B;n.y+=(z[U.a].y-c.y)*B;n.z+=(z[U.a].z-c.z)*B;a.x+=(z[U.b].x-p.x)*B;a.y+=(z[U.b].y-p.y)*B;a.z+=(z[U.b].z-p.z)*B;o.x+=(z[U.c].x-d.x)*B;o.y+=(z[U.c].y-d.y)*B;o.z+=(z[U.c].z-d.z)*B}n.add(c);a.add(p);o.add(d);c=n;p=a;d=o}if(u.side===i.BackSide){var A=t.intersectTriangle(d,p,c,true)}else{var A=t.intersectTriangle(c,p,d,u.side!==i.DoubleSide)}if(A===null)continue;A.applyMatrix4(this.matrixWorld);var E=s.ray.origin.distanceTo(A);if(E<v||E<s.near||E>s.far)continue;l.push({distance:E,point:A,face:U,faceIndex:F,object:this})}}}}();i.Mesh.prototype.clone=function(e,t){if(e===undefined)e=new i.Mesh(this.geometry,this.material);i.Object3D.prototype.clone.call(this,e,t);return e};i.Bone=function(e){i.Object3D.call(this);this.skin=e};i.Bone.prototype=Object.create(i.Object3D.prototype);i.Skeleton=function(e,t,r){this.useVertexTexture=r!==undefined?r:true;this.identityMatrix=new i.Matrix4;e=e||[];this.bones=e.slice(0);if(this.useVertexTexture){var n;if(this.bones.length>256)n=64;else if(this.bones.length>64)n=32;else if(this.bones.length>16)n=16;else n=8;this.boneTextureWidth=n;this.boneTextureHeight=n;this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4);this.boneTexture=new i.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,i.RGBAFormat,i.FloatType);this.boneTexture.minFilter=i.NearestFilter;this.boneTexture.magFilter=i.NearestFilter;this.boneTexture.generateMipmaps=false;this.boneTexture.flipY=false}else{this.boneMatrices=new Float32Array(16*this.bones.length)}if(t===undefined){this.calculateInverses()}else{if(this.bones.length===t.length){this.boneInverses=t.slice(0)}else{console.warn("THREE.Skeleton bonInverses is the wrong length.");this.boneInverses=[];for(var a=0,o=this.bones.length;a<o;a++){this.boneInverses.push(new i.Matrix4)}}}};i.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var r=new i.Matrix4;if(this.bones[e]){r.getInverse(this.bones[e].matrixWorld)}this.boneInverses.push(r)}};i.Skeleton.prototype.pose=function(){var e;for(var t=0,r=this.bones.length;t<r;t++){e=this.bones[t];if(e){e.matrixWorld.getInverse(this.boneInverses[t])}}for(var t=0,r=this.bones.length;t<r;t++){e=this.bones[t];if(e){if(e.parent){e.matrix.getInverse(e.parent.matrixWorld);e.matrix.multiply(e.matrixWorld)}else{e.matrix.copy(e.matrixWorld)}e.matrix.decompose(e.position,e.quaternion,e.scale)}}};i.Skeleton.prototype.update=function(){var e=new i.Matrix4;return function(){for(var t=0,r=this.bones.length;t<r;t++){var i=this.bones[t]?this.bones[t].matrixWorld:this.identityMatrix;e.multiplyMatrices(i,this.boneInverses[t]);e.flattenToArrayOffset(this.boneMatrices,t*16)}if(this.useVertexTexture){this.boneTexture.needsUpdate=true}}}();i.SkinnedMesh=function(e,t,r){i.Mesh.call(this,e,t);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new i.Matrix4;this.bindMatrixInverse=new i.Matrix4;var n=[];if(this.geometry&&this.geometry.bones!==undefined){var a,o,s,l,h;for(var u=0,f=this.geometry.bones.length;u<f;++u){o=this.geometry.bones[u];s=o.pos;l=o.rotq;h=o.scl;a=new i.Bone(this);n.push(a);a.name=o.name;a.position.set(s[0],s[1],s[2]);a.quaternion.set(l[0],l[1],l[2],l[3]);if(h!==undefined){a.scale.set(h[0],h[1],h[2])}else{a.scale.set(1,1,1)}}for(var u=0,f=this.geometry.bones.length;u<f;++u){o=this.geometry.bones[u];if(o.parent!==-1){n[o.parent].add(n[u])}else{this.add(n[u])}}}this.normalizeSkinWeights();this.updateMatrixWorld(true);this.bind(new i.Skeleton(n,undefined,r))};i.SkinnedMesh.prototype=Object.create(i.Mesh.prototype);i.SkinnedMesh.prototype.bind=function(e,t){this.skeleton=e;if(t===undefined){this.updateMatrixWorld(true);t=this.matrixWorld}this.bindMatrix.copy(t);this.bindMatrixInverse.getInverse(t)};i.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()};i.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof i.Geometry){for(var e=0;e<this.geometry.skinIndices.length;e++){var t=this.geometry.skinWeights[e];var r=1/t.lengthManhattan();if(r!==Infinity){t.multiplyScalar(r)}else{t.set(1)}}}else{}};i.SkinnedMesh.prototype.updateMatrixWorld=function(e){i.Mesh.prototype.updateMatrixWorld.call(this,true);if(this.bindMode==="attached"){this.bindMatrixInverse.getInverse(this.matrixWorld)}else if(this.bindMode==="detached"){this.bindMatrixInverse.getInverse(this.bindMatrix)}else{console.warn("THREE.SkinnedMesh unreckognized bindMode: "+this.bindMode)}};i.SkinnedMesh.prototype.clone=function(e){if(e===undefined){e=new i.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)}i.Mesh.prototype.clone.call(this,e);return e};i.MorphAnimMesh=function(e,t){i.Mesh.call(this,e,t);this.type="MorphAnimMesh";this.duration=1e3;this.mirroredLoop=false;this.time=0;this.lastKeyframe=0;this.currentKeyframe=0;this.direction=1;this.directionBackwards=false;this.setFrameRange(0,this.geometry.morphTargets.length-1)};i.MorphAnimMesh.prototype=Object.create(i.Mesh.prototype);i.MorphAnimMesh.prototype.setFrameRange=function(e,t){this.startKeyframe=e;this.endKeyframe=t;this.length=this.endKeyframe-this.startKeyframe+1};i.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1;this.directionBackwards=false};i.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1;this.directionBackwards=true};i.MorphAnimMesh.prototype.parseAnimations=function(){var e=this.geometry;if(!e.animations)e.animations={};var t,r=e.animations;var i=/([a-z]+)_?(\d+)/;for(var n=0,a=e.morphTargets.length;n<a;n++){var o=e.morphTargets[n];var s=o.name.match(i);if(s&&s.length>1){var l=s[1];var h=s[2];if(!r[l])r[l]={start:Infinity,end:-Infinity};var u=r[l];if(n<u.start)u.start=n;if(n>u.end)u.end=n;if(!t)t=l}}e.firstAnimation=t};i.MorphAnimMesh.prototype.setAnimationLabel=function(e,t,r){if(!this.geometry.animations)this.geometry.animations={};this.geometry.animations[e]={start:t,end:r}};i.MorphAnimMesh.prototype.playAnimation=function(e,t){var r=this.geometry.animations[e];if(r){this.setFrameRange(r.start,r.end);this.duration=1e3*((r.end-r.start)/t);this.time=0}else{console.warn("animation["+e+"] undefined")}};i.MorphAnimMesh.prototype.updateAnimation=function(e){var t=this.duration/this.length;this.time+=this.direction*e;if(this.mirroredLoop){if(this.time>this.duration||this.time<0){this.direction*=-1;if(this.time>this.duration){this.time=this.duration;this.directionBackwards=true}if(this.time<0){this.time=0;this.directionBackwards=false}}}else{this.time=this.time%this.duration;if(this.time<0)this.time+=this.duration}var r=this.startKeyframe+i.Math.clamp(Math.floor(this.time/t),0,this.length-1);if(r!==this.currentKeyframe){this.morphTargetInfluences[this.lastKeyframe]=0;this.morphTargetInfluences[this.currentKeyframe]=1;this.morphTargetInfluences[r]=0;this.lastKeyframe=this.currentKeyframe;this.currentKeyframe=r}var n=this.time%t/t;if(this.directionBackwards){n=1-n}this.morphTargetInfluences[this.currentKeyframe]=n;this.morphTargetInfluences[this.lastKeyframe]=1-n};i.MorphAnimMesh.prototype.interpolateTargets=function(e,t,r){var i=this.morphTargetInfluences;for(var n=0,a=i.length;n<a;n++){i[n]=0}if(e>-1)i[e]=1-r;if(t>-1)i[t]=r};i.MorphAnimMesh.prototype.clone=function(e){if(e===undefined)e=new i.MorphAnimMesh(this.geometry,this.material);e.duration=this.duration;e.mirroredLoop=this.mirroredLoop;e.time=this.time;e.lastKeyframe=this.lastKeyframe;e.currentKeyframe=this.currentKeyframe;e.direction=this.direction;e.directionBackwards=this.directionBackwards;i.Mesh.prototype.clone.call(this,e);return e};i.LOD=function(){i.Object3D.call(this);this.objects=[]};i.LOD.prototype=Object.create(i.Object3D.prototype);i.LOD.prototype.addLevel=function(e,t){if(t===undefined)t=0;t=Math.abs(t);for(var r=0;r<this.objects.length;r++){if(t<this.objects[r].distance){break
}}this.objects.splice(r,0,{distance:t,object:e});this.add(e)};i.LOD.prototype.getObjectForDistance=function(e){for(var t=1,r=this.objects.length;t<r;t++){if(e<this.objects[t].distance){break}}return this.objects[t-1].object};i.LOD.prototype.raycast=function(){var e=new i.Vector3;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var i=t.ray.origin.distanceTo(e);this.getObjectForDistance(i).raycast(t,r)}}();i.LOD.prototype.update=function(){var e=new i.Vector3;var t=new i.Vector3;return function(r){if(this.objects.length>1){e.setFromMatrixPosition(r.matrixWorld);t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);this.objects[0].object.visible=true;for(var n=1,a=this.objects.length;n<a;n++){if(i>=this.objects[n].distance){this.objects[n-1].object.visible=false;this.objects[n].object.visible=true}else{break}}for(;n<a;n++){this.objects[n].object.visible=false}}}}();i.LOD.prototype.clone=function(e){if(e===undefined)e=new i.LOD;i.Object3D.prototype.clone.call(this,e);for(var t=0,r=this.objects.length;t<r;t++){var n=this.objects[t].object.clone();n.visible=t===0;e.addLevel(n,this.objects[t].distance)}return e};i.Sprite=function(){var e=new Uint16Array([0,1,2,0,2,3]);var t=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]);var r=new Float32Array([0,0,1,0,1,1,0,1]);var n=new i.BufferGeometry;n.addAttribute("index",new i.BufferAttribute(e,1));n.addAttribute("position",new i.BufferAttribute(t,3));n.addAttribute("uv",new i.BufferAttribute(r,2));return function(e){i.Object3D.call(this);this.type="Sprite";this.geometry=n;this.material=e!==undefined?e:new i.SpriteMaterial}}();i.Sprite.prototype=Object.create(i.Object3D.prototype);i.Sprite.prototype.raycast=function(){var e=new i.Vector3;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var i=t.ray.distanceToPoint(e);if(i>this.scale.x){return}r.push({distance:i,point:this.position,face:null,object:this})}}();i.Sprite.prototype.clone=function(e){if(e===undefined)e=new i.Sprite(this.material);i.Object3D.prototype.clone.call(this,e);return e};i.Particle=i.Sprite;i.LensFlare=function(e,t,r,n,a){i.Object3D.call(this);this.lensFlares=[];this.positionScreen=new i.Vector3;this.customUpdateCallback=undefined;if(e!==undefined){this.add(e,t,r,n,a)}};i.LensFlare.prototype=Object.create(i.Object3D.prototype);i.LensFlare.prototype.add=function(e,t,r,n,a,o){if(t===undefined)t=-1;if(r===undefined)r=0;if(o===undefined)o=1;if(a===undefined)a=new i.Color(16777215);if(n===undefined)n=i.NormalBlending;r=Math.min(r,Math.max(0,r));this.lensFlares.push({texture:e,size:t,distance:r,x:0,y:0,z:0,scale:1,rotation:1,opacity:o,color:a,blending:n})};i.LensFlare.prototype.updateLensFlares=function(){var e,t=this.lensFlares.length;var r;var i=-this.positionScreen.x*2;var n=-this.positionScreen.y*2;for(e=0;e<t;e++){r=this.lensFlares[e];r.x=this.positionScreen.x+i*r.distance;r.y=this.positionScreen.y+n*r.distance;r.wantedRotation=r.x*Math.PI*.25;r.rotation+=(r.wantedRotation-r.rotation)*.25}};i.Scene=function(){i.Object3D.call(this);this.type="Scene";this.fog=null;this.overrideMaterial=null;this.autoUpdate=true};i.Scene.prototype=Object.create(i.Object3D.prototype);i.Scene.prototype.clone=function(e){if(e===undefined)e=new i.Scene;i.Object3D.prototype.clone.call(this,e);if(this.fog!==null)e.fog=this.fog.clone();if(this.overrideMaterial!==null)e.overrideMaterial=this.overrideMaterial.clone();e.autoUpdate=this.autoUpdate;e.matrixAutoUpdate=this.matrixAutoUpdate;return e};i.Fog=function(e,t,r){this.name="";this.color=new i.Color(e);this.near=t!==undefined?t:1;this.far=r!==undefined?r:1e3};i.Fog.prototype.clone=function(){return new i.Fog(this.color.getHex(),this.near,this.far)};i.FogExp2=function(e,t){this.name="";this.color=new i.Color(e);this.density=t!==undefined?t:25e-5};i.FogExp2.prototype.clone=function(){return new i.FogExp2(this.color.getHex(),this.density)};i.ShaderChunk={};i.ShaderChunk["alphatest_fragment"]="#ifdef ALPHATEST\n\n	if ( gl_FragColor.a < ALPHATEST ) discard;\n\n#endif\n";i.ShaderChunk["lights_lambert_vertex"]="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n	vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n	vec3 dirVector = normalize( lDirection.xyz );\n\n	float dotProduct = dot( transformedNormal, dirVector );\n	vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n	#ifdef DOUBLE_SIDED\n\n		vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n		#ifdef WRAP_AROUND\n\n			vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n		#endif\n\n	#endif\n\n	#ifdef WRAP_AROUND\n\n		vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n		directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n		#ifdef DOUBLE_SIDED\n\n			directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n		#endif\n\n	#endif\n\n	vLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n	#ifdef DOUBLE_SIDED\n\n		vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n	#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n		float lDistance = 1.0;\n		if ( pointLightDistance[ i ] > 0.0 )\n			lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n\n		lVector = normalize( lVector );\n		float dotProduct = dot( transformedNormal, lVector );\n\n		vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n		#ifdef DOUBLE_SIDED\n\n			vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n			#ifdef WRAP_AROUND\n\n				vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n			#endif\n\n		#endif\n\n		#ifdef WRAP_AROUND\n\n			vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n			pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n			#ifdef DOUBLE_SIDED\n\n				pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n			#endif\n\n		#endif\n\n		vLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n\n		#endif\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n			float lDistance = 1.0;\n			if ( spotLightDistance[ i ] > 0.0 )\n				lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n\n			lVector = normalize( lVector );\n\n			float dotProduct = dot( transformedNormal, lVector );\n			vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n			#ifdef DOUBLE_SIDED\n\n				vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n				#ifdef WRAP_AROUND\n\n					vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n				#endif\n\n			#endif\n\n			#ifdef WRAP_AROUND\n\n				vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n				spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n				#ifdef DOUBLE_SIDED\n\n					spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n				#endif\n\n			#endif\n\n			vLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n\n			#ifdef DOUBLE_SIDED\n\n				vLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n\n			#endif\n\n		}\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n		vec3 lVector = normalize( lDirection.xyz );\n\n		float dotProduct = dot( transformedNormal, lVector );\n\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n		float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n		vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n		#endif\n\n	}\n\n#endif\n\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n\n#endif";i.ShaderChunk["map_particle_pars_fragment"]="#ifdef USE_MAP\n\n	uniform sampler2D map;\n\n#endif";i.ShaderChunk["default_vertex"]="vec4 mvPosition;\n\n#ifdef USE_SKINNING\n\n	mvPosition = modelViewMatrix * skinned;\n\n#endif\n\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\n\n	mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#endif\n\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\n\n	mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;";i.ShaderChunk["map_pars_fragment"]="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	varying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n	uniform sampler2D map;\n\n#endif";i.ShaderChunk["skinnormal_vertex"]="#ifdef USE_SKINNING\n\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n	#ifdef USE_MORPHNORMALS\n\n	vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n	#else\n\n	vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n	#endif\n\n#endif\n";i.ShaderChunk["logdepthbuf_pars_vertex"]="#ifdef USE_LOGDEPTHBUF\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		varying float vFragDepth;\n\n	#endif\n\n	uniform float logDepthBufFC;\n\n#endif";i.ShaderChunk["lightmap_pars_vertex"]="#ifdef USE_LIGHTMAP\n\n	varying vec2 vUv2;\n\n#endif";i.ShaderChunk["lights_phong_fragment"]="vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef DOUBLE_SIDED\n\n	normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n	normal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	vec3 pointDiffuse = vec3( 0.0 );\n	vec3 pointSpecular = vec3( 0.0 );\n\n	for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n		float lDistance = 1.0;\n		if ( pointLightDistance[ i ] > 0.0 )\n			lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n\n		lVector = normalize( lVector );\n\n				// diffuse\n\n		float dotProduct = dot( normal, lVector );\n\n		#ifdef WRAP_AROUND\n\n			float pointDiffuseWeightFull = max( dotProduct, 0.0 );\n			float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n			vec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n		#else\n\n			float pointDiffuseWeight = max( dotProduct, 0.0 );\n\n		#endif\n\n		pointDiffuse += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\n\n				// specular\n\n		vec3 pointHalfVector = normalize( lVector + viewPosition );\n		float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n		float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n		pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	vec3 spotDiffuse = vec3( 0.0 );\n	vec3 spotSpecular = vec3( 0.0 );\n\n	for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n		float lDistance = 1.0;\n		if ( spotLightDistance[ i ] > 0.0 )\n			lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n\n		lVector = normalize( lVector );\n\n		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n					// diffuse\n\n			float dotProduct = dot( normal, lVector );\n\n			#ifdef WRAP_AROUND\n\n				float spotDiffuseWeightFull = max( dotProduct, 0.0 );\n				float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n				vec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n			#else\n\n				float spotDiffuseWeight = max( dotProduct, 0.0 );\n\n			#endif\n\n			spotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\n\n					// specular\n\n			vec3 spotHalfVector = normalize( lVector + viewPosition );\n			float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n			float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n			float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n			spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n\n		}\n\n	}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n	vec3 dirDiffuse = vec3( 0.0 );\n	vec3 dirSpecular = vec3( 0.0 );\n\n	for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n		vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n		vec3 dirVector = normalize( lDirection.xyz );\n\n				// diffuse\n\n		float dotProduct = dot( normal, dirVector );\n\n		#ifdef WRAP_AROUND\n\n			float dirDiffuseWeightFull = max( dotProduct, 0.0 );\n			float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n			vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n		#else\n\n			float dirDiffuseWeight = max( dotProduct, 0.0 );\n\n		#endif\n\n		dirDiffuse += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\n\n		// specular\n\n		vec3 dirHalfVector = normalize( dirVector + viewPosition );\n		float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n		float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n		/*\n		// fresnel term from skin shader\n		const float F0 = 0.128;\n\n		float base = 1.0 - dot( viewPosition, dirHalfVector );\n		float exponential = pow( base, 5.0 );\n\n		float fresnel = exponential + F0 * ( 1.0 - exponential );\n		*/\n\n		/*\n		// fresnel term from fresnel shader\n		const float mFresnelBias = 0.08;\n		const float mFresnelScale = 0.3;\n		const float mFresnelPower = 5.0;\n\n		float fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n		*/\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		// 		dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n		dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	vec3 hemiDiffuse = vec3( 0.0 );\n	vec3 hemiSpecular = vec3( 0.0 );\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n		vec3 lVector = normalize( lDirection.xyz );\n\n		// diffuse\n\n		float dotProduct = dot( normal, lVector );\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n		vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		hemiDiffuse += diffuse * hemiColor;\n\n		// specular (sky light)\n\n		vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n		float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n		float hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n		// specular (ground light)\n\n		vec3 lVectorGround = -lVector;\n\n		vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n		float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n		float hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n		float dotProductGround = dot( normal, lVectorGround );\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n		vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n		hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n	}\n\n#endif\n\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n\n#if MAX_DIR_LIGHTS > 0\n\n	totalDiffuse += dirDiffuse;\n	totalSpecular += dirSpecular;\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	totalDiffuse += hemiDiffuse;\n	totalSpecular += hemiSpecular;\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	totalDiffuse += pointDiffuse;\n	totalSpecular += pointSpecular;\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	totalDiffuse += spotDiffuse;\n	totalSpecular += spotSpecular;\n\n#endif\n\n#ifdef METAL\n\n	gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n\n#else\n\n	gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n\n#endif";i.ShaderChunk["fog_pars_fragment"]="#ifdef USE_FOG\n\n	uniform vec3 fogColor;\n\n	#ifdef FOG_EXP2\n\n		uniform float fogDensity;\n\n	#else\n\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n\n#endif";i.ShaderChunk["morphnormal_vertex"]="#ifdef USE_MORPHNORMALS\n\n	vec3 morphedNormal = vec3( 0.0 );\n\n	morphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n	morphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n	morphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n	morphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n	morphedNormal += normal;\n\n#endif";i.ShaderChunk["envmap_pars_fragment"]="#ifdef USE_ENVMAP\n\n	uniform float reflectivity;\n	uniform samplerCube envMap;\n	uniform float flipEnvMap;\n	uniform int combine;\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		uniform bool useRefract;\n		uniform float refractionRatio;\n\n	#else\n\n		varying vec3 vReflect;\n\n	#endif\n\n#endif";i.ShaderChunk["logdepthbuf_fragment"]="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n	gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif";i.ShaderChunk["normalmap_pars_fragment"]="#ifdef USE_NORMALMAP\n\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n\n			// Per-Pixel Tangent Space Normal Mapping\n			// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n\n		vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n		vec3 N = normalize( surf_norm );\n\n		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n		mapN.xy = normalScale * mapN.xy;\n		mat3 tsn = mat3( S, T, N );\n		return normalize( tsn * mapN );\n\n	}\n\n#endif\n";i.ShaderChunk["lights_phong_pars_vertex"]="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n";i.ShaderChunk["lightmap_pars_fragment"]="#ifdef USE_LIGHTMAP\n\n	varying vec2 vUv2;\n	uniform sampler2D lightMap;\n\n#endif";i.ShaderChunk["shadowmap_vertex"]="#ifdef USE_SHADOWMAP\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n	}\n\n#endif";i.ShaderChunk["lights_phong_vertex"]="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	vWorldPosition = worldPosition.xyz;\n\n#endif";i.ShaderChunk["map_fragment"]="#ifdef USE_MAP\n\n	vec4 texelColor = texture2D( map, vUv );\n\n	#ifdef GAMMA_INPUT\n\n		texelColor.xyz *= texelColor.xyz;\n\n	#endif\n\n	gl_FragColor = gl_FragColor * texelColor;\n\n#endif";i.ShaderChunk["lightmap_vertex"]="#ifdef USE_LIGHTMAP\n\n	vUv2 = uv2;\n\n#endif";i.ShaderChunk["map_particle_fragment"]="#ifdef USE_MAP\n\n	gl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n\n#endif";i.ShaderChunk["color_pars_fragment"]="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif\n";i.ShaderChunk["color_vertex"]="#ifdef USE_COLOR\n\n	#ifdef GAMMA_INPUT\n\n		vColor = color * color;\n\n	#else\n\n		vColor = color;\n\n	#endif\n\n#endif";i.ShaderChunk["skinning_vertex"]="#ifdef USE_SKINNING\n\n	#ifdef USE_MORPHTARGETS\n\n	vec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n	#else\n\n	vec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n	#endif\n\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	skinned  = bindMatrixInverse * skinned;\n\n#endif\n";i.ShaderChunk["envmap_pars_vertex"]="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	varying vec3 vReflect;\n\n	uniform float refractionRatio;\n	uniform bool useRefract;\n\n#endif\n";i.ShaderChunk["linear_to_gamma_fragment"]="#ifdef GAMMA_OUTPUT\n\n	gl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n\n#endif";i.ShaderChunk["color_pars_vertex"]="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif";i.ShaderChunk["lights_lambert_pars_vertex"]="uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\n\nuniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n	uniform vec3 wrapRGB;\n\n#endif\n";i.ShaderChunk["map_pars_vertex"]="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	varying vec2 vUv;\n	uniform vec4 offsetRepeat;\n\n#endif\n";i.ShaderChunk["envmap_fragment"]="#ifdef USE_ENVMAP\n\n	vec3 reflectVec;\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n		// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\n		// Transforming Normal Vectors with the Inverse Transformation\n\n		vec3 worldNormal = normalize( vec3( vec4( normal, 0.0 ) * viewMatrix ) );\n\n		if ( useRefract ) {\n\n			reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n		} else { \n\n			reflectVec = reflect( cameraToVertex, worldNormal );\n\n		}\n\n	#else\n\n		reflectVec = vReflect;\n\n	#endif\n\n	#ifdef DOUBLE_SIDED\n\n		float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n		vec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n	#else\n\n		vec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n	#endif\n\n	#ifdef GAMMA_INPUT\n\n		cubeColor.xyz *= cubeColor.xyz;\n\n	#endif\n\n	if ( combine == 1 ) {\n\n		gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n\n	} else if ( combine == 2 ) {\n\n		gl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n\n	} else {\n\n		gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n\n	}\n\n#endif";i.ShaderChunk["specularmap_pars_fragment"]="#ifdef USE_SPECULARMAP\n\n	uniform sampler2D specularMap;\n\n#endif";i.ShaderChunk["logdepthbuf_vertex"]="#ifdef USE_LOGDEPTHBUF\n\n	gl_Position.z = log2(max(1e-6, gl_Position.w + 1.0)) * logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		vFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n		gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n	#endif\n\n#endif";i.ShaderChunk["morphtarget_pars_vertex"]="#ifdef USE_MORPHTARGETS\n\n	#ifndef USE_MORPHNORMALS\n\n	uniform float morphTargetInfluences[ 8 ];\n\n	#else\n\n	uniform float morphTargetInfluences[ 4 ];\n\n	#endif\n\n#endif";i.ShaderChunk["specularmap_fragment"]="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n\n#else\n\n	specularStrength = 1.0;\n\n#endif";i.ShaderChunk["fog_fragment"]="#ifdef USE_FOG\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n	#else\n\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n\n	#endif\n\n	#ifdef FOG_EXP2\n\n		const float LOG2 = 1.442695;\n		float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\n		fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n\n	#else\n\n		float fogFactor = smoothstep( fogNear, fogFar, depth );\n\n	#endif\n	\n	gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n\n#endif";i.ShaderChunk["bumpmap_pars_fragment"]="#ifdef USE_BUMPMAP\n\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n\n			// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n			//	http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n			// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n	vec2 dHdxy_fwd() {\n\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n		return vec2( dBx, dBy );\n\n	}\n\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n		vec3 vSigmaX = dFdx( surf_pos );\n		vec3 vSigmaY = dFdy( surf_pos );\n		vec3 vN = surf_norm;		// normalized\n\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n\n		float fDet = dot( vSigmaX, R1 );\n\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n\n	}\n\n#endif";i.ShaderChunk["defaultnormal_vertex"]="vec3 objectNormal;\n\n#ifdef USE_SKINNING\n\n	objectNormal = skinnedNormal.xyz;\n\n#endif\n\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\n\n	objectNormal = morphedNormal;\n\n#endif\n\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\n\n	objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n	objectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;";i.ShaderChunk["lights_phong_pars_fragment"]="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n	uniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;";i.ShaderChunk["skinbase_vertex"]="#ifdef USE_SKINNING\n\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif";i.ShaderChunk["map_vertex"]="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif";i.ShaderChunk["lightmap_fragment"]="#ifdef USE_LIGHTMAP\n\n	gl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n\n#endif";i.ShaderChunk["shadowmap_pars_vertex"]="#ifdef USE_SHADOWMAP\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n	uniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif";i.ShaderChunk["color_fragment"]="#ifdef USE_COLOR\n\n	gl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n\n#endif";i.ShaderChunk["morphtarget_vertex"]="#ifdef USE_MORPHTARGETS\n\n	vec3 morphed = vec3( 0.0 );\n	morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n	morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n	morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n	morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n	#ifndef USE_MORPHNORMALS\n\n	morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n	morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n	morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n	morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n	#endif\n\n	morphed += position;\n\n#endif";i.ShaderChunk["envmap_vertex"]="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\n	worldNormal = normalize( worldNormal );\n\n	vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n	if ( useRefract ) {\n\n		vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n	} else {\n\n		vReflect = reflect( cameraToVertex, worldNormal );\n\n	}\n\n#endif";
i.ShaderChunk["shadowmap_fragment"]="#ifdef USE_SHADOWMAP\n\n	#ifdef SHADOWMAP_DEBUG\n\n		vec3 frustumColors[3];\n		frustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n		frustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n		frustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n	#endif\n\n	#ifdef SHADOWMAP_CASCADE\n\n		int inFrustumCount = 0;\n\n	#endif\n\n	float fDepth;\n	vec3 shadowColor = vec3( 1.0 );\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n				// if ( something && something ) breaks ATI OpenGL shader compiler\n				// if ( all( something, something ) ) using this instead\n\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n\n				// don't shadow pixels outside of light frustum\n				// use just first frustum (for cascades)\n				// don't shadow pixels behind far plane of light frustum\n\n		#ifdef SHADOWMAP_CASCADE\n\n			inFrustumCount += int( inFrustum );\n			bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n		#else\n\n			bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n		#endif\n\n		bool frustumTest = all( frustumTestVec );\n\n		if ( frustumTest ) {\n\n			shadowCoord.z += shadowBias[ i ];\n\n			#if defined( SHADOWMAP_TYPE_PCF )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n		/*\n						// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n						// must enroll loop manually\n\n				for ( float y = -1.25; y <= 1.25; y += 1.25 )\n					for ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n						vec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n								// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n								//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n						float fDepth = unpackDepth( rgbaDepth );\n\n						if ( fDepth < shadowCoord.z )\n							shadow += 1.0;\n\n				}\n\n				shadow /= 9.0;\n\n		*/\n\n				const float shadowDelta = 1.0 / 9.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.25 * xPixelOffset;\n				float dy0 = -1.25 * yPixelOffset;\n				float dx1 = 1.25 * xPixelOffset;\n				float dy1 = 1.25 * yPixelOffset;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.0 * xPixelOffset;\n				float dy0 = -1.0 * yPixelOffset;\n				float dx1 = 1.0 * xPixelOffset;\n				float dy1 = 1.0 * yPixelOffset;\n\n				mat3 shadowKernel;\n				mat3 depthKernel;\n\n				depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n				vec3 shadowZ = vec3( shadowCoord.z );\n				shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n				shadowKernel[0] *= vec3(0.25);\n\n				shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n				shadowKernel[1] *= vec3(0.25);\n\n				shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n				shadowKernel[2] *= vec3(0.25);\n\n				vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n				shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n				shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n				vec4 shadowValues;\n				shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n				shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n				shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n				shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n				shadow = dot( shadowValues, vec4( 1.0 ) );\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#else\n\n				vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n				float fDepth = unpackDepth( rgbaDepth );\n\n				if ( fDepth < shadowCoord.z )\n\n		// spot with multiple shadows is darker\n\n					shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n		// spot with multiple shadows has the same color as single shadow spot\n\n		// 					shadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n			#endif\n\n		}\n\n\n		#ifdef SHADOWMAP_DEBUG\n\n			#ifdef SHADOWMAP_CASCADE\n\n				if ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n\n			#else\n\n				if ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n\n			#endif\n\n		#endif\n\n	}\n\n	#ifdef GAMMA_OUTPUT\n\n		shadowColor *= shadowColor;\n\n	#endif\n\n	gl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n\n#endif\n";i.ShaderChunk["worldpos_vertex"]="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n	#ifdef USE_SKINNING\n\n		vec4 worldPosition = modelMatrix * skinned;\n\n	#endif\n\n	#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n\n		vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n	#endif\n\n	#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n\n		vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n	#endif\n\n#endif";i.ShaderChunk["shadowmap_pars_fragment"]="#ifdef USE_SHADOWMAP\n\n	uniform sampler2D shadowMap[ MAX_SHADOWS ];\n	uniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n	uniform float shadowDarkness[ MAX_SHADOWS ];\n	uniform float shadowBias[ MAX_SHADOWS ];\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n	float unpackDepth( const in vec4 rgba_depth ) {\n\n		const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n		float depth = dot( rgba_depth, bit_shift );\n		return depth;\n\n	}\n\n#endif";i.ShaderChunk["skinning_pars_vertex"]="#ifdef USE_SKINNING\n\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n\n	#ifdef BONE_TEXTURE\n\n		uniform sampler2D boneTexture;\n		uniform int boneTextureWidth;\n		uniform int boneTextureHeight;\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureWidth ) );\n			float y = floor( j / float( boneTextureWidth ) );\n\n			float dx = 1.0 / float( boneTextureWidth );\n			float dy = 1.0 / float( boneTextureHeight );\n\n			y = dy * ( y + 0.5 );\n\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n			mat4 bone = mat4( v1, v2, v3, v4 );\n\n			return bone;\n\n		}\n\n	#else\n\n		uniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			mat4 bone = boneGlobalMatrices[ int(i) ];\n			return bone;\n\n		}\n\n	#endif\n\n#endif\n";i.ShaderChunk["logdepthbuf_pars_fragment"]="#ifdef USE_LOGDEPTHBUF\n\n	uniform float logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		#extension GL_EXT_frag_depth : enable\n		varying float vFragDepth;\n\n	#endif\n\n#endif";i.ShaderChunk["alphamap_fragment"]="#ifdef USE_ALPHAMAP\n\n	gl_FragColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n";i.ShaderChunk["alphamap_pars_fragment"]="#ifdef USE_ALPHAMAP\n\n	uniform sampler2D alphaMap;\n\n#endif\n";i.UniformsUtils={merge:function(e){var t={};for(var r=0;r<e.length;r++){var i=this.clone(e[r]);for(var n in i){t[n]=i[n]}}return t},clone:function(e){var t={};for(var r in e){t[r]={};for(var n in e[r]){var a=e[r][n];if(a instanceof i.Color||a instanceof i.Vector2||a instanceof i.Vector3||a instanceof i.Vector4||a instanceof i.Matrix4||a instanceof i.Texture){t[r][n]=a.clone()}else if(a instanceof Array){t[r][n]=a.slice()}else{t[r][n]=a}}}return t}};i.UniformsLib={common:{diffuse:{type:"c",value:new i.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new i.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new i.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new i.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new i.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new i.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};i.ShaderLib={basic:{uniforms:i.UniformsUtils.merge([i.UniformsLib["common"],i.UniformsLib["fog"],i.UniformsLib["shadowmap"]]),vertexShader:[i.ShaderChunk["map_pars_vertex"],i.ShaderChunk["lightmap_pars_vertex"],i.ShaderChunk["envmap_pars_vertex"],i.ShaderChunk["color_pars_vertex"],i.ShaderChunk["morphtarget_pars_vertex"],i.ShaderChunk["skinning_pars_vertex"],i.ShaderChunk["shadowmap_pars_vertex"],i.ShaderChunk["logdepthbuf_pars_vertex"],"void main() {",i.ShaderChunk["map_vertex"],i.ShaderChunk["lightmap_vertex"],i.ShaderChunk["color_vertex"],i.ShaderChunk["skinbase_vertex"],"	#ifdef USE_ENVMAP",i.ShaderChunk["morphnormal_vertex"],i.ShaderChunk["skinnormal_vertex"],i.ShaderChunk["defaultnormal_vertex"],"	#endif",i.ShaderChunk["morphtarget_vertex"],i.ShaderChunk["skinning_vertex"],i.ShaderChunk["default_vertex"],i.ShaderChunk["logdepthbuf_vertex"],i.ShaderChunk["worldpos_vertex"],i.ShaderChunk["envmap_vertex"],i.ShaderChunk["shadowmap_vertex"],"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",i.ShaderChunk["color_pars_fragment"],i.ShaderChunk["map_pars_fragment"],i.ShaderChunk["alphamap_pars_fragment"],i.ShaderChunk["lightmap_pars_fragment"],i.ShaderChunk["envmap_pars_fragment"],i.ShaderChunk["fog_pars_fragment"],i.ShaderChunk["shadowmap_pars_fragment"],i.ShaderChunk["specularmap_pars_fragment"],i.ShaderChunk["logdepthbuf_pars_fragment"],"void main() {","	gl_FragColor = vec4( diffuse, opacity );",i.ShaderChunk["logdepthbuf_fragment"],i.ShaderChunk["map_fragment"],i.ShaderChunk["alphamap_fragment"],i.ShaderChunk["alphatest_fragment"],i.ShaderChunk["specularmap_fragment"],i.ShaderChunk["lightmap_fragment"],i.ShaderChunk["color_fragment"],i.ShaderChunk["envmap_fragment"],i.ShaderChunk["shadowmap_fragment"],i.ShaderChunk["linear_to_gamma_fragment"],i.ShaderChunk["fog_fragment"],"}"].join("\n")},lambert:{uniforms:i.UniformsUtils.merge([i.UniformsLib["common"],i.UniformsLib["fog"],i.UniformsLib["lights"],i.UniformsLib["shadowmap"],{ambient:{type:"c",value:new i.Color(16777215)},emissive:{type:"c",value:new i.Color(0)},wrapRGB:{type:"v3",value:new i.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",i.ShaderChunk["map_pars_vertex"],i.ShaderChunk["lightmap_pars_vertex"],i.ShaderChunk["envmap_pars_vertex"],i.ShaderChunk["lights_lambert_pars_vertex"],i.ShaderChunk["color_pars_vertex"],i.ShaderChunk["morphtarget_pars_vertex"],i.ShaderChunk["skinning_pars_vertex"],i.ShaderChunk["shadowmap_pars_vertex"],i.ShaderChunk["logdepthbuf_pars_vertex"],"void main() {",i.ShaderChunk["map_vertex"],i.ShaderChunk["lightmap_vertex"],i.ShaderChunk["color_vertex"],i.ShaderChunk["morphnormal_vertex"],i.ShaderChunk["skinbase_vertex"],i.ShaderChunk["skinnormal_vertex"],i.ShaderChunk["defaultnormal_vertex"],i.ShaderChunk["morphtarget_vertex"],i.ShaderChunk["skinning_vertex"],i.ShaderChunk["default_vertex"],i.ShaderChunk["logdepthbuf_vertex"],i.ShaderChunk["worldpos_vertex"],i.ShaderChunk["envmap_vertex"],i.ShaderChunk["lights_lambert_vertex"],i.ShaderChunk["shadowmap_vertex"],"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",i.ShaderChunk["color_pars_fragment"],i.ShaderChunk["map_pars_fragment"],i.ShaderChunk["alphamap_pars_fragment"],i.ShaderChunk["lightmap_pars_fragment"],i.ShaderChunk["envmap_pars_fragment"],i.ShaderChunk["fog_pars_fragment"],i.ShaderChunk["shadowmap_pars_fragment"],i.ShaderChunk["specularmap_pars_fragment"],i.ShaderChunk["logdepthbuf_pars_fragment"],"void main() {","	gl_FragColor = vec4( vec3( 1.0 ), opacity );",i.ShaderChunk["logdepthbuf_fragment"],i.ShaderChunk["map_fragment"],i.ShaderChunk["alphamap_fragment"],i.ShaderChunk["alphatest_fragment"],i.ShaderChunk["specularmap_fragment"],"	#ifdef DOUBLE_SIDED","		if ( gl_FrontFacing )","			gl_FragColor.xyz *= vLightFront;","		else","			gl_FragColor.xyz *= vLightBack;","	#else","		gl_FragColor.xyz *= vLightFront;","	#endif",i.ShaderChunk["lightmap_fragment"],i.ShaderChunk["color_fragment"],i.ShaderChunk["envmap_fragment"],i.ShaderChunk["shadowmap_fragment"],i.ShaderChunk["linear_to_gamma_fragment"],i.ShaderChunk["fog_fragment"],"}"].join("\n")},phong:{uniforms:i.UniformsUtils.merge([i.UniformsLib["common"],i.UniformsLib["bump"],i.UniformsLib["normalmap"],i.UniformsLib["fog"],i.UniformsLib["lights"],i.UniformsLib["shadowmap"],{ambient:{type:"c",value:new i.Color(16777215)},emissive:{type:"c",value:new i.Color(0)},specular:{type:"c",value:new i.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new i.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","varying vec3 vNormal;",i.ShaderChunk["map_pars_vertex"],i.ShaderChunk["lightmap_pars_vertex"],i.ShaderChunk["envmap_pars_vertex"],i.ShaderChunk["lights_phong_pars_vertex"],i.ShaderChunk["color_pars_vertex"],i.ShaderChunk["morphtarget_pars_vertex"],i.ShaderChunk["skinning_pars_vertex"],i.ShaderChunk["shadowmap_pars_vertex"],i.ShaderChunk["logdepthbuf_pars_vertex"],"void main() {",i.ShaderChunk["map_vertex"],i.ShaderChunk["lightmap_vertex"],i.ShaderChunk["color_vertex"],i.ShaderChunk["morphnormal_vertex"],i.ShaderChunk["skinbase_vertex"],i.ShaderChunk["skinnormal_vertex"],i.ShaderChunk["defaultnormal_vertex"],"	vNormal = normalize( transformedNormal );",i.ShaderChunk["morphtarget_vertex"],i.ShaderChunk["skinning_vertex"],i.ShaderChunk["default_vertex"],i.ShaderChunk["logdepthbuf_vertex"],"	vViewPosition = -mvPosition.xyz;",i.ShaderChunk["worldpos_vertex"],i.ShaderChunk["envmap_vertex"],i.ShaderChunk["lights_phong_vertex"],i.ShaderChunk["shadowmap_vertex"],"}"].join("\n"),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform float opacity;","uniform vec3 ambient;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;",i.ShaderChunk["color_pars_fragment"],i.ShaderChunk["map_pars_fragment"],i.ShaderChunk["alphamap_pars_fragment"],i.ShaderChunk["lightmap_pars_fragment"],i.ShaderChunk["envmap_pars_fragment"],i.ShaderChunk["fog_pars_fragment"],i.ShaderChunk["lights_phong_pars_fragment"],i.ShaderChunk["shadowmap_pars_fragment"],i.ShaderChunk["bumpmap_pars_fragment"],i.ShaderChunk["normalmap_pars_fragment"],i.ShaderChunk["specularmap_pars_fragment"],i.ShaderChunk["logdepthbuf_pars_fragment"],"void main() {","	gl_FragColor = vec4( vec3( 1.0 ), opacity );",i.ShaderChunk["logdepthbuf_fragment"],i.ShaderChunk["map_fragment"],i.ShaderChunk["alphamap_fragment"],i.ShaderChunk["alphatest_fragment"],i.ShaderChunk["specularmap_fragment"],i.ShaderChunk["lights_phong_fragment"],i.ShaderChunk["lightmap_fragment"],i.ShaderChunk["color_fragment"],i.ShaderChunk["envmap_fragment"],i.ShaderChunk["shadowmap_fragment"],i.ShaderChunk["linear_to_gamma_fragment"],i.ShaderChunk["fog_fragment"],"}"].join("\n")},particle_basic:{uniforms:i.UniformsUtils.merge([i.UniformsLib["particle"],i.UniformsLib["shadowmap"]]),vertexShader:["uniform float size;","uniform float scale;",i.ShaderChunk["color_pars_vertex"],i.ShaderChunk["shadowmap_pars_vertex"],i.ShaderChunk["logdepthbuf_pars_vertex"],"void main() {",i.ShaderChunk["color_vertex"],"	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	#ifdef USE_SIZEATTENUATION","		gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","	#else","		gl_PointSize = size;","	#endif","	gl_Position = projectionMatrix * mvPosition;",i.ShaderChunk["logdepthbuf_vertex"],i.ShaderChunk["worldpos_vertex"],i.ShaderChunk["shadowmap_vertex"],"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",i.ShaderChunk["color_pars_fragment"],i.ShaderChunk["map_particle_pars_fragment"],i.ShaderChunk["fog_pars_fragment"],i.ShaderChunk["shadowmap_pars_fragment"],i.ShaderChunk["logdepthbuf_pars_fragment"],"void main() {","	gl_FragColor = vec4( psColor, opacity );",i.ShaderChunk["logdepthbuf_fragment"],i.ShaderChunk["map_particle_fragment"],i.ShaderChunk["alphatest_fragment"],i.ShaderChunk["color_fragment"],i.ShaderChunk["shadowmap_fragment"],i.ShaderChunk["fog_fragment"],"}"].join("\n")},dashed:{uniforms:i.UniformsUtils.merge([i.UniformsLib["common"],i.UniformsLib["fog"],{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",i.ShaderChunk["color_pars_vertex"],i.ShaderChunk["logdepthbuf_pars_vertex"],"void main() {",i.ShaderChunk["color_vertex"],"	vLineDistance = scale * lineDistance;","	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	gl_Position = projectionMatrix * mvPosition;",i.ShaderChunk["logdepthbuf_vertex"],"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",i.ShaderChunk["color_pars_fragment"],i.ShaderChunk["fog_pars_fragment"],i.ShaderChunk["logdepthbuf_pars_fragment"],"void main() {","	if ( mod( vLineDistance, totalSize ) > dashSize ) {","		discard;","	}","	gl_FragColor = vec4( diffuse, opacity );",i.ShaderChunk["logdepthbuf_fragment"],i.ShaderChunk["color_fragment"],i.ShaderChunk["fog_fragment"],"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[i.ShaderChunk["morphtarget_pars_vertex"],i.ShaderChunk["logdepthbuf_pars_vertex"],"void main() {",i.ShaderChunk["morphtarget_vertex"],i.ShaderChunk["default_vertex"],i.ShaderChunk["logdepthbuf_vertex"],"}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;",i.ShaderChunk["logdepthbuf_pars_fragment"],"void main() {",i.ShaderChunk["logdepthbuf_fragment"],"	#ifdef USE_LOGDEPTHBUF_EXT","		float depth = gl_FragDepthEXT / gl_FragCoord.w;","	#else","		float depth = gl_FragCoord.z / gl_FragCoord.w;","	#endif","	float color = 1.0 - smoothstep( mNear, mFar, depth );","	gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",i.ShaderChunk["morphtarget_pars_vertex"],i.ShaderChunk["logdepthbuf_pars_vertex"],"void main() {","	vNormal = normalize( normalMatrix * normal );",i.ShaderChunk["morphtarget_vertex"],i.ShaderChunk["default_vertex"],i.ShaderChunk["logdepthbuf_vertex"],"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;",i.ShaderChunk["logdepthbuf_pars_fragment"],"void main() {","	gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",i.ShaderChunk["logdepthbuf_fragment"],"}"].join("\n")},normalmap:{uniforms:i.UniformsUtils.merge([i.UniformsLib["fog"],i.UniformsLib["lights"],i.UniformsLib["shadowmap"],{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new i.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},diffuse:{type:"c",value:new i.Color(16777215)},specular:{type:"c",value:new i.Color(1118481)},ambient:{type:"c",value:new i.Color(16777215)},shininess:{type:"f",value:30},opacity:{type:"f",value:1},useRefract:{type:"i",value:0},refractionRatio:{type:"f",value:.98},reflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new i.Vector2(0,0)},uRepeat:{type:"v2",value:new i.Vector2(1,1)},wrapRGB:{type:"v3",value:new i.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 ambient;","uniform vec3 diffuse;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;","uniform bool enableDiffuse;","uniform bool enableSpecular;","uniform bool enableAO;","uniform bool enableReflection;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tAO;","uniform samplerCube tCube;","uniform vec2 uNormalScale;","uniform bool useRefract;","uniform float refractionRatio;","uniform float reflectivity;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","	uniform vec3 wrapRGB;","#endif","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",i.ShaderChunk["shadowmap_pars_fragment"],i.ShaderChunk["fog_pars_fragment"],i.ShaderChunk["logdepthbuf_pars_fragment"],"void main() {",i.ShaderChunk["logdepthbuf_fragment"],"	gl_FragColor = vec4( vec3( 1.0 ), opacity );","	vec3 specularTex = vec3( 1.0 );","	vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","	normalTex.xy *= uNormalScale;","	normalTex = normalize( normalTex );","	if( enableDiffuse ) {","		#ifdef GAMMA_INPUT","			vec4 texelColor = texture2D( tDiffuse, vUv );","			texelColor.xyz *= texelColor.xyz;","			gl_FragColor = gl_FragColor * texelColor;","		#else","			gl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );","		#endif","	}","	if( enableAO ) {","		#ifdef GAMMA_INPUT","			vec4 aoColor = texture2D( tAO, vUv );","			aoColor.xyz *= aoColor.xyz;","			gl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;","		#else","			gl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;","		#endif","	}",i.ShaderChunk["alphatest_fragment"],"	if( enableSpecular )","		specularTex = texture2D( tSpecular, vUv ).xyz;","	mat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );","	vec3 finalNormal = tsb * normalTex;","	#ifdef FLIP_SIDED","		finalNormal = -finalNormal;","	#endif","	vec3 normal = normalize( finalNormal );","	vec3 viewPosition = normalize( vViewPosition );","	#if MAX_POINT_LIGHTS > 0","		vec3 pointDiffuse = vec3( 0.0 );","		vec3 pointSpecular = vec3( 0.0 );","		for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","			vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","			vec3 pointVector = lPosition.xyz + vViewPosition.xyz;","			float pointDistance = 1.0;","			if ( pointLightDistance[ i ] > 0.0 )","				pointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );","			pointVector = normalize( pointVector );","			#ifdef WRAP_AROUND","				float pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );","				float pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );","				vec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","			#else","				float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","			#endif","			pointDiffuse += pointDistance * pointLightColor[ i ] * diffuse * pointDiffuseWeight;","			vec3 pointHalfVector = normalize( pointVector + viewPosition );","			float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","			float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, shininess ), 0.0 );","			float specularNormalization = ( shininess + 2.0 ) / 8.0;","			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( pointVector, pointHalfVector ), 0.0 ), 5.0 );","			pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;","		}","	#endif","	#if MAX_SPOT_LIGHTS > 0","		vec3 spotDiffuse = vec3( 0.0 );","		vec3 spotSpecular = vec3( 0.0 );","		for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","			vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","			vec3 spotVector = lPosition.xyz + vViewPosition.xyz;","			float spotDistance = 1.0;","			if ( spotLightDistance[ i ] > 0.0 )","				spotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );","			spotVector = normalize( spotVector );","			float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","			if ( spotEffect > spotLightAngleCos[ i ] ) {","				spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );","				#ifdef WRAP_AROUND","					float spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );","					float spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );","					vec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","				#else","					float spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );","				#endif","				spotDiffuse += spotDistance * spotLightColor[ i ] * diffuse * spotDiffuseWeight * spotEffect;","				vec3 spotHalfVector = normalize( spotVector + viewPosition );","				float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","				float spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, shininess ), 0.0 );","				float specularNormalization = ( shininess + 2.0 ) / 8.0;","				vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( spotVector, spotHalfVector ), 0.0 ), 5.0 );","				spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;","			}","		}","	#endif","	#if MAX_DIR_LIGHTS > 0","		vec3 dirDiffuse = vec3( 0.0 );","		vec3 dirSpecular = vec3( 0.0 );","		for( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {","			vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","			vec3 dirVector = normalize( lDirection.xyz );","			#ifdef WRAP_AROUND","				float directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );","				float directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","				vec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );","			#else","				float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","			#endif","			dirDiffuse += directionalLightColor[ i ] * diffuse * dirDiffuseWeight;","			vec3 dirHalfVector = normalize( dirVector + viewPosition );","			float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","			float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, shininess ), 0.0 );","			float specularNormalization = ( shininess + 2.0 ) / 8.0;","			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );","			dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","		}","	#endif","	#if MAX_HEMI_LIGHTS > 0","		vec3 hemiDiffuse = vec3( 0.0 );","		vec3 hemiSpecular = vec3( 0.0 );","		for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","			vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","			vec3 lVector = normalize( lDirection.xyz );","			float dotProduct = dot( normal, lVector );","			float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","			vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","			hemiDiffuse += diffuse * hemiColor;","			vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","			float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","			float hemiSpecularWeightSky = specularTex.r * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );","			vec3 lVectorGround = -lVector;","			vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","			float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","			float hemiSpecularWeightGround = specularTex.r * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );","			float dotProductGround = dot( normal, lVectorGround );","			float specularNormalization = ( shininess + 2.0 ) / 8.0;","			vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );","			vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );","			hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","		}","	#endif","	vec3 totalDiffuse = vec3( 0.0 );","	vec3 totalSpecular = vec3( 0.0 );","	#if MAX_DIR_LIGHTS > 0","		totalDiffuse += dirDiffuse;","		totalSpecular += dirSpecular;","	#endif","	#if MAX_HEMI_LIGHTS > 0","		totalDiffuse += hemiDiffuse;","		totalSpecular += hemiSpecular;","	#endif","	#if MAX_POINT_LIGHTS > 0","		totalDiffuse += pointDiffuse;","		totalSpecular += pointSpecular;","	#endif","	#if MAX_SPOT_LIGHTS > 0","		totalDiffuse += spotDiffuse;","		totalSpecular += spotSpecular;","	#endif","	#ifdef METAL","		gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient + totalSpecular );","	#else","		gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient ) + totalSpecular;","	#endif","	if ( enableReflection ) {","		vec3 vReflect;","		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","		if ( useRefract ) {","			vReflect = refract( cameraToVertex, normal, refractionRatio );","		} else {","			vReflect = reflect( cameraToVertex, normal );","		}","		vec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","		#ifdef GAMMA_INPUT","			cubeColor.xyz *= cubeColor.xyz;","		#endif","		gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * reflectivity );","	}",i.ShaderChunk["shadowmap_fragment"],i.ShaderChunk["linear_to_gamma_fragment"],i.ShaderChunk["fog_fragment"],"}"].join("\n"),vertexShader:["attribute vec4 tangent;","uniform vec2 uOffset;","uniform vec2 uRepeat;","uniform bool enableDisplacement;","#ifdef VERTEX_TEXTURES","	uniform sampler2D tDisplacement;","	uniform float uDisplacementScale;","	uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",i.ShaderChunk["skinning_pars_vertex"],i.ShaderChunk["shadowmap_pars_vertex"],i.ShaderChunk["logdepthbuf_pars_vertex"],"void main() {",i.ShaderChunk["skinbase_vertex"],i.ShaderChunk["skinnormal_vertex"],"	#ifdef USE_SKINNING","		vNormal = normalize( normalMatrix * skinnedNormal.xyz );","		vec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );","		vTangent = normalize( normalMatrix * skinnedTangent.xyz );","	#else","		vNormal = normalize( normalMatrix * normal );","		vTangent = normalize( normalMatrix * tangent.xyz );","	#endif","	vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );","	vUv = uv * uRepeat + uOffset;","	vec3 displacedPosition;","	#ifdef VERTEX_TEXTURES","		if ( enableDisplacement ) {","			vec3 dv = texture2D( tDisplacement, uv ).xyz;","			float df = uDisplacementScale * dv.x + uDisplacementBias;","			displacedPosition = position + normalize( normal ) * df;","		} else {","			#ifdef USE_SKINNING","				vec4 skinVertex = bindMatrix * vec4( position, 1.0 );","				vec4 skinned = vec4( 0.0 );","				skinned += boneMatX * skinVertex * skinWeight.x;","				skinned += boneMatY * skinVertex * skinWeight.y;","				skinned += boneMatZ * skinVertex * skinWeight.z;","				skinned += boneMatW * skinVertex * skinWeight.w;","				skinned  = bindMatrixInverse * skinned;","				displacedPosition = skinned.xyz;","			#else","				displacedPosition = position;","			#endif","		}","	#else","		#ifdef USE_SKINNING","			vec4 skinVertex = bindMatrix * vec4( position, 1.0 );","			vec4 skinned = vec4( 0.0 );","			skinned += boneMatX * skinVertex * skinWeight.x;","			skinned += boneMatY * skinVertex * skinWeight.y;","			skinned += boneMatZ * skinVertex * skinWeight.z;","			skinned += boneMatW * skinVertex * skinWeight.w;","			skinned  = bindMatrixInverse * skinned;","			displacedPosition = skinned.xyz;","		#else","			displacedPosition = position;","		#endif","	#endif","	vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","	vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","	gl_Position = projectionMatrix * mvPosition;",i.ShaderChunk["logdepthbuf_vertex"],"	vWorldPosition = worldPosition.xyz;","	vViewPosition = -mvPosition.xyz;","	#ifdef USE_SHADOWMAP","		for( int i = 0; i < MAX_SHADOWS; i ++ ) {","			vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","		}","	#endif","}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",i.ShaderChunk["logdepthbuf_pars_vertex"],"void main() {","	vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","	vWorldPosition = worldPosition.xyz;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",i.ShaderChunk["logdepthbuf_vertex"],"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;",i.ShaderChunk["logdepthbuf_pars_fragment"],"void main() {","	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",i.ShaderChunk["logdepthbuf_fragment"],"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[i.ShaderChunk["morphtarget_pars_vertex"],i.ShaderChunk["skinning_pars_vertex"],i.ShaderChunk["logdepthbuf_pars_vertex"],"void main() {",i.ShaderChunk["skinbase_vertex"],i.ShaderChunk["morphtarget_vertex"],i.ShaderChunk["skinning_vertex"],i.ShaderChunk["default_vertex"],i.ShaderChunk["logdepthbuf_vertex"],"}"].join("\n"),fragmentShader:[i.ShaderChunk["logdepthbuf_pars_fragment"],"vec4 pack_depth( const in float depth ) {","	const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","	const vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","	vec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );","	res -= res.xxyz * bit_mask;","	return res;","}","void main() {",i.ShaderChunk["logdepthbuf_fragment"],"	#ifdef USE_LOGDEPTHBUF_EXT","		gl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );","	#else","		gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","	#endif","}"].join("\n")}};
i.WebGLRenderer=function(e){console.log("THREE.WebGLRenderer",i.REVISION);e=e||{};var t=e.canvas!==undefined?e.canvas:document.createElement("canvas"),r=e.context!==undefined?e.context:null,n=e.precision!==undefined?e.precision:"highp",a=e.alpha!==undefined?e.alpha:false,o=e.depth!==undefined?e.depth:true,s=e.stencil!==undefined?e.stencil:true,l=e.antialias!==undefined?e.antialias:false,h=e.premultipliedAlpha!==undefined?e.premultipliedAlpha:true,u=e.preserveDrawingBuffer!==undefined?e.preserveDrawingBuffer:false,f=e.logarithmicDepthBuffer!==undefined?e.logarithmicDepthBuffer:false,c=new i.Color(0),p=0;var d=[];var v={};var m=[];var g=[];var y=[];var _=[];var x=[];this.domElement=t;this.context=null;this.devicePixelRatio=e.devicePixelRatio!==undefined?e.devicePixelRatio:self.devicePixelRatio!==undefined?self.devicePixelRatio:1;this.autoClear=true;this.autoClearColor=true;this.autoClearDepth=true;this.autoClearStencil=true;this.sortObjects=true;this.gammaInput=false;this.gammaOutput=false;this.shadowMapEnabled=false;this.shadowMapType=i.PCFShadowMap;this.shadowMapCullFace=i.CullFaceFront;this.shadowMapDebug=false;this.shadowMapCascade=false;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=true;this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var b=this,w=[],T=null,S=null,M=-1,A=-1,E=null,C=0,P=-1,R=-1,L=-1,k=-1,F=-1,D=-1,U=-1,O=-1,j=null,V=null,N=null,B=null,z=0,I=0,H=t.width,G=t.height,W=0,X=0,Y=new Uint8Array(16),q=new Uint8Array(16),K=new i.Frustum,Z=new i.Matrix4,Q=new i.Matrix4,$=new i.Vector3,J=new i.Vector3,et=true,tt={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};var rt;try{var it={alpha:a,depth:o,stencil:s,antialias:l,premultipliedAlpha:h,preserveDrawingBuffer:u};rt=r||t.getContext("webgl",it)||t.getContext("experimental-webgl",it);if(rt===null){if(t.getContext("webgl")!==null){throw"Error creating WebGL context with your selected attributes."}else{throw"Error creating WebGL context."}}}catch(nt){console.error(nt)}if(rt.getShaderPrecisionFormat===undefined){rt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}}var at=new i.WebGLExtensions(rt);at.get("OES_texture_float");at.get("OES_texture_float_linear");at.get("OES_standard_derivatives");if(f){at.get("EXT_frag_depth")}function ot(){rt.clearColor(0,0,0,1);rt.clearDepth(1);rt.clearStencil(0);rt.enable(rt.DEPTH_TEST);rt.depthFunc(rt.LEQUAL);rt.frontFace(rt.CCW);rt.cullFace(rt.BACK);rt.enable(rt.CULL_FACE);rt.enable(rt.BLEND);rt.blendEquation(rt.FUNC_ADD);rt.blendFunc(rt.SRC_ALPHA,rt.ONE_MINUS_SRC_ALPHA);rt.viewport(z,I,H,G);rt.clearColor(c.r,c.g,c.b,p)}ot();this.context=rt;var st=rt.getParameter(rt.MAX_TEXTURE_IMAGE_UNITS);var lt=rt.getParameter(rt.MAX_VERTEX_TEXTURE_IMAGE_UNITS);var ht=rt.getParameter(rt.MAX_TEXTURE_SIZE);var ut=rt.getParameter(rt.MAX_CUBE_MAP_TEXTURE_SIZE);var ft=lt>0;var ct=ft&&at.get("OES_texture_float");var pt=rt.getShaderPrecisionFormat(rt.VERTEX_SHADER,rt.HIGH_FLOAT);var dt=rt.getShaderPrecisionFormat(rt.VERTEX_SHADER,rt.MEDIUM_FLOAT);var vt=rt.getShaderPrecisionFormat(rt.VERTEX_SHADER,rt.LOW_FLOAT);var mt=rt.getShaderPrecisionFormat(rt.FRAGMENT_SHADER,rt.HIGH_FLOAT);var gt=rt.getShaderPrecisionFormat(rt.FRAGMENT_SHADER,rt.MEDIUM_FLOAT);var yt=rt.getShaderPrecisionFormat(rt.FRAGMENT_SHADER,rt.LOW_FLOAT);var _t=function(){var e;return function(){if(e!==undefined){return e}e=[];if(at.get("WEBGL_compressed_texture_pvrtc")||at.get("WEBGL_compressed_texture_s3tc")){var t=rt.getParameter(rt.COMPRESSED_TEXTURE_FORMATS);for(var r=0;r<t.length;r++){e.push(t[r])}}return e}}();var xt=pt.precision>0&&mt.precision>0;var bt=dt.precision>0&&gt.precision>0;if(n==="highp"&&!xt){if(bt){n="mediump";console.warn("THREE.WebGLRenderer: highp not supported, using mediump.")}else{n="lowp";console.warn("THREE.WebGLRenderer: highp and mediump not supported, using lowp.")}}if(n==="mediump"&&!bt){n="lowp";console.warn("THREE.WebGLRenderer: mediump not supported, using lowp.")}var wt=new i.ShadowMapPlugin(this,d,v,m);var Tt=new i.SpritePlugin(this,_);var St=new i.LensFlarePlugin(this,x);this.getContext=function(){return rt};this.supportsVertexTextures=function(){return ft};this.supportsFloatTextures=function(){return at.get("OES_texture_float")};this.supportsStandardDerivatives=function(){return at.get("OES_standard_derivatives")};this.supportsCompressedTextureS3TC=function(){return at.get("WEBGL_compressed_texture_s3tc")};this.supportsCompressedTexturePVRTC=function(){return at.get("WEBGL_compressed_texture_pvrtc")};this.supportsBlendMinMax=function(){return at.get("EXT_blend_minmax")};this.getMaxAnisotropy=function(){var e;return function(){if(e!==undefined){return e}var t=at.get("EXT_texture_filter_anisotropic");e=t!==null?rt.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0;return e}}();this.getPrecision=function(){return n};this.setSize=function(e,r,i){t.width=e*this.devicePixelRatio;t.height=r*this.devicePixelRatio;if(i!==false){t.style.width=e+"px";t.style.height=r+"px"}this.setViewport(0,0,e,r)};this.setViewport=function(e,t,r,i){z=e*this.devicePixelRatio;I=t*this.devicePixelRatio;H=r*this.devicePixelRatio;G=i*this.devicePixelRatio;rt.viewport(z,I,H,G)};this.setScissor=function(e,t,r,i){rt.scissor(e*this.devicePixelRatio,t*this.devicePixelRatio,r*this.devicePixelRatio,i*this.devicePixelRatio)};this.enableScissorTest=function(e){e?rt.enable(rt.SCISSOR_TEST):rt.disable(rt.SCISSOR_TEST)};this.setClearColor=function(e,t){c.set(e);p=t!==undefined?t:1;rt.clearColor(c.r,c.g,c.b,p)};this.setClearColorHex=function(e,t){console.warn("THREE.WebGLRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(e,t)};this.getClearColor=function(){return c};this.getClearAlpha=function(){return p};this.clear=function(e,t,r){var i=0;if(e===undefined||e)i|=rt.COLOR_BUFFER_BIT;if(t===undefined||t)i|=rt.DEPTH_BUFFER_BIT;if(r===undefined||r)i|=rt.STENCIL_BUFFER_BIT;rt.clear(i)};this.clearColor=function(){rt.clear(rt.COLOR_BUFFER_BIT)};this.clearDepth=function(){rt.clear(rt.DEPTH_BUFFER_BIT)};this.clearStencil=function(){rt.clear(rt.STENCIL_BUFFER_BIT)};this.clearTarget=function(e,t,r,i){this.setRenderTarget(e);this.clear(t,r,i)};this.resetGLState=function(){T=null;E=null;L=-1;U=-1;O=-1;P=-1;R=-1;A=-1;M=-1;et=true;for(var e=0;e<q.length;e++){q[e]=0}};function Mt(e){e.__webglVertexBuffer=rt.createBuffer();e.__webglColorBuffer=rt.createBuffer();b.info.memory.geometries++}function At(e){e.__webglVertexBuffer=rt.createBuffer();e.__webglColorBuffer=rt.createBuffer();e.__webglLineDistanceBuffer=rt.createBuffer();b.info.memory.geometries++}function Et(e){e.__webglVertexBuffer=rt.createBuffer();e.__webglNormalBuffer=rt.createBuffer();e.__webglTangentBuffer=rt.createBuffer();e.__webglColorBuffer=rt.createBuffer();e.__webglUVBuffer=rt.createBuffer();e.__webglUV2Buffer=rt.createBuffer();e.__webglSkinIndicesBuffer=rt.createBuffer();e.__webglSkinWeightsBuffer=rt.createBuffer();e.__webglFaceBuffer=rt.createBuffer();e.__webglLineBuffer=rt.createBuffer();var t,r;if(e.numMorphTargets){e.__webglMorphTargetsBuffers=[];for(t=0,r=e.numMorphTargets;t<r;t++){e.__webglMorphTargetsBuffers.push(rt.createBuffer())}}if(e.numMorphNormals){e.__webglMorphNormalsBuffers=[];for(t=0,r=e.numMorphNormals;t<r;t++){e.__webglMorphNormalsBuffers.push(rt.createBuffer())}}b.info.memory.geometries++}var Ct=function(e){var t=e.target;t.traverse(function(e){e.removeEventListener("remove",Ct);gr(e)})};var Pt=function(e){var t=e.target;t.removeEventListener("dispose",Pt);Dt(t)};var Rt=function(e){var t=e.target;t.removeEventListener("dispose",Rt);Ut(t);b.info.memory.textures--};var Lt=function(e){var t=e.target;t.removeEventListener("dispose",Lt);Ot(t);b.info.memory.textures--};var kt=function(e){var t=e.target;t.removeEventListener("dispose",kt);jt(t)};var Ft=function(e){var t=["__webglVertexBuffer","__webglNormalBuffer","__webglTangentBuffer","__webglColorBuffer","__webglUVBuffer","__webglUV2Buffer","__webglSkinIndicesBuffer","__webglSkinWeightsBuffer","__webglFaceBuffer","__webglLineBuffer","__webglLineDistanceBuffer"];for(var r=0,i=t.length;r<i;r++){var n=t[r];if(e[n]!==undefined){rt.deleteBuffer(e[n]);delete e[n]}}if(e.__webglCustomAttributesList!==undefined){for(var n in e.__webglCustomAttributesList){rt.deleteBuffer(e.__webglCustomAttributesList[n].buffer)}delete e.__webglCustomAttributesList}b.info.memory.geometries--};var Dt=function(e){delete e.__webglInit;if(e instanceof i.BufferGeometry){for(var t in e.attributes){var r=e.attributes[t];if(r.buffer!==undefined){rt.deleteBuffer(r.buffer);delete r.buffer}}b.info.memory.geometries--}else{var n=lr[e.id];if(n!==undefined){for(var a=0,o=n.length;a<o;a++){var s=n[a];if(s.numMorphTargets!==undefined){for(var l=0,h=s.numMorphTargets;l<h;l++){rt.deleteBuffer(s.__webglMorphTargetsBuffers[l])}delete s.__webglMorphTargetsBuffers}if(s.numMorphNormals!==undefined){for(var l=0,h=s.numMorphNormals;l<h;l++){rt.deleteBuffer(s.__webglMorphNormalsBuffers[l])}delete s.__webglMorphNormalsBuffers}Ft(s)}delete lr[e.id]}else{Ft(e)}}A=-1};var Ut=function(e){if(e.image&&e.image.__webglTextureCube){rt.deleteTexture(e.image.__webglTextureCube);delete e.image.__webglTextureCube}else{if(e.__webglInit===undefined)return;rt.deleteTexture(e.__webglTexture);delete e.__webglTexture;delete e.__webglInit}};var Ot=function(e){if(!e||e.__webglTexture===undefined)return;rt.deleteTexture(e.__webglTexture);delete e.__webglTexture;if(e instanceof i.WebGLRenderTargetCube){for(var t=0;t<6;t++){rt.deleteFramebuffer(e.__webglFramebuffer[t]);rt.deleteRenderbuffer(e.__webglRenderbuffer[t])}}else{rt.deleteFramebuffer(e.__webglFramebuffer);rt.deleteRenderbuffer(e.__webglRenderbuffer)}delete e.__webglFramebuffer;delete e.__webglRenderbuffer};var jt=function(e){var t=e.program.program;if(t===undefined)return;e.program=undefined;var r,i,n;var a=false;for(r=0,i=w.length;r<i;r++){n=w[r];if(n.program===t){n.usedTimes--;if(n.usedTimes===0){a=true}break}}if(a===true){var o=[];for(r=0,i=w.length;r<i;r++){n=w[r];if(n.program!==t){o.push(n)}}w=o;rt.deleteProgram(t);b.info.memory.programs--}};function Vt(e){var t=e.geometry;var r=e.material;var i=t.vertices.length;if(r.attributes){if(t.__webglCustomAttributesList===undefined){t.__webglCustomAttributesList=[]}for(var n in r.attributes){var a=r.attributes[n];if(!a.__webglInitialized||a.createUniqueBuffers){a.__webglInitialized=true;var o=1;if(a.type==="v2")o=2;else if(a.type==="v3")o=3;else if(a.type==="v4")o=4;else if(a.type==="c")o=3;a.size=o;a.array=new Float32Array(i*o);a.buffer=rt.createBuffer();a.buffer.belongsToAttribute=n;a.needsUpdate=true}t.__webglCustomAttributesList.push(a)}}}function Nt(e,t){var r=e.vertices.length;e.__vertexArray=new Float32Array(r*3);e.__colorArray=new Float32Array(r*3);e.__sortArray=[];e.__webglParticleCount=r;Vt(t)}function Bt(e,t){var r=e.vertices.length;e.__vertexArray=new Float32Array(r*3);e.__colorArray=new Float32Array(r*3);e.__lineDistanceArray=new Float32Array(r*1);e.__webglLineCount=r;Vt(t)}function zt(e,t){var r=t.geometry,i=e.faces3,n=i.length*3,a=i.length*1,o=i.length*3,s=It(t,e);e.__vertexArray=new Float32Array(n*3);e.__normalArray=new Float32Array(n*3);e.__colorArray=new Float32Array(n*3);e.__uvArray=new Float32Array(n*2);if(r.faceVertexUvs.length>1){e.__uv2Array=new Float32Array(n*2)}if(r.hasTangents){e.__tangentArray=new Float32Array(n*4)}if(t.geometry.skinWeights.length&&t.geometry.skinIndices.length){e.__skinIndexArray=new Float32Array(n*4);e.__skinWeightArray=new Float32Array(n*4)}var l=at.get("OES_element_index_uint")!==null&&a>21845?Uint32Array:Uint16Array;e.__typeArray=l;e.__faceArray=new l(a*3);e.__lineArray=new l(o*2);var h,u;if(e.numMorphTargets){e.__morphTargetsArrays=[];for(h=0,u=e.numMorphTargets;h<u;h++){e.__morphTargetsArrays.push(new Float32Array(n*3))}}if(e.numMorphNormals){e.__morphNormalsArrays=[];for(h=0,u=e.numMorphNormals;h<u;h++){e.__morphNormalsArrays.push(new Float32Array(n*3))}}e.__webglFaceCount=a*3;e.__webglLineCount=o*2;if(s.attributes){if(e.__webglCustomAttributesList===undefined){e.__webglCustomAttributesList=[]}for(var f in s.attributes){var c=s.attributes[f];var p={};for(var d in c){p[d]=c[d]}if(!p.__webglInitialized||p.createUniqueBuffers){p.__webglInitialized=true;var v=1;if(p.type==="v2")v=2;else if(p.type==="v3")v=3;else if(p.type==="v4")v=4;else if(p.type==="c")v=3;p.size=v;p.array=new Float32Array(n*v);p.buffer=rt.createBuffer();p.buffer.belongsToAttribute=f;c.needsUpdate=true;p.__original=c}e.__webglCustomAttributesList.push(p)}}e.__inittedArrays=true}function It(e,t){return e.material instanceof i.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function Ht(e){return e&&e.shading!==undefined&&e.shading===i.SmoothShading}function Gt(e,t,r){var i,n,a,o,s,l,h=e.vertices,u=h.length,f=e.colors,c=f.length,p=e.__vertexArray,d=e.__colorArray,v=e.__sortArray,m=e.verticesNeedUpdate,g=e.elementsNeedUpdate,y=e.colorsNeedUpdate,_=e.__webglCustomAttributesList,x,b,w,T,S,M,A;if(r.sortParticles){Q.copy(Z);Q.multiply(r.matrixWorld);for(i=0;i<u;i++){a=h[i];$.copy(a);$.applyProjection(Q);v[i]=[$.z,i]}v.sort(tr);for(i=0;i<u;i++){a=h[v[i][1]];o=i*3;p[o]=a.x;p[o+1]=a.y;p[o+2]=a.z}for(n=0;n<c;n++){o=n*3;l=f[v[n][1]];d[o]=l.r;d[o+1]=l.g;d[o+2]=l.b}if(_){for(x=0,b=_.length;x<b;x++){A=_[x];if(!(A.boundTo===undefined||A.boundTo==="vertices"))continue;o=0;S=A.value.length;if(A.size===1){for(T=0;T<S;T++){s=v[T][1];A.array[T]=A.value[s]}}else if(A.size===2){for(T=0;T<S;T++){s=v[T][1];M=A.value[s];A.array[o]=M.x;A.array[o+1]=M.y;o+=2}}else if(A.size===3){if(A.type==="c"){for(T=0;T<S;T++){s=v[T][1];M=A.value[s];A.array[o]=M.r;A.array[o+1]=M.g;A.array[o+2]=M.b;o+=3}}else{for(T=0;T<S;T++){s=v[T][1];M=A.value[s];A.array[o]=M.x;A.array[o+1]=M.y;A.array[o+2]=M.z;o+=3}}}else if(A.size===4){for(T=0;T<S;T++){s=v[T][1];M=A.value[s];A.array[o]=M.x;A.array[o+1]=M.y;A.array[o+2]=M.z;A.array[o+3]=M.w;o+=4}}}}}else{if(m){for(i=0;i<u;i++){a=h[i];o=i*3;p[o]=a.x;p[o+1]=a.y;p[o+2]=a.z}}if(y){for(n=0;n<c;n++){l=f[n];o=n*3;d[o]=l.r;d[o+1]=l.g;d[o+2]=l.b}}if(_){for(x=0,b=_.length;x<b;x++){A=_[x];if(A.needsUpdate&&(A.boundTo===undefined||A.boundTo==="vertices")){S=A.value.length;o=0;if(A.size===1){for(T=0;T<S;T++){A.array[T]=A.value[T]}}else if(A.size===2){for(T=0;T<S;T++){M=A.value[T];A.array[o]=M.x;A.array[o+1]=M.y;o+=2}}else if(A.size===3){if(A.type==="c"){for(T=0;T<S;T++){M=A.value[T];A.array[o]=M.r;A.array[o+1]=M.g;A.array[o+2]=M.b;o+=3}}else{for(T=0;T<S;T++){M=A.value[T];A.array[o]=M.x;A.array[o+1]=M.y;A.array[o+2]=M.z;o+=3}}}else if(A.size===4){for(T=0;T<S;T++){M=A.value[T];A.array[o]=M.x;A.array[o+1]=M.y;A.array[o+2]=M.z;A.array[o+3]=M.w;o+=4}}}}}}if(m||r.sortParticles){rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglVertexBuffer);rt.bufferData(rt.ARRAY_BUFFER,p,t)}if(y||r.sortParticles){rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglColorBuffer);rt.bufferData(rt.ARRAY_BUFFER,d,t)}if(_){for(x=0,b=_.length;x<b;x++){A=_[x];if(A.needsUpdate||r.sortParticles){rt.bindBuffer(rt.ARRAY_BUFFER,A.buffer);rt.bufferData(rt.ARRAY_BUFFER,A.array,t)}}}}function Wt(e,t){var r,i,n,a,o,s,l=e.vertices,h=e.colors,u=e.lineDistances,f=l.length,c=h.length,p=u.length,d=e.__vertexArray,v=e.__colorArray,m=e.__lineDistanceArray,g=e.verticesNeedUpdate,y=e.colorsNeedUpdate,_=e.lineDistancesNeedUpdate,x=e.__webglCustomAttributesList,b,w,T,S,M,A,E;if(g){for(r=0;r<f;r++){a=l[r];o=r*3;d[o]=a.x;d[o+1]=a.y;d[o+2]=a.z}rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglVertexBuffer);rt.bufferData(rt.ARRAY_BUFFER,d,t)}if(y){for(i=0;i<c;i++){s=h[i];o=i*3;v[o]=s.r;v[o+1]=s.g;v[o+2]=s.b}rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglColorBuffer);rt.bufferData(rt.ARRAY_BUFFER,v,t)}if(_){for(n=0;n<p;n++){m[n]=u[n]}rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglLineDistanceBuffer);rt.bufferData(rt.ARRAY_BUFFER,m,t)}if(x){for(b=0,w=x.length;b<w;b++){E=x[b];if(E.needsUpdate&&(E.boundTo===undefined||E.boundTo==="vertices")){o=0;M=E.value.length;if(E.size===1){for(S=0;S<M;S++){E.array[S]=E.value[S]}}else if(E.size===2){for(S=0;S<M;S++){A=E.value[S];E.array[o]=A.x;E.array[o+1]=A.y;o+=2}}else if(E.size===3){if(E.type==="c"){for(S=0;S<M;S++){A=E.value[S];E.array[o]=A.r;E.array[o+1]=A.g;E.array[o+2]=A.b;o+=3}}else{for(S=0;S<M;S++){A=E.value[S];E.array[o]=A.x;E.array[o+1]=A.y;E.array[o+2]=A.z;o+=3}}}else if(E.size===4){for(S=0;S<M;S++){A=E.value[S];E.array[o]=A.x;E.array[o+1]=A.y;E.array[o+2]=A.z;E.array[o+3]=A.w;o+=4}}rt.bindBuffer(rt.ARRAY_BUFFER,E.buffer);rt.bufferData(rt.ARRAY_BUFFER,E.array,t)}}}}function Xt(e,t,r,n,a){if(!e.__inittedArrays){return}var o=Ht(a);var s,l,h,u,f,c,p,d,v,m,g,y,_,x,b,w,T,S,M,A,E,C,P,R,L,k,F,D,U,O,j,V,N,B,z,I,H,G,W,X,Y,q,K,Z,Q,$,J,et,tt,it,nt,at,ot,st,lt,ht,ut,ft=0,ct=0,pt=0,dt=0,vt=0,mt=0,gt=0,yt=0,_t=0,xt=0,bt=0,wt=0,Tt=0,St,Mt=e.__vertexArray,At=e.__uvArray,Et=e.__uv2Array,Ct=e.__normalArray,Pt=e.__tangentArray,Rt=e.__colorArray,Lt=e.__skinIndexArray,kt=e.__skinWeightArray,Ft=e.__morphTargetsArrays,Dt=e.__morphNormalsArrays,Ut=e.__webglCustomAttributesList,Ot,jt=e.__faceArray,Vt=e.__lineArray,Nt=t.geometry,Bt=Nt.verticesNeedUpdate,zt=Nt.elementsNeedUpdate,It=Nt.uvsNeedUpdate,Gt=Nt.normalsNeedUpdate,Wt=Nt.tangentsNeedUpdate,Xt=Nt.colorsNeedUpdate,Yt=Nt.morphTargetsNeedUpdate,qt=Nt.vertices,Kt=e.faces3,Zt=Nt.faces,Qt=Nt.faceVertexUvs[0],$t=Nt.faceVertexUvs[1],Jt=Nt.colors,er=Nt.skinIndices,tr=Nt.skinWeights,rr=Nt.morphTargets,ir=Nt.morphNormals;if(Bt){for(s=0,l=Kt.length;s<l;s++){u=Zt[Kt[s]];_=qt[u.a];x=qt[u.b];b=qt[u.c];Mt[ct]=_.x;Mt[ct+1]=_.y;Mt[ct+2]=_.z;Mt[ct+3]=x.x;Mt[ct+4]=x.y;Mt[ct+5]=x.z;Mt[ct+6]=b.x;Mt[ct+7]=b.y;Mt[ct+8]=b.z;ct+=9}rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglVertexBuffer);rt.bufferData(rt.ARRAY_BUFFER,Mt,r)}if(Yt){for(nt=0,at=rr.length;nt<at;nt++){bt=0;for(s=0,l=Kt.length;s<l;s++){lt=Kt[s];u=Zt[lt];_=rr[nt].vertices[u.a];x=rr[nt].vertices[u.b];b=rr[nt].vertices[u.c];ot=Ft[nt];ot[bt]=_.x;ot[bt+1]=_.y;ot[bt+2]=_.z;ot[bt+3]=x.x;ot[bt+4]=x.y;ot[bt+5]=x.z;ot[bt+6]=b.x;ot[bt+7]=b.y;ot[bt+8]=b.z;if(a.morphNormals){if(o){ht=ir[nt].vertexNormals[lt];E=ht.a;C=ht.b;P=ht.c}else{E=ir[nt].faceNormals[lt];C=E;P=E}st=Dt[nt];st[bt]=E.x;st[bt+1]=E.y;st[bt+2]=E.z;st[bt+3]=C.x;st[bt+4]=C.y;st[bt+5]=C.z;st[bt+6]=P.x;st[bt+7]=P.y;st[bt+8]=P.z}bt+=9}rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[nt]);rt.bufferData(rt.ARRAY_BUFFER,Ft[nt],r);if(a.morphNormals){rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[nt]);rt.bufferData(rt.ARRAY_BUFFER,Dt[nt],r)}}}if(tr.length){for(s=0,l=Kt.length;s<l;s++){u=Zt[Kt[s]];D=tr[u.a];U=tr[u.b];O=tr[u.c];kt[xt]=D.x;kt[xt+1]=D.y;kt[xt+2]=D.z;kt[xt+3]=D.w;kt[xt+4]=U.x;kt[xt+5]=U.y;kt[xt+6]=U.z;kt[xt+7]=U.w;kt[xt+8]=O.x;kt[xt+9]=O.y;kt[xt+10]=O.z;kt[xt+11]=O.w;V=er[u.a];N=er[u.b];B=er[u.c];Lt[xt]=V.x;Lt[xt+1]=V.y;Lt[xt+2]=V.z;Lt[xt+3]=V.w;Lt[xt+4]=N.x;Lt[xt+5]=N.y;Lt[xt+6]=N.z;Lt[xt+7]=N.w;Lt[xt+8]=B.x;Lt[xt+9]=B.y;Lt[xt+10]=B.z;Lt[xt+11]=B.w;xt+=12}if(xt>0){rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglSkinIndicesBuffer);rt.bufferData(rt.ARRAY_BUFFER,Lt,r);rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglSkinWeightsBuffer);rt.bufferData(rt.ARRAY_BUFFER,kt,r)}}if(Xt){for(s=0,l=Kt.length;s<l;s++){u=Zt[Kt[s]];d=u.vertexColors;v=u.color;if(d.length===3&&a.vertexColors===i.VertexColors){L=d[0];k=d[1];F=d[2]}else{L=v;k=v;F=v}Rt[_t]=L.r;Rt[_t+1]=L.g;Rt[_t+2]=L.b;Rt[_t+3]=k.r;Rt[_t+4]=k.g;Rt[_t+5]=k.b;Rt[_t+6]=F.r;Rt[_t+7]=F.g;Rt[_t+8]=F.b;_t+=9}if(_t>0){rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglColorBuffer);rt.bufferData(rt.ARRAY_BUFFER,Rt,r)}}if(Wt&&Nt.hasTangents){for(s=0,l=Kt.length;s<l;s++){u=Zt[Kt[s]];m=u.vertexTangents;T=m[0];S=m[1];M=m[2];Pt[gt]=T.x;Pt[gt+1]=T.y;Pt[gt+2]=T.z;Pt[gt+3]=T.w;Pt[gt+4]=S.x;Pt[gt+5]=S.y;Pt[gt+6]=S.z;Pt[gt+7]=S.w;Pt[gt+8]=M.x;Pt[gt+9]=M.y;Pt[gt+10]=M.z;Pt[gt+11]=M.w;gt+=12}rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglTangentBuffer);rt.bufferData(rt.ARRAY_BUFFER,Pt,r)}if(Gt){for(s=0,l=Kt.length;s<l;s++){u=Zt[Kt[s]];f=u.vertexNormals;c=u.normal;if(f.length===3&&o){for($=0;$<3;$++){et=f[$];Ct[mt]=et.x;Ct[mt+1]=et.y;Ct[mt+2]=et.z;mt+=3}}else{for($=0;$<3;$++){Ct[mt]=c.x;Ct[mt+1]=c.y;Ct[mt+2]=c.z;mt+=3}}}rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglNormalBuffer);rt.bufferData(rt.ARRAY_BUFFER,Ct,r)}if(It&&Qt){for(s=0,l=Kt.length;s<l;s++){h=Kt[s];g=Qt[h];if(g===undefined)continue;for($=0;$<3;$++){tt=g[$];At[pt]=tt.x;At[pt+1]=tt.y;pt+=2}}if(pt>0){rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglUVBuffer);rt.bufferData(rt.ARRAY_BUFFER,At,r)}}if(It&&$t){for(s=0,l=Kt.length;s<l;s++){h=Kt[s];y=$t[h];if(y===undefined)continue;for($=0;$<3;$++){it=y[$];Et[dt]=it.x;Et[dt+1]=it.y;dt+=2}}if(dt>0){rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglUV2Buffer);rt.bufferData(rt.ARRAY_BUFFER,Et,r)}}if(zt){for(s=0,l=Kt.length;s<l;s++){jt[vt]=ft;jt[vt+1]=ft+1;jt[vt+2]=ft+2;vt+=3;Vt[yt]=ft;Vt[yt+1]=ft+1;Vt[yt+2]=ft;Vt[yt+3]=ft+2;Vt[yt+4]=ft+1;Vt[yt+5]=ft+2;yt+=6;ft+=3}rt.bindBuffer(rt.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer);rt.bufferData(rt.ELEMENT_ARRAY_BUFFER,jt,r);rt.bindBuffer(rt.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer);rt.bufferData(rt.ELEMENT_ARRAY_BUFFER,Vt,r)}if(Ut){for($=0,J=Ut.length;$<J;$++){Ot=Ut[$];if(!Ot.__original.needsUpdate)continue;wt=0;Tt=0;if(Ot.size===1){if(Ot.boundTo===undefined||Ot.boundTo==="vertices"){for(s=0,l=Kt.length;s<l;s++){u=Zt[Kt[s]];Ot.array[wt]=Ot.value[u.a];Ot.array[wt+1]=Ot.value[u.b];Ot.array[wt+2]=Ot.value[u.c];wt+=3}}else if(Ot.boundTo==="faces"){for(s=0,l=Kt.length;s<l;s++){St=Ot.value[Kt[s]];Ot.array[wt]=St;Ot.array[wt+1]=St;Ot.array[wt+2]=St;wt+=3}}}else if(Ot.size===2){if(Ot.boundTo===undefined||Ot.boundTo==="vertices"){for(s=0,l=Kt.length;s<l;s++){u=Zt[Kt[s]];_=Ot.value[u.a];x=Ot.value[u.b];b=Ot.value[u.c];Ot.array[wt]=_.x;Ot.array[wt+1]=_.y;Ot.array[wt+2]=x.x;Ot.array[wt+3]=x.y;Ot.array[wt+4]=b.x;Ot.array[wt+5]=b.y;wt+=6}}else if(Ot.boundTo==="faces"){for(s=0,l=Kt.length;s<l;s++){St=Ot.value[Kt[s]];_=St;x=St;b=St;Ot.array[wt]=_.x;Ot.array[wt+1]=_.y;Ot.array[wt+2]=x.x;Ot.array[wt+3]=x.y;Ot.array[wt+4]=b.x;Ot.array[wt+5]=b.y;wt+=6}}}else if(Ot.size===3){var nr;if(Ot.type==="c"){nr=["r","g","b"]}else{nr=["x","y","z"]}if(Ot.boundTo===undefined||Ot.boundTo==="vertices"){for(s=0,l=Kt.length;s<l;s++){u=Zt[Kt[s]];_=Ot.value[u.a];x=Ot.value[u.b];b=Ot.value[u.c];Ot.array[wt]=_[nr[0]];Ot.array[wt+1]=_[nr[1]];Ot.array[wt+2]=_[nr[2]];Ot.array[wt+3]=x[nr[0]];Ot.array[wt+4]=x[nr[1]];Ot.array[wt+5]=x[nr[2]];Ot.array[wt+6]=b[nr[0]];Ot.array[wt+7]=b[nr[1]];Ot.array[wt+8]=b[nr[2]];wt+=9}}else if(Ot.boundTo==="faces"){for(s=0,l=Kt.length;s<l;s++){St=Ot.value[Kt[s]];_=St;x=St;b=St;Ot.array[wt]=_[nr[0]];Ot.array[wt+1]=_[nr[1]];Ot.array[wt+2]=_[nr[2]];Ot.array[wt+3]=x[nr[0]];Ot.array[wt+4]=x[nr[1]];Ot.array[wt+5]=x[nr[2]];Ot.array[wt+6]=b[nr[0]];Ot.array[wt+7]=b[nr[1]];Ot.array[wt+8]=b[nr[2]];wt+=9}}else if(Ot.boundTo==="faceVertices"){for(s=0,l=Kt.length;s<l;s++){St=Ot.value[Kt[s]];_=St[0];x=St[1];b=St[2];Ot.array[wt]=_[nr[0]];Ot.array[wt+1]=_[nr[1]];Ot.array[wt+2]=_[nr[2]];Ot.array[wt+3]=x[nr[0]];Ot.array[wt+4]=x[nr[1]];Ot.array[wt+5]=x[nr[2]];Ot.array[wt+6]=b[nr[0]];Ot.array[wt+7]=b[nr[1]];Ot.array[wt+8]=b[nr[2]];wt+=9}}}else if(Ot.size===4){if(Ot.boundTo===undefined||Ot.boundTo==="vertices"){for(s=0,l=Kt.length;s<l;s++){u=Zt[Kt[s]];_=Ot.value[u.a];x=Ot.value[u.b];b=Ot.value[u.c];Ot.array[wt]=_.x;Ot.array[wt+1]=_.y;Ot.array[wt+2]=_.z;Ot.array[wt+3]=_.w;Ot.array[wt+4]=x.x;Ot.array[wt+5]=x.y;Ot.array[wt+6]=x.z;Ot.array[wt+7]=x.w;Ot.array[wt+8]=b.x;Ot.array[wt+9]=b.y;Ot.array[wt+10]=b.z;Ot.array[wt+11]=b.w;wt+=12}}else if(Ot.boundTo==="faces"){for(s=0,l=Kt.length;s<l;s++){St=Ot.value[Kt[s]];_=St;x=St;b=St;Ot.array[wt]=_.x;Ot.array[wt+1]=_.y;Ot.array[wt+2]=_.z;Ot.array[wt+3]=_.w;Ot.array[wt+4]=x.x;Ot.array[wt+5]=x.y;Ot.array[wt+6]=x.z;Ot.array[wt+7]=x.w;Ot.array[wt+8]=b.x;Ot.array[wt+9]=b.y;Ot.array[wt+10]=b.z;Ot.array[wt+11]=b.w;wt+=12}}else if(Ot.boundTo==="faceVertices"){for(s=0,l=Kt.length;s<l;s++){St=Ot.value[Kt[s]];_=St[0];x=St[1];b=St[2];Ot.array[wt]=_.x;Ot.array[wt+1]=_.y;Ot.array[wt+2]=_.z;Ot.array[wt+3]=_.w;Ot.array[wt+4]=x.x;Ot.array[wt+5]=x.y;Ot.array[wt+6]=x.z;Ot.array[wt+7]=x.w;Ot.array[wt+8]=b.x;Ot.array[wt+9]=b.y;Ot.array[wt+10]=b.z;Ot.array[wt+11]=b.w;wt+=12}}}rt.bindBuffer(rt.ARRAY_BUFFER,Ot.buffer);rt.bufferData(rt.ARRAY_BUFFER,Ot.array,r)}}if(n){delete e.__inittedArrays;delete e.__colorArray;delete e.__normalArray;delete e.__tangentArray;delete e.__uvArray;delete e.__uv2Array;delete e.__faceArray;delete e.__vertexArray;delete e.__lineArray;delete e.__skinIndexArray;delete e.__skinWeightArray}}function Yt(e){var t=e.attributes;var r=e.attributesKeys;for(var i=0,n=r.length;i<n;i++){var a=r[i];var o=t[a];if(o.buffer===undefined){o.buffer=rt.createBuffer();o.needsUpdate=true}if(o.needsUpdate===true){var s=a==="index"?rt.ELEMENT_ARRAY_BUFFER:rt.ARRAY_BUFFER;rt.bindBuffer(s,o.buffer);rt.bufferData(s,o.array,rt.STATIC_DRAW);o.needsUpdate=false}}}this.renderBufferImmediate=function(e,t,r){Kt();if(e.hasPositions&&!e.__webglVertexBuffer)e.__webglVertexBuffer=rt.createBuffer();if(e.hasNormals&&!e.__webglNormalBuffer)e.__webglNormalBuffer=rt.createBuffer();if(e.hasUvs&&!e.__webglUvBuffer)e.__webglUvBuffer=rt.createBuffer();if(e.hasColors&&!e.__webglColorBuffer)e.__webglColorBuffer=rt.createBuffer();if(e.hasPositions){rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglVertexBuffer);rt.bufferData(rt.ARRAY_BUFFER,e.positionArray,rt.DYNAMIC_DRAW);Zt(t.attributes.position);rt.vertexAttribPointer(t.attributes.position,3,rt.FLOAT,false,0,0)}if(e.hasNormals){rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglNormalBuffer);if(r.shading===i.FlatShading){var n,a,o,s,l,h,u,f,c,p,d,v,m,g,y=e.count*3;for(g=0;g<y;g+=9){m=e.normalArray;s=m[g];u=m[g+1];p=m[g+2];l=m[g+3];f=m[g+4];d=m[g+5];h=m[g+6];c=m[g+7];v=m[g+8];n=(s+l+h)/3;a=(u+f+c)/3;o=(p+d+v)/3;m[g]=n;m[g+1]=a;m[g+2]=o;m[g+3]=n;m[g+4]=a;m[g+5]=o;m[g+6]=n;m[g+7]=a;m[g+8]=o}}rt.bufferData(rt.ARRAY_BUFFER,e.normalArray,rt.DYNAMIC_DRAW);Zt(t.attributes.normal);rt.vertexAttribPointer(t.attributes.normal,3,rt.FLOAT,false,0,0)}if(e.hasUvs&&r.map){rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglUvBuffer);rt.bufferData(rt.ARRAY_BUFFER,e.uvArray,rt.DYNAMIC_DRAW);Zt(t.attributes.uv);rt.vertexAttribPointer(t.attributes.uv,2,rt.FLOAT,false,0,0)}if(e.hasColors&&r.vertexColors!==i.NoColors){rt.bindBuffer(rt.ARRAY_BUFFER,e.__webglColorBuffer);rt.bufferData(rt.ARRAY_BUFFER,e.colorArray,rt.DYNAMIC_DRAW);Zt(t.attributes.color);rt.vertexAttribPointer(t.attributes.color,3,rt.FLOAT,false,0,0)}Qt();rt.drawArrays(rt.TRIANGLES,0,e.count);e.count=0};function qt(e,t,r,i){var n=r.attributes;var a=t.attributes;var o=t.attributesKeys;for(var s=0,l=o.length;s<l;s++){var h=o[s];var u=a[h];if(u>=0){var f=n[h];if(f!==undefined){var c=f.itemSize;rt.bindBuffer(rt.ARRAY_BUFFER,f.buffer);Zt(u);rt.vertexAttribPointer(u,c,rt.FLOAT,false,0,i*c*4)}else if(e.defaultAttributeValues!==undefined){if(e.defaultAttributeValues[h].length===2){rt.vertexAttrib2fv(u,e.defaultAttributeValues[h])}else if(e.defaultAttributeValues[h].length===3){rt.vertexAttrib3fv(u,e.defaultAttributeValues[h])}}}}Qt()}this.renderBufferDirect=function(e,t,r,n,a,o){if(n.visible===false)return;var s=xr(e,t,r,n,o);var l=false,h=n.wireframe?1:0,u=a.id*16777215+s.id*2+h;if(u!==A){A=u;l=true}if(l){Kt()}if(o instanceof i.Mesh){var f=n.wireframe===true?rt.LINES:rt.TRIANGLES;var c=a.attributes.index;if(c){var p,d;if(c.array instanceof Uint32Array&&at.get("OES_element_index_uint")){p=rt.UNSIGNED_INT;d=4}else{p=rt.UNSIGNED_SHORT;d=2}var v=a.offsets;if(v.length===0){if(l){qt(n,s,a,0);rt.bindBuffer(rt.ELEMENT_ARRAY_BUFFER,c.buffer)}rt.drawElements(f,c.array.length,p,0);b.info.render.calls++;b.info.render.vertices+=c.array.length;b.info.render.faces+=c.array.length/3}else{l=true;for(var m=0,g=v.length;m<g;m++){var y=v[m].index;if(l){qt(n,s,a,y);rt.bindBuffer(rt.ELEMENT_ARRAY_BUFFER,c.buffer)}rt.drawElements(f,v[m].count,p,v[m].start*d);b.info.render.calls++;b.info.render.vertices+=v[m].count;b.info.render.faces+=v[m].count/3}}}else{if(l){qt(n,s,a,0)}var _=a.attributes["position"];rt.drawArrays(f,0,_.array.length/3);b.info.render.calls++;b.info.render.vertices+=_.array.length/3;b.info.render.faces+=_.array.length/9}}else if(o instanceof i.PointCloud){if(l){qt(n,s,a,0)}var _=a.attributes.position;rt.drawArrays(rt.POINTS,0,_.array.length/3);b.info.render.calls++;b.info.render.points+=_.array.length/3}else if(o instanceof i.Line){var f=o.mode===i.LineStrip?rt.LINE_STRIP:rt.LINES;Vr(n.linewidth);var c=a.attributes.index;if(c){var p,d;if(c.array instanceof Uint32Array){p=rt.UNSIGNED_INT;d=4}else{p=rt.UNSIGNED_SHORT;d=2}var v=a.offsets;if(v.length===0){if(l){qt(n,s,a,0);rt.bindBuffer(rt.ELEMENT_ARRAY_BUFFER,c.buffer)}rt.drawElements(f,c.array.length,p,0);b.info.render.calls++;b.info.render.vertices+=c.array.length}else{if(v.length>1)l=true;for(var m=0,g=v.length;m<g;m++){var y=v[m].index;if(l){qt(n,s,a,y);rt.bindBuffer(rt.ELEMENT_ARRAY_BUFFER,c.buffer)}rt.drawElements(f,v[m].count,p,v[m].start*d);b.info.render.calls++;b.info.render.vertices+=v[m].count}}}else{if(l){qt(n,s,a,0)}var _=a.attributes.position;rt.drawArrays(f,0,_.array.length/3);b.info.render.calls++;b.info.render.points+=_.array.length/3}}};this.renderBuffer=function(e,t,r,n,a,o){if(n.visible===false)return;var s=xr(e,t,r,n,o);var l=s.attributes;var h=false,u=n.wireframe?1:0,f=a.id*16777215+s.id*2+u;if(f!==A){A=f;h=true}if(h){Kt()}if(!n.morphTargets&&l.position>=0){if(h){rt.bindBuffer(rt.ARRAY_BUFFER,a.__webglVertexBuffer);Zt(l.position);rt.vertexAttribPointer(l.position,3,rt.FLOAT,false,0,0)}}else{if(o.morphTargetBase){$t(n,a,o)}}if(h){if(a.__webglCustomAttributesList){for(var c=0,p=a.__webglCustomAttributesList.length;c<p;c++){var d=a.__webglCustomAttributesList[c];if(l[d.buffer.belongsToAttribute]>=0){rt.bindBuffer(rt.ARRAY_BUFFER,d.buffer);Zt(l[d.buffer.belongsToAttribute]);rt.vertexAttribPointer(l[d.buffer.belongsToAttribute],d.size,rt.FLOAT,false,0,0)}}}if(l.color>=0){if(o.geometry.colors.length>0||o.geometry.faces.length>0){rt.bindBuffer(rt.ARRAY_BUFFER,a.__webglColorBuffer);Zt(l.color);rt.vertexAttribPointer(l.color,3,rt.FLOAT,false,0,0)}else if(n.defaultAttributeValues!==undefined){rt.vertexAttrib3fv(l.color,n.defaultAttributeValues.color)}}if(l.normal>=0){rt.bindBuffer(rt.ARRAY_BUFFER,a.__webglNormalBuffer);Zt(l.normal);rt.vertexAttribPointer(l.normal,3,rt.FLOAT,false,0,0)}if(l.tangent>=0){rt.bindBuffer(rt.ARRAY_BUFFER,a.__webglTangentBuffer);Zt(l.tangent);rt.vertexAttribPointer(l.tangent,4,rt.FLOAT,false,0,0)}if(l.uv>=0){if(o.geometry.faceVertexUvs[0]){rt.bindBuffer(rt.ARRAY_BUFFER,a.__webglUVBuffer);Zt(l.uv);rt.vertexAttribPointer(l.uv,2,rt.FLOAT,false,0,0)}else if(n.defaultAttributeValues!==undefined){rt.vertexAttrib2fv(l.uv,n.defaultAttributeValues.uv)}}if(l.uv2>=0){if(o.geometry.faceVertexUvs[1]){rt.bindBuffer(rt.ARRAY_BUFFER,a.__webglUV2Buffer);Zt(l.uv2);rt.vertexAttribPointer(l.uv2,2,rt.FLOAT,false,0,0)}else if(n.defaultAttributeValues!==undefined){rt.vertexAttrib2fv(l.uv2,n.defaultAttributeValues.uv2)}}if(n.skinning&&l.skinIndex>=0&&l.skinWeight>=0){rt.bindBuffer(rt.ARRAY_BUFFER,a.__webglSkinIndicesBuffer);Zt(l.skinIndex);rt.vertexAttribPointer(l.skinIndex,4,rt.FLOAT,false,0,0);rt.bindBuffer(rt.ARRAY_BUFFER,a.__webglSkinWeightsBuffer);Zt(l.skinWeight);rt.vertexAttribPointer(l.skinWeight,4,rt.FLOAT,false,0,0)}if(l.lineDistance>=0){rt.bindBuffer(rt.ARRAY_BUFFER,a.__webglLineDistanceBuffer);Zt(l.lineDistance);rt.vertexAttribPointer(l.lineDistance,1,rt.FLOAT,false,0,0)}}Qt();if(o instanceof i.Mesh){var v=a.__typeArray===Uint32Array?rt.UNSIGNED_INT:rt.UNSIGNED_SHORT;if(n.wireframe){Vr(n.wireframeLinewidth);if(h)rt.bindBuffer(rt.ELEMENT_ARRAY_BUFFER,a.__webglLineBuffer);rt.drawElements(rt.LINES,a.__webglLineCount,v,0)}else{if(h)rt.bindBuffer(rt.ELEMENT_ARRAY_BUFFER,a.__webglFaceBuffer);rt.drawElements(rt.TRIANGLES,a.__webglFaceCount,v,0)}b.info.render.calls++;b.info.render.vertices+=a.__webglFaceCount;b.info.render.faces+=a.__webglFaceCount/3}else if(o instanceof i.Line){var m=o.mode===i.LineStrip?rt.LINE_STRIP:rt.LINES;
Vr(n.linewidth);rt.drawArrays(m,0,a.__webglLineCount);b.info.render.calls++}else if(o instanceof i.PointCloud){rt.drawArrays(rt.POINTS,0,a.__webglParticleCount);b.info.render.calls++;b.info.render.points+=a.__webglParticleCount}};function Kt(){for(var e=0,t=Y.length;e<t;e++){Y[e]=0}}function Zt(e){Y[e]=1;if(q[e]===0){rt.enableVertexAttribArray(e);q[e]=1}}function Qt(){for(var e=0,t=q.length;e<t;e++){if(q[e]!==Y[e]){rt.disableVertexAttribArray(e);q[e]=0}}}function $t(e,t,r){var i=e.program.attributes;if(r.morphTargetBase!==-1&&i.position>=0){rt.bindBuffer(rt.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[r.morphTargetBase]);Zt(i.position);rt.vertexAttribPointer(i.position,3,rt.FLOAT,false,0,0)}else if(i.position>=0){rt.bindBuffer(rt.ARRAY_BUFFER,t.__webglVertexBuffer);Zt(i.position);rt.vertexAttribPointer(i.position,3,rt.FLOAT,false,0,0)}if(r.morphTargetForcedOrder.length){var n=0;var a=r.morphTargetForcedOrder;var o=r.morphTargetInfluences;while(n<e.numSupportedMorphTargets&&n<a.length){if(i["morphTarget"+n]>=0){rt.bindBuffer(rt.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[a[n]]);Zt(i["morphTarget"+n]);rt.vertexAttribPointer(i["morphTarget"+n],3,rt.FLOAT,false,0,0)}if(i["morphNormal"+n]>=0&&e.morphNormals){rt.bindBuffer(rt.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[a[n]]);Zt(i["morphNormal"+n]);rt.vertexAttribPointer(i["morphNormal"+n],3,rt.FLOAT,false,0,0)}r.__webglMorphTargetInfluences[n]=o[a[n]];n++}}else{var s,l=[];var o=r.morphTargetInfluences;var h,u=o.length;for(h=0;h<u;h++){s=o[h];if(s>0){l.push([s,h])}}if(l.length>e.numSupportedMorphTargets){l.sort(tr);l.length=e.numSupportedMorphTargets}else if(l.length>e.numSupportedMorphNormals){l.sort(tr)}else if(l.length===0){l.push([0,0])}var f,n=0;while(n<e.numSupportedMorphTargets){if(l[n]){f=l[n][1];if(i["morphTarget"+n]>=0){rt.bindBuffer(rt.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[f]);Zt(i["morphTarget"+n]);rt.vertexAttribPointer(i["morphTarget"+n],3,rt.FLOAT,false,0,0)}if(i["morphNormal"+n]>=0&&e.morphNormals){rt.bindBuffer(rt.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[f]);Zt(i["morphNormal"+n]);rt.vertexAttribPointer(i["morphNormal"+n],3,rt.FLOAT,false,0,0)}r.__webglMorphTargetInfluences[n]=o[f]}else{r.__webglMorphTargetInfluences[n]=0}n++}}if(e.program.uniforms.morphTargetInfluences!==null){rt.uniform1fv(e.program.uniforms.morphTargetInfluences,r.__webglMorphTargetInfluences)}}function Jt(e,t){if(e.material.id!==t.material.id){return t.material.id-e.material.id}else if(e.z!==t.z){return t.z-e.z}else{return e.id-t.id}}function er(e,t){if(e.z!==t.z){return e.z-t.z}else{return e.id-t.id}}function tr(e,t){return t[0]-e[0]}this.render=function(e,t,r,n){if(t instanceof i.Camera===false){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}var a=e.fog;A=-1;M=-1;E=null;et=true;if(e.autoUpdate===true)e.updateMatrixWorld();if(t.parent===undefined)t.updateMatrixWorld();e.traverse(function(e){if(e instanceof i.SkinnedMesh){e.skeleton.update()}});t.matrixWorldInverse.getInverse(t.matrixWorld);Z.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse);K.setFromMatrix(Z);d.length=0;g.length=0;y.length=0;_.length=0;x.length=0;rr(e,e);if(b.sortObjects===true){g.sort(Jt);y.sort(er)}wt.render(e,t);b.info.render.calls=0;b.info.render.vertices=0;b.info.render.faces=0;b.info.render.points=0;this.setRenderTarget(r);if(this.autoClear||n){this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil)}for(var o=0,s=m.length;o<s;o++){var l=m[o];var h=l.object;if(h.visible){Dr(h,t);ar(l)}}if(e.overrideMaterial){var u=e.overrideMaterial;this.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst);this.setDepthTest(u.depthTest);this.setDepthWrite(u.depthWrite);Nr(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits);ir(g,t,d,a,true,u);ir(y,t,d,a,true,u);nr(m,"",t,d,a,false,u)}else{var u=null;this.setBlending(i.NoBlending);ir(g,t,d,a,false,u);nr(m,"opaque",t,d,a,false,u);ir(y,t,d,a,true,u);nr(m,"transparent",t,d,a,true,u)}Tt.render(e,t);St.render(e,t,W,X);if(r&&r.generateMipmaps&&r.minFilter!==i.NearestFilter&&r.minFilter!==i.LinearFilter){Xr(r)}this.setDepthTest(true);this.setDepthWrite(true)};function rr(e,t){if(t.visible===false)return;if(t instanceof i.Scene||t instanceof i.Group){}else{sr(t,e);if(t instanceof i.Light){d.push(t)}else if(t instanceof i.Sprite){_.push(t)}else if(t instanceof i.LensFlare){x.push(t)}else{var r=v[t.id];if(r&&(t.frustumCulled===false||K.intersectsObject(t)===true)){dr(t,e);for(var n=0,a=r.length;n<a;n++){var o=r[n];or(o);o.render=true;if(b.sortObjects===true){if(t.renderDepth!==null){o.z=t.renderDepth}else{$.setFromMatrixPosition(t.matrixWorld);$.applyProjection(Z);o.z=$.z}}}}}}for(var n=0,a=t.children.length;n<a;n++){rr(e,t.children[n])}}function ir(e,t,r,n,a,o){var s;for(var l=e.length-1;l!==-1;l--){var h=e[l];var u=h.object;var f=h.buffer;Dr(u,t);if(o){s=o}else{s=h.material;if(!s)continue;if(a)b.setBlending(s.blending,s.blendEquation,s.blendSrc,s.blendDst);b.setDepthTest(s.depthTest);b.setDepthWrite(s.depthWrite);Nr(s.polygonOffset,s.polygonOffsetFactor,s.polygonOffsetUnits)}b.setMaterialFaces(s);if(f instanceof i.BufferGeometry){b.renderBufferDirect(t,r,n,s,f,u)}else{b.renderBuffer(t,r,n,s,f,u)}}}function nr(e,t,r,i,n,a,o){var s;for(var l=0,h=e.length;l<h;l++){var u=e[l];var f=u.object;if(f.visible){if(o){s=o}else{s=u[t];if(!s)continue;if(a)b.setBlending(s.blending,s.blendEquation,s.blendSrc,s.blendDst);b.setDepthTest(s.depthTest);b.setDepthWrite(s.depthWrite);Nr(s.polygonOffset,s.polygonOffsetFactor,s.polygonOffsetUnits)}b.renderImmediateObject(r,i,n,s,f)}}}this.renderImmediateObject=function(e,t,r,i,n){var a=xr(e,t,r,i,n);A=-1;b.setMaterialFaces(i);if(n.immediateRenderCallback){n.immediateRenderCallback(a,rt,K)}else{n.render(function(e){b.renderBufferImmediate(e,a,i)})}};function ar(e){var t=e.object,r=t.material;if(r.transparent){e.transparent=r;e.opaque=null}else{e.opaque=r;e.transparent=null}}function or(e){var t=e.object;var r=e.buffer;var n=t.geometry;var a=t.material;if(a instanceof i.MeshFaceMaterial){var o=n instanceof i.BufferGeometry?0:r.materialIndex;a=a.materials[o];e.material=a;if(a.transparent){y.push(e)}else{g.push(e)}}else if(a){e.material=a;if(a.transparent){y.push(e)}else{g.push(e)}}}function sr(e,t){if(e.__webglInit===undefined){e.__webglInit=true;e._modelViewMatrix=new i.Matrix4;e._normalMatrix=new i.Matrix3;e.addEventListener("removed",Ct)}var r=e.geometry;if(r===undefined){}else if(r.__webglInit===undefined){r.__webglInit=true;r.addEventListener("dispose",Pt);if(r instanceof i.BufferGeometry){}else if(e instanceof i.Mesh){fr(t,e,r)}else if(e instanceof i.Line){if(r.__webglVertexBuffer===undefined){At(r);Bt(r,e);r.verticesNeedUpdate=true;r.colorsNeedUpdate=true;r.lineDistancesNeedUpdate=true}}else if(e instanceof i.PointCloud){if(r.__webglVertexBuffer===undefined){Mt(r);Nt(r,e);r.verticesNeedUpdate=true;r.colorsNeedUpdate=true}}}if(e.__webglActive===undefined){e.__webglActive=true;if(e instanceof i.Mesh){if(r instanceof i.BufferGeometry){cr(v,r,e)}else if(r instanceof i.Geometry){var n=lr[r.id];for(var a=0,o=n.length;a<o;a++){cr(v,n[a],e)}}}else if(e instanceof i.Line||e instanceof i.PointCloud){cr(v,r,e)}else if(e instanceof i.ImmediateRenderObject||e.immediateRenderCallback){pr(m,e)}}}var lr={};var hr=0;function ur(e,t){var r=at.get("OES_element_index_uint")?4294967296:65535;var i,n={};var a=e.morphTargets.length;var o=e.morphNormals.length;var s;var l={};var h=[];for(var u=0,f=e.faces.length;u<f;u++){var c=e.faces[u];var p=t?c.materialIndex:0;if(!(p in n)){n[p]={hash:p,counter:0}}i=n[p].hash+"_"+n[p].counter;if(!(i in l)){s={id:hr++,faces3:[],materialIndex:p,vertices:0,numMorphTargets:a,numMorphNormals:o};l[i]=s;h.push(s)}if(l[i].vertices+3>r){n[p].counter+=1;i=n[p].hash+"_"+n[p].counter;if(!(i in l)){s={id:hr++,faces3:[],materialIndex:p,vertices:0,numMorphTargets:a,numMorphNormals:o};l[i]=s;h.push(s)}}l[i].faces3.push(u);l[i].vertices+=3}return h}function fr(e,t,r){var n=t.material,a=false;if(lr[r.id]===undefined||r.groupsNeedUpdate===true){delete v[t.id];lr[r.id]=ur(r,n instanceof i.MeshFaceMaterial);r.groupsNeedUpdate=false}var o=lr[r.id];for(var s=0,l=o.length;s<l;s++){var h=o[s];if(h.__webglVertexBuffer===undefined){Et(h);zt(h,t);r.verticesNeedUpdate=true;r.morphTargetsNeedUpdate=true;r.elementsNeedUpdate=true;r.uvsNeedUpdate=true;r.normalsNeedUpdate=true;r.tangentsNeedUpdate=true;r.colorsNeedUpdate=true;a=true}else{a=false}if(a||t.__webglActive===undefined){cr(v,h,t)}}t.__webglActive=true}function cr(e,t,r){var i=r.id;e[i]=e[i]||[];e[i].push({id:i,buffer:t,object:r,material:null,z:0})}function pr(e,t){e.push({id:null,object:t,opaque:null,transparent:null,z:0})}function dr(e,t){var r=e.geometry,n,a;if(r instanceof i.BufferGeometry){Yt(r)}else if(e instanceof i.Mesh){if(r.groupsNeedUpdate===true){fr(t,e,r)}var o=lr[r.id];for(var s=0,l=o.length;s<l;s++){var h=o[s];a=It(e,h);if(r.groupsNeedUpdate===true){zt(h,e)}n=a.attributes&&vr(a);if(r.verticesNeedUpdate||r.morphTargetsNeedUpdate||r.elementsNeedUpdate||r.uvsNeedUpdate||r.normalsNeedUpdate||r.colorsNeedUpdate||r.tangentsNeedUpdate||n){Xt(h,e,rt.DYNAMIC_DRAW,!r.dynamic,a)}}r.verticesNeedUpdate=false;r.morphTargetsNeedUpdate=false;r.elementsNeedUpdate=false;r.uvsNeedUpdate=false;r.normalsNeedUpdate=false;r.colorsNeedUpdate=false;r.tangentsNeedUpdate=false;a.attributes&&mr(a)}else if(e instanceof i.Line){a=It(e,r);n=a.attributes&&vr(a);if(r.verticesNeedUpdate||r.colorsNeedUpdate||r.lineDistancesNeedUpdate||n){Wt(r,rt.DYNAMIC_DRAW)}r.verticesNeedUpdate=false;r.colorsNeedUpdate=false;r.lineDistancesNeedUpdate=false;a.attributes&&mr(a)}else if(e instanceof i.PointCloud){a=It(e,r);n=a.attributes&&vr(a);if(r.verticesNeedUpdate||r.colorsNeedUpdate||e.sortParticles||n){Gt(r,rt.DYNAMIC_DRAW,e)}r.verticesNeedUpdate=false;r.colorsNeedUpdate=false;a.attributes&&mr(a)}}function vr(e){for(var t in e.attributes){if(e.attributes[t].needsUpdate)return true}return false}function mr(e){for(var t in e.attributes){e.attributes[t].needsUpdate=false}}function gr(e){if(e instanceof i.Mesh||e instanceof i.PointCloud||e instanceof i.Line){delete v[e.id]}else if(e instanceof i.ImmediateRenderObject||e.immediateRenderCallback){yr(m,e)}delete e.__webglInit;delete e._modelViewMatrix;delete e._normalMatrix;delete e.__webglActive}function yr(e,t){for(var r=e.length-1;r>=0;r--){if(e[r].object===t){e.splice(r,1)}}}function _r(e,t,r,a){e.addEventListener("dispose",kt);var o;if(e instanceof i.MeshDepthMaterial){o="depth"}else if(e instanceof i.MeshNormalMaterial){o="normal"}else if(e instanceof i.MeshBasicMaterial){o="basic"}else if(e instanceof i.MeshLambertMaterial){o="lambert"}else if(e instanceof i.MeshPhongMaterial){o="phong"}else if(e instanceof i.LineBasicMaterial){o="basic"}else if(e instanceof i.LineDashedMaterial){o="dashed"}else if(e instanceof i.PointCloudMaterial){o="particle_basic"}if(o){var s=i.ShaderLib[o];e.__webglShader={uniforms:i.UniformsUtils.clone(s.uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}}else{e.__webglShader={uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}}var l=Zr(t);var h=Qr(t);var u=Kr(a);var c={precision:n,supportsVertexTextures:ft,map:!!e.map,envMap:!!e.envMap,lightMap:!!e.lightMap,bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,vertexColors:e.vertexColors,fog:r,useFog:e.fog,fogExp:r instanceof i.FogExp2,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:f,skinning:e.skinning,maxBones:u,useVertexTexture:ct&&a&&a.skeleton&&a.skeleton.useVertexTexture,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:b.maxMorphTargets,maxMorphNormals:b.maxMorphNormals,maxDirLights:l.directional,maxPointLights:l.point,maxSpotLights:l.spot,maxHemiLights:l.hemi,maxShadows:h,shadowMapEnabled:b.shadowMapEnabled&&a.receiveShadow&&h>0,shadowMapType:b.shadowMapType,shadowMapDebug:b.shadowMapDebug,shadowMapCascade:b.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,wrapAround:e.wrapAround,doubleSided:e.side===i.DoubleSide,flipSided:e.side===i.BackSide};var p=[];if(o){p.push(o)}else{p.push(e.fragmentShader);p.push(e.vertexShader)}if(e.defines!==undefined){for(var d in e.defines){p.push(d);p.push(e.defines[d])}}for(var d in c){p.push(d);p.push(c[d])}var v=p.join();var m;for(var g=0,y=w.length;g<y;g++){var _=w[g];if(_.code===v){m=_;m.usedTimes++;break}}if(m===undefined){m=new i.WebGLProgram(b,v,e,c);w.push(m);b.info.memory.programs=w.length}e.program=m;var x=m.attributes;if(e.morphTargets){e.numSupportedMorphTargets=0;var T,S="morphTarget";for(var M=0;M<b.maxMorphTargets;M++){T=S+M;if(x[T]>=0){e.numSupportedMorphTargets++}}}if(e.morphNormals){e.numSupportedMorphNormals=0;var T,S="morphNormal";for(M=0;M<b.maxMorphNormals;M++){T=S+M;if(x[T]>=0){e.numSupportedMorphNormals++}}}e.uniformsList=[];for(var A in e.__webglShader.uniforms){var E=e.program.uniforms[A];if(E){e.uniformsList.push([e.__webglShader.uniforms[A],E])}}}function xr(e,t,r,n,a){C=0;if(n.needsUpdate){if(n.program)jt(n);_r(n,t,r,a);n.needsUpdate=false}if(n.morphTargets){if(!a.__webglMorphTargetInfluences){a.__webglMorphTargetInfluences=new Float32Array(b.maxMorphTargets)}}var o=false;var s=false;var l=false;var h=n.program,u=h.uniforms,c=n.__webglShader.uniforms;if(h.id!==T){rt.useProgram(h.program);T=h.id;o=true;s=true;l=true}if(n.id!==M){if(M===-1)l=true;M=n.id;s=true}if(o||e!==E){rt.uniformMatrix4fv(u.projectionMatrix,false,e.projectionMatrix.elements);if(f){rt.uniform1f(u.logDepthBufFC,2/(Math.log(e.far+1)/Math.LN2))}if(e!==E)E=e;if(n instanceof i.ShaderMaterial||n instanceof i.MeshPhongMaterial||n.envMap){if(u.cameraPosition!==null){$.setFromMatrixPosition(e.matrixWorld);rt.uniform3f(u.cameraPosition,$.x,$.y,$.z)}}if(n instanceof i.MeshPhongMaterial||n instanceof i.MeshLambertMaterial||n instanceof i.ShaderMaterial||n.skinning){if(u.viewMatrix!==null){rt.uniformMatrix4fv(u.viewMatrix,false,e.matrixWorldInverse.elements)}}}if(n.skinning){if(a.bindMatrix&&u.bindMatrix!==null){rt.uniformMatrix4fv(u.bindMatrix,false,a.bindMatrix.elements)}if(a.bindMatrixInverse&&u.bindMatrixInverse!==null){rt.uniformMatrix4fv(u.bindMatrixInverse,false,a.bindMatrixInverse.elements)}if(ct&&a.skeleton&&a.skeleton.useVertexTexture){if(u.boneTexture!==null){var p=kr();rt.uniform1i(u.boneTexture,p);b.setTexture(a.skeleton.boneTexture,p)}if(u.boneTextureWidth!==null){rt.uniform1i(u.boneTextureWidth,a.skeleton.boneTextureWidth)}if(u.boneTextureHeight!==null){rt.uniform1i(u.boneTextureHeight,a.skeleton.boneTextureHeight)}}else if(a.skeleton&&a.skeleton.boneMatrices){if(u.boneGlobalMatrices!==null){rt.uniformMatrix4fv(u.boneGlobalMatrices,false,a.skeleton.boneMatrices)}}}if(s){if(r&&n.fog){Mr(c,r)}if(n instanceof i.MeshPhongMaterial||n instanceof i.MeshLambertMaterial||n.lights){if(et){l=true;jr(t);et=false}if(l){Cr(c,tt);Pr(c,true)}else{Pr(c,false)}}if(n instanceof i.MeshBasicMaterial||n instanceof i.MeshLambertMaterial||n instanceof i.MeshPhongMaterial){br(c,n)}if(n instanceof i.LineBasicMaterial){wr(c,n)}else if(n instanceof i.LineDashedMaterial){wr(c,n);Tr(c,n)}else if(n instanceof i.PointCloudMaterial){Sr(c,n)}else if(n instanceof i.MeshPhongMaterial){Ar(c,n)}else if(n instanceof i.MeshLambertMaterial){Er(c,n)}else if(n instanceof i.MeshDepthMaterial){c.mNear.value=e.near;c.mFar.value=e.far;c.opacity.value=n.opacity}else if(n instanceof i.MeshNormalMaterial){c.opacity.value=n.opacity}if(a.receiveShadow&&!n._shadowPass){Rr(c,t)}Fr(n.uniformsList)}Lr(u,a);if(u.modelMatrix!==null){rt.uniformMatrix4fv(u.modelMatrix,false,a.matrixWorld.elements)}return h}function br(e,t){e.opacity.value=t.opacity;if(b.gammaInput){e.diffuse.value.copyGammaToLinear(t.color)}else{e.diffuse.value=t.color}e.map.value=t.map;e.lightMap.value=t.lightMap;e.specularMap.value=t.specularMap;e.alphaMap.value=t.alphaMap;if(t.bumpMap){e.bumpMap.value=t.bumpMap;e.bumpScale.value=t.bumpScale}if(t.normalMap){e.normalMap.value=t.normalMap;e.normalScale.value.copy(t.normalScale)}var r;if(t.map){r=t.map}else if(t.specularMap){r=t.specularMap}else if(t.normalMap){r=t.normalMap}else if(t.bumpMap){r=t.bumpMap}else if(t.alphaMap){r=t.alphaMap}if(r!==undefined){var n=r.offset;var a=r.repeat;e.offsetRepeat.value.set(n.x,n.y,a.x,a.y)}e.envMap.value=t.envMap;e.flipEnvMap.value=t.envMap instanceof i.WebGLRenderTargetCube?1:-1;if(b.gammaInput){e.reflectivity.value=t.reflectivity}else{e.reflectivity.value=t.reflectivity}e.refractionRatio.value=t.refractionRatio;e.combine.value=t.combine;e.useRefract.value=t.envMap&&t.envMap.mapping instanceof i.CubeRefractionMapping}function wr(e,t){e.diffuse.value=t.color;e.opacity.value=t.opacity}function Tr(e,t){e.dashSize.value=t.dashSize;e.totalSize.value=t.dashSize+t.gapSize;e.scale.value=t.scale}function Sr(e,r){e.psColor.value=r.color;e.opacity.value=r.opacity;e.size.value=r.size;e.scale.value=t.height/2;e.map.value=r.map}function Mr(e,t){e.fogColor.value=t.color;if(t instanceof i.Fog){e.fogNear.value=t.near;e.fogFar.value=t.far}else if(t instanceof i.FogExp2){e.fogDensity.value=t.density}}function Ar(e,t){e.shininess.value=t.shininess;if(b.gammaInput){e.ambient.value.copyGammaToLinear(t.ambient);e.emissive.value.copyGammaToLinear(t.emissive);e.specular.value.copyGammaToLinear(t.specular)}else{e.ambient.value=t.ambient;e.emissive.value=t.emissive;e.specular.value=t.specular}if(t.wrapAround){e.wrapRGB.value.copy(t.wrapRGB)}}function Er(e,t){if(b.gammaInput){e.ambient.value.copyGammaToLinear(t.ambient);e.emissive.value.copyGammaToLinear(t.emissive)}else{e.ambient.value=t.ambient;e.emissive.value=t.emissive}if(t.wrapAround){e.wrapRGB.value.copy(t.wrapRGB)}}function Cr(e,t){e.ambientLightColor.value=t.ambient;e.directionalLightColor.value=t.directional.colors;e.directionalLightDirection.value=t.directional.positions;e.pointLightColor.value=t.point.colors;e.pointLightPosition.value=t.point.positions;e.pointLightDistance.value=t.point.distances;e.spotLightColor.value=t.spot.colors;e.spotLightPosition.value=t.spot.positions;e.spotLightDistance.value=t.spot.distances;e.spotLightDirection.value=t.spot.directions;e.spotLightAngleCos.value=t.spot.anglesCos;e.spotLightExponent.value=t.spot.exponents;e.hemisphereLightSkyColor.value=t.hemi.skyColors;e.hemisphereLightGroundColor.value=t.hemi.groundColors;e.hemisphereLightDirection.value=t.hemi.positions}function Pr(e,t){e.ambientLightColor.needsUpdate=t;e.directionalLightColor.needsUpdate=t;e.directionalLightDirection.needsUpdate=t;e.pointLightColor.needsUpdate=t;e.pointLightPosition.needsUpdate=t;e.pointLightDistance.needsUpdate=t;e.spotLightColor.needsUpdate=t;e.spotLightPosition.needsUpdate=t;e.spotLightDistance.needsUpdate=t;e.spotLightDirection.needsUpdate=t;e.spotLightAngleCos.needsUpdate=t;e.spotLightExponent.needsUpdate=t;e.hemisphereLightSkyColor.needsUpdate=t;e.hemisphereLightGroundColor.needsUpdate=t;e.hemisphereLightDirection.needsUpdate=t}function Rr(e,t){if(e.shadowMatrix){var r=0;for(var n=0,a=t.length;n<a;n++){var o=t[n];if(!o.castShadow)continue;if(o instanceof i.SpotLight||o instanceof i.DirectionalLight&&!o.shadowCascade){e.shadowMap.value[r]=o.shadowMap;e.shadowMapSize.value[r]=o.shadowMapSize;e.shadowMatrix.value[r]=o.shadowMatrix;e.shadowDarkness.value[r]=o.shadowDarkness;e.shadowBias.value[r]=o.shadowBias;r++}}}}function Lr(e,t){rt.uniformMatrix4fv(e.modelViewMatrix,false,t._modelViewMatrix.elements);if(e.normalMatrix){rt.uniformMatrix3fv(e.normalMatrix,false,t._normalMatrix.elements)}}function kr(){var e=C;if(e>=st){console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+st)}C+=1;return e}function Fr(e){var t,r,n;for(var a=0,o=e.length;a<o;a++){var s=e[a][0];if(s.needsUpdate===false)continue;var l=s.type;var h=s.value;var u=e[a][1];switch(l){case"1i":rt.uniform1i(u,h);break;case"1f":rt.uniform1f(u,h);break;case"2f":rt.uniform2f(u,h[0],h[1]);break;case"3f":rt.uniform3f(u,h[0],h[1],h[2]);break;case"4f":rt.uniform4f(u,h[0],h[1],h[2],h[3]);break;case"1iv":rt.uniform1iv(u,h);break;case"3iv":rt.uniform3iv(u,h);break;case"1fv":rt.uniform1fv(u,h);break;case"2fv":rt.uniform2fv(u,h);break;case"3fv":rt.uniform3fv(u,h);break;case"4fv":rt.uniform4fv(u,h);break;case"Matrix3fv":rt.uniformMatrix3fv(u,false,h);break;case"Matrix4fv":rt.uniformMatrix4fv(u,false,h);break;case"i":rt.uniform1i(u,h);break;case"f":rt.uniform1f(u,h);break;case"v2":rt.uniform2f(u,h.x,h.y);break;case"v3":rt.uniform3f(u,h.x,h.y,h.z);break;case"v4":rt.uniform4f(u,h.x,h.y,h.z,h.w);break;case"c":rt.uniform3f(u,h.r,h.g,h.b);break;case"iv1":rt.uniform1iv(u,h);break;case"iv":rt.uniform3iv(u,h);break;case"fv1":rt.uniform1fv(u,h);break;case"fv":rt.uniform3fv(u,h);break;case"v2v":if(s._array===undefined){s._array=new Float32Array(2*h.length)}for(var f=0,c=h.length;f<c;f++){n=f*2;s._array[n]=h[f].x;s._array[n+1]=h[f].y}rt.uniform2fv(u,s._array);break;case"v3v":if(s._array===undefined){s._array=new Float32Array(3*h.length)}for(var f=0,c=h.length;f<c;f++){n=f*3;s._array[n]=h[f].x;s._array[n+1]=h[f].y;s._array[n+2]=h[f].z}rt.uniform3fv(u,s._array);break;case"v4v":if(s._array===undefined){s._array=new Float32Array(4*h.length)}for(var f=0,c=h.length;f<c;f++){n=f*4;s._array[n]=h[f].x;s._array[n+1]=h[f].y;s._array[n+2]=h[f].z;s._array[n+3]=h[f].w}rt.uniform4fv(u,s._array);break;case"m3":rt.uniformMatrix3fv(u,false,h.elements);break;case"m3v":if(s._array===undefined){s._array=new Float32Array(9*h.length)}for(var f=0,c=h.length;f<c;f++){h[f].flattenToArrayOffset(s._array,f*9)}rt.uniformMatrix3fv(u,false,s._array);break;case"m4":rt.uniformMatrix4fv(u,false,h.elements);break;case"m4v":if(s._array===undefined){s._array=new Float32Array(16*h.length)}for(var f=0,c=h.length;f<c;f++){h[f].flattenToArrayOffset(s._array,f*16)}rt.uniformMatrix4fv(u,false,s._array);break;case"t":t=h;r=kr();rt.uniform1i(u,r);if(!t)continue;if(t instanceof i.CubeTexture||t.image instanceof Array&&t.image.length===6){Ir(t,r)}else if(t instanceof i.WebGLRenderTargetCube){Hr(t,r)}else{b.setTexture(t,r)}break;case"tv":if(s._array===undefined){s._array=[]}for(var f=0,c=s.value.length;f<c;f++){s._array[f]=kr()}rt.uniform1iv(u,s._array);for(var f=0,c=s.value.length;f<c;f++){t=s.value[f];r=s._array[f];if(!t)continue;b.setTexture(t,r)}break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+l)}}}function Dr(e,t){e._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld);e._normalMatrix.getNormalMatrix(e._modelViewMatrix)}function Ur(e,t,r,i){e[t]=r.r*r.r*i;e[t+1]=r.g*r.g*i;e[t+2]=r.b*r.b*i}function Or(e,t,r,i){e[t]=r.r*i;e[t+1]=r.g*i;e[t+2]=r.b*i}function jr(e){var t,r,n,a,o=0,s=0,l=0,h,u,f,c,p,d,v,m=tt,g=m.directional.colors,y=m.directional.positions,_=m.point.colors,x=m.point.positions,w=m.point.distances,T=m.spot.colors,S=m.spot.positions,M=m.spot.distances,A=m.spot.directions,E=m.spot.anglesCos,C=m.spot.exponents,P=m.hemi.skyColors,R=m.hemi.groundColors,L=m.hemi.positions,k=0,F=0,D=0,U=0,O=0,j=0,V=0,N=0,B=0,z=0,I=0,H=0;for(t=0,r=e.length;t<r;t++){n=e[t];if(n.onlyShadow)continue;h=n.color;c=n.intensity;v=n.distance;if(n instanceof i.AmbientLight){if(!n.visible)continue;if(b.gammaInput){o+=h.r*h.r;s+=h.g*h.g;l+=h.b*h.b}else{o+=h.r;s+=h.g;l+=h.b}}else if(n instanceof i.DirectionalLight){O+=1;if(!n.visible)continue;J.setFromMatrixPosition(n.matrixWorld);$.setFromMatrixPosition(n.target.matrixWorld);J.sub($);J.normalize();B=k*3;y[B]=J.x;y[B+1]=J.y;y[B+2]=J.z;if(b.gammaInput){Ur(g,B,h,c*c)}else{Or(g,B,h,c)}k+=1}else if(n instanceof i.PointLight){j+=1;if(!n.visible)continue;z=F*3;if(b.gammaInput){Ur(_,z,h,c*c)}else{Or(_,z,h,c)}$.setFromMatrixPosition(n.matrixWorld);x[z]=$.x;x[z+1]=$.y;x[z+2]=$.z;w[F]=v;F+=1}else if(n instanceof i.SpotLight){V+=1;if(!n.visible)continue;I=D*3;if(b.gammaInput){Ur(T,I,h,c*c)}else{Or(T,I,h,c)}J.setFromMatrixPosition(n.matrixWorld);S[I]=J.x;S[I+1]=J.y;S[I+2]=J.z;M[D]=v;$.setFromMatrixPosition(n.target.matrixWorld);J.sub($);J.normalize();A[I]=J.x;A[I+1]=J.y;A[I+2]=J.z;E[D]=Math.cos(n.angle);C[D]=n.exponent;D+=1}else if(n instanceof i.HemisphereLight){N+=1;if(!n.visible)continue;J.setFromMatrixPosition(n.matrixWorld);J.normalize();H=U*3;L[H]=J.x;L[H+1]=J.y;L[H+2]=J.z;u=n.color;f=n.groundColor;if(b.gammaInput){p=c*c;Ur(P,H,u,p);Ur(R,H,f,p)}else{Or(P,H,u,c);Or(R,H,f,c)}U+=1}}for(t=k*3,r=Math.max(g.length,O*3);t<r;t++)g[t]=0;for(t=F*3,r=Math.max(_.length,j*3);t<r;t++)_[t]=0;for(t=D*3,r=Math.max(T.length,V*3);t<r;t++)T[t]=0;for(t=U*3,r=Math.max(P.length,N*3);t<r;t++)P[t]=0;for(t=U*3,r=Math.max(R.length,N*3);t<r;t++)R[t]=0;m.directional.length=k;m.point.length=F;m.spot.length=D;m.hemi.length=U;m.ambient[0]=o;m.ambient[1]=s;m.ambient[2]=l}this.setFaceCulling=function(e,t){if(e===i.CullFaceNone){rt.disable(rt.CULL_FACE)}else{if(t===i.FrontFaceDirectionCW){rt.frontFace(rt.CW)}else{rt.frontFace(rt.CCW)}if(e===i.CullFaceBack){rt.cullFace(rt.BACK)}else if(e===i.CullFaceFront){rt.cullFace(rt.FRONT)}else{rt.cullFace(rt.FRONT_AND_BACK)}rt.enable(rt.CULL_FACE)}};this.setMaterialFaces=function(e){var t=e.side===i.DoubleSide;var r=e.side===i.BackSide;if(P!==t){if(t){rt.disable(rt.CULL_FACE)}else{rt.enable(rt.CULL_FACE)}P=t}if(R!==r){if(r){rt.frontFace(rt.CW)}else{rt.frontFace(rt.CCW)}R=r}};this.setDepthTest=function(e){if(U!==e){if(e){rt.enable(rt.DEPTH_TEST)}else{rt.disable(rt.DEPTH_TEST)}U=e}};this.setDepthWrite=function(e){if(O!==e){rt.depthMask(e);O=e}};function Vr(e){if(e!==B){rt.lineWidth(e);B=e}}function Nr(e,t,r){if(j!==e){if(e){rt.enable(rt.POLYGON_OFFSET_FILL)}else{rt.disable(rt.POLYGON_OFFSET_FILL)}j=e}if(e&&(V!==t||N!==r)){rt.polygonOffset(t,r);V=t;N=r}}this.setBlending=function(e,t,r,n){if(e!==L){if(e===i.NoBlending){rt.disable(rt.BLEND)}else if(e===i.AdditiveBlending){rt.enable(rt.BLEND);rt.blendEquation(rt.FUNC_ADD);rt.blendFunc(rt.SRC_ALPHA,rt.ONE)}else if(e===i.SubtractiveBlending){rt.enable(rt.BLEND);rt.blendEquation(rt.FUNC_ADD);rt.blendFunc(rt.ZERO,rt.ONE_MINUS_SRC_COLOR)}else if(e===i.MultiplyBlending){rt.enable(rt.BLEND);rt.blendEquation(rt.FUNC_ADD);rt.blendFunc(rt.ZERO,rt.SRC_COLOR)}else if(e===i.CustomBlending){rt.enable(rt.BLEND)}else{rt.enable(rt.BLEND);rt.blendEquationSeparate(rt.FUNC_ADD,rt.FUNC_ADD);rt.blendFuncSeparate(rt.SRC_ALPHA,rt.ONE_MINUS_SRC_ALPHA,rt.ONE,rt.ONE_MINUS_SRC_ALPHA)}L=e}if(e===i.CustomBlending){if(t!==k){rt.blendEquation(qr(t));k=t}if(r!==F||n!==D){rt.blendFunc(qr(r),qr(n));F=r;D=n}}else{k=null;F=null;D=null}};function Br(e,t,r){var n;if(r){rt.texParameteri(e,rt.TEXTURE_WRAP_S,qr(t.wrapS));rt.texParameteri(e,rt.TEXTURE_WRAP_T,qr(t.wrapT));rt.texParameteri(e,rt.TEXTURE_MAG_FILTER,qr(t.magFilter));rt.texParameteri(e,rt.TEXTURE_MIN_FILTER,qr(t.minFilter))}else{rt.texParameteri(e,rt.TEXTURE_WRAP_S,rt.CLAMP_TO_EDGE);rt.texParameteri(e,rt.TEXTURE_WRAP_T,rt.CLAMP_TO_EDGE);rt.texParameteri(e,rt.TEXTURE_MAG_FILTER,Yr(t.magFilter));rt.texParameteri(e,rt.TEXTURE_MIN_FILTER,Yr(t.minFilter))}n=at.get("EXT_texture_filter_anisotropic");if(n&&t.type!==i.FloatType){if(t.anisotropy>1||t.__oldAnisotropy){rt.texParameterf(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,b.getMaxAnisotropy()));t.__oldAnisotropy=t.anisotropy}}}this.uploadTexture=function(e){if(e.__webglInit===undefined){e.__webglInit=true;e.addEventListener("dispose",Rt);e.__webglTexture=rt.createTexture();b.info.memory.textures++}rt.bindTexture(rt.TEXTURE_2D,e.__webglTexture);rt.pixelStorei(rt.UNPACK_FLIP_Y_WEBGL,e.flipY);rt.pixelStorei(rt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha);rt.pixelStorei(rt.UNPACK_ALIGNMENT,e.unpackAlignment);e.image=zr(e.image,ht);var t=e.image,r=i.Math.isPowerOfTwo(t.width)&&i.Math.isPowerOfTwo(t.height),n=qr(e.format),a=qr(e.type);Br(rt.TEXTURE_2D,e,r);var o,s=e.mipmaps;if(e instanceof i.DataTexture){if(s.length>0&&r){for(var l=0,h=s.length;l<h;l++){o=s[l];rt.texImage2D(rt.TEXTURE_2D,l,n,o.width,o.height,0,n,a,o.data)}e.generateMipmaps=false}else{rt.texImage2D(rt.TEXTURE_2D,0,n,t.width,t.height,0,n,a,t.data)}}else if(e instanceof i.CompressedTexture){for(var l=0,h=s.length;l<h;l++){o=s[l];if(e.format!==i.RGBAFormat&&e.format!==i.RGBFormat){if(_t().indexOf(n)>-1){rt.compressedTexImage2D(rt.TEXTURE_2D,l,n,o.width,o.height,0,o.data)}else{console.warn("Attempt to load unsupported compressed texture format")}}else{rt.texImage2D(rt.TEXTURE_2D,l,n,o.width,o.height,0,n,a,o.data)}}}else{if(s.length>0&&r){for(var l=0,h=s.length;l<h;l++){o=s[l];rt.texImage2D(rt.TEXTURE_2D,l,n,n,a,o)}e.generateMipmaps=false}else{rt.texImage2D(rt.TEXTURE_2D,0,n,n,a,e.image)}}if(e.generateMipmaps&&r)rt.generateMipmap(rt.TEXTURE_2D);e.needsUpdate=false;if(e.onUpdate)e.onUpdate()};this.setTexture=function(e,t){rt.activeTexture(rt.TEXTURE0+t);if(e.needsUpdate){b.uploadTexture(e)}else{rt.bindTexture(rt.TEXTURE_2D,e.__webglTexture)}};function zr(e,t){if(e.width>t||e.height>t){var r=t/Math.max(e.width,e.height);var i=document.createElement("canvas");i.width=Math.floor(e.width*r);i.height=Math.floor(e.height*r);var n=i.getContext("2d");n.drawImage(e,0,0,e.width,e.height,0,0,i.width,i.height);console.log("THREE.WebGLRenderer:",e,"is too big ("+e.width+"x"+e.height+"). Resized to "+i.width+"x"+i.height+".");return i}return e}function Ir(e,t){if(e.image.length===6){if(e.needsUpdate){if(!e.image.__webglTextureCube){e.addEventListener("dispose",Rt);e.image.__webglTextureCube=rt.createTexture();b.info.memory.textures++}rt.activeTexture(rt.TEXTURE0+t);rt.bindTexture(rt.TEXTURE_CUBE_MAP,e.image.__webglTextureCube);rt.pixelStorei(rt.UNPACK_FLIP_Y_WEBGL,e.flipY);var r=e instanceof i.CompressedTexture;var n=e.image[0]instanceof i.DataTexture;var a=[];for(var o=0;o<6;o++){if(b.autoScaleCubemaps&&!r&&!n){a[o]=zr(e.image[o],ut)}else{a[o]=n?e.image[o].image:e.image[o]}}var s=a[0],l=i.Math.isPowerOfTwo(s.width)&&i.Math.isPowerOfTwo(s.height),h=qr(e.format),u=qr(e.type);Br(rt.TEXTURE_CUBE_MAP,e,l);for(var o=0;o<6;o++){if(!r){if(n){rt.texImage2D(rt.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,h,a[o].width,a[o].height,0,h,u,a[o].data)}else{rt.texImage2D(rt.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,h,h,u,a[o])}}else{var f,c=a[o].mipmaps;for(var p=0,d=c.length;p<d;p++){f=c[p];if(e.format!==i.RGBAFormat&&e.format!==i.RGBFormat){if(_t().indexOf(h)>-1){rt.compressedTexImage2D(rt.TEXTURE_CUBE_MAP_POSITIVE_X+o,p,h,f.width,f.height,0,f.data)}else{console.warn("Attempt to load unsupported compressed texture format")}}else{rt.texImage2D(rt.TEXTURE_CUBE_MAP_POSITIVE_X+o,p,h,f.width,f.height,0,h,u,f.data)}}}}if(e.generateMipmaps&&l){rt.generateMipmap(rt.TEXTURE_CUBE_MAP)}e.needsUpdate=false;if(e.onUpdate)e.onUpdate()}else{rt.activeTexture(rt.TEXTURE0+t);rt.bindTexture(rt.TEXTURE_CUBE_MAP,e.image.__webglTextureCube)}}}function Hr(e,t){rt.activeTexture(rt.TEXTURE0+t);rt.bindTexture(rt.TEXTURE_CUBE_MAP,e.__webglTexture)}function Gr(e,t,r){rt.bindFramebuffer(rt.FRAMEBUFFER,e);rt.framebufferTexture2D(rt.FRAMEBUFFER,rt.COLOR_ATTACHMENT0,r,t.__webglTexture,0)}function Wr(e,t){rt.bindRenderbuffer(rt.RENDERBUFFER,e);if(t.depthBuffer&&!t.stencilBuffer){rt.renderbufferStorage(rt.RENDERBUFFER,rt.DEPTH_COMPONENT16,t.width,t.height);rt.framebufferRenderbuffer(rt.FRAMEBUFFER,rt.DEPTH_ATTACHMENT,rt.RENDERBUFFER,e)}else if(t.depthBuffer&&t.stencilBuffer){rt.renderbufferStorage(rt.RENDERBUFFER,rt.DEPTH_STENCIL,t.width,t.height);rt.framebufferRenderbuffer(rt.FRAMEBUFFER,rt.DEPTH_STENCIL_ATTACHMENT,rt.RENDERBUFFER,e)}else{rt.renderbufferStorage(rt.RENDERBUFFER,rt.RGBA4,t.width,t.height)}}this.setRenderTarget=function(e){var t=e instanceof i.WebGLRenderTargetCube;if(e&&e.__webglFramebuffer===undefined){if(e.depthBuffer===undefined)e.depthBuffer=true;if(e.stencilBuffer===undefined)e.stencilBuffer=true;e.addEventListener("dispose",Lt);e.__webglTexture=rt.createTexture();b.info.memory.textures++;var r=i.Math.isPowerOfTwo(e.width)&&i.Math.isPowerOfTwo(e.height),n=qr(e.format),a=qr(e.type);if(t){e.__webglFramebuffer=[];e.__webglRenderbuffer=[];rt.bindTexture(rt.TEXTURE_CUBE_MAP,e.__webglTexture);Br(rt.TEXTURE_CUBE_MAP,e,r);for(var o=0;o<6;o++){e.__webglFramebuffer[o]=rt.createFramebuffer();e.__webglRenderbuffer[o]=rt.createRenderbuffer();rt.texImage2D(rt.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,n,e.width,e.height,0,n,a,null);
Gr(e.__webglFramebuffer[o],e,rt.TEXTURE_CUBE_MAP_POSITIVE_X+o);Wr(e.__webglRenderbuffer[o],e)}if(r)rt.generateMipmap(rt.TEXTURE_CUBE_MAP)}else{e.__webglFramebuffer=rt.createFramebuffer();if(e.shareDepthFrom){e.__webglRenderbuffer=e.shareDepthFrom.__webglRenderbuffer}else{e.__webglRenderbuffer=rt.createRenderbuffer()}rt.bindTexture(rt.TEXTURE_2D,e.__webglTexture);Br(rt.TEXTURE_2D,e,r);rt.texImage2D(rt.TEXTURE_2D,0,n,e.width,e.height,0,n,a,null);Gr(e.__webglFramebuffer,e,rt.TEXTURE_2D);if(e.shareDepthFrom){if(e.depthBuffer&&!e.stencilBuffer){rt.framebufferRenderbuffer(rt.FRAMEBUFFER,rt.DEPTH_ATTACHMENT,rt.RENDERBUFFER,e.__webglRenderbuffer)}else if(e.depthBuffer&&e.stencilBuffer){rt.framebufferRenderbuffer(rt.FRAMEBUFFER,rt.DEPTH_STENCIL_ATTACHMENT,rt.RENDERBUFFER,e.__webglRenderbuffer)}}else{Wr(e.__webglRenderbuffer,e)}if(r)rt.generateMipmap(rt.TEXTURE_2D)}if(t){rt.bindTexture(rt.TEXTURE_CUBE_MAP,null)}else{rt.bindTexture(rt.TEXTURE_2D,null)}rt.bindRenderbuffer(rt.RENDERBUFFER,null);rt.bindFramebuffer(rt.FRAMEBUFFER,null)}var s,l,h,u,f;if(e){if(t){s=e.__webglFramebuffer[e.activeCubeFace]}else{s=e.__webglFramebuffer}l=e.width;h=e.height;u=0;f=0}else{s=null;l=H;h=G;u=z;f=I}if(s!==S){rt.bindFramebuffer(rt.FRAMEBUFFER,s);rt.viewport(u,f,l,h);S=s}W=l;X=h};function Xr(e){if(e instanceof i.WebGLRenderTargetCube){rt.bindTexture(rt.TEXTURE_CUBE_MAP,e.__webglTexture);rt.generateMipmap(rt.TEXTURE_CUBE_MAP);rt.bindTexture(rt.TEXTURE_CUBE_MAP,null)}else{rt.bindTexture(rt.TEXTURE_2D,e.__webglTexture);rt.generateMipmap(rt.TEXTURE_2D);rt.bindTexture(rt.TEXTURE_2D,null)}}function Yr(e){if(e===i.NearestFilter||e===i.NearestMipMapNearestFilter||e===i.NearestMipMapLinearFilter){return rt.NEAREST}return rt.LINEAR}function qr(e){var t;if(e===i.RepeatWrapping)return rt.REPEAT;if(e===i.ClampToEdgeWrapping)return rt.CLAMP_TO_EDGE;if(e===i.MirroredRepeatWrapping)return rt.MIRRORED_REPEAT;if(e===i.NearestFilter)return rt.NEAREST;if(e===i.NearestMipMapNearestFilter)return rt.NEAREST_MIPMAP_NEAREST;if(e===i.NearestMipMapLinearFilter)return rt.NEAREST_MIPMAP_LINEAR;if(e===i.LinearFilter)return rt.LINEAR;if(e===i.LinearMipMapNearestFilter)return rt.LINEAR_MIPMAP_NEAREST;if(e===i.LinearMipMapLinearFilter)return rt.LINEAR_MIPMAP_LINEAR;if(e===i.UnsignedByteType)return rt.UNSIGNED_BYTE;if(e===i.UnsignedShort4444Type)return rt.UNSIGNED_SHORT_4_4_4_4;if(e===i.UnsignedShort5551Type)return rt.UNSIGNED_SHORT_5_5_5_1;if(e===i.UnsignedShort565Type)return rt.UNSIGNED_SHORT_5_6_5;if(e===i.ByteType)return rt.BYTE;if(e===i.ShortType)return rt.SHORT;if(e===i.UnsignedShortType)return rt.UNSIGNED_SHORT;if(e===i.IntType)return rt.INT;if(e===i.UnsignedIntType)return rt.UNSIGNED_INT;if(e===i.FloatType)return rt.FLOAT;if(e===i.AlphaFormat)return rt.ALPHA;if(e===i.RGBFormat)return rt.RGB;if(e===i.RGBAFormat)return rt.RGBA;if(e===i.LuminanceFormat)return rt.LUMINANCE;if(e===i.LuminanceAlphaFormat)return rt.LUMINANCE_ALPHA;if(e===i.AddEquation)return rt.FUNC_ADD;if(e===i.SubtractEquation)return rt.FUNC_SUBTRACT;if(e===i.ReverseSubtractEquation)return rt.FUNC_REVERSE_SUBTRACT;if(e===i.ZeroFactor)return rt.ZERO;if(e===i.OneFactor)return rt.ONE;if(e===i.SrcColorFactor)return rt.SRC_COLOR;if(e===i.OneMinusSrcColorFactor)return rt.ONE_MINUS_SRC_COLOR;if(e===i.SrcAlphaFactor)return rt.SRC_ALPHA;if(e===i.OneMinusSrcAlphaFactor)return rt.ONE_MINUS_SRC_ALPHA;if(e===i.DstAlphaFactor)return rt.DST_ALPHA;if(e===i.OneMinusDstAlphaFactor)return rt.ONE_MINUS_DST_ALPHA;if(e===i.DstColorFactor)return rt.DST_COLOR;if(e===i.OneMinusDstColorFactor)return rt.ONE_MINUS_DST_COLOR;if(e===i.SrcAlphaSaturateFactor)return rt.SRC_ALPHA_SATURATE;t=at.get("WEBGL_compressed_texture_s3tc");if(t!==null){if(e===i.RGB_S3TC_DXT1_Format)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===i.RGBA_S3TC_DXT1_Format)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===i.RGBA_S3TC_DXT3_Format)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===i.RGBA_S3TC_DXT5_Format)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}t=at.get("WEBGL_compressed_texture_pvrtc");if(t!==null){if(e===i.RGB_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===i.RGB_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===i.RGBA_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===i.RGBA_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}t=at.get("EXT_blend_minmax");if(t!==null){if(e===i.MinEquation)return t.MIN_EXT;if(e===i.MaxEquation)return t.MAX_EXT}return 0}function Kr(e){if(ct&&e&&e.skeleton&&e.skeleton.useVertexTexture){return 1024}else{var t=rt.getParameter(rt.MAX_VERTEX_UNIFORM_VECTORS);var r=Math.floor((t-20)/4);var n=r;if(e!==undefined&&e instanceof i.SkinnedMesh){n=Math.min(e.skeleton.bones.length,n);if(n<e.skeleton.bones.length){console.warn("WebGLRenderer: too many bones - "+e.skeleton.bones.length+", this GPU supports just "+n+" (try OpenGL instead of ANGLE)")}}return n}}function Zr(e){var t=0;var r=0;var n=0;var a=0;for(var o=0,s=e.length;o<s;o++){var l=e[o];if(l.onlyShadow||l.visible===false)continue;if(l instanceof i.DirectionalLight)t++;if(l instanceof i.PointLight)r++;if(l instanceof i.SpotLight)n++;if(l instanceof i.HemisphereLight)a++}return{directional:t,point:r,spot:n,hemi:a}}function Qr(e){var t=0;for(var r=0,n=e.length;r<n;r++){var a=e[r];if(!a.castShadow)continue;if(a instanceof i.SpotLight)t++;if(a instanceof i.DirectionalLight&&!a.shadowCascade)t++}return t}this.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")};this.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")};this.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")};this.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}};i.WebGLRenderTarget=function(e,t,r){this.width=e;this.height=t;r=r||{};this.wrapS=r.wrapS!==undefined?r.wrapS:i.ClampToEdgeWrapping;this.wrapT=r.wrapT!==undefined?r.wrapT:i.ClampToEdgeWrapping;this.magFilter=r.magFilter!==undefined?r.magFilter:i.LinearFilter;this.minFilter=r.minFilter!==undefined?r.minFilter:i.LinearMipMapLinearFilter;this.anisotropy=r.anisotropy!==undefined?r.anisotropy:1;this.offset=new i.Vector2(0,0);this.repeat=new i.Vector2(1,1);this.format=r.format!==undefined?r.format:i.RGBAFormat;this.type=r.type!==undefined?r.type:i.UnsignedByteType;this.depthBuffer=r.depthBuffer!==undefined?r.depthBuffer:true;this.stencilBuffer=r.stencilBuffer!==undefined?r.stencilBuffer:true;this.generateMipmaps=true;this.shareDepthFrom=null};i.WebGLRenderTarget.prototype={constructor:i.WebGLRenderTarget,setSize:function(e,t){this.width=e;this.height=t},clone:function(){var e=new i.WebGLRenderTarget(this.width,this.height);e.wrapS=this.wrapS;e.wrapT=this.wrapT;e.magFilter=this.magFilter;e.minFilter=this.minFilter;e.anisotropy=this.anisotropy;e.offset.copy(this.offset);e.repeat.copy(this.repeat);e.format=this.format;e.type=this.type;e.depthBuffer=this.depthBuffer;e.stencilBuffer=this.stencilBuffer;e.generateMipmaps=this.generateMipmaps;e.shareDepthFrom=this.shareDepthFrom;return e},dispose:function(){this.dispatchEvent({type:"dispose"})}};i.EventDispatcher.prototype.apply(i.WebGLRenderTarget.prototype);i.WebGLRenderTargetCube=function(e,t,r){i.WebGLRenderTarget.call(this,e,t,r);this.activeCubeFace=0};i.WebGLRenderTargetCube.prototype=Object.create(i.WebGLRenderTarget.prototype);i.WebGLExtensions=function(e){var t={};this.get=function(r){if(t[r]!==undefined){return t[r]}var i;switch(r){case"OES_texture_float":i=e.getExtension("OES_texture_float");break;case"OES_texture_float_linear":i=e.getExtension("OES_texture_float_linear");break;case"OES_standard_derivatives":i=e.getExtension("OES_standard_derivatives");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"OES_element_index_uint":i=e.getExtension("OES_element_index_uint");break;case"EXT_blend_minmax":i=e.getExtension("EXT_blend_minmax");break;case"EXT_frag_depth":i=e.getExtension("EXT_frag_depth");break}if(i===null){console.log("THREE.WebGLRenderer: "+r+" extension not supported.")}t[r]=i;return i}};i.WebGLProgram=function(){var e=0;var t=function(e){var t,r,i=[];for(var n in e){t=e[n];if(t===false)continue;r="#define "+n+" "+t;i.push(r)}return i.join("\n")};var r=function(e,t,r){var i={};for(var n=0,a=r.length;n<a;n++){var o=r[n];i[o]=e.getUniformLocation(t,o)}return i};var n=function(e,t,r){var i={};for(var n=0,a=r.length;n<a;n++){var o=r[n];i[o]=e.getAttribLocation(t,o)}return i};return function(a,o,s,l){var h=a;var u=h.context;var f=s.defines;var c=s.__webglShader.uniforms;var p=s.attributes;var d=s.__webglShader.vertexShader;var v=s.__webglShader.fragmentShader;var m=s.index0AttributeName;if(m===undefined&&l.morphTargets===true){m="position"}var g="SHADOWMAP_TYPE_BASIC";if(l.shadowMapType===i.PCFShadowMap){g="SHADOWMAP_TYPE_PCF"}else if(l.shadowMapType===i.PCFSoftShadowMap){g="SHADOWMAP_TYPE_PCF_SOFT"}var y=t(f);var _=u.createProgram();var x,b;if(s instanceof i.RawShaderMaterial){x="";b=""}else{x=["precision "+l.precision+" float;","precision "+l.precision+" int;",y,l.supportsVertexTextures?"#define VERTEX_TEXTURES":"",h.gammaInput?"#define GAMMA_INPUT":"",h.gammaOutput?"#define GAMMA_OUTPUT":"","#define MAX_DIR_LIGHTS "+l.maxDirLights,"#define MAX_POINT_LIGHTS "+l.maxPointLights,"#define MAX_SPOT_LIGHTS "+l.maxSpotLights,"#define MAX_HEMI_LIGHTS "+l.maxHemiLights,"#define MAX_SHADOWS "+l.maxShadows,"#define MAX_BONES "+l.maxBones,l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.lightMap?"#define USE_LIGHTMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.vertexColors?"#define USE_COLOR":"",l.skinning?"#define USE_SKINNING":"",l.useVertexTexture?"#define BONE_TEXTURE":"",l.morphTargets?"#define USE_MORPHTARGETS":"",l.morphNormals?"#define USE_MORPHNORMALS":"",l.wrapAround?"#define WRAP_AROUND":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+g:"",l.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",l.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",l.sizeAttenuation?"#define USE_SIZEATTENUATION":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",""].join("\n");b=["precision "+l.precision+" float;","precision "+l.precision+" int;",l.bumpMap||l.normalMap?"#extension GL_OES_standard_derivatives : enable":"",y,"#define MAX_DIR_LIGHTS "+l.maxDirLights,"#define MAX_POINT_LIGHTS "+l.maxPointLights,"#define MAX_SPOT_LIGHTS "+l.maxSpotLights,"#define MAX_HEMI_LIGHTS "+l.maxHemiLights,"#define MAX_SHADOWS "+l.maxShadows,l.alphaTest?"#define ALPHATEST "+l.alphaTest:"",h.gammaInput?"#define GAMMA_INPUT":"",h.gammaOutput?"#define GAMMA_OUTPUT":"",l.useFog&&l.fog?"#define USE_FOG":"",l.useFog&&l.fogExp?"#define FOG_EXP2":"",l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.lightMap?"#define USE_LIGHTMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.vertexColors?"#define USE_COLOR":"",l.metal?"#define METAL":"",l.wrapAround?"#define WRAP_AROUND":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+g:"",l.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",l.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n")}var w=new i.WebGLShader(u,u.VERTEX_SHADER,x+d);var T=new i.WebGLShader(u,u.FRAGMENT_SHADER,b+v);u.attachShader(_,w);u.attachShader(_,T);if(m!==undefined){u.bindAttribLocation(_,0,m)}u.linkProgram(_);if(u.getProgramParameter(_,u.LINK_STATUS)===false){console.error("THREE.WebGLProgram: Could not initialise shader.");console.error("gl.VALIDATE_STATUS",u.getProgramParameter(_,u.VALIDATE_STATUS));console.error("gl.getError()",u.getError())}if(u.getProgramInfoLog(_)!==""){console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",u.getProgramInfoLog(_))}u.deleteShader(w);u.deleteShader(T);var S=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences","bindMatrix","bindMatrixInverse"];if(l.useVertexTexture){S.push("boneTexture");S.push("boneTextureWidth");S.push("boneTextureHeight")}else{S.push("boneGlobalMatrices")}if(l.logarithmicDepthBuffer){S.push("logDepthBufFC")}for(var M in c){S.push(M)}this.uniforms=r(u,_,S);S=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"];for(var A=0;A<l.maxMorphTargets;A++){S.push("morphTarget"+A)}for(var A=0;A<l.maxMorphNormals;A++){S.push("morphNormal"+A)}for(var E in p){S.push(E)}this.attributes=n(u,_,S);this.attributesKeys=Object.keys(this.attributes);this.id=e++;this.code=o;this.usedTimes=1;this.program=_;this.vertexShader=w;this.fragmentShader=T;return this}}();i.WebGLShader=function(){var e=function(e){var t=e.split("\n");for(var r=0;r<t.length;r++){t[r]=r+1+": "+t[r]}return t.join("\n")};return function(t,r,i){var n=t.createShader(r);t.shaderSource(n,i);t.compileShader(n);if(t.getShaderParameter(n,t.COMPILE_STATUS)===false){console.error("THREE.WebGLShader: Shader couldn't compile.")}if(t.getShaderInfoLog(n)!==""){console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t.getShaderInfoLog(n));console.warn(e(i))}return n}}();i.LensFlarePlugin=function(e,t){var r=e.context;var n,a;var o,s,l;var h;var u,f;var c=function(){var e=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]);var t=new Uint16Array([0,1,2,0,2,3]);n=r.createBuffer();a=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,n);r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,a);r.bufferData(r.ELEMENT_ARRAY_BUFFER,t,r.STATIC_DRAW);u=r.createTexture();f=r.createTexture();r.bindTexture(r.TEXTURE_2D,u);r.texImage2D(r.TEXTURE_2D,0,r.RGB,16,16,0,r.RGB,r.UNSIGNED_BYTE,null);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST);r.bindTexture(r.TEXTURE_2D,f);r.texImage2D(r.TEXTURE_2D,0,r.RGBA,16,16,0,r.RGBA,r.UNSIGNED_BYTE,null);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST);h=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;var i;if(h){i={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}}else{i={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}}o=p(i);s={vertex:r.getAttribLocation(o,"position"),uv:r.getAttribLocation(o,"uv")};l={renderType:r.getUniformLocation(o,"renderType"),map:r.getUniformLocation(o,"map"),occlusionMap:r.getUniformLocation(o,"occlusionMap"),opacity:r.getUniformLocation(o,"opacity"),color:r.getUniformLocation(o,"color"),scale:r.getUniformLocation(o,"scale"),rotation:r.getUniformLocation(o,"rotation"),screenPosition:r.getUniformLocation(o,"screenPosition")}};this.render=function(p,d,v,m){if(t.length===0)return;var g=new i.Vector3;var y=m/v,_=v*.5,x=m*.5;var b=16/m,w=new i.Vector2(b*y,b);var T=new i.Vector3(1,1,0),S=new i.Vector2(1,1);if(o===undefined){c()}r.useProgram(o);r.enableVertexAttribArray(s.vertex);r.enableVertexAttribArray(s.uv);r.uniform1i(l.occlusionMap,0);r.uniform1i(l.map,1);r.bindBuffer(r.ARRAY_BUFFER,n);r.vertexAttribPointer(s.vertex,2,r.FLOAT,false,2*8,0);r.vertexAttribPointer(s.uv,2,r.FLOAT,false,2*8,8);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,a);r.disable(r.CULL_FACE);r.depthMask(false);for(var M=0,A=t.length;M<A;M++){b=16/m;w.set(b*y,b);var E=t[M];g.set(E.matrixWorld.elements[12],E.matrixWorld.elements[13],E.matrixWorld.elements[14]);g.applyMatrix4(d.matrixWorldInverse);g.applyProjection(d.projectionMatrix);T.copy(g);S.x=T.x*_+_;S.y=T.y*x+x;if(h||S.x>0&&S.x<v&&S.y>0&&S.y<m){r.activeTexture(r.TEXTURE1);r.bindTexture(r.TEXTURE_2D,u);r.copyTexImage2D(r.TEXTURE_2D,0,r.RGB,S.x-8,S.y-8,16,16,0);r.uniform1i(l.renderType,0);r.uniform2f(l.scale,w.x,w.y);r.uniform3f(l.screenPosition,T.x,T.y,T.z);r.disable(r.BLEND);r.enable(r.DEPTH_TEST);r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0);r.activeTexture(r.TEXTURE0);r.bindTexture(r.TEXTURE_2D,f);r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,S.x-8,S.y-8,16,16,0);r.uniform1i(l.renderType,1);r.disable(r.DEPTH_TEST);r.activeTexture(r.TEXTURE1);r.bindTexture(r.TEXTURE_2D,u);r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0);E.positionScreen.copy(T);if(E.customUpdateCallback){E.customUpdateCallback(E)}else{E.updateLensFlares()}r.uniform1i(l.renderType,2);r.enable(r.BLEND);for(var C=0,P=E.lensFlares.length;C<P;C++){var R=E.lensFlares[C];if(R.opacity>.001&&R.scale>.001){T.x=R.x;T.y=R.y;T.z=R.z;b=R.size*R.scale/m;w.x=b*y;w.y=b;r.uniform3f(l.screenPosition,T.x,T.y,T.z);r.uniform2f(l.scale,w.x,w.y);r.uniform1f(l.rotation,R.rotation);r.uniform1f(l.opacity,R.opacity);r.uniform3f(l.color,R.color.r,R.color.g,R.color.b);e.setBlending(R.blending,R.blendEquation,R.blendSrc,R.blendDst);e.setTexture(R.texture,1);r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0)}}}}r.enable(r.CULL_FACE);r.enable(r.DEPTH_TEST);r.depthMask(true);e.resetGLState()};function p(t){var i=r.createProgram();var n=r.createShader(r.FRAGMENT_SHADER);var a=r.createShader(r.VERTEX_SHADER);var o="precision "+e.getPrecision()+" float;\n";r.shaderSource(n,o+t.fragmentShader);r.shaderSource(a,o+t.vertexShader);r.compileShader(n);r.compileShader(a);r.attachShader(i,n);r.attachShader(i,a);r.linkProgram(i);return i}};i.ShadowMapPlugin=function(e,t,r,n){var a=e.context;var o,s,l,h,u=new i.Frustum,f=new i.Matrix4,c=new i.Vector3,p=new i.Vector3,d=new i.Vector3,v=[];var m=i.ShaderLib["depthRGBA"];var g=i.UniformsUtils.clone(m.uniforms);o=new i.ShaderMaterial({uniforms:g,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader});s=new i.ShaderMaterial({uniforms:g,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,morphTargets:true});l=new i.ShaderMaterial({uniforms:g,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,skinning:true});h=new i.ShaderMaterial({uniforms:g,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,morphTargets:true,skinning:true});o._shadowPass=true;s._shadowPass=true;l._shadowPass=true;h._shadowPass=true;this.render=function(r,c){if(e.shadowMapEnabled===false)return;var p,m,g,T,S,M,A,E,C,P,R,L,k,F,D=[],U=0,O=null;a.clearColor(1,1,1,1);a.disable(a.BLEND);a.enable(a.CULL_FACE);a.frontFace(a.CCW);if(e.shadowMapCullFace===i.CullFaceFront){a.cullFace(a.FRONT)}else{a.cullFace(a.BACK)}e.setDepthTest(true);for(p=0,m=t.length;p<m;p++){F=t[p];if(!F.castShadow)continue;if(F instanceof i.DirectionalLight&&F.shadowCascade){for(S=0;S<F.shadowCascadeCount;S++){var j;if(!F.shadowCascadeArray[S]){j=_(F,S);j.originalCamera=c;var V=new i.Gyroscope;V.position.copy(F.shadowCascadeOffset);V.add(j);V.add(j.target);c.add(V);F.shadowCascadeArray[S]=j;console.log("Created virtualLight",j)}else{j=F.shadowCascadeArray[S]}x(F,S);D[U]=j;U++}}else{D[U]=F;U++}}for(p=0,m=D.length;p<m;p++){F=D[p];if(!F.shadowMap){var N=i.LinearFilter;if(e.shadowMapType===i.PCFSoftShadowMap){N=i.NearestFilter}var B={minFilter:N,magFilter:N,format:i.RGBAFormat};F.shadowMap=new i.WebGLRenderTarget(F.shadowMapWidth,F.shadowMapHeight,B);F.shadowMapSize=new i.Vector2(F.shadowMapWidth,F.shadowMapHeight);F.shadowMatrix=new i.Matrix4}if(!F.shadowCamera){if(F instanceof i.SpotLight){F.shadowCamera=new i.PerspectiveCamera(F.shadowCameraFov,F.shadowMapWidth/F.shadowMapHeight,F.shadowCameraNear,F.shadowCameraFar)}else if(F instanceof i.DirectionalLight){F.shadowCamera=new i.OrthographicCamera(F.shadowCameraLeft,F.shadowCameraRight,F.shadowCameraTop,F.shadowCameraBottom,F.shadowCameraNear,F.shadowCameraFar)}else{console.error("Unsupported light type for shadow");continue}r.add(F.shadowCamera);if(r.autoUpdate===true)r.updateMatrixWorld()}if(F.shadowCameraVisible&&!F.cameraHelper){F.cameraHelper=new i.CameraHelper(F.shadowCamera);r.add(F.cameraHelper)}if(F.isVirtual&&j.originalCamera==c){b(c,F)}M=F.shadowMap;A=F.shadowMatrix;E=F.shadowCamera;E.position.setFromMatrixPosition(F.matrixWorld);d.setFromMatrixPosition(F.target.matrixWorld);E.lookAt(d);E.updateMatrixWorld();E.matrixWorldInverse.getInverse(E.matrixWorld);if(F.cameraHelper)F.cameraHelper.visible=F.shadowCameraVisible;if(F.shadowCameraVisible)F.cameraHelper.update();A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);A.multiply(E.projectionMatrix);A.multiply(E.matrixWorldInverse);f.multiplyMatrices(E.projectionMatrix,E.matrixWorldInverse);u.setFromMatrix(f);e.setRenderTarget(M);e.clear();v.length=0;y(r,r,E);var z,I,H;for(g=0,T=v.length;g<T;g++){L=v[g];k=L.object;P=L.buffer;z=w(k);I=k.geometry.morphTargets!==undefined&&k.geometry.morphTargets.length>0&&z.morphTargets;H=k instanceof i.SkinnedMesh&&z.skinning;if(k.customDepthMaterial){R=k.customDepthMaterial}else if(H){R=I?h:l}else if(I){R=s}else{R=o}e.setMaterialFaces(z);if(P instanceof i.BufferGeometry){e.renderBufferDirect(E,t,O,R,P,k)}else{e.renderBuffer(E,t,O,R,P,k)}}for(g=0,T=n.length;g<T;g++){L=n[g];k=L.object;if(k.visible&&k.castShadow){k._modelViewMatrix.multiplyMatrices(E.matrixWorldInverse,k.matrixWorld);e.renderImmediateObject(E,t,O,o,k)}}}var G=e.getClearColor(),W=e.getClearAlpha();a.clearColor(G.r,G.g,G.b,W);a.enable(a.BLEND);if(e.shadowMapCullFace===i.CullFaceFront){a.cullFace(a.BACK)}e.resetGLState()};function y(e,t,i){if(t.visible){var n=r[t.id];if(n&&t.castShadow&&(t.frustumCulled===false||u.intersectsObject(t)===true)){for(var a=0,o=n.length;a<o;a++){var s=n[a];t._modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld);v.push(s)}}for(var a=0,o=t.children.length;a<o;a++){y(e,t.children[a],i)}}}function _(e,t){var r=new i.DirectionalLight;r.isVirtual=true;r.onlyShadow=true;r.castShadow=true;r.shadowCameraNear=e.shadowCameraNear;r.shadowCameraFar=e.shadowCameraFar;r.shadowCameraLeft=e.shadowCameraLeft;r.shadowCameraRight=e.shadowCameraRight;r.shadowCameraBottom=e.shadowCameraBottom;r.shadowCameraTop=e.shadowCameraTop;r.shadowCameraVisible=e.shadowCameraVisible;r.shadowDarkness=e.shadowDarkness;r.shadowBias=e.shadowCascadeBias[t];r.shadowMapWidth=e.shadowCascadeWidth[t];r.shadowMapHeight=e.shadowCascadeHeight[t];r.pointsWorld=[];r.pointsFrustum=[];var n=r.pointsWorld,a=r.pointsFrustum;for(var o=0;o<8;o++){n[o]=new i.Vector3;a[o]=new i.Vector3}var s=e.shadowCascadeNearZ[t];var l=e.shadowCascadeFarZ[t];a[0].set(-1,-1,s);a[1].set(1,-1,s);a[2].set(-1,1,s);a[3].set(1,1,s);a[4].set(-1,-1,l);a[5].set(1,-1,l);a[6].set(-1,1,l);a[7].set(1,1,l);return r}function x(e,t){var r=e.shadowCascadeArray[t];r.position.copy(e.position);r.target.position.copy(e.target.position);r.lookAt(r.target);r.shadowCameraVisible=e.shadowCameraVisible;r.shadowDarkness=e.shadowDarkness;r.shadowBias=e.shadowCascadeBias[t];var i=e.shadowCascadeNearZ[t];var n=e.shadowCascadeFarZ[t];var a=r.pointsFrustum;a[0].z=i;a[1].z=i;a[2].z=i;a[3].z=i;a[4].z=n;a[5].z=n;a[6].z=n;a[7].z=n}function b(e,t){var r=t.shadowCamera,i=t.pointsFrustum,n=t.pointsWorld;c.set(Infinity,Infinity,Infinity);p.set(-Infinity,-Infinity,-Infinity);for(var a=0;a<8;a++){var o=n[a];o.copy(i[a]);o.unproject(e);o.applyMatrix4(r.matrixWorldInverse);if(o.x<c.x)c.x=o.x;if(o.x>p.x)p.x=o.x;if(o.y<c.y)c.y=o.y;if(o.y>p.y)p.y=o.y;if(o.z<c.z)c.z=o.z;if(o.z>p.z)p.z=o.z}r.left=c.x;r.right=p.x;r.top=p.y;r.bottom=c.y;r.updateProjectionMatrix()}function w(e){return e.material instanceof i.MeshFaceMaterial?e.material.materials[0]:e.material}};i.SpritePlugin=function(e,t){var r=e.context;var n,a;var o,s,l;var h;var u=function(){var e=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]);var t=new Uint16Array([0,1,2,0,2,3]);n=r.createBuffer();a=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,n);r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,a);r.bufferData(r.ELEMENT_ARRAY_BUFFER,t,r.STATIC_DRAW);o=f();s={position:r.getAttribLocation(o,"position"),uv:r.getAttribLocation(o,"uv")};l={uvOffset:r.getUniformLocation(o,"uvOffset"),uvScale:r.getUniformLocation(o,"uvScale"),rotation:r.getUniformLocation(o,"rotation"),scale:r.getUniformLocation(o,"scale"),color:r.getUniformLocation(o,"color"),map:r.getUniformLocation(o,"map"),opacity:r.getUniformLocation(o,"opacity"),modelViewMatrix:r.getUniformLocation(o,"modelViewMatrix"),projectionMatrix:r.getUniformLocation(o,"projectionMatrix"),fogType:r.getUniformLocation(o,"fogType"),fogDensity:r.getUniformLocation(o,"fogDensity"),fogNear:r.getUniformLocation(o,"fogNear"),fogFar:r.getUniformLocation(o,"fogFar"),fogColor:r.getUniformLocation(o,"fogColor"),alphaTest:r.getUniformLocation(o,"alphaTest")};var u=document.createElement("canvas");u.width=8;u.height=8;var c=u.getContext("2d");c.fillStyle="white";c.fillRect(0,0,8,8);h=new i.Texture(u);h.needsUpdate=true};this.render=function(f,p){if(t.length===0)return;if(o===undefined){u()}r.useProgram(o);r.enableVertexAttribArray(s.position);r.enableVertexAttribArray(s.uv);r.disable(r.CULL_FACE);r.enable(r.BLEND);r.bindBuffer(r.ARRAY_BUFFER,n);r.vertexAttribPointer(s.position,2,r.FLOAT,false,2*8,0);r.vertexAttribPointer(s.uv,2,r.FLOAT,false,2*8,8);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,a);r.uniformMatrix4fv(l.projectionMatrix,false,p.projectionMatrix.elements);r.activeTexture(r.TEXTURE0);r.uniform1i(l.map,0);var d=0;var v=0;var m=f.fog;if(m){r.uniform3f(l.fogColor,m.color.r,m.color.g,m.color.b);if(m instanceof i.Fog){r.uniform1f(l.fogNear,m.near);r.uniform1f(l.fogFar,m.far);r.uniform1i(l.fogType,1);d=1;v=1}else if(m instanceof i.FogExp2){r.uniform1f(l.fogDensity,m.density);r.uniform1i(l.fogType,2);d=2;v=2}}else{r.uniform1i(l.fogType,0);d=0;v=0}for(var g=0,y=t.length;g<y;g++){var _=t[g];_._modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,_.matrixWorld);if(_.renderDepth===null){_.z=-_._modelViewMatrix.elements[14]}else{_.z=_.renderDepth}}t.sort(c);var x=[];for(var g=0,y=t.length;g<y;g++){var _=t[g];var b=_.material;r.uniform1f(l.alphaTest,b.alphaTest);r.uniformMatrix4fv(l.modelViewMatrix,false,_._modelViewMatrix.elements);x[0]=_.scale.x;x[1]=_.scale.y;var w=0;if(f.fog&&b.fog){w=v}if(d!==w){r.uniform1i(l.fogType,w);d=w}if(b.map!==null){r.uniform2f(l.uvOffset,b.map.offset.x,b.map.offset.y);r.uniform2f(l.uvScale,b.map.repeat.x,b.map.repeat.y)}else{r.uniform2f(l.uvOffset,0,0);r.uniform2f(l.uvScale,1,1)}r.uniform1f(l.opacity,b.opacity);r.uniform3f(l.color,b.color.r,b.color.g,b.color.b);r.uniform1f(l.rotation,b.rotation);r.uniform2fv(l.scale,x);e.setBlending(b.blending,b.blendEquation,b.blendSrc,b.blendDst);e.setDepthTest(b.depthTest);e.setDepthWrite(b.depthWrite);if(b.map&&b.map.image&&b.map.image.width){e.setTexture(b.map,0)}else{e.setTexture(h,0)}r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0)}r.enable(r.CULL_FACE);e.resetGLState()};function f(){var t=r.createProgram();var i=r.createShader(r.VERTEX_SHADER);var n=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(i,["precision "+e.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n"));
r.shaderSource(n,["precision "+e.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n"));r.compileShader(i);r.compileShader(n);r.attachShader(t,i);r.attachShader(t,n);r.linkProgram(t);return t}function c(e,t){if(e.z!==t.z){return t.z-e.z}else{return t.id-e.id}}};i.GeometryUtils={merge:function(e,t,r){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var n;if(t instanceof i.Mesh){t.matrixAutoUpdate&&t.updateMatrix();n=t.matrix;t=t.geometry}e.merge(t,n,r)},center:function(e){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return e.center()}};i.ImageUtils={crossOrigin:undefined,loadTexture:function(e,t,r,n){var a=new i.ImageLoader;a.crossOrigin=this.crossOrigin;var o=new i.Texture(undefined,t);a.load(e,function(e){o.image=e;o.needsUpdate=true;if(r)r(o)},undefined,function(e){if(n)n(e)});o.sourceFile=e;return o},loadTextureCube:function(e,t,r,n){var a=[];var o=new i.ImageLoader;o.crossOrigin=this.crossOrigin;var s=new i.CubeTexture(a,t);s.flipY=false;var l=0;var h=function(t){o.load(e[t],function(e){s.images[t]=e;l+=1;if(l===6){s.needsUpdate=true;if(r)r(s)}})};for(var u=0,f=e.length;u<f;++u){h(u)}return s},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(e,t){var r=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]};var i=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]};var n=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]};t=t|1;var a=e.width;var o=e.height;var s=document.createElement("canvas");s.width=a;s.height=o;var l=s.getContext("2d");l.drawImage(e,0,0);var h=l.getImageData(0,0,a,o).data;var u=l.createImageData(a,o);var f=u.data;for(var c=0;c<a;c++){for(var p=0;p<o;p++){var d=p-1<0?0:p-1;var v=p+1>o-1?o-1:p+1;var m=c-1<0?0:c-1;var g=c+1>a-1?a-1:c+1;var y=[];var _=[0,0,h[(p*a+c)*4]/255*t];y.push([-1,0,h[(p*a+m)*4]/255*t]);y.push([-1,-1,h[(d*a+m)*4]/255*t]);y.push([0,-1,h[(d*a+c)*4]/255*t]);y.push([1,-1,h[(d*a+g)*4]/255*t]);y.push([1,0,h[(p*a+g)*4]/255*t]);y.push([1,1,h[(v*a+g)*4]/255*t]);y.push([0,1,h[(v*a+c)*4]/255*t]);y.push([-1,1,h[(v*a+m)*4]/255*t]);var x=[];var b=y.length;for(var w=0;w<b;w++){var T=y[w];var S=y[(w+1)%b];T=i(T,_);S=i(S,_);x.push(n(r(T,S)))}var M=[0,0,0];for(var w=0;w<x.length;w++){M[0]+=x[w][0];M[1]+=x[w][1];M[2]+=x[w][2]}M[0]/=x.length;M[1]/=x.length;M[2]/=x.length;var A=(p*a+c)*4;f[A]=(M[0]+1)/2*255|0;f[A+1]=(M[1]+1)/2*255|0;f[A+2]=M[2]*255|0;f[A+3]=255}}l.putImageData(u,0,0);return s},generateDataTexture:function(e,t,r){var n=e*t;var a=new Uint8Array(3*n);var o=Math.floor(r.r*255);var s=Math.floor(r.g*255);var l=Math.floor(r.b*255);for(var h=0;h<n;h++){a[h*3]=o;a[h*3+1]=s;a[h*3+2]=l}var u=new i.DataTexture(a,e,t,i.RGBFormat);u.needsUpdate=true;return u}};i.SceneUtils={createMultiMaterialObject:function(e,t){var r=new i.Object3D;for(var n=0,a=t.length;n<a;n++){r.add(new i.Mesh(e,t[n]))}return r},detach:function(e,t,r){e.applyMatrix(t.matrixWorld);t.remove(e);r.add(e)},attach:function(e,t,r){var n=new i.Matrix4;n.getInverse(r.matrixWorld);e.applyMatrix(n);t.remove(e);r.add(e)}};i.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(e){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(e){var t=e.familyName.toLowerCase();var r=this;r.faces[t]=r.faces[t]||{};r.faces[t][e.cssFontWeight]=r.faces[t][e.cssFontWeight]||{};r.faces[t][e.cssFontWeight][e.cssFontStyle]=e;var i=r.faces[t][e.cssFontWeight][e.cssFontStyle]=e;return e},drawText:function(e){var t=[],r=[];var n,a,o=this.getFace(),s=this.size/o.resolution,l=0,h=String(e).split(""),u=h.length;var f=[];for(n=0;n<u;n++){var c=new i.Path;var p=this.extractGlyphPoints(h[n],o,s,l,c);l+=p.offset;f.push(p.path)}var d=l/2;return{paths:f,offset:d}},extractGlyphPoints:function(e,t,r,n,a){var o=[];var s,l,h,u,f,c,p,d,v,m,g,y,_,x,b,w,T,S,M,A=t.glyphs[e]||t.glyphs["?"];if(!A)return;if(A.o){u=A._cachedOutline||(A._cachedOutline=A.o.split(" "));c=u.length;p=r;d=r;for(s=0;s<c;){f=u[s++];switch(f){case"m":v=u[s++]*p+n;m=u[s++]*d;a.moveTo(v,m);break;case"l":v=u[s++]*p+n;m=u[s++]*d;a.lineTo(v,m);break;case"q":g=u[s++]*p+n;y=u[s++]*d;b=u[s++]*p+n;w=u[s++]*d;a.quadraticCurveTo(b,w,g,y);M=o[o.length-1];if(M){_=M.x;x=M.y;for(l=1,h=this.divisions;l<=h;l++){var E=l/h;var C=i.Shape.Utils.b2(E,_,b,g);var P=i.Shape.Utils.b2(E,x,w,y)}}break;case"b":g=u[s++]*p+n;y=u[s++]*d;b=u[s++]*p+n;w=u[s++]*d;T=u[s++]*p+n;S=u[s++]*d;a.bezierCurveTo(b,w,T,S,g,y);M=o[o.length-1];if(M){_=M.x;x=M.y;for(l=1,h=this.divisions;l<=h;l++){var E=l/h;var C=i.Shape.Utils.b3(E,_,b,T,g);var P=i.Shape.Utils.b3(E,x,w,S,y)}}break}}}return{offset:A.ha*r,path:a}}};i.FontUtils.generateShapes=function(e,t){t=t||{};var r=t.size!==undefined?t.size:100;var n=t.curveSegments!==undefined?t.curveSegments:4;var a=t.font!==undefined?t.font:"helvetiker";var o=t.weight!==undefined?t.weight:"normal";var s=t.style!==undefined?t.style:"normal";i.FontUtils.size=r;i.FontUtils.divisions=n;i.FontUtils.face=a;i.FontUtils.weight=o;i.FontUtils.style=s;var l=i.FontUtils.drawText(e);var h=l.paths;var u=[];for(var f=0,c=h.length;f<c;f++){Array.prototype.push.apply(u,h[f].toShapes())}return u};(function(e){var t=1e-10;var r=function(e,t){var r=e.length;if(r<3)return null;var a=[],o=[],s=[];var l,h,u;if(i(e)>0){for(h=0;h<r;h++)o[h]=h}else{for(h=0;h<r;h++)o[h]=r-1-h}var f=r;var c=2*f;for(h=f-1;f>2;){if(c--<=0){console.log("Warning, unable to triangulate polygon!");if(t)return s;return a}l=h;if(f<=l)l=0;h=l+1;if(f<=h)h=0;u=h+1;if(f<=u)u=0;if(n(e,l,h,u,f,o)){var p,d,v,m,g;p=o[l];d=o[h];v=o[u];a.push([e[p],e[d],e[v]]);s.push([o[l],o[h],o[u]]);for(m=h,g=h+1;g<f;m++,g++){o[m]=o[g]}f--;c=2*f}}if(t)return s;return a};var i=function(e){var t=e.length;var r=0;for(var i=t-1,n=0;n<t;i=n++){r+=e[i].x*e[n].y-e[n].x*e[i].y}return r*.5};var n=function(e,r,i,n,a,o){var s;var l,h,u,f;var c,p,d,v;l=e[o[r]].x;h=e[o[r]].y;u=e[o[i]].x;f=e[o[i]].y;c=e[o[n]].x;p=e[o[n]].y;if(t>(u-l)*(p-h)-(f-h)*(c-l))return false;var m,g,y,_,x,b;var w,T,S,M,A,E;var C,P,R;m=c-u;g=p-f;y=l-c;_=h-p;x=u-l;b=f-h;for(s=0;s<a;s++){d=e[o[s]].x;v=e[o[s]].y;if(d===l&&v===h||d===u&&v===f||d===c&&v===p)continue;w=d-l;T=v-h;S=d-u;M=v-f;A=d-c;E=v-p;R=m*M-g*S;C=x*T-b*w;P=y*E-_*A;if(R>=-t&&P>=-t&&C>=-t)return false}return true};e.Triangulate=r;e.Triangulate.area=i;return e})(i.FontUtils);self._typeface_js={faces:i.FontUtils.faces,loadFace:i.FontUtils.loadFace};i.typeface_js=self._typeface_js;i.Audio=function(e){i.Object3D.call(this);this.type="Audio";this.context=e.context;this.source=this.context.createBufferSource();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.panner=this.context.createPanner();this.panner.connect(this.gain)};i.Audio.prototype=Object.create(i.Object3D.prototype);i.Audio.prototype.load=function(e){var t=this;var r=new XMLHttpRequest;r.open("GET",e,true);r.responseType="arraybuffer";r.onload=function(e){t.context.decodeAudioData(this.response,function(e){t.source.buffer=e;t.source.connect(t.panner);t.source.start(0)})};r.send();return this};i.Audio.prototype.setLoop=function(e){this.source.loop=e};i.Audio.prototype.setRefDistance=function(e){this.panner.refDistance=e};i.Audio.prototype.setRolloffFactor=function(e){this.panner.rolloffFactor=e};i.Audio.prototype.updateMatrixWorld=function(){var e=new i.Vector3;return function(t){i.Object3D.prototype.updateMatrixWorld.call(this,t);e.setFromMatrixPosition(this.matrixWorld);this.panner.setPosition(e.x,e.y,e.z)}}();i.AudioListener=function(){i.Object3D.call(this);this.type="AudioListener";this.context=new(window.AudioContext||window.webkitAudioContext)};i.AudioListener.prototype=Object.create(i.Object3D.prototype);i.AudioListener.prototype.updateMatrixWorld=function(){var e=new i.Vector3;var t=new i.Quaternion;var r=new i.Vector3;var n=new i.Vector3;var a=new i.Vector3;var o=new i.Vector3;return function(s){i.Object3D.prototype.updateMatrixWorld.call(this,s);var l=this.context.listener;this.matrixWorld.decompose(e,t,r);n.set(0,0,-1).applyQuaternion(t);a.subVectors(e,o);l.setPosition(e.x,e.y,e.z);l.setOrientation(n.x,n.y,n.z,this.up.x,this.up.y,this.up.z);l.setVelocity(a.x,a.y,a.z);o.copy(e)}}();i.Curve=function(){};i.Curve.prototype.getPoint=function(e){console.log("Warning, getPoint() not implemented!");return null};i.Curve.prototype.getPointAt=function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)};i.Curve.prototype.getPoints=function(e){if(!e)e=5;var t,r=[];for(t=0;t<=e;t++){r.push(this.getPoint(t/e))}return r};i.Curve.prototype.getSpacedPoints=function(e){if(!e)e=5;var t,r=[];for(t=0;t<=e;t++){r.push(this.getPointAt(t/e))}return r};i.Curve.prototype.getLength=function(){var e=this.getLengths();return e[e.length-1]};i.Curve.prototype.getLengths=function(e){if(!e)e=this.__arcLengthDivisions?this.__arcLengthDivisions:200;if(this.cacheArcLengths&&this.cacheArcLengths.length==e+1&&!this.needsUpdate){return this.cacheArcLengths}this.needsUpdate=false;var t=[];var r,i=this.getPoint(0);var n,a=0;t.push(0);for(n=1;n<=e;n++){r=this.getPoint(n/e);a+=r.distanceTo(i);t.push(a);i=r}this.cacheArcLengths=t;return t};i.Curve.prototype.updateArcLengths=function(){this.needsUpdate=true;this.getLengths()};i.Curve.prototype.getUtoTmapping=function(e,t){var r=this.getLengths();var i=0,n=r.length;var a;if(t){a=t}else{a=e*r[n-1]}var o=0,s=n-1,l;while(o<=s){i=Math.floor(o+(s-o)/2);l=r[i]-a;if(l<0){o=i+1;continue}else if(l>0){s=i-1;continue}else{s=i;break}}i=s;if(r[i]==a){var h=i/(n-1);return h}var u=r[i];var f=r[i+1];var c=f-u;var p=(a-u)/c;var h=(i+p)/(n-1);return h};i.Curve.prototype.getTangent=function(e){var t=1e-4;var r=e-t;var i=e+t;if(r<0)r=0;if(i>1)i=1;var n=this.getPoint(r);var a=this.getPoint(i);var o=a.clone().sub(n);return o.normalize()};i.Curve.prototype.getTangentAt=function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)};i.Curve.Utils={tangentQuadraticBezier:function(e,t,r,i){return 2*(1-e)*(r-t)+2*e*(i-r)},tangentCubicBezier:function(e,t,r,i,n){return-3*t*(1-e)*(1-e)+3*r*(1-e)*(1-e)-6*e*r*(1-e)+6*e*i*(1-e)-3*e*e*i+3*e*e*n},tangentSpline:function(e,t,r,i,n){var a=6*e*e-6*e;var o=3*e*e-4*e+1;var s=-6*e*e+6*e;var l=3*e*e-2*e;return a+o+s+l},interpolate:function(e,t,r,i,n){var a=(r-e)*.5;var o=(i-t)*.5;var s=n*n;var l=n*s;return(2*t-2*r+a+o)*l+(-3*t+3*r-2*a-o)*s+a*n+t}};i.Curve.create=function(e,t){e.prototype=Object.create(i.Curve.prototype);e.prototype.getPoint=t;return e};i.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=false};i.CurvePath.prototype=Object.create(i.Curve.prototype);i.CurvePath.prototype.add=function(e){this.curves.push(e)};i.CurvePath.prototype.checkConnection=function(){};i.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0);var t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){this.curves.push(new i.LineCurve(t,e))}};i.CurvePath.prototype.getPoint=function(e){var t=e*this.getLength();var r=this.getCurveLengths();var i=0,n,a;while(i<r.length){if(r[i]>=t){n=r[i]-t;a=this.curves[i];var o=1-n/a.getLength();return a.getPointAt(o);break}i++}return null};i.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]};i.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length){return this.cacheLengths}var e=[],t=0;var r,i=this.curves.length;for(r=0;r<i;r++){t+=this.curves[r].getLength();e.push(t)}this.cacheLengths=e;return e};i.CurvePath.prototype.getBoundingBox=function(){var e=this.getPoints();var t,r,n;var a,o,s;t=r=Number.NEGATIVE_INFINITY;a=o=Number.POSITIVE_INFINITY;var l,h,u,f;var c=e[0]instanceof i.Vector3;f=c?new i.Vector3:new i.Vector2;for(h=0,u=e.length;h<u;h++){l=e[h];if(l.x>t)t=l.x;else if(l.x<a)a=l.x;if(l.y>r)r=l.y;else if(l.y<o)o=l.y;if(c){if(l.z>n)n=l.z;else if(l.z<s)s=l.z}f.add(l)}var p={minX:a,minY:o,maxX:t,maxY:r};if(c){p.maxZ=n;p.minZ=s}return p};i.CurvePath.prototype.createPointsGeometry=function(e){var t=this.getPoints(e,true);return this.createGeometry(t)};i.CurvePath.prototype.createSpacedPointsGeometry=function(e){var t=this.getSpacedPoints(e,true);return this.createGeometry(t)};i.CurvePath.prototype.createGeometry=function(e){var t=new i.Geometry;for(var r=0;r<e.length;r++){t.vertices.push(new i.Vector3(e[r].x,e[r].y,e[r].z||0))}return t};i.CurvePath.prototype.addWrapPath=function(e){this.bends.push(e)};i.CurvePath.prototype.getTransformedPoints=function(e,t){var r=this.getPoints(e);var i,n;if(!t){t=this.bends}for(i=0,n=t.length;i<n;i++){r=this.getWrapPoints(r,t[i])}return r};i.CurvePath.prototype.getTransformedSpacedPoints=function(e,t){var r=this.getSpacedPoints(e);var i,n;if(!t){t=this.bends}for(i=0,n=t.length;i<n;i++){r=this.getWrapPoints(r,t[i])}return r};i.CurvePath.prototype.getWrapPoints=function(e,t){var r=this.getBoundingBox();var i,n,a,o,s,l;for(i=0,n=e.length;i<n;i++){a=e[i];o=a.x;s=a.y;l=o/r.maxX;l=t.getUtoTmapping(l,o);var h=t.getPoint(l);var u=t.getTangent(l);u.set(-u.y,u.x).multiplyScalar(s);a.x=h.x+u.x;a.y=h.y+u.y}return e};i.Gyroscope=function(){i.Object3D.call(this)};i.Gyroscope.prototype=Object.create(i.Object3D.prototype);i.Gyroscope.prototype.updateMatrixWorld=function(){var e=new i.Vector3;var t=new i.Quaternion;var r=new i.Vector3;var n=new i.Vector3;var a=new i.Quaternion;var o=new i.Vector3;return function(i){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||i){if(this.parent){this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);this.matrixWorld.decompose(n,a,o);this.matrix.decompose(e,t,r);this.matrixWorld.compose(n,t,o)}else{this.matrixWorld.copy(this.matrix)}this.matrixWorldNeedsUpdate=false;i=true}for(var s=0,l=this.children.length;s<l;s++){this.children[s].updateMatrixWorld(i)}}}();i.Path=function(e){i.CurvePath.call(this);this.actions=[];if(e){this.fromPoints(e)}};i.Path.prototype=Object.create(i.CurvePath.prototype);i.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"};i.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;t<r;t++){this.lineTo(e[t].x,e[t].y)}};i.Path.prototype.moveTo=function(e,t){var r=Array.prototype.slice.call(arguments);this.actions.push({action:i.PathActions.MOVE_TO,args:r})};i.Path.prototype.lineTo=function(e,t){var r=Array.prototype.slice.call(arguments);var n=this.actions[this.actions.length-1].args;var a=n[n.length-2];var o=n[n.length-1];var s=new i.LineCurve(new i.Vector2(a,o),new i.Vector2(e,t));this.curves.push(s);this.actions.push({action:i.PathActions.LINE_TO,args:r})};i.Path.prototype.quadraticCurveTo=function(e,t,r,n){var a=Array.prototype.slice.call(arguments);var o=this.actions[this.actions.length-1].args;var s=o[o.length-2];var l=o[o.length-1];var h=new i.QuadraticBezierCurve(new i.Vector2(s,l),new i.Vector2(e,t),new i.Vector2(r,n));this.curves.push(h);this.actions.push({action:i.PathActions.QUADRATIC_CURVE_TO,args:a})};i.Path.prototype.bezierCurveTo=function(e,t,r,n,a,o){var s=Array.prototype.slice.call(arguments);var l=this.actions[this.actions.length-1].args;var h=l[l.length-2];var u=l[l.length-1];var f=new i.CubicBezierCurve(new i.Vector2(h,u),new i.Vector2(e,t),new i.Vector2(r,n),new i.Vector2(a,o));this.curves.push(f);this.actions.push({action:i.PathActions.BEZIER_CURVE_TO,args:s})};i.Path.prototype.splineThru=function(e){var t=Array.prototype.slice.call(arguments);var r=this.actions[this.actions.length-1].args;var n=r[r.length-2];var a=r[r.length-1];var o=[new i.Vector2(n,a)];Array.prototype.push.apply(o,e);var s=new i.SplineCurve(o);this.curves.push(s);this.actions.push({action:i.PathActions.CSPLINE_THRU,args:t})};i.Path.prototype.arc=function(e,t,r,i,n,a){var o=this.actions[this.actions.length-1].args;var s=o[o.length-2];var l=o[o.length-1];this.absarc(e+s,t+l,r,i,n,a)};i.Path.prototype.absarc=function(e,t,r,i,n,a){this.absellipse(e,t,r,r,i,n,a)};i.Path.prototype.ellipse=function(e,t,r,i,n,a,o){var s=this.actions[this.actions.length-1].args;var l=s[s.length-2];var h=s[s.length-1];this.absellipse(e+l,t+h,r,i,n,a,o)};i.Path.prototype.absellipse=function(e,t,r,n,a,o,s){var l=Array.prototype.slice.call(arguments);var h=new i.EllipseCurve(e,t,r,n,a,o,s);this.curves.push(h);var u=h.getPoint(1);l.push(u.x);l.push(u.y);this.actions.push({action:i.PathActions.ELLIPSE,args:l})};i.Path.prototype.getSpacedPoints=function(e,t){if(!e)e=40;var r=[];for(var i=0;i<e;i++){r.push(this.getPoint(i/e))}return r};i.Path.prototype.getPoints=function(e,t){if(this.useSpacedPoints){console.log("tata");return this.getSpacedPoints(e,t)}e=e||12;var r=[];var n,a,o,s,l;var h,u,f,c,p,d,v,m,g,y,_,x,b;for(n=0,a=this.actions.length;n<a;n++){o=this.actions[n];s=o.action;l=o.args;switch(s){case i.PathActions.MOVE_TO:r.push(new i.Vector2(l[0],l[1]));break;case i.PathActions.LINE_TO:r.push(new i.Vector2(l[0],l[1]));break;case i.PathActions.QUADRATIC_CURVE_TO:h=l[2];u=l[3];p=l[0];d=l[1];if(r.length>0){g=r[r.length-1];v=g.x;m=g.y}else{g=this.actions[n-1].args;v=g[g.length-2];m=g[g.length-1]}for(y=1;y<=e;y++){_=y/e;x=i.Shape.Utils.b2(_,v,p,h);b=i.Shape.Utils.b2(_,m,d,u);r.push(new i.Vector2(x,b))}break;case i.PathActions.BEZIER_CURVE_TO:h=l[4];u=l[5];p=l[0];d=l[1];f=l[2];c=l[3];if(r.length>0){g=r[r.length-1];v=g.x;m=g.y}else{g=this.actions[n-1].args;v=g[g.length-2];m=g[g.length-1]}for(y=1;y<=e;y++){_=y/e;x=i.Shape.Utils.b3(_,v,p,f,h);b=i.Shape.Utils.b3(_,m,d,c,u);r.push(new i.Vector2(x,b))}break;case i.PathActions.CSPLINE_THRU:g=this.actions[n-1].args;var w=new i.Vector2(g[g.length-2],g[g.length-1]);var T=[w];var S=e*l[0].length;T=T.concat(l[0]);var M=new i.SplineCurve(T);for(y=1;y<=S;y++){r.push(M.getPointAt(y/S))}break;case i.PathActions.ARC:var A=l[0],E=l[1],C=l[2],P=l[3],R=l[4],L=!!l[5];var k=R-P;var F;var D=e*2;for(y=1;y<=D;y++){_=y/D;if(!L){_=1-_}F=P+_*k;x=A+C*Math.cos(F);b=E+C*Math.sin(F);r.push(new i.Vector2(x,b))}break;case i.PathActions.ELLIPSE:var A=l[0],E=l[1],U=l[2],O=l[3],P=l[4],R=l[5],L=!!l[6];var k=R-P;var F;var D=e*2;for(y=1;y<=D;y++){_=y/D;if(!L){_=1-_}F=P+_*k;x=A+U*Math.cos(F);b=E+O*Math.sin(F);r.push(new i.Vector2(x,b))}break}}var j=r[r.length-1];var V=1e-10;if(Math.abs(j.x-r[0].x)<V&&Math.abs(j.y-r[0].y)<V)r.splice(r.length-1,1);if(t){r.push(r[0])}return r};i.Path.prototype.toShapes=function(e,t){function r(e){var t,r,n,a,o;var s=[],l=new i.Path;for(t=0,r=e.length;t<r;t++){n=e[t];o=n.args;a=n.action;if(a==i.PathActions.MOVE_TO){if(l.actions.length!=0){s.push(l);l=new i.Path}}l[a].apply(l,o)}if(l.actions.length!=0){s.push(l)}return s}function n(e){var t=[];for(var r=0,n=e.length;r<n;r++){var a=e[r];var o=new i.Shape;o.actions=a.actions;o.curves=a.curves;t.push(o)}return t}function a(e,t){var r=1e-10;var i=t.length;var n=false;for(var a=i-1,o=0;o<i;a=o++){var s=t[a];var l=t[o];var h=l.x-s.x;var u=l.y-s.y;if(Math.abs(u)>r){if(u<0){s=t[o];h=-h;l=t[a];u=-u}if(e.y<s.y||e.y>l.y)continue;if(e.y==s.y){if(e.x==s.x)return true}else{var f=u*(e.x-s.x)-h*(e.y-s.y);if(f==0)return true;if(f<0)continue;n=!n}}else{if(e.y!=s.y)continue;if(l.x<=e.x&&e.x<=s.x||s.x<=e.x&&e.x<=l.x)return true}}return n}var o=r(this.actions);if(o.length==0)return[];if(t===true)return n(o);var s,l,h,u=[];if(o.length==1){l=o[0];h=new i.Shape;h.actions=l.actions;h.curves=l.curves;u.push(h);return u}var f=!i.Shape.Utils.isClockWise(o[0].getPoints());f=e?!f:f;var c=[];var p=[];var d=[];var v=0;var m;p[v]=undefined;d[v]=[];var g,y;for(g=0,y=o.length;g<y;g++){l=o[g];m=l.getPoints();s=i.Shape.Utils.isClockWise(m);s=e?!s:s;if(s){if(!f&&p[v])v++;p[v]={s:new i.Shape,p:m};p[v].s.actions=l.actions;p[v].s.curves=l.curves;if(f)v++;d[v]=[]}else{d[v].push({h:l,p:m[0]})}}if(!p[0])return n(o);if(p.length>1){var _=false;var x=[];for(var b=0,w=p.length;b<w;b++){c[b]=[]}for(var b=0,w=p.length;b<w;b++){var T=p[b];var S=d[b];for(var M=0;M<S.length;M++){var A=S[M];var E=true;for(var C=0;C<p.length;C++){if(a(A.p,p[C].p)){if(b!=C)x.push({froms:b,tos:C,hole:M});if(E){E=false;c[C].push(A)}else{_=true}}}if(E){c[b].push(A)}}}if(x.length>0){if(!_)d=c}}var P,R,L;for(g=0,y=p.length;g<y;g++){h=p[g].s;u.push(h);P=d[g];for(R=0,L=P.length;R<L;R++){h.holes.push(P[R].h)}}return u};i.Shape=function(){i.Path.apply(this,arguments);this.holes=[]};i.Shape.prototype=Object.create(i.Path.prototype);i.Shape.prototype.extrude=function(e){var t=new i.ExtrudeGeometry(this,e);return t};i.Shape.prototype.makeGeometry=function(e){var t=new i.ShapeGeometry(this,e);return t};i.Shape.prototype.getPointsHoles=function(e){var t,r=this.holes.length,i=[];for(t=0;t<r;t++){i[t]=this.holes[t].getTransformedPoints(e,this.bends)}return i};i.Shape.prototype.getSpacedPointsHoles=function(e){var t,r=this.holes.length,i=[];for(t=0;t<r;t++){i[t]=this.holes[t].getTransformedSpacedPoints(e,this.bends)}return i};i.Shape.prototype.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}};i.Shape.prototype.extractPoints=function(e){if(this.useSpacedPoints){return this.extractAllSpacedPoints(e)}return this.extractAllPoints(e)};i.Shape.prototype.extractAllSpacedPoints=function(e){return{shape:this.getTransformedSpacedPoints(e),holes:this.getSpacedPointsHoles(e)}};i.Shape.Utils={triangulateShape:function(e,t){function r(e,t,r){if(e.x!=t.x){if(e.x<t.x){return e.x<=r.x&&r.x<=t.x}else{return t.x<=r.x&&r.x<=e.x}}else{if(e.y<t.y){return e.y<=r.y&&r.y<=t.y}else{return t.y<=r.y&&r.y<=e.y}}}function n(e,t,i,n,a){var o=1e-10;var s=t.x-e.x,l=t.y-e.y;var h=n.x-i.x,u=n.y-i.y;var f=e.x-i.x;var c=e.y-i.y;var p=l*h-s*u;var d=l*f-s*c;if(Math.abs(p)>o){var v;if(p>0){if(d<0||d>p)return[];v=u*f-h*c;if(v<0||v>p)return[]}else{if(d>0||d<p)return[];v=u*f-h*c;if(v>0||v<p)return[]}if(v==0){if(a&&(d==0||d==p))return[];return[e]}if(v==p){if(a&&(d==0||d==p))return[];return[t]}if(d==0)return[i];if(d==p)return[n];var m=v/p;return[{x:e.x+m*s,y:e.y+m*l}]}else{if(d!=0||u*f!=h*c)return[];var g=s==0&&l==0;var y=h==0&&u==0;if(g&&y){if(e.x!=i.x||e.y!=i.y)return[];return[e]}if(g){if(!r(i,n,e))return[];return[e]}if(y){if(!r(e,t,i))return[];return[i]}var _,x,b,w;var T,S,M,A;if(s!=0){if(e.x<t.x){_=e;b=e.x;x=t;w=t.x}else{_=t;b=t.x;x=e;w=e.x}if(i.x<n.x){T=i;M=i.x;S=n;A=n.x}else{T=n;M=n.x;S=i;A=i.x}}else{if(e.y<t.y){_=e;b=e.y;x=t;w=t.y}else{_=t;b=t.y;x=e;w=e.y}if(i.y<n.y){T=i;M=i.y;S=n;A=n.y}else{T=n;M=n.y;S=i;A=i.y}}if(b<=M){if(w<M)return[];if(w==M){if(a)return[];return[T]}if(w<=A)return[T,x];return[T,S]}else{if(b>A)return[];if(b==A){if(a)return[];return[_]}if(w<=A)return[_,x];return[_,S]}}}function a(e,t,r,i){var n=1e-10;var a=t.x-e.x,o=t.y-e.y;var s=r.x-e.x,l=r.y-e.y;var h=i.x-e.x,u=i.y-e.y;var f=a*l-o*s;var c=a*u-o*h;if(Math.abs(f)>n){var p=h*l-u*s;if(f>0){return c>=0&&p>=0}else{return c>=0||p>=0}}else{return c>0}}function o(e,t){var r=e.concat();var i;function o(e,t){var n=r.length-1;var o=e-1;if(o<0)o=n;var s=e+1;if(s>n)s=0;var l=a(r[e],r[o],r[s],i[t]);if(!l){return false}var h=i.length-1;var u=t-1;if(u<0)u=h;var f=t+1;if(f>h)f=0;l=a(i[t],i[u],i[f],r[e]);if(!l){return false}return true}function s(e,t){var i,a,o;for(i=0;i<r.length;i++){a=i+1;a%=r.length;o=n(e,t,r[i],r[a],true);if(o.length>0)return true}return false}var l=[];function h(e,r){var i,a,o,s,h;for(i=0;i<l.length;i++){a=t[l[i]];for(o=0;o<a.length;o++){s=o+1;s%=a.length;h=n(e,r,a[o],a[s],true);if(h.length>0)return true}}return false}var u,f,c,p,d,v,m=[],g,y,_,x;for(var b=0,w=t.length;b<w;b++){l.push(b)}var T=0;var S=l.length*2;while(l.length>0){S--;if(S<0){console.log("Infinite Loop! Holes left:"+l.length+", Probably Hole outside Shape!");break}for(f=T;f<r.length;f++){c=r[f];u=-1;for(var b=0;b<l.length;b++){d=l[b];v=c.x+":"+c.y+":"+d;if(m[v]!==undefined)continue;i=t[d];for(var M=0;M<i.length;M++){p=i[M];if(!o(f,M))continue;if(s(c,p))continue;if(h(c,p))continue;u=M;l.splice(b,1);g=r.slice(0,f+1);y=r.slice(f);_=i.slice(u);x=i.slice(0,u+1);r=g.concat(_).concat(x).concat(y);T=f;break}if(u>=0)break;m[v]=true}if(u>=0)break}}return r}var s,l,h,u,f,c,p={};var d=e.concat();for(var v=0,m=t.length;v<m;v++){Array.prototype.push.apply(d,t[v])}for(s=0,l=d.length;s<l;s++){f=d[s].x+":"+d[s].y;if(p[f]!==undefined){console.log("Duplicate point",f)}p[f]=s}var g=o(e,t);var y=i.FontUtils.Triangulate(g,false);for(s=0,l=y.length;s<l;s++){u=y[s];for(h=0;h<3;h++){f=u[h].x+":"+u[h].y;c=p[f];if(c!==undefined){u[h]=c}}}return y.concat()},isClockWise:function(e){return i.FontUtils.Triangulate.area(e)<0},b2p0:function(e,t){var r=1-e;return r*r*t},b2p1:function(e,t){return 2*(1-e)*e*t},b2p2:function(e,t){return e*e*t},b2:function(e,t,r,i){return this.b2p0(e,t)+this.b2p1(e,r)+this.b2p2(e,i)},b3p0:function(e,t){var r=1-e;return r*r*r*t},b3p1:function(e,t){var r=1-e;return 3*r*r*e*t},b3p2:function(e,t){var r=1-e;return 3*r*e*e*t},b3p3:function(e,t){return e*e*e*t},b3:function(e,t,r,i,n){return this.b3p0(e,t)+this.b3p1(e,r)+this.b3p2(e,i)+this.b3p3(e,n)}};i.LineCurve=function(e,t){this.v1=e;this.v2=t};i.LineCurve.prototype=Object.create(i.Curve.prototype);i.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);t.multiplyScalar(e).add(this.v1);return t};i.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)};i.LineCurve.prototype.getTangent=function(e){var t=this.v2.clone().sub(this.v1);return t.normalize()};i.QuadraticBezierCurve=function(e,t,r){this.v0=e;this.v1=t;this.v2=r};i.QuadraticBezierCurve.prototype=Object.create(i.Curve.prototype);i.QuadraticBezierCurve.prototype.getPoint=function(e){var t=new i.Vector2;t.x=i.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x);t.y=i.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y);return t};i.QuadraticBezierCurve.prototype.getTangent=function(e){var t=new i.Vector2;t.x=i.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x);t.y=i.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y);return t.normalize()};i.CubicBezierCurve=function(e,t,r,i){this.v0=e;this.v1=t;this.v2=r;this.v3=i};i.CubicBezierCurve.prototype=Object.create(i.Curve.prototype);i.CubicBezierCurve.prototype.getPoint=function(e){var t,r;t=i.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x);r=i.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new i.Vector2(t,r)};i.CubicBezierCurve.prototype.getTangent=function(e){var t,r;t=i.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x);r=i.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var n=new i.Vector2(t,r);n.normalize();return n};i.SplineCurve=function(e){this.points=e==undefined?[]:e};i.SplineCurve.prototype=Object.create(i.Curve.prototype);i.SplineCurve.prototype.getPoint=function(e){var t=this.points;var r=(t.length-1)*e;var n=Math.floor(r);var a=r-n;var o=t[n==0?n:n-1];var s=t[n];var l=t[n>t.length-2?t.length-1:n+1];var h=t[n>t.length-3?t.length-1:n+2];var u=new i.Vector2;u.x=i.Curve.Utils.interpolate(o.x,s.x,l.x,h.x,a);u.y=i.Curve.Utils.interpolate(o.y,s.y,l.y,h.y,a);return u};i.EllipseCurve=function(e,t,r,i,n,a,o){this.aX=e;this.aY=t;this.xRadius=r;this.yRadius=i;this.aStartAngle=n;this.aEndAngle=a;this.aClockwise=o};i.EllipseCurve.prototype=Object.create(i.Curve.prototype);i.EllipseCurve.prototype.getPoint=function(e){var t=this.aEndAngle-this.aStartAngle;if(t<0)t+=Math.PI*2;if(t>Math.PI*2)t-=Math.PI*2;var r;if(this.aClockwise===true){r=this.aEndAngle+(1-e)*(Math.PI*2-t)}else{r=this.aStartAngle+e*t}var n=new i.Vector2;n.x=this.aX+this.xRadius*Math.cos(r);n.y=this.aY+this.yRadius*Math.sin(r);return n};i.ArcCurve=function(e,t,r,n,a,o){i.EllipseCurve.call(this,e,t,r,r,n,a,o)};i.ArcCurve.prototype=Object.create(i.EllipseCurve.prototype);i.LineCurve3=i.Curve.create(function(e,t){this.v1=e;this.v2=t},function(e){var t=new i.Vector3;t.subVectors(this.v2,this.v1);t.multiplyScalar(e);t.add(this.v1);return t});i.QuadraticBezierCurve3=i.Curve.create(function(e,t,r){this.v0=e;this.v1=t;this.v2=r},function(e){var t=new i.Vector3;t.x=i.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x);t.y=i.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y);t.z=i.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z);return t});i.CubicBezierCurve3=i.Curve.create(function(e,t,r,i){this.v0=e;this.v1=t;this.v2=r;this.v3=i},function(e){var t=new i.Vector3;t.x=i.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x);t.y=i.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);t.z=i.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return t});i.SplineCurve3=i.Curve.create(function(e){this.points=e==undefined?[]:e},function(e){var t=this.points;var r=(t.length-1)*e;var n=Math.floor(r);var a=r-n;var o=t[n==0?n:n-1];var s=t[n];var l=t[n>t.length-2?t.length-1:n+1];var h=t[n>t.length-3?t.length-1:n+2];var u=new i.Vector3;u.x=i.Curve.Utils.interpolate(o.x,s.x,l.x,h.x,a);u.y=i.Curve.Utils.interpolate(o.y,s.y,l.y,h.y,a);u.z=i.Curve.Utils.interpolate(o.z,s.z,l.z,h.z,a);return u});i.ClosedSplineCurve3=i.Curve.create(function(e){this.points=e==undefined?[]:e},function(e){var t=this.points;var r=(t.length-0)*e;var n=Math.floor(r);var a=r-n;n+=n>0?0:(Math.floor(Math.abs(n)/t.length)+1)*t.length;var o=t[(n-1)%t.length];var s=t[n%t.length];var l=t[(n+1)%t.length];var h=t[(n+2)%t.length];var u=new i.Vector3;u.x=i.Curve.Utils.interpolate(o.x,s.x,l.x,h.x,a);u.y=i.Curve.Utils.interpolate(o.y,s.y,l.y,h.y,a);u.z=i.Curve.Utils.interpolate(o.z,s.z,l.z,h.z,a);return u});i.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){console.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){console.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){console.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(e){if(e.initialized===true)return;for(var t=0;t<e.hierarchy.length;t++){for(var r=0;r<e.hierarchy[t].keys.length;r++){if(e.hierarchy[t].keys[r].time<0){e.hierarchy[t].keys[r].time=0}if(e.hierarchy[t].keys[r].rot!==undefined&&!(e.hierarchy[t].keys[r].rot instanceof i.Quaternion)){var n=e.hierarchy[t].keys[r].rot;e.hierarchy[t].keys[r].rot=(new i.Quaternion).fromArray(n)}}if(e.hierarchy[t].keys.length&&e.hierarchy[t].keys[0].morphTargets!==undefined){var a={};for(var r=0;r<e.hierarchy[t].keys.length;r++){for(var o=0;o<e.hierarchy[t].keys[r].morphTargets.length;o++){var s=e.hierarchy[t].keys[r].morphTargets[o];a[s]=-1}}e.hierarchy[t].usedMorphTargets=a;for(var r=0;r<e.hierarchy[t].keys.length;r++){var l={};for(var s in a){for(var o=0;o<e.hierarchy[t].keys[r].morphTargets.length;o++){if(e.hierarchy[t].keys[r].morphTargets[o]===s){l[s]=e.hierarchy[t].keys[r].morphTargetsInfluences[o];break}}if(o===e.hierarchy[t].keys[r].morphTargets.length){l[s]=0}}e.hierarchy[t].keys[r].morphTargetsInfluences=l}}for(var r=1;r<e.hierarchy[t].keys.length;r++){if(e.hierarchy[t].keys[r].time===e.hierarchy[t].keys[r-1].time){e.hierarchy[t].keys.splice(r,1);
r--}}for(var r=0;r<e.hierarchy[t].keys.length;r++){e.hierarchy[t].keys[r].index=r}}e.initialized=true;return e},parse:function(e){var t=function(e,r){r.push(e);for(var i=0;i<e.children.length;i++)t(e.children[i],r)};var r=[];if(e instanceof i.SkinnedMesh){for(var n=0;n<e.skeleton.bones.length;n++){r.push(e.skeleton.bones[n])}}else{t(e,r)}return r},play:function(e){if(this.animations.indexOf(e)===-1){this.animations.push(e)}},stop:function(e){var t=this.animations.indexOf(e);if(t!==-1){this.animations.splice(t,1)}},update:function(e){for(var t=0;t<this.animations.length;t++){this.animations[t].resetBlendWeights()}for(var t=0;t<this.animations.length;t++){this.animations[t].update(e)}}};i.Animation=function(e,t){this.root=e;this.data=i.AnimationHandler.init(t);this.hierarchy=i.AnimationHandler.parse(e);this.currentTime=0;this.timeScale=1;this.isPlaying=false;this.loop=true;this.weight=0;this.interpolationType=i.AnimationHandler.LINEAR};i.Animation.prototype.keyTypes=["pos","rot","scl"];i.Animation.prototype.play=function(e,t){this.currentTime=e!==undefined?e:0;this.weight=t!==undefined?t:1;this.isPlaying=true;this.reset();i.AnimationHandler.play(this)};i.Animation.prototype.stop=function(){this.isPlaying=false;i.AnimationHandler.stop(this)};i.Animation.prototype.reset=function(){for(var e=0,t=this.hierarchy.length;e<t;e++){var r=this.hierarchy[e];r.matrixAutoUpdate=true;if(r.animationCache===undefined){r.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}}}if(r.animationCache.animations[this.data.name]===undefined){r.animationCache.animations[this.data.name]={};r.animationCache.animations[this.data.name].prevKey={pos:0,rot:0,scl:0};r.animationCache.animations[this.data.name].nextKey={pos:0,rot:0,scl:0};r.animationCache.animations[this.data.name].originalMatrix=r.matrix}var i=r.animationCache.animations[this.data.name];for(var n=0;n<3;n++){var a=this.keyTypes[n];var o=this.data.hierarchy[e].keys[0];var s=this.getNextKeyWith(a,e,1);while(s.time<this.currentTime&&s.index>o.index){o=s;s=this.getNextKeyWith(a,e,s.index+1)}i.prevKey[a]=o;i.nextKey[a]=s}}};i.Animation.prototype.resetBlendWeights=function(){for(var e=0,t=this.hierarchy.length;e<t;e++){var r=this.hierarchy[e];if(r.animationCache!==undefined){r.animationCache.blending.positionWeight=0;r.animationCache.blending.quaternionWeight=0;r.animationCache.blending.scaleWeight=0}}};i.Animation.prototype.update=function(){var e=[];var t=new i.Vector3;var r=new i.Vector3;var n=new i.Quaternion;var a=function(e,t){var r=[],i=[],n,a,s,l,h,u,f,c,p;n=(e.length-1)*t;a=Math.floor(n);s=n-a;r[0]=a===0?a:a-1;r[1]=a;r[2]=a>e.length-2?a:a+1;r[3]=a>e.length-3?a:a+2;u=e[r[0]];f=e[r[1]];c=e[r[2]];p=e[r[3]];l=s*s;h=s*l;i[0]=o(u[0],f[0],c[0],p[0],s,l,h);i[1]=o(u[1],f[1],c[1],p[1],s,l,h);i[2]=o(u[2],f[2],c[2],p[2],s,l,h);return i};var o=function(e,t,r,i,n,a,o){var s=(r-e)*.5,l=(i-t)*.5;return(2*(t-r)+s+l)*o+(-3*(t-r)-2*s-l)*a+s*n+t};return function(o){if(this.isPlaying===false)return;this.currentTime+=o*this.timeScale;if(this.weight===0)return;var s=this.data.length;if(this.currentTime>s||this.currentTime<0){if(this.loop){this.currentTime%=s;if(this.currentTime<0)this.currentTime+=s;this.reset()}else{this.stop();return}}for(var l=0,h=this.hierarchy.length;l<h;l++){var u=this.hierarchy[l];var f=u.animationCache.animations[this.data.name];var c=u.animationCache.blending;for(var p=0;p<3;p++){var d=this.keyTypes[p];var v=f.prevKey[d];var m=f.nextKey[d];if(this.timeScale>0&&m.time<=this.currentTime||this.timeScale<0&&v.time>=this.currentTime){v=this.data.hierarchy[l].keys[0];m=this.getNextKeyWith(d,l,1);while(m.time<this.currentTime&&m.index>v.index){v=m;m=this.getNextKeyWith(d,l,m.index+1)}f.prevKey[d]=v;f.nextKey[d]=m}u.matrixAutoUpdate=true;u.matrixWorldNeedsUpdate=true;var g=(this.currentTime-v.time)/(m.time-v.time);var y=v[d];var _=m[d];if(g<0)g=0;if(g>1)g=1;if(d==="pos"){if(this.interpolationType===i.AnimationHandler.LINEAR){r.x=y[0]+(_[0]-y[0])*g;r.y=y[1]+(_[1]-y[1])*g;r.z=y[2]+(_[2]-y[2])*g;var x=this.weight/(this.weight+c.positionWeight);u.position.lerp(r,x);c.positionWeight+=this.weight}else if(this.interpolationType===i.AnimationHandler.CATMULLROM||this.interpolationType===i.AnimationHandler.CATMULLROM_FORWARD){e[0]=this.getPrevKeyWith("pos",l,v.index-1)["pos"];e[1]=y;e[2]=_;e[3]=this.getNextKeyWith("pos",l,m.index+1)["pos"];g=g*.33+.33;var b=a(e,g);var x=this.weight/(this.weight+c.positionWeight);c.positionWeight+=this.weight;var w=u.position;w.x=w.x+(b[0]-w.x)*x;w.y=w.y+(b[1]-w.y)*x;w.z=w.z+(b[2]-w.z)*x;if(this.interpolationType===i.AnimationHandler.CATMULLROM_FORWARD){var T=a(e,g*1.01);t.set(T[0],T[1],T[2]);t.sub(w);t.y=0;t.normalize();var S=Math.atan2(t.x,t.z);u.rotation.set(0,S,0)}}}else if(d==="rot"){i.Quaternion.slerp(y,_,n,g);if(c.quaternionWeight===0){u.quaternion.copy(n);c.quaternionWeight=this.weight}else{var x=this.weight/(this.weight+c.quaternionWeight);i.Quaternion.slerp(u.quaternion,n,u.quaternion,x);c.quaternionWeight+=this.weight}}else if(d==="scl"){r.x=y[0]+(_[0]-y[0])*g;r.y=y[1]+(_[1]-y[1])*g;r.z=y[2]+(_[2]-y[2])*g;var x=this.weight/(this.weight+c.scaleWeight);u.scale.lerp(r,x);c.scaleWeight+=this.weight}}}return true}}();i.Animation.prototype.getNextKeyWith=function(e,t,r){var n=this.data.hierarchy[t].keys;if(this.interpolationType===i.AnimationHandler.CATMULLROM||this.interpolationType===i.AnimationHandler.CATMULLROM_FORWARD){r=r<n.length-1?r:n.length-1}else{r=r%n.length}for(;r<n.length;r++){if(n[r][e]!==undefined){return n[r]}}return this.data.hierarchy[t].keys[0]};i.Animation.prototype.getPrevKeyWith=function(e,t,r){var n=this.data.hierarchy[t].keys;if(this.interpolationType===i.AnimationHandler.CATMULLROM||this.interpolationType===i.AnimationHandler.CATMULLROM_FORWARD){r=r>0?r:0}else{r=r>=0?r:r+n.length}for(;r>=0;r--){if(n[r][e]!==undefined){return n[r]}}return this.data.hierarchy[t].keys[n.length-1]};i.KeyFrameAnimation=function(e){this.root=e.node;this.data=i.AnimationHandler.init(e);this.hierarchy=i.AnimationHandler.parse(this.root);this.currentTime=0;this.timeScale=.001;this.isPlaying=false;this.isPaused=true;this.loop=true;for(var t=0,r=this.hierarchy.length;t<r;t++){var n=this.data.hierarchy[t].keys,a=this.data.hierarchy[t].sids,o=this.hierarchy[t];if(n.length&&a){for(var s=0;s<a.length;s++){var l=a[s],h=this.getNextKeyWith(l,t,0);if(h){h.apply(l)}}o.matrixAutoUpdate=false;this.data.hierarchy[t].node.updateMatrix();o.matrixWorldNeedsUpdate=true}}};i.KeyFrameAnimation.prototype.play=function(e){this.currentTime=e!==undefined?e:0;if(this.isPlaying===false){this.isPlaying=true;var t,r=this.hierarchy.length,n,a;for(t=0;t<r;t++){n=this.hierarchy[t];a=this.data.hierarchy[t];if(a.animationCache===undefined){a.animationCache={};a.animationCache.prevKey=null;a.animationCache.nextKey=null;a.animationCache.originalMatrix=n.matrix}var o=this.data.hierarchy[t].keys;if(o.length){a.animationCache.prevKey=o[0];a.animationCache.nextKey=o[1];this.startTime=Math.min(o[0].time,this.startTime);this.endTime=Math.max(o[o.length-1].time,this.endTime)}}this.update(0)}this.isPaused=false;i.AnimationHandler.play(this)};i.KeyFrameAnimation.prototype.stop=function(){this.isPlaying=false;this.isPaused=false;i.AnimationHandler.stop(this);for(var e=0;e<this.data.hierarchy.length;e++){var t=this.hierarchy[e];var r=this.data.hierarchy[e];if(r.animationCache!==undefined){var n=r.animationCache.originalMatrix;n.copy(t.matrix);t.matrix=n;delete r.animationCache}}};i.KeyFrameAnimation.prototype.update=function(e){if(this.isPlaying===false)return;this.currentTime+=e*this.timeScale;var t=this.data.length;if(this.loop===true&&this.currentTime>t){this.currentTime%=t}this.currentTime=Math.min(this.currentTime,t);for(var r=0,i=this.hierarchy.length;r<i;r++){var n=this.hierarchy[r];var a=this.data.hierarchy[r];var o=a.keys,s=a.animationCache;if(o.length){var l=s.prevKey;var h=s.nextKey;if(h.time<=this.currentTime){while(h.time<this.currentTime&&h.index>l.index){l=h;h=o[l.index+1]}s.prevKey=l;s.nextKey=h}if(h.time>=this.currentTime){l.interpolate(h,this.currentTime)}else{l.interpolate(h,h.time)}this.data.hierarchy[r].node.updateMatrix();n.matrixWorldNeedsUpdate=true}}};i.KeyFrameAnimation.prototype.getNextKeyWith=function(e,t,r){var i=this.data.hierarchy[t].keys;r=r%i.length;for(;r<i.length;r++){if(i[r].hasTarget(e)){return i[r]}}return i[0]};i.KeyFrameAnimation.prototype.getPrevKeyWith=function(e,t,r){var i=this.data.hierarchy[t].keys;r=r>=0?r:r+i.length;for(;r>=0;r--){if(i[r].hasTarget(e)){return i[r]}}return i[i.length-1]};i.MorphAnimation=function(e){this.mesh=e;this.frames=e.morphTargetInfluences.length;this.currentTime=0;this.duration=1e3;this.loop=true;this.isPlaying=false};i.MorphAnimation.prototype={play:function(){this.isPlaying=true},pause:function(){this.isPlaying=false},update:function(){var e=0;var t=0;return function(r){if(this.isPlaying===false)return;this.currentTime+=r;if(this.loop===true&&this.currentTime>this.duration){this.currentTime%=this.duration}this.currentTime=Math.min(this.currentTime,this.duration);var i=this.duration/this.frames;var n=Math.floor(this.currentTime/i);if(n!=t){this.mesh.morphTargetInfluences[e]=0;this.mesh.morphTargetInfluences[t]=1;this.mesh.morphTargetInfluences[n]=0;e=t;t=n}this.mesh.morphTargetInfluences[n]=this.currentTime%i/i;this.mesh.morphTargetInfluences[e]=1-this.mesh.morphTargetInfluences[n]}}()};i.BoxGeometry=function(e,t,r,n,a,o){i.Geometry.call(this);this.type="BoxGeometry";this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:a,depthSegments:o};this.widthSegments=n||1;this.heightSegments=a||1;this.depthSegments=o||1;var s=this;var l=e/2;var h=t/2;var u=r/2;f("z","y",-1,-1,r,t,l,0);f("z","y",1,-1,r,t,-l,1);f("x","z",1,1,e,r,h,2);f("x","z",1,-1,e,r,-h,3);f("x","y",1,-1,e,t,u,4);f("x","y",-1,-1,e,t,-u,5);function f(e,t,r,n,a,o,l,h){var u,f,c,p=s.widthSegments,d=s.heightSegments,v=a/2,m=o/2,g=s.vertices.length;if(e==="x"&&t==="y"||e==="y"&&t==="x"){u="z"}else if(e==="x"&&t==="z"||e==="z"&&t==="x"){u="y";d=s.depthSegments}else if(e==="z"&&t==="y"||e==="y"&&t==="z"){u="x";p=s.depthSegments}var y=p+1,_=d+1,x=a/p,b=o/d,w=new i.Vector3;w[u]=l>0?1:-1;for(c=0;c<_;c++){for(f=0;f<y;f++){var T=new i.Vector3;T[e]=(f*x-v)*r;T[t]=(c*b-m)*n;T[u]=l;s.vertices.push(T)}}for(c=0;c<d;c++){for(f=0;f<p;f++){var S=f+y*c;var M=f+y*(c+1);var A=f+1+y*(c+1);var E=f+1+y*c;var C=new i.Vector2(f/p,1-c/d);var P=new i.Vector2(f/p,1-(c+1)/d);var R=new i.Vector2((f+1)/p,1-(c+1)/d);var L=new i.Vector2((f+1)/p,1-c/d);var k=new i.Face3(S+g,M+g,E+g);k.normal.copy(w);k.vertexNormals.push(w.clone(),w.clone(),w.clone());k.materialIndex=h;s.faces.push(k);s.faceVertexUvs[0].push([C,P,L]);k=new i.Face3(M+g,A+g,E+g);k.normal.copy(w);k.vertexNormals.push(w.clone(),w.clone(),w.clone());k.materialIndex=h;s.faces.push(k);s.faceVertexUvs[0].push([P.clone(),R,L.clone()])}}}this.mergeVertices()};i.BoxGeometry.prototype=Object.create(i.Geometry.prototype);i.CircleGeometry=function(e,t,r,n){i.Geometry.call(this);this.type="CircleGeometry";this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n};e=e||50;t=t!==undefined?Math.max(3,t):8;r=r!==undefined?r:0;n=n!==undefined?n:Math.PI*2;var a,o=[],s=new i.Vector3,l=new i.Vector2(.5,.5);this.vertices.push(s);o.push(l);for(a=0;a<=t;a++){var h=new i.Vector3;var u=r+a/t*n;h.x=e*Math.cos(u);h.y=e*Math.sin(u);this.vertices.push(h);o.push(new i.Vector2((h.x/e+1)/2,(h.y/e+1)/2))}var f=new i.Vector3(0,0,1);for(a=1;a<=t;a++){this.faces.push(new i.Face3(a,a+1,0,[f.clone(),f.clone(),f.clone()]));this.faceVertexUvs[0].push([o[a].clone(),o[a+1].clone(),l.clone()])}this.computeFaceNormals();this.boundingSphere=new i.Sphere(new i.Vector3,e)};i.CircleGeometry.prototype=Object.create(i.Geometry.prototype);i.CubeGeometry=function(e,t,r,n,a,o){console.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry.");return new i.BoxGeometry(e,t,r,n,a,o)};i.CylinderGeometry=function(e,t,r,n,a,o){i.Geometry.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:a,openEnded:o};e=e!==undefined?e:20;t=t!==undefined?t:20;r=r!==undefined?r:100;n=n||8;a=a||1;o=o!==undefined?o:false;var s=r/2;var l,h,u=[],f=[];for(h=0;h<=a;h++){var c=[];var p=[];var d=h/a;var v=d*(t-e)+e;for(l=0;l<=n;l++){var m=l/n;var g=new i.Vector3;g.x=v*Math.sin(m*Math.PI*2);g.y=-d*r+s;g.z=v*Math.cos(m*Math.PI*2);this.vertices.push(g);c.push(this.vertices.length-1);p.push(new i.Vector2(m,1-d))}u.push(c);f.push(p)}var y=(t-e)/r;var _,x;for(l=0;l<n;l++){if(e!==0){_=this.vertices[u[0][l]].clone();x=this.vertices[u[0][l+1]].clone()}else{_=this.vertices[u[1][l]].clone();x=this.vertices[u[1][l+1]].clone()}_.setY(Math.sqrt(_.x*_.x+_.z*_.z)*y).normalize();x.setY(Math.sqrt(x.x*x.x+x.z*x.z)*y).normalize();for(h=0;h<a;h++){var b=u[h][l];var w=u[h+1][l];var T=u[h+1][l+1];var S=u[h][l+1];var M=_.clone();var A=_.clone();var E=x.clone();var C=x.clone();var P=f[h][l].clone();var R=f[h+1][l].clone();var L=f[h+1][l+1].clone();var k=f[h][l+1].clone();this.faces.push(new i.Face3(b,w,S,[M,A,C]));this.faceVertexUvs[0].push([P,R,k]);this.faces.push(new i.Face3(w,T,S,[A.clone(),E,C.clone()]));this.faceVertexUvs[0].push([R.clone(),L,k.clone()])}}if(o===false&&e>0){this.vertices.push(new i.Vector3(0,s,0));for(l=0;l<n;l++){var b=u[0][l];var w=u[0][l+1];var T=this.vertices.length-1;var M=new i.Vector3(0,1,0);var A=new i.Vector3(0,1,0);var E=new i.Vector3(0,1,0);var P=f[0][l].clone();var R=f[0][l+1].clone();var L=new i.Vector2(R.x,0);this.faces.push(new i.Face3(b,w,T,[M,A,E]));this.faceVertexUvs[0].push([P,R,L])}}if(o===false&&t>0){this.vertices.push(new i.Vector3(0,-s,0));for(l=0;l<n;l++){var b=u[h][l+1];var w=u[h][l];var T=this.vertices.length-1;var M=new i.Vector3(0,-1,0);var A=new i.Vector3(0,-1,0);var E=new i.Vector3(0,-1,0);var P=f[h][l+1].clone();var R=f[h][l].clone();var L=new i.Vector2(R.x,1);this.faces.push(new i.Face3(b,w,T,[M,A,E]));this.faceVertexUvs[0].push([P,R,L])}}this.computeFaceNormals()};i.CylinderGeometry.prototype=Object.create(i.Geometry.prototype);i.ExtrudeGeometry=function(e,t){if(typeof e==="undefined"){e=[];return}i.Geometry.call(this);this.type="ExtrudeGeometry";e=e instanceof Array?e:[e];this.addShapeList(e,t);this.computeFaceNormals()};i.ExtrudeGeometry.prototype=Object.create(i.Geometry.prototype);i.ExtrudeGeometry.prototype.addShapeList=function(e,t){var r=e.length;for(var i=0;i<r;i++){var n=e[i];this.addShape(n,t)}};i.ExtrudeGeometry.prototype.addShape=function(e,t){var r=t.amount!==undefined?t.amount:100;var n=t.bevelThickness!==undefined?t.bevelThickness:6;var a=t.bevelSize!==undefined?t.bevelSize:n-2;var o=t.bevelSegments!==undefined?t.bevelSegments:3;var s=t.bevelEnabled!==undefined?t.bevelEnabled:true;var l=t.curveSegments!==undefined?t.curveSegments:12;var h=t.steps!==undefined?t.steps:1;var u=t.extrudePath;var f,c=false;var p=t.material;var d=t.extrudeMaterial;var v=t.UVGenerator!==undefined?t.UVGenerator:i.ExtrudeGeometry.WorldUVGenerator;var m,g,y,_;if(u){f=u.getSpacedPoints(h);c=true;s=false;m=t.frames!==undefined?t.frames:new i.TubeGeometry.FrenetFrames(u,h,false);g=new i.Vector3;y=new i.Vector3;_=new i.Vector3}if(!s){o=0;n=0;a=0}var x,b,w;var T=this;var S=[];var M=this.vertices.length;var A=e.extractPoints(l);var E=A.shape;var C=A.holes;var P=!i.Shape.Utils.isClockWise(E);if(P){E=E.reverse();for(b=0,w=C.length;b<w;b++){x=C[b];if(i.Shape.Utils.isClockWise(x)){C[b]=x.reverse()}}P=false}var R=i.Shape.Utils.triangulateShape(E,C);var L=E;for(b=0,w=C.length;b<w;b++){x=C[b];E=E.concat(x)}function k(e,t,r){if(!t)console.log("die");return t.clone().multiplyScalar(r).add(e)}var F,D,U,O,j,V=E.length,N,B=R.length,z,I=L.length;var H=180/Math.PI;function G(e,t,r){var n=1e-10;var a,o,s=1;var l=e.x-t.x,h=e.y-t.y;var u=r.x-e.x,f=r.y-e.y;var c=l*l+h*h;var p=l*f-h*u;if(Math.abs(p)>n){var d=Math.sqrt(c);var v=Math.sqrt(u*u+f*f);var m=t.x-h/d;var g=t.y+l/d;var y=r.x-f/v;var _=r.y+u/v;var x=((y-m)*f-(_-g)*u)/(l*f-h*u);a=m+l*x-e.x;o=g+h*x-e.y;var b=a*a+o*o;if(b<=2){return new i.Vector2(a,o)}else{s=Math.sqrt(b/2)}}else{var w=false;if(l>n){if(u>n){w=true}}else{if(l<-n){if(u<-n){w=true}}else{if(Math.sign(h)==Math.sign(f)){w=true}}}if(w){a=-h;o=l;s=Math.sqrt(c)}else{a=l;o=h;s=Math.sqrt(c/2)}}return new i.Vector2(a/s,o/s)}var W=[];for(var X=0,Y=L.length,q=Y-1,K=X+1;X<Y;X++,q++,K++){if(q===Y)q=0;if(K===Y)K=0;var Z=L[X];var Q=L[q];var $=L[K];W[X]=G(L[X],L[q],L[K])}var J=[],et,tt=W.concat();for(b=0,w=C.length;b<w;b++){x=C[b];et=[];for(X=0,Y=x.length,q=Y-1,K=X+1;X<Y;X++,q++,K++){if(q===Y)q=0;if(K===Y)K=0;et[X]=G(x[X],x[q],x[K])}J.push(et);tt=tt.concat(et)}for(F=0;F<o;F++){U=F/o;O=n*(1-U);D=a*Math.sin(U*Math.PI/2);for(X=0,Y=L.length;X<Y;X++){j=k(L[X],W[X],D);ot(j.x,j.y,-O)}for(b=0,w=C.length;b<w;b++){x=C[b];et=J[b];for(X=0,Y=x.length;X<Y;X++){j=k(x[X],et[X],D);ot(j.x,j.y,-O)}}}D=a;for(X=0;X<V;X++){j=s?k(E[X],tt[X],D):E[X];if(!c){ot(j.x,j.y,0)}else{y.copy(m.normals[0]).multiplyScalar(j.x);g.copy(m.binormals[0]).multiplyScalar(j.y);_.copy(f[0]).add(y).add(g);ot(_.x,_.y,_.z)}}var rt;for(rt=1;rt<=h;rt++){for(X=0;X<V;X++){j=s?k(E[X],tt[X],D):E[X];if(!c){ot(j.x,j.y,r/h*rt)}else{y.copy(m.normals[rt]).multiplyScalar(j.x);g.copy(m.binormals[rt]).multiplyScalar(j.y);_.copy(f[rt]).add(y).add(g);ot(_.x,_.y,_.z)}}}for(F=o-1;F>=0;F--){U=F/o;O=n*(1-U);D=a*Math.sin(U*Math.PI/2);for(X=0,Y=L.length;X<Y;X++){j=k(L[X],W[X],D);ot(j.x,j.y,r+O)}for(b=0,w=C.length;b<w;b++){x=C[b];et=J[b];for(X=0,Y=x.length;X<Y;X++){j=k(x[X],et[X],D);if(!c){ot(j.x,j.y,r+O)}else{ot(j.x,j.y+f[h-1].y,f[h-1].x+O)}}}}it();nt();function it(){if(s){var e=0;var t=V*e;for(X=0;X<B;X++){N=R[X];st(N[2]+t,N[1]+t,N[0]+t)}e=h+o*2;t=V*e;for(X=0;X<B;X++){N=R[X];st(N[0]+t,N[1]+t,N[2]+t)}}else{for(X=0;X<B;X++){N=R[X];st(N[2],N[1],N[0])}for(X=0;X<B;X++){N=R[X];st(N[0]+V*h,N[1]+V*h,N[2]+V*h)}}}function nt(){var e=0;at(L,e);e+=L.length;for(b=0,w=C.length;b<w;b++){x=C[b];at(x,e);e+=x.length}}function at(e,t){var r,i;X=e.length;while(--X>=0){r=X;i=X-1;if(i<0)i=e.length-1;var n=0,a=h+o*2;for(n=0;n<a;n++){var s=V*n;var l=V*(n+1);var u=t+r+s,f=t+i+s,c=t+i+l,p=t+r+l;lt(u,f,c,p,e,n,a,r,i)}}}function ot(e,t,r){T.vertices.push(new i.Vector3(e,t,r))}function st(e,t,r){e+=M;t+=M;r+=M;T.faces.push(new i.Face3(e,t,r,null,null,p));var n=v.generateTopUV(T,e,t,r);T.faceVertexUvs[0].push(n)}function lt(e,t,r,n,a,o,s,l,h){e+=M;t+=M;r+=M;n+=M;T.faces.push(new i.Face3(e,t,n,null,null,d));T.faces.push(new i.Face3(t,r,n,null,null,d));var u=v.generateSideWallUV(T,e,t,r,n);T.faceVertexUvs[0].push([u[0],u[1],u[3]]);T.faceVertexUvs[0].push([u[1],u[2],u[3]])}};i.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,r,n){var a=e.vertices;var o=a[t];var s=a[r];var l=a[n];return[new i.Vector2(o.x,o.y),new i.Vector2(s.x,s.y),new i.Vector2(l.x,l.y)]},generateSideWallUV:function(e,t,r,n,a){var o=e.vertices;var s=o[t];var l=o[r];var h=o[n];var u=o[a];if(Math.abs(s.y-l.y)<.01){return[new i.Vector2(s.x,1-s.z),new i.Vector2(l.x,1-l.z),new i.Vector2(h.x,1-h.z),new i.Vector2(u.x,1-u.z)]}else{return[new i.Vector2(s.y,1-s.z),new i.Vector2(l.y,1-l.z),new i.Vector2(h.y,1-h.z),new i.Vector2(u.y,1-u.z)]}}};i.ShapeGeometry=function(e,t){i.Geometry.call(this);this.type="ShapeGeometry";if(e instanceof Array===false)e=[e];this.addShapeList(e,t);this.computeFaceNormals()};i.ShapeGeometry.prototype=Object.create(i.Geometry.prototype);i.ShapeGeometry.prototype.addShapeList=function(e,t){for(var r=0,i=e.length;r<i;r++){this.addShape(e[r],t)}return this};i.ShapeGeometry.prototype.addShape=function(e,t){if(t===undefined)t={};var r=t.curveSegments!==undefined?t.curveSegments:12;var n=t.material;var a=t.UVGenerator===undefined?i.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator;var o,s,l,h;var u=this.vertices.length;var f=e.extractPoints(r);var c=f.shape;var p=f.holes;var d=!i.Shape.Utils.isClockWise(c);if(d){c=c.reverse();for(o=0,s=p.length;o<s;o++){l=p[o];if(i.Shape.Utils.isClockWise(l)){p[o]=l.reverse()}}d=false}var v=i.Shape.Utils.triangulateShape(c,p);var m=c;for(o=0,s=p.length;o<s;o++){l=p[o];c=c.concat(l)}var g,y=c.length;var _,x=v.length;var b,w=m.length;for(o=0;o<y;o++){g=c[o];this.vertices.push(new i.Vector3(g.x,g.y,0))}for(o=0;o<x;o++){_=v[o];var T=_[0]+u;var S=_[1]+u;var M=_[2]+u;this.faces.push(new i.Face3(T,S,M,null,null,n));this.faceVertexUvs[0].push(a.generateTopUV(this,T,S,M))}};i.LatheGeometry=function(e,t,r,n){i.Geometry.call(this);this.type="LatheGeometry";this.parameters={points:e,segments:t,phiStart:r,phiLength:n};t=t||12;r=r||0;n=n||2*Math.PI;var a=1/(e.length-1);var o=1/t;for(var s=0,l=t;s<=l;s++){var h=r+s*o*n;var u=Math.cos(h),f=Math.sin(h);for(var c=0,p=e.length;c<p;c++){var d=e[c];var v=new i.Vector3;v.x=u*d.x-f*d.y;v.y=f*d.x+u*d.y;v.z=d.z;this.vertices.push(v)}}var m=e.length;for(var s=0,l=t;s<l;s++){for(var c=0,p=e.length-1;c<p;c++){var g=c+m*s;var y=g;var _=g+m;var u=g+1+m;var x=g+1;var b=s*o;var w=c*a;var T=b+o;var S=w+a;this.faces.push(new i.Face3(y,_,x));this.faceVertexUvs[0].push([new i.Vector2(b,w),new i.Vector2(T,w),new i.Vector2(b,S)]);this.faces.push(new i.Face3(_,u,x));this.faceVertexUvs[0].push([new i.Vector2(T,w),new i.Vector2(T,S),new i.Vector2(b,S)])}}this.mergeVertices();this.computeFaceNormals();this.computeVertexNormals()};i.LatheGeometry.prototype=Object.create(i.Geometry.prototype);i.PlaneGeometry=function(e,t,r,n){console.info("THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint.");i.Geometry.call(this);this.type="PlaneGeometry";this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};this.fromBufferGeometry(new i.PlaneBufferGeometry(e,t,r,n))};i.PlaneGeometry.prototype=Object.create(i.Geometry.prototype);i.PlaneBufferGeometry=function(e,t,r,n){i.BufferGeometry.call(this);this.type="PlaneBufferGeometry";this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};var a=e/2;var o=t/2;var s=r||1;var l=n||1;var h=s+1;var u=l+1;var f=e/s;var c=t/l;var p=new Float32Array(h*u*3);var d=new Float32Array(h*u*3);var v=new Float32Array(h*u*2);var m=0;var g=0;for(var y=0;y<u;y++){var _=y*c-o;for(var x=0;x<h;x++){var b=x*f-a;p[m]=b;p[m+1]=-_;d[m+2]=1;v[g]=x/s;v[g+1]=1-y/l;m+=3;g+=2}}m=0;var w=new(p.length/3>65535?Uint32Array:Uint16Array)(s*l*6);for(var y=0;y<l;y++){for(var x=0;x<s;x++){var T=x+h*y;var S=x+h*(y+1);var M=x+1+h*(y+1);var A=x+1+h*y;w[m]=T;w[m+1]=S;w[m+2]=A;w[m+3]=S;w[m+4]=M;w[m+5]=A;m+=6}}this.addAttribute("index",new i.BufferAttribute(w,1));this.addAttribute("position",new i.BufferAttribute(p,3));this.addAttribute("normal",new i.BufferAttribute(d,3));this.addAttribute("uv",new i.BufferAttribute(v,2))};i.PlaneBufferGeometry.prototype=Object.create(i.BufferGeometry.prototype);i.RingGeometry=function(e,t,r,n,a,o){i.Geometry.call(this);this.type="RingGeometry";this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:a,thetaLength:o};e=e||0;t=t||50;a=a!==undefined?a:0;o=o!==undefined?o:Math.PI*2;r=r!==undefined?Math.max(3,r):8;n=n!==undefined?Math.max(1,n):8;var s,l,h=[],u=e,f=(t-e)/n;for(s=0;s<n+1;s++){for(l=0;l<r+1;l++){var c=new i.Vector3;var p=a+l/r*o;c.x=u*Math.cos(p);c.y=u*Math.sin(p);this.vertices.push(c);h.push(new i.Vector2((c.x/t+1)/2,(c.y/t+1)/2))}u+=f}var d=new i.Vector3(0,0,1);for(s=0;s<n;s++){var v=s*(r+1);for(l=0;l<r;l++){var p=l+v;var m=p;var g=p+r+1;var y=p+r+2;this.faces.push(new i.Face3(m,g,y,[d.clone(),d.clone(),d.clone()]));this.faceVertexUvs[0].push([h[m].clone(),h[g].clone(),h[y].clone()]);m=p;g=p+r+2;y=p+1;this.faces.push(new i.Face3(m,g,y,[d.clone(),d.clone(),d.clone()]));this.faceVertexUvs[0].push([h[m].clone(),h[g].clone(),h[y].clone()])}}this.computeFaceNormals();this.boundingSphere=new i.Sphere(new i.Vector3,u)};i.RingGeometry.prototype=Object.create(i.Geometry.prototype);i.SphereGeometry=function(e,t,r,n,a,o,s){i.Geometry.call(this);this.type="SphereGeometry";this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:a,thetaStart:o,thetaLength:s};e=e||50;t=Math.max(3,Math.floor(t)||8);r=Math.max(2,Math.floor(r)||6);n=n!==undefined?n:0;a=a!==undefined?a:Math.PI*2;o=o!==undefined?o:0;s=s!==undefined?s:Math.PI;var l,h,u=[],f=[];for(h=0;h<=r;h++){var c=[];var p=[];for(l=0;l<=t;l++){var d=l/t;var v=h/r;var m=new i.Vector3;m.x=-e*Math.cos(n+d*a)*Math.sin(o+v*s);m.y=e*Math.cos(o+v*s);m.z=e*Math.sin(n+d*a)*Math.sin(o+v*s);this.vertices.push(m);c.push(this.vertices.length-1);p.push(new i.Vector2(d,1-v))}u.push(c);f.push(p)}for(h=0;h<r;h++){for(l=0;l<t;l++){var g=u[h][l+1];var y=u[h][l];var _=u[h+1][l];var x=u[h+1][l+1];var b=this.vertices[g].clone().normalize();var w=this.vertices[y].clone().normalize();var T=this.vertices[_].clone().normalize();var S=this.vertices[x].clone().normalize();var M=f[h][l+1].clone();var A=f[h][l].clone();var E=f[h+1][l].clone();var C=f[h+1][l+1].clone();if(Math.abs(this.vertices[g].y)===e){M.x=(M.x+A.x)/2;this.faces.push(new i.Face3(g,_,x,[b,T,S]));this.faceVertexUvs[0].push([M,E,C])}else if(Math.abs(this.vertices[_].y)===e){E.x=(E.x+C.x)/2;this.faces.push(new i.Face3(g,y,_,[b,w,T]));this.faceVertexUvs[0].push([M,A,E])}else{this.faces.push(new i.Face3(g,y,x,[b,w,S]));this.faceVertexUvs[0].push([M,A,C]);this.faces.push(new i.Face3(y,_,x,[w.clone(),T,S.clone()]));this.faceVertexUvs[0].push([A.clone(),E,C.clone()])}}}this.computeFaceNormals();this.boundingSphere=new i.Sphere(new i.Vector3,e)};i.SphereGeometry.prototype=Object.create(i.Geometry.prototype);i.TextGeometry=function(e,t){t=t||{};var r=i.FontUtils.generateShapes(e,t);t.amount=t.height!==undefined?t.height:50;if(t.bevelThickness===undefined)t.bevelThickness=10;if(t.bevelSize===undefined)t.bevelSize=8;if(t.bevelEnabled===undefined)t.bevelEnabled=false;i.ExtrudeGeometry.call(this,r,t);this.type="TextGeometry"};i.TextGeometry.prototype=Object.create(i.ExtrudeGeometry.prototype);i.TorusGeometry=function(e,t,r,n,a){i.Geometry.call(this);this.type="TorusGeometry";this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:a};e=e||100;t=t||40;r=r||8;n=n||6;a=a||Math.PI*2;var o=new i.Vector3,s=[],l=[];for(var h=0;h<=r;h++){for(var u=0;u<=n;u++){var f=u/n*a;var c=h/r*Math.PI*2;o.x=e*Math.cos(f);o.y=e*Math.sin(f);var p=new i.Vector3;p.x=(e+t*Math.cos(c))*Math.cos(f);p.y=(e+t*Math.cos(c))*Math.sin(f);p.z=t*Math.sin(c);this.vertices.push(p);s.push(new i.Vector2(u/n,h/r));l.push(p.clone().sub(o).normalize())}}for(var h=1;h<=r;h++){for(var u=1;u<=n;u++){var d=(n+1)*h+u-1;var v=(n+1)*(h-1)+u-1;var m=(n+1)*(h-1)+u;var g=(n+1)*h+u;var y=new i.Face3(d,v,g,[l[d].clone(),l[v].clone(),l[g].clone()]);this.faces.push(y);this.faceVertexUvs[0].push([s[d].clone(),s[v].clone(),s[g].clone()]);y=new i.Face3(v,m,g,[l[v].clone(),l[m].clone(),l[g].clone()]);this.faces.push(y);this.faceVertexUvs[0].push([s[v].clone(),s[m].clone(),s[g].clone()])}}this.computeFaceNormals()};i.TorusGeometry.prototype=Object.create(i.Geometry.prototype);i.TorusKnotGeometry=function(e,t,r,n,a,o,s){i.Geometry.call(this);this.type="TorusKnotGeometry";this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,p:a,q:o,heightScale:s};e=e||100;t=t||40;r=r||64;n=n||8;a=a||2;o=o||3;s=s||1;var l=new Array(r);var h=new i.Vector3;var u=new i.Vector3;var f=new i.Vector3;for(var c=0;c<r;++c){l[c]=new Array(n);var p=c/r*2*a*Math.PI;var d=L(p,o,a,e,s);var v=L(p+.01,o,a,e,s);h.subVectors(v,d);u.addVectors(v,d);f.crossVectors(h,u);u.crossVectors(f,h);f.normalize();u.normalize();for(var m=0;m<n;++m){var g=m/n*2*Math.PI;var y=-t*Math.cos(g);var _=t*Math.sin(g);var x=new i.Vector3;x.x=d.x+y*u.x+_*f.x;x.y=d.y+y*u.y+_*f.y;x.z=d.z+y*u.z+_*f.z;l[c][m]=this.vertices.push(x)-1}}for(var c=0;c<r;++c){for(var m=0;m<n;++m){var b=(c+1)%r;var w=(m+1)%n;var T=l[c][m];var S=l[b][m];var M=l[b][w];var A=l[c][w];var E=new i.Vector2(c/r,m/n);var C=new i.Vector2((c+1)/r,m/n);var P=new i.Vector2((c+1)/r,(m+1)/n);var R=new i.Vector2(c/r,(m+1)/n);this.faces.push(new i.Face3(T,S,A));this.faceVertexUvs[0].push([E,C,R]);this.faces.push(new i.Face3(S,M,A));this.faceVertexUvs[0].push([C.clone(),P,R.clone()])}}this.computeFaceNormals();this.computeVertexNormals();function L(e,t,r,n,a){var o=Math.cos(e);var s=Math.sin(e);var l=t/r*e;var h=Math.cos(l);var u=n*(2+h)*.5*o;var f=n*(2+h)*s*.5;var c=a*n*Math.sin(l)*.5;return new i.Vector3(u,f,c)}};i.TorusKnotGeometry.prototype=Object.create(i.Geometry.prototype);i.TubeGeometry=function(e,t,r,n,a){i.Geometry.call(this);this.type="TubeGeometry";this.parameters={path:e,segments:t,radius:r,radialSegments:n,closed:a};t=t||64;r=r||1;n=n||8;a=a||false;var o=[];var s=this,l,h,u,f=t+1,c,p,d,v,m,g,y,_,x,b,w,T=new i.Vector3,S,M,A,E,C,P,R,L,k,F,D,U;var O=new i.TubeGeometry.FrenetFrames(e,t,a),j=O.tangents,V=O.normals,N=O.binormals;this.tangents=j;this.normals=V;this.binormals=N;function B(e,t,r){return s.vertices.push(new i.Vector3(e,t,r))-1}for(S=0;S<f;S++){o[S]=[];y=S/(f-1);w=e.getPointAt(y);l=j[S];h=V[S];u=N[S];for(M=0;M<n;M++){_=M/n*2*Math.PI;x=-r*Math.cos(_);b=r*Math.sin(_);T.copy(w);T.x+=x*h.x+b*u.x;T.y+=x*h.y+b*u.y;T.z+=x*h.z+b*u.z;o[S][M]=B(T.x,T.y,T.z)}}for(S=0;S<t;S++){for(M=0;M<n;M++){A=a?(S+1)%t:S+1;E=(M+1)%n;C=o[S][M];P=o[A][M];R=o[A][E];L=o[S][E];k=new i.Vector2(S/t,M/n);F=new i.Vector2((S+1)/t,M/n);D=new i.Vector2((S+1)/t,(M+1)/n);U=new i.Vector2(S/t,(M+1)/n);this.faces.push(new i.Face3(C,P,L));this.faceVertexUvs[0].push([k,F,U]);this.faces.push(new i.Face3(P,R,L));this.faceVertexUvs[0].push([F.clone(),D,U.clone()])}}this.computeFaceNormals();this.computeVertexNormals()};i.TubeGeometry.prototype=Object.create(i.Geometry.prototype);i.TubeGeometry.FrenetFrames=function(e,t,r){var n=new i.Vector3,a=new i.Vector3,o=new i.Vector3,s=[],l=[],h=[],u=new i.Vector3,f=new i.Matrix4,c=t+1,p,d=1e-4,v,m,g,y,_,x,b;this.tangents=s;this.normals=l;this.binormals=h;for(_=0;_<c;_++){x=_/(c-1);s[_]=e.getTangentAt(x);s[_].normalize()}w();function w(){l[0]=new i.Vector3;h[0]=new i.Vector3;v=Number.MAX_VALUE;m=Math.abs(s[0].x);g=Math.abs(s[0].y);y=Math.abs(s[0].z);if(m<=v){v=m;a.set(1,0,0)}if(g<=v){v=g;a.set(0,1,0)}if(y<=v){a.set(0,0,1)}u.crossVectors(s[0],a).normalize();l[0].crossVectors(s[0],u);h[0].crossVectors(s[0],l[0])}for(_=1;_<c;_++){l[_]=l[_-1].clone();h[_]=h[_-1].clone();u.crossVectors(s[_-1],s[_]);if(u.length()>d){u.normalize();p=Math.acos(i.Math.clamp(s[_-1].dot(s[_]),-1,1));l[_].applyMatrix4(f.makeRotationAxis(u,p))}h[_].crossVectors(s[_],l[_])}if(r){p=Math.acos(i.Math.clamp(l[0].dot(l[c-1]),-1,1));p/=c-1;if(s[0].dot(u.crossVectors(l[0],l[c-1]))>0){p=-p}for(_=1;_<c;_++){l[_].applyMatrix4(f.makeRotationAxis(s[_],p*_));h[_].crossVectors(s[_],l[_])}}};i.PolyhedronGeometry=function(e,t,r,n){i.Geometry.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:e,indices:t,radius:r,detail:n};r=r||1;n=n||0;var a=this;for(var o=0,s=e.length;o<s;o+=3){w(new i.Vector3(e[o],e[o+1],e[o+2]))}var l=[],h=this.vertices;var u=[];for(var o=0,f=0,s=t.length;o<s;o+=3,f++){var c=h[t[o]];var p=h[t[o+1]];var d=h[t[o+2]];u[f]=new i.Face3(c.index,p.index,d.index,[c.clone(),p.clone(),d.clone()])}var v=new i.Vector3;for(var o=0,s=u.length;o<s;o++){S(u[o],n)}for(var o=0,s=this.faceVertexUvs[0].length;o<s;o++){var m=this.faceVertexUvs[0][o];var g=m[0].x;var y=m[1].x;var _=m[2].x;var x=Math.max(g,Math.max(y,_));var b=Math.min(g,Math.min(y,_));if(x>.9&&b<.1){if(g<.2)m[0].x+=1;if(y<.2)m[1].x+=1;if(_<.2)m[2].x+=1}}for(var o=0,s=this.vertices.length;o<s;o++){this.vertices[o].multiplyScalar(r)}this.mergeVertices();this.computeFaceNormals();this.boundingSphere=new i.Sphere(new i.Vector3,r);function w(e){var t=e.normalize().clone();t.index=a.vertices.push(t)-1;var r=M(e)/2/Math.PI+.5;var n=A(e)/Math.PI+.5;t.uv=new i.Vector2(r,1-n);return t}function T(e,t,r){var n=new i.Face3(e.index,t.index,r.index,[e.clone(),t.clone(),r.clone()]);a.faces.push(n);v.copy(e).add(t).add(r).divideScalar(3);var o=M(v);a.faceVertexUvs[0].push([E(e.uv,e,o),E(t.uv,t,o),E(r.uv,r,o)])}function S(e,t){var r=Math.pow(2,t);var i=Math.pow(4,t);var n=w(a.vertices[e.a]);var o=w(a.vertices[e.b]);var s=w(a.vertices[e.c]);var l=[];for(var h=0;h<=r;h++){l[h]=[];var u=w(n.clone().lerp(s,h/r));var f=w(o.clone().lerp(s,h/r));var c=r-h;
for(var p=0;p<=c;p++){if(p==0&&h==r){l[h][p]=u}else{l[h][p]=w(u.clone().lerp(f,p/c))}}}for(var h=0;h<r;h++){for(var p=0;p<2*(r-h)-1;p++){var d=Math.floor(p/2);if(p%2==0){T(l[h][d+1],l[h+1][d],l[h][d])}else{T(l[h][d+1],l[h+1][d+1],l[h+1][d])}}}}function M(e){return Math.atan2(e.z,-e.x)}function A(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}function E(e,t,r){if(r<0&&e.x===1)e=new i.Vector2(e.x-1,e.y);if(t.x===0&&t.z===0)e=new i.Vector2(r/2/Math.PI+.5,e.y);return e.clone()}};i.PolyhedronGeometry.prototype=Object.create(i.Geometry.prototype);i.DodecahedronGeometry=function(e,t){this.parameters={radius:e,detail:t};var r=(1+Math.sqrt(5))/2;var n=1/r;var a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n];var o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];i.PolyhedronGeometry.call(this,a,o,e,t)};i.DodecahedronGeometry.prototype=Object.create(i.Geometry.prototype);i.IcosahedronGeometry=function(e,t){var r=(1+Math.sqrt(5))/2;var n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1];var a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];i.PolyhedronGeometry.call(this,n,a,e,t);this.type="IcosahedronGeometry";this.parameters={radius:e,detail:t}};i.IcosahedronGeometry.prototype=Object.create(i.Geometry.prototype);i.OctahedronGeometry=function(e,t){this.parameters={radius:e,detail:t};var r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1];var n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];i.PolyhedronGeometry.call(this,r,n,e,t);this.type="OctahedronGeometry";this.parameters={radius:e,detail:t}};i.OctahedronGeometry.prototype=Object.create(i.Geometry.prototype);i.TetrahedronGeometry=function(e,t){var r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1];var n=[2,1,0,0,3,2,1,3,0,2,3,1];i.PolyhedronGeometry.call(this,r,n,e,t);this.type="TetrahedronGeometry";this.parameters={radius:e,detail:t}};i.TetrahedronGeometry.prototype=Object.create(i.Geometry.prototype);i.ParametricGeometry=function(e,t,r){i.Geometry.call(this);this.type="ParametricGeometry";this.parameters={func:e,slices:t,stacks:r};var n=this.vertices;var a=this.faces;var o=this.faceVertexUvs[0];var s,l,h,u;var f,c;var p=r+1;var d=t+1;for(s=0;s<=r;s++){c=s/r;for(h=0;h<=t;h++){f=h/t;u=e(f,c);n.push(u)}}var v,m,g,y;var _,x,b,w;for(s=0;s<r;s++){for(h=0;h<t;h++){v=s*d+h;m=s*d+h+1;g=(s+1)*d+h+1;y=(s+1)*d+h;_=new i.Vector2(h/t,s/r);x=new i.Vector2((h+1)/t,s/r);b=new i.Vector2((h+1)/t,(s+1)/r);w=new i.Vector2(h/t,(s+1)/r);a.push(new i.Face3(v,m,y));o.push([_,x,w]);a.push(new i.Face3(m,g,y));o.push([x.clone(),b,w.clone()])}}this.computeFaceNormals();this.computeVertexNormals()};i.ParametricGeometry.prototype=Object.create(i.Geometry.prototype);i.AxisHelper=function(e){e=e||1;var t=new Float32Array([0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e]);var r=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]);var n=new i.BufferGeometry;n.addAttribute("position",new i.BufferAttribute(t,3));n.addAttribute("color",new i.BufferAttribute(r,3));var a=new i.LineBasicMaterial({vertexColors:i.VertexColors});i.Line.call(this,n,a,i.LinePieces)};i.AxisHelper.prototype=Object.create(i.Line.prototype);i.ArrowHelper=function(){var e=new i.Geometry;e.vertices.push(new i.Vector3(0,0,0),new i.Vector3(0,1,0));var t=new i.CylinderGeometry(0,.5,1,5,1);t.applyMatrix((new i.Matrix4).makeTranslation(0,-.5,0));return function(r,n,a,o,s,l){i.Object3D.call(this);if(o===undefined)o=16776960;if(a===undefined)a=1;if(s===undefined)s=.2*a;if(l===undefined)l=.2*s;this.position.copy(n);this.line=new i.Line(e,new i.LineBasicMaterial({color:o}));this.line.matrixAutoUpdate=false;this.add(this.line);this.cone=new i.Mesh(t,new i.MeshBasicMaterial({color:o}));this.cone.matrixAutoUpdate=false;this.add(this.cone);this.setDirection(r);this.setLength(a,s,l)}}();i.ArrowHelper.prototype=Object.create(i.Object3D.prototype);i.ArrowHelper.prototype.setDirection=function(){var e=new i.Vector3;var t;return function(r){if(r.y>.99999){this.quaternion.set(0,0,0,1)}else if(r.y<-.99999){this.quaternion.set(1,0,0,0)}else{e.set(r.z,0,-r.x).normalize();t=Math.acos(r.y);this.quaternion.setFromAxisAngle(e,t)}}}();i.ArrowHelper.prototype.setLength=function(e,t,r){if(t===undefined)t=.2*e;if(r===undefined)r=.2*t;this.line.scale.set(1,e,1);this.line.updateMatrix();this.cone.scale.set(r,t,r);this.cone.position.y=e;this.cone.updateMatrix()};i.ArrowHelper.prototype.setColor=function(e){this.line.material.color.set(e);this.cone.material.color.set(e)};i.BoxHelper=function(e){var t=new i.BufferGeometry;t.addAttribute("position",new i.BufferAttribute(new Float32Array(72),3));i.Line.call(this,t,new i.LineBasicMaterial({color:16776960}),i.LinePieces);if(e!==undefined){this.update(e)}};i.BoxHelper.prototype=Object.create(i.Line.prototype);i.BoxHelper.prototype.update=function(e){var t=e.geometry;if(t.boundingBox===null){t.computeBoundingBox()}var r=t.boundingBox.min;var i=t.boundingBox.max;var n=this.geometry.attributes.position.array;n[0]=i.x;n[1]=i.y;n[2]=i.z;n[3]=r.x;n[4]=i.y;n[5]=i.z;n[6]=r.x;n[7]=i.y;n[8]=i.z;n[9]=r.x;n[10]=r.y;n[11]=i.z;n[12]=r.x;n[13]=r.y;n[14]=i.z;n[15]=i.x;n[16]=r.y;n[17]=i.z;n[18]=i.x;n[19]=r.y;n[20]=i.z;n[21]=i.x;n[22]=i.y;n[23]=i.z;n[24]=i.x;n[25]=i.y;n[26]=r.z;n[27]=r.x;n[28]=i.y;n[29]=r.z;n[30]=r.x;n[31]=i.y;n[32]=r.z;n[33]=r.x;n[34]=r.y;n[35]=r.z;n[36]=r.x;n[37]=r.y;n[38]=r.z;n[39]=i.x;n[40]=r.y;n[41]=r.z;n[42]=i.x;n[43]=r.y;n[44]=r.z;n[45]=i.x;n[46]=i.y;n[47]=r.z;n[48]=i.x;n[49]=i.y;n[50]=i.z;n[51]=i.x;n[52]=i.y;n[53]=r.z;n[54]=r.x;n[55]=i.y;n[56]=i.z;n[57]=r.x;n[58]=i.y;n[59]=r.z;n[60]=r.x;n[61]=r.y;n[62]=i.z;n[63]=r.x;n[64]=r.y;n[65]=r.z;n[66]=i.x;n[67]=r.y;n[68]=i.z;n[69]=i.x;n[70]=r.y;n[71]=r.z;this.geometry.attributes.position.needsUpdate=true;this.geometry.computeBoundingSphere();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false};i.BoundingBoxHelper=function(e,t){var r=t!==undefined?t:8947848;this.object=e;this.box=new i.Box3;i.Mesh.call(this,new i.BoxGeometry(1,1,1),new i.MeshBasicMaterial({color:r,wireframe:true}))};i.BoundingBoxHelper.prototype=Object.create(i.Mesh.prototype);i.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};i.CameraHelper=function(e){var t=new i.Geometry;var r=new i.LineBasicMaterial({color:16777215,vertexColors:i.FaceColors});var n={};var a=16755200;var o=16711680;var s=43775;var l=16777215;var h=3355443;u("n1","n2",a);u("n2","n4",a);u("n4","n3",a);u("n3","n1",a);u("f1","f2",a);u("f2","f4",a);u("f4","f3",a);u("f3","f1",a);u("n1","f1",a);u("n2","f2",a);u("n3","f3",a);u("n4","f4",a);u("p","n1",o);u("p","n2",o);u("p","n3",o);u("p","n4",o);u("u1","u2",s);u("u2","u3",s);u("u3","u1",s);u("c","t",l);u("p","c",h);u("cn1","cn2",h);u("cn3","cn4",h);u("cf1","cf2",h);u("cf3","cf4",h);function u(e,t,r){f(e,r);f(t,r)}function f(e,r){t.vertices.push(new i.Vector3);t.colors.push(new i.Color(r));if(n[e]===undefined){n[e]=[]}n[e].push(t.vertices.length-1)}i.Line.call(this,t,r,i.LinePieces);this.camera=e;this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.pointMap=n;this.update()};i.CameraHelper.prototype=Object.create(i.Line.prototype);i.CameraHelper.prototype.update=function(){var e,t;var r=new i.Vector3;var n=new i.Camera;var a=function(i,a,o,s){r.set(a,o,s).unproject(n);var l=t[i];if(l!==undefined){for(var h=0,u=l.length;h<u;h++){e.vertices[l[h]].copy(r)}}};return function(){e=this.geometry;t=this.pointMap;var r=1,i=1;n.projectionMatrix.copy(this.camera.projectionMatrix);a("c",0,0,-1);a("t",0,0,1);a("n1",-r,-i,-1);a("n2",r,-i,-1);a("n3",-r,i,-1);a("n4",r,i,-1);a("f1",-r,-i,1);a("f2",r,-i,1);a("f3",-r,i,1);a("f4",r,i,1);a("u1",r*.7,i*1.1,-1);a("u2",-r*.7,i*1.1,-1);a("u3",0,i*2,-1);a("cf1",-r,0,1);a("cf2",r,0,1);a("cf3",0,-i,1);a("cf4",0,i,1);a("cn1",-r,0,-1);a("cn2",r,0,-1);a("cn3",0,-i,-1);a("cn4",0,i,-1);e.verticesNeedUpdate=true}}();i.DirectionalLightHelper=function(e,t){i.Object3D.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;t=t||1;var r=new i.Geometry;r.vertices.push(new i.Vector3(-t,t,0),new i.Vector3(t,t,0),new i.Vector3(t,-t,0),new i.Vector3(-t,-t,0),new i.Vector3(-t,t,0));var n=new i.LineBasicMaterial({fog:false});n.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new i.Line(r,n);this.add(this.lightPlane);r=new i.Geometry;r.vertices.push(new i.Vector3,new i.Vector3);n=new i.LineBasicMaterial({fog:false});n.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new i.Line(r,n);this.add(this.targetLine);this.update()};i.DirectionalLightHelper.prototype=Object.create(i.Object3D.prototype);i.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};i.DirectionalLightHelper.prototype.update=function(){var e=new i.Vector3;var t=new i.Vector3;var r=new i.Vector3;return function(){e.setFromMatrixPosition(this.light.matrixWorld);t.setFromMatrixPosition(this.light.target.matrixWorld);r.subVectors(t,e);this.lightPlane.lookAt(r);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(r);this.targetLine.geometry.verticesNeedUpdate=true;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();i.EdgesHelper=function(e,t){var r=t!==undefined?t:16777215;var n=[0,0],a={};var o=function(e,t){return e-t};var s=["a","b","c"];var l=new i.BufferGeometry;var h=e.geometry.clone();h.mergeVertices();h.computeFaceNormals();var u=h.vertices;var f=h.faces;var c=0;for(var p=0,d=f.length;p<d;p++){var v=f[p];for(var m=0;m<3;m++){n[0]=v[s[m]];n[1]=v[s[(m+1)%3]];n.sort(o);var g=n.toString();if(a[g]===undefined){a[g]={vert1:n[0],vert2:n[1],face1:p,face2:undefined};c++}else{a[g].face2=p}}}var y=new Float32Array(c*2*3);var _=0;for(var g in a){var x=a[g];if(x.face2===undefined||f[x.face1].normal.dot(f[x.face2].normal)<.9999){var b=u[x.vert1];y[_++]=b.x;y[_++]=b.y;y[_++]=b.z;b=u[x.vert2];y[_++]=b.x;y[_++]=b.y;y[_++]=b.z}}l.addAttribute("position",new i.BufferAttribute(y,3));i.Line.call(this,l,new i.LineBasicMaterial({color:r}),i.LinePieces);this.matrix=e.matrixWorld;this.matrixAutoUpdate=false};i.EdgesHelper.prototype=Object.create(i.Line.prototype);i.FaceNormalsHelper=function(e,t,r,n){this.object=e;this.size=t!==undefined?t:1;var a=r!==undefined?r:16776960;var o=n!==undefined?n:1;var s=new i.Geometry;var l=this.object.geometry.faces;for(var h=0,u=l.length;h<u;h++){s.vertices.push(new i.Vector3,new i.Vector3)}i.Line.call(this,s,new i.LineBasicMaterial({color:a,linewidth:o}),i.LinePieces);this.matrixAutoUpdate=false;this.normalMatrix=new i.Matrix3;this.update()};i.FaceNormalsHelper.prototype=Object.create(i.Line.prototype);i.FaceNormalsHelper.prototype.update=function(){var e=this.geometry.vertices;var t=this.object;var r=t.geometry.vertices;var i=t.geometry.faces;var n=t.matrixWorld;t.updateMatrixWorld(true);this.normalMatrix.getNormalMatrix(n);for(var a=0,o=0,s=i.length;a<s;a++,o+=2){var l=i[a];e[o].copy(r[l.a]).add(r[l.b]).add(r[l.c]).divideScalar(3).applyMatrix4(n);e[o+1].copy(l.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(e[o])}this.geometry.verticesNeedUpdate=true;return this};i.GridHelper=function(e,t){var r=new i.Geometry;var n=new i.LineBasicMaterial({vertexColors:i.VertexColors});this.color1=new i.Color(4473924);this.color2=new i.Color(8947848);for(var a=-e;a<=e;a+=t){r.vertices.push(new i.Vector3(-e,0,a),new i.Vector3(e,0,a),new i.Vector3(a,0,-e),new i.Vector3(a,0,e));var o=a===0?this.color1:this.color2;r.colors.push(o,o,o,o)}i.Line.call(this,r,n,i.LinePieces)};i.GridHelper.prototype=Object.create(i.Line.prototype);i.GridHelper.prototype.setColors=function(e,t){this.color1.set(e);this.color2.set(t);this.geometry.colorsNeedUpdate=true};i.HemisphereLightHelper=function(e,t,r,n){i.Object3D.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.colors=[new i.Color,new i.Color];var a=new i.SphereGeometry(t,4,2);a.applyMatrix((new i.Matrix4).makeRotationX(-Math.PI/2));for(var o=0,s=8;o<s;o++){a.faces[o].color=this.colors[o<4?0:1]}var l=new i.MeshBasicMaterial({vertexColors:i.FaceColors,wireframe:true});this.lightSphere=new i.Mesh(a,l);this.add(this.lightSphere);this.update()};i.HemisphereLightHelper.prototype=Object.create(i.Object3D.prototype);i.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose()};i.HemisphereLightHelper.prototype.update=function(){var e=new i.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=true}}();i.PointLightHelper=function(e,t){this.light=e;this.light.updateMatrixWorld();var r=new i.SphereGeometry(t,4,2);var n=new i.MeshBasicMaterial({wireframe:true,fog:false});n.color.copy(this.light.color).multiplyScalar(this.light.intensity);i.Mesh.call(this,r,n);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=false};i.PointLightHelper.prototype=Object.create(i.Mesh.prototype);i.PointLightHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};i.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};i.SkeletonHelper=function(e){this.bones=this.getBoneList(e);var t=new i.Geometry;for(var r=0;r<this.bones.length;r++){var n=this.bones[r];if(n.parent instanceof i.Bone){t.vertices.push(new i.Vector3);t.vertices.push(new i.Vector3);t.colors.push(new i.Color(0,0,1));t.colors.push(new i.Color(0,1,0))}}var a=new i.LineBasicMaterial({vertexColors:i.VertexColors,depthTest:false,depthWrite:false,transparent:true});i.Line.call(this,t,a,i.LinePieces);this.root=e;this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.update()};i.SkeletonHelper.prototype=Object.create(i.Line.prototype);i.SkeletonHelper.prototype.getBoneList=function(e){var t=[];if(e instanceof i.Bone){t.push(e)}for(var r=0;r<e.children.length;r++){t.push.apply(t,this.getBoneList(e.children[r]))}return t};i.SkeletonHelper.prototype.update=function(){var e=this.geometry;var t=(new i.Matrix4).getInverse(this.root.matrixWorld);var r=new i.Matrix4;var n=0;for(var a=0;a<this.bones.length;a++){var o=this.bones[a];if(o.parent instanceof i.Bone){r.multiplyMatrices(t,o.matrixWorld);e.vertices[n].setFromMatrixPosition(r);r.multiplyMatrices(t,o.parent.matrixWorld);e.vertices[n+1].setFromMatrixPosition(r);n+=2}}e.verticesNeedUpdate=true;e.computeBoundingSphere()};i.SpotLightHelper=function(e){i.Object3D.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;var t=new i.CylinderGeometry(0,1,1,8,1,true);t.applyMatrix((new i.Matrix4).makeTranslation(0,-.5,0));t.applyMatrix((new i.Matrix4).makeRotationX(-Math.PI/2));var r=new i.MeshBasicMaterial({wireframe:true,fog:false});this.cone=new i.Mesh(t,r);this.add(this.cone);this.update()};i.SpotLightHelper.prototype=Object.create(i.Object3D.prototype);i.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};i.SpotLightHelper.prototype.update=function(){var e=new i.Vector3;var t=new i.Vector3;return function(){var r=this.light.distance?this.light.distance:1e4;var i=r*Math.tan(this.light.angle);this.cone.scale.set(i,i,r);e.setFromMatrixPosition(this.light.matrixWorld);t.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(t.sub(e));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();i.VertexNormalsHelper=function(e,t,r,n){this.object=e;this.size=t!==undefined?t:1;var a=r!==undefined?r:16711680;var o=n!==undefined?n:1;var s=new i.Geometry;var l=e.geometry.vertices;var h=e.geometry.faces;for(var u=0,f=h.length;u<f;u++){var c=h[u];for(var p=0,d=c.vertexNormals.length;p<d;p++){s.vertices.push(new i.Vector3,new i.Vector3)}}i.Line.call(this,s,new i.LineBasicMaterial({color:a,linewidth:o}),i.LinePieces);this.matrixAutoUpdate=false;this.normalMatrix=new i.Matrix3;this.update()};i.VertexNormalsHelper.prototype=Object.create(i.Line.prototype);i.VertexNormalsHelper.prototype.update=function(e){var t=new i.Vector3;return function(e){var r=["a","b","c","d"];this.object.updateMatrixWorld(true);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);var i=this.geometry.vertices;var n=this.object.geometry.vertices;var a=this.object.geometry.faces;var o=this.object.matrixWorld;var s=0;for(var l=0,h=a.length;l<h;l++){var u=a[l];for(var f=0,c=u.vertexNormals.length;f<c;f++){var p=u[r[f]];var d=n[p];var v=u.vertexNormals[f];i[s].copy(d).applyMatrix4(o);t.copy(v).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);t.add(i[s]);s=s+1;i[s].copy(t);s=s+1}}this.geometry.verticesNeedUpdate=true;return this}}();i.VertexTangentsHelper=function(e,t,r,n){this.object=e;this.size=t!==undefined?t:1;var a=r!==undefined?r:255;var o=n!==undefined?n:1;var s=new i.Geometry;var l=e.geometry.vertices;var h=e.geometry.faces;for(var u=0,f=h.length;u<f;u++){var c=h[u];for(var p=0,d=c.vertexTangents.length;p<d;p++){s.vertices.push(new i.Vector3);s.vertices.push(new i.Vector3)}}i.Line.call(this,s,new i.LineBasicMaterial({color:a,linewidth:o}),i.LinePieces);this.matrixAutoUpdate=false;this.update()};i.VertexTangentsHelper.prototype=Object.create(i.Line.prototype);i.VertexTangentsHelper.prototype.update=function(e){var t=new i.Vector3;return function(e){var r=["a","b","c","d"];this.object.updateMatrixWorld(true);var i=this.geometry.vertices;var n=this.object.geometry.vertices;var a=this.object.geometry.faces;var o=this.object.matrixWorld;var s=0;for(var l=0,h=a.length;l<h;l++){var u=a[l];for(var f=0,c=u.vertexTangents.length;f<c;f++){var p=u[r[f]];var d=n[p];var v=u.vertexTangents[f];i[s].copy(d).applyMatrix4(o);t.copy(v).transformDirection(o).multiplyScalar(this.size);t.add(i[s]);s=s+1;i[s].copy(t);s=s+1}}this.geometry.verticesNeedUpdate=true;return this}}();i.WireframeHelper=function(e,t){var r=t!==undefined?t:16777215;var n=[0,0],a={};var o=function(e,t){return e-t};var s=["a","b","c"];var l=new i.BufferGeometry;if(e.geometry instanceof i.Geometry){var h=e.geometry.vertices;var u=e.geometry.faces;var f=0;var c=new Uint32Array(6*u.length);for(var p=0,d=u.length;p<d;p++){var v=u[p];for(var m=0;m<3;m++){n[0]=v[s[m]];n[1]=v[s[(m+1)%3]];n.sort(o);var g=n.toString();if(a[g]===undefined){c[2*f]=n[0];c[2*f+1]=n[1];a[g]=true;f++}}}var y=new Float32Array(f*2*3);for(var p=0,d=f;p<d;p++){for(var m=0;m<2;m++){var _=h[c[2*p+m]];var x=6*p+3*m;y[x+0]=_.x;y[x+1]=_.y;y[x+2]=_.z}}l.addAttribute("position",new i.BufferAttribute(y,3))}else if(e.geometry instanceof i.BufferGeometry){if(e.geometry.attributes.index!==undefined){var h=e.geometry.attributes.position.array;var b=e.geometry.attributes.index.array;var w=e.geometry.drawcalls;var f=0;if(w.length===0){w=[{count:b.length,index:0,start:0}]}var c=new Uint32Array(2*b.length);for(var T=0,S=w.length;T<S;++T){var M=w[T].start;var A=w[T].count;var x=w[T].index;for(var p=M,E=M+A;p<E;p+=3){for(var m=0;m<3;m++){n[0]=x+b[p+m];n[1]=x+b[p+(m+1)%3];n.sort(o);var g=n.toString();if(a[g]===undefined){c[2*f]=n[0];c[2*f+1]=n[1];a[g]=true;f++}}}}var y=new Float32Array(f*2*3);for(var p=0,d=f;p<d;p++){for(var m=0;m<2;m++){var x=6*p+3*m;var C=3*c[2*p+m];y[x+0]=h[C];y[x+1]=h[C+1];y[x+2]=h[C+2]}}l.addAttribute("position",new i.BufferAttribute(y,3))}else{var h=e.geometry.attributes.position.array;var f=h.length/3;var P=f/3;var y=new Float32Array(f*2*3);for(var p=0,d=P;p<d;p++){for(var m=0;m<3;m++){var x=18*p+6*m;var R=9*p+3*m;y[x+0]=h[R];y[x+1]=h[R+1];y[x+2]=h[R+2];var C=9*p+3*((m+1)%3);y[x+3]=h[C];y[x+4]=h[C+1];y[x+5]=h[C+2]}}l.addAttribute("position",new i.BufferAttribute(y,3))}}i.Line.call(this,l,new i.LineBasicMaterial({color:r}),i.LinePieces);this.matrix=e.matrixWorld;this.matrixAutoUpdate=false};i.WireframeHelper.prototype=Object.create(i.Line.prototype);i.ImmediateRenderObject=function(){i.Object3D.call(this);this.render=function(e){}};i.ImmediateRenderObject.prototype=Object.create(i.Object3D.prototype);i.MorphBlendMesh=function(e,t){i.Mesh.call(this,e,t);this.animationsMap={};this.animationsList=[];var r=this.geometry.morphTargets.length;var n="__default";var a=0;var o=r-1;var s=r/1;this.createAnimation(n,a,o,s);this.setAnimationWeight(n,1)};i.MorphBlendMesh.prototype=Object.create(i.Mesh.prototype);i.MorphBlendMesh.prototype.createAnimation=function(e,t,r,i){var n={startFrame:t,endFrame:r,length:r-t+1,fps:i,duration:(r-t)/i,lastFrame:0,currentFrame:0,active:false,time:0,direction:1,weight:1,directionBackwards:false,mirroredLoop:false};this.animationsMap[e]=n;this.animationsList.push(n)};i.MorphBlendMesh.prototype.autoCreateAnimations=function(e){var t=/([a-z]+)_?(\d+)/;var r,i={};var n=this.geometry;for(var a=0,o=n.morphTargets.length;a<o;a++){var s=n.morphTargets[a];var l=s.name.match(t);if(l&&l.length>1){var h=l[1];var u=l[2];if(!i[h])i[h]={start:Infinity,end:-Infinity};var f=i[h];if(a<f.start)f.start=a;if(a>f.end)f.end=a;if(!r)r=h}}for(var h in i){var f=i[h];this.createAnimation(h,f.start,f.end,e)}this.firstAnimation=r};i.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];if(t){t.direction=1;t.directionBackwards=false}};i.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];if(t){t.direction=-1;t.directionBackwards=true}};i.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var r=this.animationsMap[e];if(r){r.fps=t;r.duration=(r.end-r.start)/r.fps}};i.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var r=this.animationsMap[e];if(r){r.duration=t;r.fps=(r.end-r.start)/r.duration}};i.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var r=this.animationsMap[e];if(r){r.weight=t}};i.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var r=this.animationsMap[e];if(r){r.time=t}};i.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0;var r=this.animationsMap[e];if(r){t=r.time}return t};i.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1;var r=this.animationsMap[e];if(r){t=r.duration}return t};i.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];if(t){t.time=0;t.active=true}else{console.warn("animation["+e+"] undefined")}};i.MorphBlendMesh.prototype.stopAnimation=function(e){var t=this.animationsMap[e];if(t){t.active=false}};i.MorphBlendMesh.prototype.update=function(e){for(var t=0,r=this.animationsList.length;t<r;t++){var n=this.animationsList[t];if(!n.active)continue;var a=n.duration/n.length;n.time+=n.direction*e;if(n.mirroredLoop){if(n.time>n.duration||n.time<0){n.direction*=-1;if(n.time>n.duration){n.time=n.duration;n.directionBackwards=true}if(n.time<0){n.time=0;n.directionBackwards=false}}}else{n.time=n.time%n.duration;if(n.time<0)n.time+=n.duration}var o=n.startFrame+i.Math.clamp(Math.floor(n.time/a),0,n.length-1);var s=n.weight;if(o!==n.currentFrame){this.morphTargetInfluences[n.lastFrame]=0;this.morphTargetInfluences[n.currentFrame]=1*s;this.morphTargetInfluences[o]=0;n.lastFrame=n.currentFrame;n.currentFrame=o}var l=n.time%a/a;if(n.directionBackwards)l=1-l;this.morphTargetInfluences[n.currentFrame]=l*s;this.morphTargetInfluences[n.lastFrame]=(1-l)*s}}},{}],216:[function(e,t,r){var i=e("add-event-listener");var n=e("mouse-event-offset");var a=e("events/");function o(e){e=e||{};e.element=e.element||window;var t=new a;var r=e.position||[0,0];if(e.touchstart!==false){i(e.element,"mousedown",o);i(e.element,"touchstart",function(e){var t=e.targetTouches[0];o(e,t)})}i(e.element,"mousemove",o);i(e.element,"touchmove",function(e){var t=e.targetTouches[0];o(e,t)});t.position=r;return t;function o(e,i){var a=n(e,i);r[0]=a.x;r[1]=a.y;t.emit("move",e)}}t.exports=function(e){return o(e).position};t.exports.emitter=function(e){return o(e)}},{"add-event-listener":217,"events/":74,"mouse-event-offset":218}],217:[function(e,t,r){t.exports=e(1)},{"/projects/xmas/node_modules/add-event-listener/index.js":1}],218:[function(e,t,r){t.exports=e(149)},{"/projects/xmas/node_modules/mouse-event-offset/index.js":149}],219:[function(e,t,r){var i={emptyUserAgentDeviceType:"desktop",unknownUserAgentDeviceType:"phone",botUserAgentDeviceType:"bot"};var n={tv:"tv",tablet:"tablet",phone:"phone",desktop:"desktop",bot:"bot"};t.exports=function(e,t){t=t||{};if(!e||e===""){return t.emptyUserAgentDeviceType||n.desktop}if(e.match(/GoogleTV|SmartTV|Internet TV|NetCast|NETTV|AppleTV|boxee|Kylo|Roku|DLNADOC|CE\-HTML/i)){return n.tv}else if(e.match(/Xbox|PLAYSTATION 3|Wii/i)){return n.tv}else if(e.match(/iP(a|ro)d/i)||e.match(/tablet/i)&&!e.match(/RX-34/i)||e.match(/FOLIO/i)){return n.tablet}else if(e.match(/Linux/i)&&e.match(/Android/i)&&!e.match(/Fennec|mobi|HTC Magic|HTCX06HT|Nexus One|SC-02B|fone 945/i)){return n.tablet}else if(e.match(/Kindle/i)||e.match(/Mac OS/i)&&e.match(/Silk/i)){return n.tablet}else if(e.match(/GT-P10|SC-01C|SHW-M180S|SGH-T849|SCH-I800|SHW-M180L|SPH-P100|SGH-I987|zt180|HTC( Flyer|_Flyer)|Sprint ATP51|ViewPad7|pandigital(sprnova|nova)|Ideos S7|Dell Streak 7|Advent Vega|A101IT|A70BHT|MID7015|Next2|nook/i)||e.match(/MB511/i)&&e.match(/RUTEM/i)){return n.tablet}else if(e.match(/BOLT|Fennec|Iris|Maemo|Minimo|Mobi|mowser|NetFront|Novarra|Prism|RX-34|Skyfire|Tear|XV6875|XV6975|Google Wireless Transcoder/i)){return n.phone}else if(e.match(/Opera/i)&&e.match(/Windows NT 5/i)&&e.match(/HTC|Xda|Mini|Vario|SAMSUNG\-GT\-i8000|SAMSUNG\-SGH\-i9/i)){return n.phone}else if(e.match(/Windows (NT|XP|ME|9)/)&&!e.match(/Phone/i)&&!e.match(/Bot|Spider|ia_archiver|NewsGator/i)||e.match(/Win( ?9|NT)/i)){return n.desktop}else if(e.match(/Macintosh|PowerPC/i)&&!e.match(/Silk/i)){return n.desktop}else if(e.match(/Linux/i)&&e.match(/X11/i)&&!e.match(/Charlotte/i)){return n.desktop}else if(e.match(/CrOS/)){return n.desktop}else if(e.match(/Solaris|SunOS|BSD/i)){return n.desktop}else if(e.match(/curl|Bot|B-O-T|Crawler|Spider|Spyder|Yahoo|ia_archiver|Covario-IDS|findlinks|DataparkSearch|larbin|Mediapartners-Google|NG-Search|Snappy|Teoma|Jeeves|Charlotte|NewsGator|TinEye|Cerberian|SearchSight|Zao|Scrubby|Qseero|PycURL|Pompos|oegp|SBIder|yoogliFetchAgent|yacy|webcollage|VYU2|voyager|updated|truwoGPS|StackRambler|Sqworm|silk|semanticdiscovery|ScoutJet|Nymesis|NetResearchServer|MVAClient|mogimogi|Mnogosearch|Arachmo|Accoona|holmes|htdig|ichiro|webis|LinkWalker|lwp-trivial/i)&&!e.match(/mobile|Playstation/i)){return t.botUserAgentDeviceType||n.bot}else{return t.unknownUserAgentDeviceType||n.phone}};t.exports.devices=n;t.exports.defaultOptions=i},{}],220:[function(e,t,r){t.exports=function i(e,t,r){return(r-e)/(t-e)}},{}],221:[function(e,t,r){var i={create:e("gl-vec3/create"),sub:e("gl-vec3/subtract"),copy:e("gl-vec3/copy")};t.exports=e("./lib/build")(i)},{"./lib/build":222,"gl-vec3/copy":223,"gl-vec3/create":224,"gl-vec3/subtract":225}],222:[function(e,t,r){t.exports=function(e){function t(t){this.position=e.create();this.previous=e.create();this.acceleration=e.create();this.mass=1;this.radius=0;if(t&&typeof t.mass==="number")this.mass=t.mass;if(t&&typeof t.radius==="number")this.radius=t.radius;if(t&&t.position)e.copy(this.position,t.position);if(t&&(t.previous||t.position))e.copy(this.previous,t.previous||t.position);if(t&&t.acceleration)e.copy(this.acceleration,t.acceleration)}t.prototype.addForce=function(t){e.sub(this.previous,this.previous,t);return this};t.prototype.place=function(t){e.copy(this.position,t);e.copy(this.previous,t);return this};return function(e){return new t(e)}}},{}],223:[function(e,t,r){t.exports=i;function i(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}},{}],224:[function(e,t,r){t.exports=i;function i(){var e=new Float32Array(3);e[0]=0;e[1]=0;e[2]=0;return e}},{}],225:[function(e,t,r){t.exports=i;function i(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];return e}},{}],226:[function(e,t,r){var i={create:e("gl-vec3/create"),add:e("gl-vec3/add"),multiply:e("gl-vec3/multiply"),sub:e("gl-vec3/subtract"),scale:e("gl-vec3/scale"),copy:e("gl-vec3/copy"),sqrLen:e("gl-vec3/squaredLength"),fromValues:e("gl-vec3/fromValues")};t.exports=e("./lib/build")(i)},{"./lib/build":228,"gl-vec3/add":229,"gl-vec3/copy":230,"gl-vec3/create":231,"gl-vec3/fromValues":232,"gl-vec3/multiply":233,"gl-vec3/scale":234,"gl-vec3/squaredLength":235,"gl-vec3/subtract":236}],227:[function(e,t,r){t.exports=function(e){var t=e.fromValues(-Infinity,-Infinity,-Infinity);var r=e.fromValues(Infinity,Infinity,Infinity);var i=e.fromValues(1,1,1);var n=e.create();var a=1e-6;return function o(s,l,h,u,f){if(!h&&!u)return;e.copy(n,i);h=h||t;u=u||r;var c=0,p=s.position.length,d=false,v=s.radius||0;for(c=0;c<p;c++)if(typeof h[c]==="number"&&s.position[c]-v<h[c]){n[c]=-1;s.position[c]=h[c]+v;d=true}for(c=0;c<p;c++)if(typeof u[c]==="number"&&s.position[c]+v>u[c]){n[c]=-1;s.position[c]=u[c]-v;d=true}var m=e.sqrLen(l);if(!d||m<=a)return;var g=Math.sqrt(m);if(g!==0)e.scale(l,l,1/g);e.scale(n,n,g*f);e.multiply(l,l,n)}}},{}],228:[function(e,t,r){var i=e("as-number");var n=e("clamp");var a=e("./box-collision");t.exports=function o(e){var t=a(e);var r=e.create();var n=e.create();var o=e.create();function s(t){if(!(this instanceof s))return new s(t);t=t||{};this.gravity=t.gravity||e.create();this.friction=i(t.friction,.98);this.min=t.min;this.max=t.max;this.bounce=i(t.bounce,1)}s.prototype.collision=function(e,r){t(e,r,this.min,this.max,this.bounce)};s.prototype.integratePoint=function(t,i){var a=typeof t.mass==="number"?t.mass:1;if(a===0){this.collision(t,o);e.copy(t.acceleration,o);return}e.add(t.acceleration,t.acceleration,this.gravity);e.scale(t.acceleration,t.acceleration,a);e.sub(r,t.position,t.previous);e.scale(r,r,this.friction);this.collision(t,r);e.copy(t.previous,t.position);var s=i*i;e.scale(n,t.acceleration,.5*s);e.add(t.position,t.position,r);e.add(t.position,t.position,n);e.copy(t.acceleration,o)};s.prototype.integrate=function(e,t){for(var r=0;r<e.length;r++){this.integratePoint(e[r],t)}};return s}},{"./box-collision":227,"as-number":3,clamp:55}],229:[function(e,t,r){t.exports=i;function i(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];return e}},{}],230:[function(e,t,r){t.exports=e(223)},{"/projects/xmas/node_modules/verlet-point/node_modules/gl-vec3/copy.js":223}],231:[function(e,t,r){t.exports=e(224)},{"/projects/xmas/node_modules/verlet-point/node_modules/gl-vec3/create.js":224}],232:[function(e,t,r){t.exports=i;function i(e,t,r){var i=new Float32Array(3);i[0]=e;i[1]=t;i[2]=r;return i}},{}],233:[function(e,t,r){t.exports=i;function i(e,t,r){e[0]=t[0]*r[0];e[1]=t[1]*r[1];e[2]=t[2]*r[2];return e}},{}],234:[function(e,t,r){t.exports=i;function i(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;return e}},{}],235:[function(e,t,r){t.exports=i;function i(e){var t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i}},{}],236:[function(e,t,r){t.exports=e(225)},{"/projects/xmas/node_modules/verlet-point/node_modules/gl-vec3/subtract.js":225}],237:[function(e,t,r){t.exports=e(213)},{"/projects/xmas/node_modules/three-sdf-text/node_modules/gl-sprite-text/node_modules/xtend/immutable.js":213}],238:[function(e,t,r){"use strict";var i=e("three");var n=e("array-range");var a=e("gl-vec3/random");var o=e("randf");var s=e("gsap");var l=e("./config");var h=e("clamp");var u=e("./colors");var f=e("mouse-event-offset");var c=e("verlet-system/3d");var p=e("verlet-point/3d");var d=e("./mouse");var v=e("./is-mobile");var m=new i.Sphere;
var g=1e-4;t.exports=function(e,t){var r=l.startDelay+1.5;var h=r;var f=new i.IcosahedronGeometry(3,2);var m=new i.Mesh(f,new i.MeshBasicMaterial({color:13750737,opacity:.3,transparent:true,wireframe:true}));f.computeBoundingSphere();var y=v?50:100;var x=n(y).map(function(e){var r=t.clone();var n=r.material.materials.map(function(t){if(/ribbon/i.test(t.name)){t=t.clone();t.color=new i.Color(u[e%u.length])}return t});r.material=new i.MeshFaceMaterial(n);var l=new i.Object3D;l.add(r);var f=m.clone();var c=new i.Object3D;c.scale.multiplyScalar(g);c.add(l);c.add(f);var p=o(.08,.35);s.to(c.scale,1,{x:p*o(.95,1.05),y:p*o(.95,1.05),z:p,delay:h+=.02});f.visible=false;r.position.y=-.4;var d=a([0,0,0],10);c.position.fromArray(d);c.rotation.x=o(-Math.PI*2,Math.PI*2);c.rotation.y=o(-Math.PI*2,Math.PI*2);c.rotation.z=o(-Math.PI*2,Math.PI*2);c.hover=f;return c});var b=x.map(function(e){var t=p({position:e.position.toArray()});t.rotational=new i.Vector2;return t});setTimeout(function(){b.forEach(function(e,t){var r=o(.001,.005);e.addForce([o(-r,r),o(-r,r),o(-r,r)])})},r*1e3);x.forEach(function(t){e.scene.add(t)});var w=c({gravity:[0,0,0],friction:.9999});var T=-1,S=-1,M=-1;e.on("tick",function(t){w.integrate(b,t/1e3);b.forEach(function(e,r){x[r].position.fromArray(e.position);x[r].rotation.x+=e.rotational.x;x[r].rotation.y+=e.rotational.y;e.rotational.multiplyScalar(.99);x[r].rotation.x+=t/1e3*.1});d.update(e);S=_(x,f.boundingSphere);if(S!==T){if(T!==-1){}if(S!==-1){}}T=S});A();function A(){var t=(new i.Vector2).fromArray(d.position);var r=new i.Vector3;var n=new i.Vector3;d.on("move",function(i){if(S!==-1){var a=d.position;var o=e.width,s=e.height;r.set(a[0]/o*2-1,-a[1]/s*2+1,.5);r.unproject(e.camera);n.set(t.x/o*2-1,-t.y/s*2+1,.5);n.unproject(e.camera);n.sub(r).negate().normalize();b[S].rotational.x-=n.x*.005;b[S].rotational.y-=n.y*.005;n.multiplyScalar(.001);b[S].addForce(n.toArray())}t.fromArray(d.position)})}};function y(e){e.visible=false}function _(e,t){for(var r=0;r<e.length;r++){m.copy(t);m.applyMatrix4(e[r].matrixWorld);if(d.raycaster.ray.isIntersectionSphere(m))return r}return-1}},{"./colors":241,"./config":242,"./is-mobile":249,"./mouse":250,"array-range":2,clamp:55,"gl-vec3/random":98,gsap:130,"mouse-event-offset":149,randf:152,three:215,"verlet-point/3d":221,"verlet-system/3d":226}],239:[function(e,t,r){"use strict";var i=e("three");t.exports=function(e){e.add(new i.AmbientLight(4210752));e.add(new i.HemisphereLight(14085623,6908265,1));var t=new i.DirectionalLight(16777215,.15);t.position.set(5,5,-2);e.add(t)}},{three:215}],240:[function(e,t,r){"use strict";var i=e("three");var n=e("three-sdf-text")(i);var a=e("gsap");var o=e("./texture-cache")("fonts/LatoBlack-sdf.png");var s=e("gl-mat4");var l=e("./mouse");var h=e("./is-mobile");var u=[(h?"swipe":"drag")+" to rotate","tap the Earth\nto warm up with some coffee"];var f=1.5;t.exports=function(e,t){var r=1.8;var l=0;var c=false;var p=i.ImageUtils.loadTexture(o);p.minFilter=i.LinearMipMapLinearFilter;p.magFilter=i.LinearFilter;p.flipY=false;p.anistrophy=e.renderer.getMaxAnisotropy();var d=null;var v=null;var m=true;var g=[];g.push(x(u[0]));e.on("text",function(t){if(v===null||v!==e.controls.theta)_();g.forEach(function(t){t.text.draw(e.camera,t.object3d)});e.renderer.resetGLState();v=e.controls.theta});return{showing:function(){return m},show:function(e){A();c=false;var t=g[0];t.text.opacity=0;t.object3d.scale.y=0;w(e,t.text,t.object3d)}};function y(e,t){if(Math.abs(t-e)<Math.PI)return t-e;if(t>e)return t-e-Math.PI*2;return t-e+Math.PI*2}function _(){g.forEach(function(t){var r=e.controls.theta;r=r-2*Math.PI*Math.floor(r/(2*Math.PI)+.5);a.killTweensOf(t.parent.rotation);a.to(t.parent.rotation,.5,{y:r,delay:.001,ease:"easeOutQuart"})})}function x(a){var o=h?window.innerWidth:undefined;var s=n(e.renderer,{text:a,font:t,padding:-4,color:16448250,textures:[p]});var l=new i.Object3D;s.opacity=0;l.position.set(0,0,0);l.scale.y=0;b(s);var c=new i.Object3D;c.position.set(0,-1.8,0);c.add(l);e.scene.add(c);S(r,u[0],s,l,function(){M(s,l,f)});return{text:s,object3d:l,parent:c}}function b(e){var t=.007;s.identity(e.transform);s.scale(e.transform,e.transform,[t,t,t]);var r=e.element.getBounds();var i=[-r.width/2,-r.height,0];s.translate(e.transform,e.transform,i);var n=1;var a=[n,n,n];s.scale(e.transform,e.transform,a)}function w(e,t,r){S(0,e,t,r,function(){T(t,r,f)}.bind(this))}function T(e,t,r){a.to(t.scale,1,{y:0,delay:r,ease:"easeOutExpo"});a.to(e,.5,{opacity:0,delay:r,ease:"easeOutQuad"})}function S(e,t,r,i,n){a.killTweensOf([r,i]);a.to(r,1,{opacity:1,delay:e,onStart:function(e,t,r){t.element.text=e;t.element.align="center";t.element.layout(500);r.scale.y=0;b(t);a.to(r.scale,1,{y:1,ease:"easeOutExpo"})}.bind(null,t,r,i),onComplete:n})}function M(e,t,r){if(c)return;r=r||0;d=a.delayedCall(r,function(){T(e,t);var r=E();if(!r){c=true;return}S(1,r,e,t,M.bind(null,e,t,f))})}function A(){if(d){d.kill();d=null}g.forEach(function(e){a.killTweensOf([e.parent.rotation,e.text,e.object3d.scale])})}function E(){l++;if(l>u.length-1)return"";return u[l]}}},{"./is-mobile":249,"./mouse":250,"./texture-cache":257,"gl-mat4":84,gsap:130,three:215,"three-sdf-text":154}],241:[function(e,t,r){"use strict";t.exports=[10825005,10847277,13316915,9751347,3390411,2124699,14373065,8329415,8438694]},{}],242:[function(e,t,r){"use strict";t.exports={startDelay:.85,startPosition:0}},{}],243:[function(e,t,r){"use strict";var i=e("three");t.exports=function(e){e=e||function(){};var t=new i.JSONLoader(false);t.load("models/gift1.js",function(t,r){t.computeVertexNormals();r.forEach(function(e){e.shading=i.FlatShading});var n=new i.Mesh(t,new i.MeshFaceMaterial(r));e(null,n)})}},{three:215}],244:[function(e,t,r){"use strict";var i=e("three");var n=e("./shaders/matcap");var a=e("./texture-cache");var o=a("img/nrm3.png");var s=a("img/mcap3.png");t.exports=function(e,t){e=e||{};t=t||function(){};var r=e.envMap;var a=new i.JSONLoader(false);a.load("models/ball.js",function(e,n){e.computeVertexNormals();var a=i.ImageUtils.loadTexture(o);a.wrapS=a.wrapT=i.RepeatWrapping;a.minFilter=a.magFilter=i.LinearFilter;a.generateMipmaps=false;var h=i.ImageUtils.loadTexture(s);h.wrapS=h.wrapT=i.ClampToEdgeWrapping;h.minFilter=h.magFilter=i.LinearFilter;h.generateMipmaps=false;var u=l(h,a,r,1);var f=l(h,a,r,0);var c=new i.Mesh(e,new i.MeshFaceMaterial([f,f,u]));t(null,c)});function l(e,t,r,a){var o=t;var s=e;var l=new i.ShaderMaterial(n({normalMap:o,blending:i.NormalBlending,transparent:true,tMatCap:s}));l.uniforms.combine.value=2;l.uniforms.envMap.value=r;l.uniforms.reflectivity.value=.15;l.uniforms.shininess.value=70;l.uniforms.diffuse.value=new i.Color(16777215);l.uniforms.tMatCap.value=s;l.uniforms.refractionRatio.value=.9;l.uniforms.flipEnvMap.value=1;l.normalMap=o;l.uniforms.normalScale.value.multiplyScalar(.02);l.uniforms.seethru.value=a;l.needsUpdate=true;return l}}},{"./shaders/matcap":254,"./texture-cache":257,three:215}],245:[function(e,t,r){"use strict";var i=e("three");var n=e("array-range");var a=e("events/");var o=e("./sync-floor");var s=e("lerp");var l=e("gsap");var h=e("./shaders/blend");var u=new i.Sphere;var f=e("./texture-cache")("img/earth1-small.jpg");var c=e("./config");var p=e("./is-mobile");var d=e("./point-to-latlng");var v=e("./mouse");t.exports=function(t,r){var n=0;var o=c.startPosition;var s=new i.Vector3;var m=new i.Vector3;var g=new i.Vector3;var y=new a;r.position.y=o;var _=1.15;var x=new i.SphereGeometry(_,50,50);x.computeBoundingSphere();var b=new i.Texture;var w=i.ImageUtils.loadTexture(f,undefined,function(){b.image=e("delaunify")(w.image,{count:2e3});b.needsUpdate=true});var T=new i.ShaderMaterial(h({tProcessed:b,map:w}));var S=new i.Mesh(x,T);t.scene.add(S);t.scene.add(r);t.cubeIgnores.push(S,r);var M=.001;S.scale.set(M,M,M);r.scale.set(M,M,M);var A=c.startDelay+.25;l.fromTo(S.rotation,1,{y:-Math.PI*.5},{y:0,delay:A,ease:"easeOutQuart"});l.to([S.scale,r.scale],1,{ease:"easeOutExpo",x:1,y:1,z:1,delay:A,onComplete:function(){}});t.on("tick",function(e){E(e/1e3)});v.on("click",function(e,t){v.position[0]=e;v.position[1]=t;var r=C(g);if(r){var i=d(g,u.radius,-S.rotation.y);y.emit("select",i)}});E(0);return y;function E(e){n+=e;var i=.02;S.rotation.y+=e*i;S.position.copy(r.position);var a=.02;v.update(t);var o=x.boundingSphere;u.copy(o);u.applyMatrix4(S.matrixWorld);if(!p&&v.raycaster.ray.isIntersectionSphere(u)){a=.1;v.raycaster.ray.intersectSphere(u,s)}else{}m.lerp(s,a);T.uniforms.origin.value=m;T.uniforms.anim.value=Math.sin(n)/2+.5}function C(e){v.update(t);var r=x.boundingSphere;u.copy(r);u.applyMatrix4(S.matrixWorld);if(v.raycaster.ray.isIntersectionSphere(u))return v.raycaster.ray.intersectSphere(u,e);return false}}},{"./config":242,"./is-mobile":249,"./mouse":250,"./point-to-latlng":251,"./shaders/blend":253,"./sync-floor":256,"./texture-cache":257,"array-range":2,delaunify:68,"events/":74,gsap:130,lerp:133,three:215}],246:[function(e,t,r){"use strict";var i=e("bluebird");t.exports=function(e){return new i(function(t,r){var i=new google.maps.Geocoder;i.geocode({latLng:new google.maps.LatLng(e[0],e[1])},function(e,i){if(i==google.maps.GeocoderStatus.OK){t(e)}else{r("could not geocode "+i)}})})}},{bluebird:6}],247:[function(e,t,r){"use strict";var i=e("bluebird");var n=i.promisify(e("nearest-coffee"));var a=e("./geocode");var o=e("xtend");t.exports=function(e){return a(e).then(function(t){if(t.length===0)return i.reject("could not get geocode info");var r=Math.max(0,t.length-3);return{name:t[r].formatted_address,originalLocation:e,location:[t[r].geometry.location.lat(),t[r].geometry.location.lng()]}}).then(function(e){var t=n({location:e.location,radius:5e4});return i.all([i.resolve(e),t])}).spread(function(e,t){if(t.length===0)return i.reject("no coffee found");console.log(t[0].name,"in",e.name);return o(e,{cafe:t[0].name})})}},{"./geocode":246,bluebird:6,"nearest-coffee":150,xtend:237}],248:[function(e,t,r){"use strict";var i=e("bluebird");var n=e("three");var a=e("./three-mesh-viewer")(n);var o=e("./preload-textures");var s=i.promisify(e("./create-orb"));var l=i.promisify(e("./create-gift"));var h=e("./earth");var u=e("gsap");var f=i.promisify(e("load-json-xhr"));var c=e("./texture-cache");var p=e("./config");var d=e("lodash.throttle");var v=e("./get-coffee");e("domready")(function(){document.body.style.background="#151a17";var t=a();i.all([o(c.paths),s({envMap:t.cubeCamera.renderTarget}),l(),f("fonts/LatoBlack-sdf.json")]).spread(function(r,i,a,o){var s=new n.Vector3;t.scene.fog=new n.FogExp2(1580830,.05);t.controls.target.set(0,0,0);t.controls.zoomSpeed=.1;t.controls.rotateSpeed=.4;t.controls.minPolarAngle=30*Math.PI/180;t.controls.maxPolarAngle=150*Math.PI/180;t.controls.minDistance=4;t.controls.maxDistance=9;t.controls.noPan=true;t.camera.position.set(0,6,6);u.to(t.camera.position,1,{y:3,ease:"easeOutQuart",delay:p.startDelay});e("./add-lights")(t.scene);e("./stars")(t);var l=h(t,i);e("./add-gifts")(t,a);var f=e("./add-text")(t,o);u.to(t,1,{margin:20,ease:"easeOutQuart",delay:1,onStart:function(){document.body.style.background="#fff"}});var c=["no coffee here!","nope... try again!"];var m=d(function(e){console.log("Searching...",e);v(e).then(function(e){f.show(e.cafe+"\n"+e.name)}).catch(function(e){f.show(c[~~(Math.random()*c.length)])})},3500);setTimeout(function(){console.log("allow");l.on("select",m)},6e3)})})},{"./add-gifts":238,"./add-lights":239,"./add-text":240,"./config":242,"./create-gift":243,"./create-orb":244,"./earth":245,"./get-coffee":247,"./preload-textures":252,"./stars":255,"./texture-cache":257,"./three-mesh-viewer":258,bluebird:6,domready:73,gsap:130,"load-json-xhr":134,"lodash.throttle":142,three:215}],249:[function(e,t,r){"use strict";var i=e("ua-device-type");t.exports=/(phone)|(tablet)/i.test(i(navigator.userAgent))},{"ua-device-type":219}],250:[function(e,t,r){"use strict";var i=e("three");var n=e("touch-position").emitter();var a=e("add-event-listener");var o=e("mouse-event-offset");n.vector=new i.Vector3;n.raycaster=new i.Raycaster;n.update=function(e){var t=n.position;var r=e.width,i=e.height;n.vector.set(t[0]/r*2-1,-t[1]/i*2+1,.5);n.vector.unproject(e.camera);n.vector.sub(e.camera.position).normalize();n.raycaster.set(e.camera.position,n.vector)};a(window,"click",function(e){var t=o(e);n.emit("click",t.x,t.y)});a(window,"touchstart",function(e){var t=e.targetTouches[0];var r=o(e,t);n.emit("click",r.x,r.y)});t.exports=n},{"add-event-listener":1,"mouse-event-offset":149,three:215,"touch-position":216}],251:[function(e,t,r){"use strict";t.exports=function(e,t,r){r=r||0;r*=180/Math.PI;r+=90;t=t||1;var i=e.x,n=e.y,a=e.z;var o=90-Math.acos(n/t)*180/Math.PI;var s=(r+Math.atan2(i,a)*180/Math.PI)%360-180;o=Math.round(o*1e5)/1e5;s=Math.round(s*1e5)/1e5;return[o,s]}},{}],252:[function(e,t,r){"use strict";var i=e("three");var n=e("bluebird");var a=n.promisify(e("img"));t.exports=function(e){e=e||[];return n.all(e.map(function(e){return a(e).then(function(e){return e})}))}},{bluebird:6,img:131,three:215}],253:[function(e,t,r){"use strict";var i=e("three");t.exports=function(e){e=e||{};var t={uniforms:i.UniformsUtils.merge([i.UniformsLib["common"],i.UniformsLib["fog"],i.UniformsLib["shadowmap"],{tProcessed:{type:"t",value:e.tProcessed||new i.Texture},origin:{type:"v3",value:new i.Vector3},anim:{type:"f",value:0}}]),vertexShader:[i.ShaderChunk["map_pars_vertex"],i.ShaderChunk["lightmap_pars_vertex"],i.ShaderChunk["envmap_pars_vertex"],i.ShaderChunk["color_pars_vertex"],i.ShaderChunk["morphtarget_pars_vertex"],i.ShaderChunk["skinning_pars_vertex"],i.ShaderChunk["shadowmap_pars_vertex"],i.ShaderChunk["logdepthbuf_pars_vertex"],"varying vec4 vWorldPos1;","void main() {",i.ShaderChunk["map_vertex"],i.ShaderChunk["lightmap_vertex"],i.ShaderChunk["color_vertex"],i.ShaderChunk["skinbase_vertex"],"   #ifdef USE_ENVMAP",i.ShaderChunk["morphnormal_vertex"],i.ShaderChunk["skinnormal_vertex"],i.ShaderChunk["defaultnormal_vertex"],"   #endif",i.ShaderChunk["morphtarget_vertex"],i.ShaderChunk["skinning_vertex"],i.ShaderChunk["default_vertex"],i.ShaderChunk["logdepthbuf_vertex"],i.ShaderChunk["worldpos_vertex"],i.ShaderChunk["envmap_vertex"],i.ShaderChunk["shadowmap_vertex"],"vWorldPos1 = modelMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform sampler2D tProcessed;","uniform float anim;","uniform vec3 origin;","varying vec4 vWorldPos1;",i.ShaderChunk["color_pars_fragment"],i.ShaderChunk["map_pars_fragment"],i.ShaderChunk["alphamap_pars_fragment"],i.ShaderChunk["lightmap_pars_fragment"],i.ShaderChunk["envmap_pars_fragment"],i.ShaderChunk["fog_pars_fragment"],i.ShaderChunk["shadowmap_pars_fragment"],i.ShaderChunk["specularmap_pars_fragment"],i.ShaderChunk["logdepthbuf_pars_fragment"],"void main() {","   gl_FragColor = vec4( diffuse, opacity );",i.ShaderChunk["logdepthbuf_fragment"],i.ShaderChunk["map_fragment"],"float dist = distance(origin, vWorldPos1.xyz) / (1.0);","dist = smoothstep(0.20, 0.41, dist);","vec4 procColor = texture2D(tProcessed, vUv);","vec3 blended = max(gl_FragColor.rgb, procColor.rgb);","vec3 other = mix(procColor.rgb, blended, anim);","gl_FragColor.rgb = mix(other, gl_FragColor.rgb, 1.0-dist);",i.ShaderChunk["alphamap_fragment"],i.ShaderChunk["alphatest_fragment"],i.ShaderChunk["specularmap_fragment"],i.ShaderChunk["lightmap_fragment"],i.ShaderChunk["color_fragment"],i.ShaderChunk["envmap_fragment"],i.ShaderChunk["shadowmap_fragment"],i.ShaderChunk["linear_to_gamma_fragment"],i.ShaderChunk["fog_fragment"],"}"].join("\n"),fog:false,defines:{USE_MAP:""}};t.uniforms.tProcessed.value=e.tProcessed;t.uniforms.map.value=e.map;return t}},{three:215}],254:[function(e,t,r){"use strict";var i=e("three");var n=e("xtend");var a="\n#ifdef USE_NORMALMAP\n\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\n\n        // Per-Pixel Tangent Space Normal Mapping\n        // http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n    vec3 q0 = dFdx( eye_pos.xyz );\n    vec3 q1 = dFdy( eye_pos.xyz );\n    vec2 st0 = dFdx( vUv.st );\n    vec2 st1 = dFdy( vUv.st );\n\n    vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n    vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n    vec3 N = normalize( surf_norm );\n\n    vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n    mapN.xy = normalScale * mapN.xy;\n    mat3 tsn = mat3( S, T, N );\n    return normalize( tsn * mapN );\n\n}\n\n#endif\n";t.exports=function(e){e=e||{};var t=n({uniforms:i.UniformsUtils.merge([i.UniformsLib["common"],i.UniformsLib["bump"],i.UniformsLib["normalmap"],i.UniformsLib["fog"],i.UniformsLib["lights"],i.UniformsLib["shadowmap"],{ambient:{type:"c",value:new i.Color(16777215)},emissive:{type:"c",value:new i.Color(0)},specular:{type:"c",value:new i.Color(1118481)},shininess:{type:"f",value:30},seethru:{type:"f",value:0},wrapRGB:{type:"v3",value:new i.Vector3(1,1,1)},tMatCap:{type:"t",value:e.tMatCap||new i.Texture}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","varying vec3 vNormal;","varying vec3 matCapE;","varying vec2 vUv;","uniform vec4 offsetRepeat;",i.ShaderChunk["lightmap_pars_vertex"],i.ShaderChunk["envmap_pars_vertex"],i.ShaderChunk["lights_phong_pars_vertex"],i.ShaderChunk["color_pars_vertex"],i.ShaderChunk["morphtarget_pars_vertex"],i.ShaderChunk["skinning_pars_vertex"],i.ShaderChunk["shadowmap_pars_vertex"],i.ShaderChunk["logdepthbuf_pars_vertex"],"void main() {","matCapE = normalize( vec3( modelViewMatrix * vec4( position.xyz, 1.0 ) ) );",i.ShaderChunk["map_vertex"],i.ShaderChunk["lightmap_vertex"],i.ShaderChunk["color_vertex"],i.ShaderChunk["morphnormal_vertex"],i.ShaderChunk["skinbase_vertex"],i.ShaderChunk["skinnormal_vertex"],i.ShaderChunk["defaultnormal_vertex"],"   vNormal = normalize( transformedNormal );",i.ShaderChunk["morphtarget_vertex"],i.ShaderChunk["skinning_vertex"],i.ShaderChunk["default_vertex"],i.ShaderChunk["logdepthbuf_vertex"],"   vViewPosition = -mvPosition.xyz;",i.ShaderChunk["worldpos_vertex"],i.ShaderChunk["envmap_vertex"],i.ShaderChunk["lights_phong_vertex"],i.ShaderChunk["shadowmap_vertex"],"}"].join("\n"),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform float opacity;","uniform vec3 ambient;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float seethru;","varying vec3 matCapE;","uniform sampler2D tMatCap;",i.ShaderChunk["color_pars_fragment"],i.ShaderChunk["map_pars_fragment"],i.ShaderChunk["alphamap_pars_fragment"],i.ShaderChunk["lightmap_pars_fragment"],i.ShaderChunk["envmap_pars_fragment"],i.ShaderChunk["fog_pars_fragment"],i.ShaderChunk["lights_phong_pars_fragment"],i.ShaderChunk["shadowmap_pars_fragment"],i.ShaderChunk["bumpmap_pars_fragment"],a,i.ShaderChunk["specularmap_pars_fragment"],i.ShaderChunk["logdepthbuf_pars_fragment"],"void main() {","   gl_FragColor = vec4( vec3( 1.0 ), opacity );",i.ShaderChunk["logdepthbuf_fragment"],i.ShaderChunk["map_fragment"],i.ShaderChunk["alphamap_fragment"],i.ShaderChunk["alphatest_fragment"],i.ShaderChunk["specularmap_fragment"],i.ShaderChunk["lights_phong_fragment"],"vec3 r = reflect( matCapE, normal );","r.z += 1.0;","float m = 2. * length(r);","vec2 vN = r.xy / m + .5;","vec3 matCapColor = texture2D( tMatCap, vN ).rgb;","gl_FragColor.rgb = mix(gl_FragColor.rgb, gl_FragColor.rgb * matCapColor, 1.0);","float rimval = 1.0 * smoothstep(-1.0, 1.0, normal.y);","float rimPower = 2.0;","float rimf = rimPower * abs(dot(normal, matCapE));","float rimFade = rimval * (1. - smoothstep(0.0, 1.0, rimf));","gl_FragColor.rgb += vec3(rimFade)*0.25;",i.ShaderChunk["lightmap_fragment"],i.ShaderChunk["color_fragment"],i.ShaderChunk["envmap_fragment"],"gl_FragColor.a *= (1.0 - smoothstep(0.0, 3.0, rimf)*seethru);",i.ShaderChunk["shadowmap_fragment"],i.ShaderChunk["linear_to_gamma_fragment"],i.ShaderChunk["fog_fragment"],"}"].join("\n"),defines:{USE_ENVMAP:"",USE_FOG:""},lights:true},e);if(e.normalMap){t.defines["USE_NORMALMAP"]="";t.uniforms.normalMap.value=e.normalMap}return t}},{three:215,xtend:237}],255:[function(e,t,r){"use strict";var i=e("gl-vec3/random");var n=e("array-range");var a=e("three");var o=e("randf");var s=e("gsap");var l=e("./config");var h=e("./is-mobile");t.exports=function(e){var t=new a.BoxGeometry(1,1,1);var r=new a.MeshBasicMaterial({color:16777215,transparent:true,fog:false});var u=h?250:500;var f=l.startDelay+.25;var c=n(u).map(function(e){var n=100;var l=i([0,0,0],n);var h=new a.Mesh(t,r.clone());h.material.opacity=o(.05,.5);h.position.fromArray(l);var u=o(.1,.5);var c=1e-4;h.scale.set(c,c,c);s.to(h.scale,1,{ease:"easeOutExpo",x:u,y:u,z:u,delay:f+=.005});return h});c.forEach(function(t){e.scene.add(t)})}},{"./config":242,"./is-mobile":249,"array-range":2,"gl-vec3/random":98,gsap:130,randf:152,three:215}],256:[function(e,t,r){"use strict";var i=e("smoothstep");var n=e("lerp");var a=e("three");var o=e("clamp");var s=e("unlerp");t.exports=function l(e,t){e.position.x=t.position.x;e.position.z=t.position.z;var r=t.position.distanceTo(e.position);r=1-o(s(1,6,r),0,1);e.material.opacity=n(0,.6,r);var i=n(2,5,r);e.scale.set(i,i,i)}},{clamp:55,lerp:133,smoothstep:153,three:215,unlerp:220}],257:[function(e,t,r){"use strict";t.exports=function(e){if(e)t.exports.paths.push(e);return e};t.exports.paths=[]},{}],258:[function(e,t,r){"use strict";var i=e("three");var n=e("canvas-testbed");var a=e("as-number");var o=e("./three-orbit-controls");var s=e("gl-vignette-background");var l=e("events/");t.exports=function(e){var t=o(e);return h.bind(null,e,t)};function h(e,t,r,i){var o=new l;o.margin=0;i=i||{};n(c,p,{context:"webgl",onResize:d});var h,u={scale:[1,1]};var f=window.devicePixelRatio||1;return o;function c(e,t,r,i){e.disable(e.DEPTH_TEST);e.disable(e.CULL_FACE);var n=o.margin;o.renderer.enableScissorTest(false);o.renderer.clear();e.enable(e.BLEND);e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA);o.renderer.enableScissorTest(true);o.renderer.setScissor(n,n,t-n*2,r-n*2);var a=Math.max(t,r)*1.05;u.scale[0]=1/t*a;u.scale[1]=1/r*a;h.style(u);h.draw();o.renderer.resetGLState();o.controls.update();o.renderer.render(o.scene,o.camera);o.emit("tick",i);o.emit("text",i)}function p(n,l,u){o.renderer=new e.WebGLRenderer({canvas:n.canvas,width:l,alpha:false,height:u});o.renderer.setClearColor(16777215,1);o.renderer.autoClear=false;o.width=l;o.height=u;i.fov=a(i.fov,45);i.near=a(i.near,.01);i.far=a(i.far,1e3);o.camera=new e.PerspectiveCamera(i.fov,l/u,i.near,i.far);o.camera.position.z=-5;o.camera.lookAt(new e.Vector3);o.scene=new e.Scene;if(r)o.scene.add(r);o.controls=new t(o.camera);o.cubeIgnores=[];o.cubeCamera=new e.CubeCamera(i.near,i.far,256);o.cubeCamera.renderTarget.minFilter=e.LinearFilter;o.cubeCamera.renderTarget.generateMipmaps=false;o.scene.add(o.cubeCamera);h=s(o.renderer.getContext(),{aspect:1,color2:[.02,.02,.02],color1:[.12,.12,.12],smoothing:[-.5,1],noiseAlpha:.4,offset:[-.05,-.15]})}function d(e,t){o.renderer.setViewport(0,0,e,t);o.width=e;o.height=t;o.camera.aspect=e/t;o.camera.updateProjectionMatrix()}}},{"./three-orbit-controls":259,"as-number":3,"canvas-testbed":46,"events/":74,"gl-vignette-background":100,three:215}],259:[function(e,t,r){"use strict";var i=e("inherits");var n=e("gsap");t.exports=function(e){if(!e.MOUSE)e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};function t(t,r){this.object=t;this.domElement=r!==undefined?r:document;this.enabled=true;this.target=new e.Vector3;this.center=this.target;this.noZoom=false;this.zoomSpeed=1;this.minDistance=0;this.maxDistance=Infinity;this.noRotate=false;this.rotateSpeed=1;this.noPan=false;this.keyPanSpeed=7;this.autoRotate=false;this.autoRotateSpeed=2;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.noKeys=false;this.phi=0;this.theta=0;this.rotateOffset={phi:0,theta:0};this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.constrainDelta={x:0,y:0};var i=this;var a=1e-6;var o=new e.Vector2;var s=new e.Vector2;var l=new e.Vector2;var h=new e.Vector2;var u=new e.Vector2;var f=new e.Vector2;var c=new e.Vector3;var p=new e.Vector3;var d=new e.Vector2;var v=new e.Vector2;var m=new e.Vector2;var g=0;var y=0;var _=1;var x=new e.Vector3;var b=new e.Vector3;var w={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5};var T=w.NONE;this.target0=this.target.clone();this.position0=this.object.position.clone();var S=(new e.Quaternion).setFromUnitVectors(t.up,new e.Vector3(0,1,0));var M=S.clone().inverse();var A={type:"change"};var E={type:"start"};var C={type:"end"};this.rotateLeft=function(e){if(e===undefined){e=P()}y-=e};this.rotateUp=function(e){if(e===undefined){e=P()}g-=e};this.panLeft=function(e){var t=this.object.matrix.elements;c.set(t[0],t[1],t[2]);c.multiplyScalar(-e);x.add(c)};this.panUp=function(e){var t=this.object.matrix.elements;c.set(t[4],t[5],t[6]);c.multiplyScalar(e);x.add(c)};this.pan=function(e,t){var r=i.domElement===document?i.domElement.body:i.domElement;if(i.object.fov!==undefined){var n=i.object.position;var a=n.clone().sub(i.target);var o=a.length();o*=Math.tan(i.object.fov/2*Math.PI/180);i.panLeft(2*e*o/r.clientHeight);i.panUp(2*t*o/r.clientHeight)}else if(i.object.top!==undefined){i.panLeft(e*(i.object.right-i.object.left)/r.clientWidth);i.panUp(t*(i.object.top-i.object.bottom)/r.clientHeight)}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")}};this.dollyIn=function(e){if(e===undefined){e=R()}_/=e};this.dollyOut=function(e){if(e===undefined){e=R()}_*=e};this.update=function(){var e=this.object.position;i.rotateLeft(2*Math.PI*i.constrainDelta.x/window.innerWidth*i.rotateSpeed);i.rotateUp(2*Math.PI*i.constrainDelta.y/window.innerHeight*i.rotateSpeed*.75);p.copy(e).sub(this.target);p.applyQuaternion(S);var t=Math.atan2(p.x,p.z);var r=Math.atan2(Math.sqrt(p.x*p.x+p.z*p.z),p.y);if(this.autoRotate){this.rotateLeft(P())}t+=y;r+=g;r=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,r));r=Math.max(a,Math.min(Math.PI-a,r));var n=p.length()*_;n=Math.max(this.minDistance,Math.min(this.maxDistance,n));this.target.add(x);i.phi=r;i.theta=t;p.x=n*Math.sin(r)*Math.sin(t);p.y=n*Math.cos(r);p.z=n*Math.sin(r)*Math.cos(t);p.applyQuaternion(M);e.copy(this.target).add(p);this.object.lookAt(this.target);y=0;g=0;_=1;x.set(0,0,0);if(b.distanceToSquared(this.object.position)>a){this.dispatchEvent(A);b.copy(this.object.position)}};this.reset=function(){T=w.NONE;this.target.copy(this.target0);this.object.position.copy(this.position0);this.update()};this.isRotating=function(){return T===w.ROTATE};function P(){return 2*Math.PI/60/60*i.autoRotateSpeed}function R(){return Math.pow(.95,i.zoomSpeed)}function L(e){if(i.enabled===false)return;e.preventDefault();if(e.button===0){if(i.noRotate===true)return;T=w.ROTATE;o.set(e.clientX,e.clientY)}else if(e.button===1){if(i.noZoom===true)return;T=w.DOLLY;d.set(e.clientX,e.clientY)}else if(e.button===2){if(i.noPan===true)return;T=w.PAN;h.set(e.clientX,e.clientY)}i.domElement.addEventListener("mousemove",k,false);i.domElement.addEventListener("mouseup",F,false);i.dispatchEvent(E)}function k(e){if(i.enabled===false)return;e.preventDefault();var t=i.domElement===document?i.domElement.body:i.domElement;if(T===w.ROTATE){if(i.noRotate===true)return;s.set(e.clientX,e.clientY);l.subVectors(s,o);i.constrainDelta.x=l.x;i.constrainDelta.y=l.y;n.killTweensOf(i.constrainDelta);n.to(i.constrainDelta,.45,{x:0,y:0,ease:"easeOutQuad",delay:0});o.copy(s)}else if(T===w.DOLLY){if(i.noZoom===true)return;v.set(e.clientX,e.clientY);m.subVectors(v,d);if(m.y>0){i.dollyIn()}else{i.dollyOut()}d.copy(v)}else if(T===w.PAN){if(i.noPan===true)return;u.set(e.clientX,e.clientY);f.subVectors(u,h);i.pan(f.x,f.y);h.copy(u)}i.update()}function F(){if(i.enabled===false)return;i.domElement.removeEventListener("mousemove",k,false);i.domElement.removeEventListener("mouseup",F,false);i.dispatchEvent(C);T=w.NONE}function D(e){if(i.enabled===false||i.noZoom===true)return;e.preventDefault();e.stopPropagation();var t=0;if(e.wheelDelta!==undefined){t=e.wheelDelta}else if(e.detail!==undefined){t=-e.detail}if(t>0){i.dollyOut()}else{i.dollyIn()}i.update();i.dispatchEvent(E);i.dispatchEvent(C)}function U(e){if(i.enabled===false||i.noKeys===true||i.noPan===true)return;switch(e.keyCode){case i.keys.UP:i.pan(0,i.keyPanSpeed);i.update();break;case i.keys.BOTTOM:i.pan(0,-i.keyPanSpeed);i.update();break;case i.keys.LEFT:i.pan(i.keyPanSpeed,0);i.update();break;case i.keys.RIGHT:i.pan(-i.keyPanSpeed,0);i.update();break}}function O(e){if(i.enabled===false)return;switch(e.touches.length){case 1:if(i.noRotate===true)return;T=w.TOUCH_ROTATE;o.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(i.noZoom===true)return;T=w.TOUCH_DOLLY;var t=e.touches[0].pageX-e.touches[1].pageX;var r=e.touches[0].pageY-e.touches[1].pageY;var n=Math.sqrt(t*t+r*r);d.set(0,n);break;case 3:if(i.noPan===true)return;T=w.TOUCH_PAN;h.set(e.touches[0].pageX,e.touches[0].pageY);break;default:T=w.NONE}i.dispatchEvent(E)}function j(e){if(i.enabled===false)return;e.preventDefault();e.stopPropagation();var t=i.domElement===document?i.domElement.body:i.domElement;switch(e.touches.length){case 1:if(i.noRotate===true)return;if(T!==w.TOUCH_ROTATE)return;s.set(e.touches[0].pageX,e.touches[0].pageY);l.subVectors(s,o);i.constrainDelta.x=l.x;i.constrainDelta.y=l.y;n.killTweensOf(i.constrainDelta);n.to(i.constrainDelta,.45,{x:0,y:0,ease:"easeOutQuad",delay:0});o.copy(s);i.update();break;case 2:if(i.noZoom===true)return;if(T!==w.TOUCH_DOLLY)return;var r=e.touches[0].pageX-e.touches[1].pageX;var a=e.touches[0].pageY-e.touches[1].pageY;var c=Math.sqrt(r*r+a*a);v.set(0,c);m.subVectors(v,d);if(m.y>0){i.dollyOut()}else{i.dollyIn()}d.copy(v);i.update();break;case 3:if(i.noPan===true)return;if(T!==w.TOUCH_PAN)return;u.set(e.touches[0].pageX,e.touches[0].pageY);f.subVectors(u,h);i.pan(f.x,f.y);h.copy(u);i.update();break;default:T=w.NONE}}function V(){if(i.enabled===false)return;i.dispatchEvent(C);T=w.NONE}this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},false);this.domElement.addEventListener("mousedown",L,false);this.domElement.addEventListener("mousewheel",D,false);this.domElement.addEventListener("DOMMouseScroll",D,false);this.domElement.addEventListener("touchstart",O,false);this.domElement.addEventListener("touchend",V,false);this.domElement.addEventListener("touchmove",j,false);window.addEventListener("keydown",U,false);this.update()}i(t,e.EventDispatcher);return t}},{gsap:130,inherits:132}]},{},[248]);